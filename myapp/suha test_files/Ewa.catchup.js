Type.registerNamespace("_Ewa");_Ewa.DR=function(){};_Ewa.bcE=function(){};_Ewa.tL=function(){};_Ewa.bcF=function(){};_Ewa.bcG=function(){};_Ewa.bcH=function(){};_Ewa.bcI=function(){};_Ewa.bda=function(){};_Ewa.bdb=function(){};_Ewa.Eg=function(){};_Ewa.Eh=function(){};_Ewa.bdc=function(){};_Ewa.bdd=function(){};_Ewa.bdD=function(){};_Ewa.bdE=function(){};_Ewa.bdF=function(){};_Ewa.bdG=function(){};_Ewa.bdH=function(){};_Ewa.Em=function(){};_Ewa.bdI=function(){};_Ewa.bdJ=function(){};_Ewa.bdK=function(){};_Ewa.DR.registerClass("_Ewa.DR");_Ewa.tL.registerClass("_Ewa.tL");_Ewa.bcF.registerClass("_Ewa.bcF");_Ewa.Eg.registerClass("_Ewa.Eg");_Ewa.Eh.registerClass("_Ewa.Eh");_Ewa.bdD.registerClass("_Ewa.bdD");_Ewa.bdE.registerClass("_Ewa.bdE",_Ewa.bdD);_Ewa.bdF.registerClass("_Ewa.bdF",_Ewa.bdD);_Ewa.bdG.registerClass("_Ewa.bdG",_Ewa.bdD);_Ewa.bdH.registerClass("_Ewa.bdH");_Ewa.Em.registerClass("_Ewa.Em");Type.registerNamespace("Common.App.CatchUpActivity");Common.App.CatchUpActivity.j=function(){};Common.App.CatchUpActivity.j.registerInterface("Common.App.CatchUpActivity.j");Common.App.CatchUpActivity.g=function(n,t,i,r,u,f,e){this.p=Function.createDelegate(this,this.J);this.q=Function.createDelegate(this,this.K);this.r=Function.createDelegate(this,this.L);this.x=Function.createDelegate(this,this.w);this.E=Function.createDelegate(this,this.N);this.d=n;this.t=t;this.l=i;this.s=r;this.f=u;this.k=f;this.j=e;this.f.a(3602816928,2147483648,Common.w.a)};Common.App.CatchUpActivity.g.prototype={a:null,g:null,e:null,i:null,c:null,m:null,n:null,b:null,u:0,o:null,h:!1,d:null,t:null,l:null,s:null,f:null,k:null,j:null,y:null,v:null,A:!1,B:!1,z:null,C:!1,N:function(){if(!this.h&&(this.e=this.v?this.v:document.getElementById("WACDocumentPanel"),this.e)){if(this.s.x(),this.a=document.createElement("Div"),this.a.className="CatchUpActivityNotificationContainer CatchUpActivityNotificationContainerBorder",this.a.id="CatchUpNotification",this.e.appendChild(this.a),this.A&&this.i&&(this.n=document.createElement("Div"),this.n.className="CatchUpActivityNotificationBeakBorder CatchUpActivityNotificationBeak",this.a.appendChild(this.n),this.m=document.createElement("Div"),this.m.className="CatchUpActivityNotificationBeak",this.a.appendChild(this.m)),this.G(this.y,this.B,this.z,this.C),this.O(),this.i){var n=Sys.UI.DomElement.getBounds(this.i),t=Sys.UI.DomElement.getBounds(this.e);this.a.style.top=n.y-t.y+this.i.clientHeight+12+"px"}else this.a.style.bottom="-"+(this.a.clientHeight+10)+"px";this.Q();this.h=!0;Common.a.b().a().g()||(this.u=window.setTimeout(this.x,1e4));this.M()}},O:function(){this.d.a("click",this.a,this.r);this.d.a("click",this.g,this.q);this.b&&this.d.a("click",this.b,this.p)},R:function(){this.d.b("click",this.a,this.r);this.d.b("click",this.g,this.q);this.b&&this.d.b("click",this.b,this.p)},G:function(n,t,i,r){this.g=this.F();this.a.appendChild(this.g);this.c=document.createElement("Div");this.c.className="CatchUpActivityNotificationMessageContainer";this.c.setAttribute("aria-live","polite");this.c.setAttribute("aria-atomic","true");this.c.setAttribute("role","alert");this.a.appendChild(this.c);this.c.appendChild(this.I());this.c.appendChild(this.H(n,r));t&&(this.b=document.createElement("button"),this.b.className="CatchUpActvitiyNotificationButton",this.b.innerText=i?i:$a.dY,this.c.appendChild(this.b))},I:function(){var n=document.createElement("Div");return n.className="CatchUpActivityNotificationTitle",n.innerText=$a.dZ,n},H:function(n,t){var u=document.createElement("Div"),f,o,e,i,r,h,s;if(u.className="CatchUpActivityNotificationMessage",t||(f=document.createElement("Div"),f.className="CatchUpActivityNotificationDotContainer",o=document.createElement("Div"),o.className="CatchUpActivityNotificationDot",f.appendChild(o),u.appendChild(f),e=document.createElement("span"),e.className="CatchUpActivityNotificationNewText",e.innerText=$a.ea,u.appendChild(e)),i=document.createElement("span"),i.className="CatchUpActivityNotificationMessageText",!n||n.length<1)i.innerText=$a.eb;else{switch(n.length){case 1:r=$a.ee;break;case 2:r=$a.eg;break;case 3:r=$a.ef;break;case 4:r=$a.ec;break;default:r=$a.ed}h=this;s=function(n){var t;return t=document.createElement("span"),t.setAttribute("dir","auto"),t.style.fontFamily="'Segoe UI Semibold', 'Segoe UI Web', Arial, Verdana, sans-serif",t.setAttribute("unselectable","on"),t.innerText=n,t};Common.o.u(i,r,n,s)}return i.setAttribute("dir","auto"),u.appendChild(i),u},F:function(){var n=document.createElement("a"),t;return n.className="CatchUpActivityNotificationCloseAnchor",n.href="#",t=Common.O.a(16,16,"ClosePaneGlyph_16x16x32","CatchUpActivityNotificationCloseIcon",!0,$a.b),n.appendChild(t),n},K:function(){return Diag.a.a(50643481,207,50,"Close button was clicked on Catch-Up Activity Notification callout."),this.f.d(3602816928,2,null),this.w(),!0},w:function(){if(this.h)if(Common.a.b().a().g()){if(this.o){var n=this,t=this;Common.UISurfaces.b().then(function(t){return t.removeNotification(n.o),n.o=null,n.D(!0),null},function(n){return Diag.a.a(593352346,383,15,"Failed to GetNotificationsAPIAsync: {0}",n),null})}}else this.D(!1)},D:function(n){this.e&&this.a&&this.e.contains(this.a)&&(this.R(),this.e.removeChild(this.a),n||window.clearTimeout(this.u));this.h=!1;!n&&this.k&&this.k.a(this)},L:function(){return!0},J:function(){return Diag.a.a(50643482,207,50,"Primary Button was clicked on Catch-Up Activity Notification callout."),Common.K.b(1206905761,!0,"",0,0,0,null),this.f.d(1750752436,2,null),this.w(),!0},Q:function(){var n=this.t.a("CatchUpNotification"),t;n.d="main";this.d.d("CatchUpNotification",this.a,!1);t=this;n.p(function(){t.P()});this.l.a("CatchUpNotification");this.l.b("CatchUpNotification")},P:function(){this.b&&(Diag.a.a(50643483,207,50,"Focus was set to the Button on the Activity Notification Callout."),this.b.focus())},M:function(){if(Diag.a.a(37552158,207,50,"The Catch-Up Activity Notification callout was shown in the UI."),!this.j){Diag.a.a(50656925,207,15,"CatchUpActivityNotification ISystemInitiatedFeedback was null");return}var n=2e4,t=this;this.j.CW(function(){window.setTimeout(function(){t.j.a().a("CatchUpChangesFeedback",null,null)},n)})}};Common.App.CatchUpActivity.h=function(){};Common.App.CatchUpActivity.h.a=function(){Common.App.a.a().a(new Common.App.CatchUpActivity.h,0,!1)};Common.App.CatchUpActivity.h.prototype={d:null,a:function(){return"Common.App.CatchUpActivity"},c:function(n){var t,u,i,r;this.d=n;t=this;this.d.c(Common.App.CatchUpActivity.j,null).a().b(function(){return new Common.App.CatchUpActivity.g(Common.i.a(),Common.p.a(),Common.cl.a(),Common.a.b(),Common.a.c(),t.d.a(CommonUI.n,null),Common.Utils.b.a(Common.bn,t.d.b(Common.bn,null)))});u=this;this.d.c(Common.App.CatchUpActivity.d,null).c(Common.App.CatchUpActivity.c,null).a().b(function(){return new Common.App.CatchUpActivity.d(Common.a.e,new Common.App.CatchUpActivity.k(window.performance))});i=this;this.d.c(Common.App.CatchUpActivity.e,null).c(Common.App.CatchUpActivity.a,null).a().b(function(){return new Common.App.CatchUpActivity.e(i.d.a(Common.App.CatchUpActivity.c,null),function(){return Common.a.i},new Common.dm)});r=this;this.d.c(Common.App.CatchUpActivity.b,null).a().b(function(){return new Common.App.CatchUpActivity.b(r.d.b(Common.bn,null))})},b:function(){this.d.a(Common.App.CatchUpActivity.c,null);this.d.a(Common.App.CatchUpActivity.a,null)}};Common.App.CatchUpActivity.d=function(n,t){this.b=n;this.c=t};Common.App.CatchUpActivity.d.prototype={b:null,c:null,a:function(n,t,i,r){var u=this;return this.d(n,r,function(n){return u.b.f(n,2,i,t,!1,2,null,null,null,!1,null,null,"2",null,!1,null)})},d:function(n,t,i){var r=!!t&&t!=="",u=n,f,e;return r&&(u=Common.k.e(n,"perfTag",t)),f=new Date,e=this,Common.eu.a(Common.cg,Common.cg,i(u),function(n){var i=new Date-f;return!n||!n.a||!n.a.a()?n:(r&&n.a.a().e&&e.e(n.a.a().e.getResolvedUrl(),t,i),n)})},e:function(n,t,i){var f=this.c.b(n),u,r;f.f.length&&(u=$$sc.b.s(f),u&&(r={},r.Message="Request durations for activities calls.",r.PerfTag=t,r.CustomDuration=i,r.PerformanceDuration=u.a.duration,Diag.a.a(592189641,3012,50,JSON.stringify(r))))}};Common.App.CatchUpActivity.e=function(n,t,i){this.d=n;this.b=t;this.c=i};Common.App.CatchUpActivity.e.prototype={d:null,b:null,c:null,a:function(n){var t=this,i=this;return Common.eu.a(Common.cg,Array,this.c.a(new Common.App.CatchUpActivity.i(this.b(),n),function(n,i,r){return t.d.a(n,i,r,"ActivityFeed")},null),function(n){if(!n)return Diag.a.a(572846937,3012,10,"GetActivityFeedEntries: Response is null"),null;if(!n.a)return Diag.a.a(572846938,3012,10,"GetActivityFeedEntries: Response.Args is null"),null;if(!n.a.a())return Diag.a.a(572846939,3012,10,"GetActivityFeedEntries: Response.Args.Data is null"),null;if(!n.a.a().b)return Diag.a.a(572846940,3012,10,"GetActivityFeedEntries: Response.Args.Data.ResponseData is null"),null;var t=Common.dm.a(n.a.a().b);return t?t:(Diag.a.a(572846941,3012,10,"GetActivityFeedEntries: Deserialized response is null"),null)})}};Common.App.CatchUpActivity.b=function(n){this.b=n;this.a=new $$sc.l};Common.App.CatchUpActivity.b.prototype={b:null,a:null,c:function(){this.d("CatchUpChangesFeedback",20)},d:function(n,t){if(!this.b){Diag.a.a(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null");return}var i=this,r=function(t){i.a.c(n)||(i.a.d(n),t.a(n,null,null))},u=this;this.b.a(function(n){if(!t){r(n);return}var i=t*1e3;window.setTimeout(function(){r(n)},i)})}};Common.App.CatchUpActivity.i=function(n,t){Common.App.CatchUpActivity.i.initializeBase(this,[n]);this.DocumentId=t};Common.App.CatchUpActivity.i.prototype={a:function(){return 6},DocumentId:null};Common.App.CatchUpActivity.k=function(n){this.a=n};Common.App.CatchUpActivity.k.prototype={a:null,b:function(n){var t=new($$sc.v.$$(Common.App.CatchUpActivity.f)),i,f;if(!this.a||(i=this.a.getEntriesByName(n,"resource"),!i))return t;for(var u=i,e=u.length,r=0;r<e;++r)f=u[r],t.b(new Common.App.CatchUpActivity.f(f));return t}};Common.App.CatchUpActivity.f=function(n){this.a=n};Common.App.CatchUpActivity.f.prototype={a:null};Common.App.CatchUpActivity.g.registerClass("Common.App.CatchUpActivity.g",null,Common.App.CatchUpActivity.j);Common.App.CatchUpActivity.d.registerClass("Common.App.CatchUpActivity.d",null,Common.App.CatchUpActivity.c);Common.App.CatchUpActivity.e.registerClass("Common.App.CatchUpActivity.e",null,Common.App.CatchUpActivity.a);Common.App.CatchUpActivity.b.registerClass("Common.App.CatchUpActivity.b");Common.App.CatchUpActivity.i.registerClass("Common.App.CatchUpActivity.i",Common.iI);Common.App.CatchUpActivity.f.registerClass("Common.App.CatchUpActivity.f");Common.App.CatchUpActivity.h.a();Type.registerNamespace("_Ewa");_Ewa.bmR=function(){};_Ewa.bmR.a=function(){Common.P.a('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}')};_Ewa.bmR.a();Type.registerNamespace("_Ewa");_Ewa.bgc=function(){};_Ewa.bgc.registerInterface("_Ewa.bgc");_Ewa.GZ=function(n,t){this.b=n;this.a=t};_Ewa.GZ.prototype={a:null,b:null,B:function(n,t){return this.a?t===-876699925?!this.a.a():!1:!0},z:function(n,t){var i=!1;switch(t.a){case-876699925:i=this.a.c()}return i?$$sc.a.a(Boolean,!0):_Ewa.X.a(t.a)},y:function(n,t){return _Ewa.a.a(494)&&t.a===-876699925?!0:!1},A:function(){return!1}};_Ewa.vl=function(n){_Ewa.vl.initializeBase(this,[n])};_Ewa.vl.a=function(n){_Ewa.bg.a(285,new _Ewa.vl(n))};_Ewa.vl.prototype={m:function(){var n=this;this.i.a().c(_Ewa.hO,286,function(t){n.n([new _Ewa.GZ(n.i,t)],null)},null)}};_Ewa.Ha=function(n,t){this.a=n;this.b=t};_Ewa.Ha.prototype={a:null,b:!1,doesContentExist:function(n){var t,i;if(!n)return Diag.a.a(590348556,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(n.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return n.navigationId?(t={},t.NavigationId=atob(n.navigationId),i=this.a.c(567929329,2,t,null),i===32):(Diag.a.a(590348555,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1);default:return!1}}};_Ewa.Hf=function(n,t,i){_Ewa.Hf.initializeBase(this);this.c=n;this.a=t;this.b=i};_Ewa.Hf.prototype={c:null,a:null,b:!1};_Ewa.Hb=function(n){_Ewa.Hb.initializeBase(this);this.a=n};_Ewa.Hb.prototype={a:!1};_Ewa.on=function(n,t,i){this.d=[];_Ewa.on.initializeBase(this,[!1]);this.h=n;this.a=t;this.f=i;this.l()};_Ewa.on.prototype={c:null,h:null,f:null,k:function(n){this.eo("cuahscek",n)},p:function(n){this.ep("cuahscek",n)},r:function(n){this.eo("cuasfek",n)},u:function(n){this.ep("cuasfek",n)},q:function(n){this.eo("cuadfek",n)},t:function(n){this.ep("cuadfek",n)},a:null,dispose:function(){System.a.b([this.a]);System.a.b(this.d);this.a=null;this.d=null;this.f=null;_Ewa.bX.prototype.dispose.call(this)},n:function(n){if((!n||this.a.a!==2)&&(n||this.a.a===2)){var t=this.a.a;this.a.a=n?2:this.f.a()?0:1;this.i(t)}},g:function(n){if((!n||this.a.a!==3)&&(n||this.a.a===3)){!n&&this.c&&this.j(this.c,!0);var t=this.a.a;this.a.a=n?3:this.f.a()?0:1;this.i(t)}},m:function(n,t){n&&(t&&(this.c=n),Sys.UI.DomElement.addCssClass(n,"CatchUpActivityHighlightEnlargedDot"))},j:function(n,t){if(t){if(this.c){Sys.UI.DomElement.removeCssClass(this.c,"CatchUpActivityHighlightEnlargedDot");this.c=null;return}}else{if(!n)return;if(this.c&&this.c.id===n.id)return;Sys.UI.DomElement.removeCssClass(n,"CatchUpActivityHighlightEnlargedDot")}},v:function(n){if((!n||this.a.a!==1)&&(n||this.a.a)){var t=this.a.a;this.a.a=n?1:0;this.i(t)}},o:function(n,t){var i=new _Ewa.Hf(this.a.b,n,t);this.em("cuasfek",i,this)},s:function(n){var t=new _Ewa.Hb(n);this.em("cuadfek",t,this)},i:function(n){var t=new _Ewa.Hd(this.a.b,this.a.a,n);this.em("cuahscek",t,this)}};_Ewa.Hc=function(n){this.w=Function.createDelegate(this,this.I);this.C=Function.createDelegate(this,this.Q);this.A=Function.createDelegate(this,this.N);this.o=Function.createDelegate(this,this.T);this.z=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.L);this.B=Function.createDelegate(this,this.O);this.x=Function.createDelegate(this,this.K);this.g={};this.l=n;this.f=_Ewa.c.a(this.l);this.k=this.f.a();this.p=this.f.f();this.k.z(this.x);this.k.h(this.B);this.f.L(this.y);this.p.d(this.z);this.m=null;this.h=null;this.n=!1;this.s={}};_Ewa.Hc.prototype={l:null,f:null,k:null,p:null,i:null,h:null,m:null,n:!1,q:null,j:null,s:null,u:null,c:function(n){return this.i=n,n},D:!1,a:function(){return this.D},v:function(){return this.u||(this.u=this.l.a().a(_Ewa.dh,65,!1,null)),this.u},F:function(){return this.q||(this.q=new _Ewa.Hh),this.q},dispose:function(){this.k.C(this.x);this.k.k(this.B);this.f.M(this.y);this.p.c(this.z);this.G();this.f=null;this.k=null;this.p=null;this.j=null;this.m=null;this.h=null;this.s=null},d:function(n){var t,i,u,f,o;if(this.G(),!_Ewa.bt.a(n)){if(Diag.a.a(42795989,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights()."),this.g=this.F().f(this.l,n,this),this.g){t=this.g;for(i in t){u={key:i,value:t[i]};f=u.value;for(var e=f,s=e.length,r=0;r<s;++r)o=e[r],this.H(o)}}this.F().i(this.l)}},e:function(n){var t,i,u,f,o;if(n&&this.D){Diag.a.b(40482380,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");return}if(n||this.r(),this.g){t=this.g;for(i in t){u={key:i,value:t[i]};f=u.value;for(var e=f,s=e.length,r=0;r<s;++r)o=e[r],o.v(n)}}},b:function(n){var t,u;if(this.h&&this.t(!0),this.E(),t=this.g[n.activityId],!t){Diag.a.a(40482385,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select");return}for(var r=t,f=r.length,i=0;i<f;++i)u=r[i],u.g(!0)},G:function(){var n,t,u,f,r;if(this.g){n=this.g;for(t in n){u={key:t,value:n[t]};f=u.value;for(var e=f,o=e.length,i=0;i<o;++i)r=e[i],this.P(r),r.dispose()}}this.g={};this.F().h();this.q=null},N:function(n,t){switch(t.a){case 0:case 1:t.c===3&&(this.J(),this.j=null);break;case 2:break;case 3:this.E();this.j=t.b;this.R();break;default:Diag.a.b(40482382,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+t.a)}},R:function(){var n,t;if(this.v()&&(n=this.g[this.j],n&&n.length>0&&n[0].a.e===3)){if(t=n[0],!t){Diag.a.b(50606102,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null.");return}this.v().bE(t.z())}},J:function(){this.v()&&this.v().bd()},E:function(){var n,r;if(this.j){if(n=this.g[this.j],!n){Diag.a.a(40482386,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection");return}for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],r.g(!1);this.j=null}},K:function(){this.r()},O:function(){this.r()},L:function(){this.r()},M:function(){this.r()},r:function(){this.E();this.t(!0)},Q:function(n,t){var r,i;if(this.i&&t.a!==this.h){if(t.b&&this.t(!0),r=this.S(t.a),!r){Diag.a.b(41996808,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null.");return}this.i.createActivityIndicatorTooltip((i=new _Ewa.DF,i.target=t.a,i.container=r,i.activityIds=[t.c],i.isSticky=t.b,i.dirHint=this.f.d()?12:9,i));t.b?(this.h=t.a,Diag.a.a(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(this.m=t.a,Diag.a.a(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event."));this.n||(this.f.i().d(this.o),this.f.z(this.o),this.n=!0)}},S:function(n){if(!n)return Diag.a.b(41996809,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;var i=String.format("{0}-{1}",n.id,"Flyout"),t=this.s[i];if(!t){if(!this.f.k())return Diag.a.b(41996810,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;t=document.createElement("Div");t.className="CatchUpActivityFlyoutContainer";t.id=i;this.f.k().appendChild(t);this.s[i]=t}return t},I:function(n,t){this.t(t.a)},T:function(){var n,t;if(!this.i){Diag.a.b(578421981,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.");return}this.h&&this.i.updateActivityIndicatorTooltip((n=new _Ewa.tI,n.target=this.h,n.isSticky=!0,n));this.m&&this.i.updateActivityIndicatorTooltip((t=new _Ewa.tI,t.target=this.h,t.isSticky=!1,t))},t:function(n){if(this.i){var t;this.i.dismissActivityIndicatorTooltips((t=new _Ewa.DG,t.clearSticky=n,t));this.m=null;n&&(this.h=null);this.n&&!this.h&&(this.f.i().c(this.o),this.f.D(this.o),this.n=!1)}},H:function(n){n.k(this.A);n.r(this.C);n.q(this.w)},P:function(n){n.p(this.A);n.u(this.C);n.t(this.w)}};_Ewa.bgb=function(n,t,i,r){_Ewa.bgb.initializeBase(this,[!1]);this.h=n;this.b=t;this.e=i;this.g=r;this.a=0};_Ewa.bgb.prototype={h:null,g:0,a:0,b:null,e:0,dispose:function(){this.b=null;_Ewa.bik.prototype.dispose.call(this)}};_Ewa.Hd=function(n,t,i){_Ewa.Hd.initializeBase(this);this.b=n;this.a=t;this.c=i};_Ewa.Hd.prototype={b:null,a:0,c:0};_Ewa.CatchUpActivityManager=function(n,t,i){var r,f,u;this.l=Function.createDelegate(this,this.u);this.d=n;this.e=new _Ewa.Hc(this.d);this.i=new _Ewa.Ha(Common.a.c(),_Ewa.a.a(525));r=null;_Ewa.qE.b()&&(r=Common.Utils.b.b(Common.App.CatchUpActivity.a,Common.Utils.a.a().b(Common.App.CatchUpActivity.a,null)));this.k=new _Ewa.eH(this.d,this,r);this.j=new _Ewa.He(Common.a.c());_Ewa.a.c("Microsoft.Office.Excel.EmptyCatchUpExperience",!1)&&_Ewa.a.a(563)&&(this.m=new _Ewa.Hg(this.d));f=this;this.r(function(n){f.t(n)},t);this.s();u=null;_Ewa.qE.a()&&!i&&(u=Common.Utils.a.a().a(Common.App.CatchUpActivity.b,null));this.g=i||new _Ewa.qG(u);this.n=new _Ewa.Hi(this.d,this.g);this.h=null};_Ewa.CatchUpActivityManager.a=function(){return _Ewa.a.c("Microsoft.Office.Excel.CatchUpTasksAndOutstandingDataEnabled",!1)};_Ewa.CatchUpActivityManager.prototype={f:null,d:null,e:null,k:null,j:null,i:null,m:null,n:null,g:null,o:!1,h:null,a:function(){var n=this.g.b;return n&&!this.o&&(Diag.a.a(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.o=!0),n},b:function(){return this.g.a},p:!1,dispose:function(){this.h=null;this.f&&this.f.getWywaEvent().removeListener(this.l);this.d=null;this.f=null;System.a.a(this.e);this.e=null;this.k=null;this.j=null;this.i=null;this.n=null;this.g=null},c:function(){return this.g.f(),!0},q:function(n){n&&(this.h=n.ActivityList)},s:function(){Diag.a.a(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");_Ewa.CatchUpActivityManager.a()&&Diag.a.a(594401288,3012,50,"Tasks and outstanding data is enabled")},u:function(n){(this.e.d(this.h),this.h=null,this.e.e(!0),n.wywaActivities&&n.wywaActivities.length&&n.wywaActivities[0].type!==2)&&this.e.b(n.wywaActivities[0])},r:function(n,t){_Ewa.qF.a("ScriptDownload");var i=this;_Ewa.g.a(_Ewa.m.b(Common.bm,this.d.a(),283,284,t,null),function(t){n($$sc.h.a(Object,t.a().a().loadScript("catchUpActivity")))},this.d.a().d(),3,null,null)},t:function(n){var t=this;_Ewa.g.a(n,function(){Common.cP.a(function(){var n;t.f=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance((n=new _Ewa.DJ,n.activityContentManager=$$as(_Ewa.tE,t.i),n.activityNavigationManager=$$as(_Ewa.tF,t.j),n.activityRequestManager=$$as(_Ewa.tG,t.k),n.dataCulture=t.d.e().DataCultureTag,n.flyoutFocus=null,n.flyoutRibbonButton=$$as(_Ewa.qG,t.g),n.uiCulture=t.d.e().UICultureTag,n.ulsLogger=new UlsExternalLogger,n.emptyCatchUpBehaviorManager=$$as(_Ewa.tH,t.m),n))});t.e.c(t.f.getActivityIndicatorTooltipManager());_Ewa.lo.a(t.d);t.f.getWywaEvent().addListener(t.l);_Ewa.qF.a("InitializeCatchUpApp");var n;t.f.initialize((n=new _Ewa.DE,n.featuredActivityGroupsEnabled=!1,n.flyoutEnabled=!0,n.summaryStringEnabled=!1,n))},this.d.g(),3,null,null)}};_Ewa.vm=function(n){_Ewa.vm.initializeBase(this);this.i=n;this.l()};_Ewa.vm.a=function(n){n.a().b(_Ewa.bmn.$$(_Ewa.hO),287,new _Ewa.vm(n))};_Ewa.vm.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.hO,286,!1,null)||new _Ewa.CatchUpActivityManager(this.i,this.j,null))}};_Ewa.He=function(n){this.b=n};_Ewa.He.prototype={b:null,navigateToActivity:function(n){var r=n.activity,t,i,u,f;if(!this.c(r))return this.a(4);if(!this.d(r))return this.a(7);t={};try{if(i=window.self.atob(r.navigationId),!i||!i.length)return this.a(5);t.NavigationId=i}catch(e){return Diag.a.a(590956161,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",e),this.a(5)}return this.b.c(567929329,2,t,null)===8?(this.b.d(1938400843,2,null),this.a(2)):(u=this.b.c(36098707,2,t,null),f=u===32?1:6,this.a(f))},c:function(n){return!n||!n.navigationId?!1:!0},d:function(n){switch(n.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}},a:function(n){return Promise.resolve(n)}};_Ewa.vn=function(){};_Ewa.vn.b=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.getWywaActivitiesDataRequest=t,_Ewa.k.a(n,"GetWywaActivitiesData",o,i,r,u,f,0,null,null)};_Ewa.vn.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.getRelevantActivitiesDataRequest=t,_Ewa.k.a(n,"GetRelevantActivitiesData",o,i,r,u,f,0,null,null)};_Ewa.qE=function(){};_Ewa.qE.a=function(){return _Ewa.a.b("OfficeVSO:5033904_FloodgateEventLoggingIsEnabled")};_Ewa.qE.b=function(){return _Ewa.a.b("OfficeVSO:5178376_ResolveCatchUpRequestHandlerFromContainer")};_Ewa.Hg=function(n){this.a=n};_Ewa.Hg.prototype={a:null,shouldShowEmptyExperienceButton:function(){var n=this.a.a().a(_Ewa.jW,365,!1,null);return this.a.b().X()&&(!n||!n.b())},onButtonClick:function(){var n={InputMethod:_Ewa.H.a};this.a.h().a(new _Ewa.J(1834994092,_Ewa.H.a,this.a.q(),16,null),n,null)}};_Ewa.Hh=function(){this.b=new($$sc.v.$$(_Ewa.bY));this.a={};this.c={}};_Ewa.Hh.prototype={b:null,a:null,c:null,h:function(){this.b=null;this.a=null;this.c=null},i:function(n){_Ewa.c.a(n).j().d([24],null,null)},f:function(n,t,i){for(var r,e,o,u,d,g,v,f,tt,y,s={},p=t,it=p.length,h=0;h<it;++h)if(r=p[h],r&&!_Ewa.bt.a(r.LocationList)){for(var w=[],c={},b=[],k=r.LocationList,rt=k.length,l=0;l<rt;++l){if(e=k[l],!e){Diag.a.b(50731148,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+r.Id);break}switch(e.Type){case 0:o=e;u=null;"0"in c?(u=c["0"],g=o.RangeList,u.w(g)):(d=o.RangeList,u=new _Ewa.Hj(n,new _Ewa.vo(n,r.Id,r.Type,0,d),i),w.push(u),c["0"]=u);for(var nt=o.RangeList,ut=nt.length,a=0;a<ut;++a)v=nt[a],f=new _Ewa.bY(_Ewa.h.b(v),_Ewa.C.a(n.d().b(v.SheetName))),this.d(f)in this.a?(tt=this.a[this.d(f)],tt.push(u)):(y=[],y.push(u),this.a[this.d(f)]=y),b.push(f),this.b.b(f);break;default:Diag.a.a(50731149,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}Diag.a.b(50731150,0,!(r.Id in s),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+r.Id);this.c[r.Id]=b;s[r.Id]=w}return this.g(n,this.b.g(),this.a),s},e:function(n){var r=n,t,u,f,o;for(t in r){u={key:t,value:r[t]};f=u.value;for(var e=f,s=e.length,i=0;i<s;++i)o=e[i],o.C()}},d:function(n){return String.format("{0}-{1}",n.a,n.b)},g:function(n,t,i){this.e(i);var r=_Ewa.c.a(n).j(),u=this;r.c(t,[24],!0,function(n,t){var h=new _Ewa.bY(n.a,n.i),e=u.d(h),o=i[e],f;if(!o){Diag.a.b(50731151,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+e);return}for(var s=o,c=s.length,r=0;r<c;++r)f=s[r],f.x(t),n.h=f},!0)}};_Ewa.qF=function(){};_Ewa.qF.a=function(n){window.performance&&typeof window.performance.mark=="function"&&window.performance.mark("CatchUpInit."+n)};_Ewa.eH=function(n,t,i){this.a=n;this.b=t;this.c=i;this.e=Common.Utils.a.a().a(Common.App.People.d,null);this.f=Common.Utils.a.a().a(Common.App.People.i,null)};_Ewa.eH.h=function(n){switch(n){case 1:return 1;case 2:return 1002;case 3:return 2;case 5:return 1003;case 8:return 1006;case 7:return 1005;case 9:return 1007;default:return 1}};_Ewa.eH.g=function(n){switch(n){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return Diag.a.b(51499465,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};_Ewa.eH.c=function(n){return String.format("{0}/{1}",n.Provider,n.Id)};_Ewa.eH.f=function(n){var f=_Ewa.eH.e(n);if(_Ewa.bt.a(f))return null;var i,t=(i=new _Ewa.DH,i.region=f.join(_Ewa.eH.b),i.type=100,i.subregion=[],i),r=0,u=0,e,o;return _Ewa.eH.d(n,e={val:r},o={val:u}),r=e.val,u=o.val,u?r||(u===1?t.type=107:u>1&&(t.type=107)):r===1?(t.type=105,t.subregion.push(_Ewa.h.b(n[0].RangeList[0]).toString())):r>1&&(t.type=106),t};_Ewa.eH.e=function(n){var r,t,i,o,f,s;if(!n)return null;r=[];t="";for(var e=n,h=e.length,u=0;u<h;++u)i=e[u],i.Type===1?(o=i,t=o.SheetName):i.Type?i.Type===2&&(s=i,t=s.SheetName):(f=i,t=f.RangeList?f.RangeList[0].SheetName:null),!t||!t.length||Array.contains(r,t)||r.push(t);return r};_Ewa.eH.d=function(n,t,i){var r,f,e;t.val=i.val=0;for(var o=n,s=o.length,u=0;u<s;++u)r=o[u],r.Type?r.Type===1&&(e=r,i.val+=e.XluidList?e.XluidList.length:0):(f=r,t.val+=f.RangeList?f.RangeList.length:0)};_Ewa.eH.prototype={a:null,b:null,c:null,e:null,f:null,requestWYWAActivities:function(){if(this.b.p){var n,t=(n=new _Ewa.tL,n.LowWaterline="",n.HighWaterline="",n);return this.h(t)}return Promise.resolve(_Ewa.eH.a)},requestActivities:function(n,t){if(t&&t.length){var i,r=(i=new _Ewa.tL,i.LowWaterline=t,i.HighWaterline=n,i);return this.h(r)}return Promise.resolve(_Ewa.eH.a)},requestRelevantActivities:function(){if(!this.a.b().a()||this.a.b().ba())return Diag.a.a(561584145,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.a.b().a(),this.a.b().ba()),Promise.resolve(_Ewa.eH.a);var n,i=(n=new _Ewa.DR,n.SetDaysBack=Common.a.a.c("AppWaterlineOverrideDaysValue",0),n.SetTimestamp=Common.a.a.c("AppWaterlineOverrideTimestampValue",0),n),t=this;return new Promise(function(n,r){var u=function(i){var r=_Ewa.eH.a,u;i?_Ewa.O.a(i)?Diag.a.a(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",_Ewa.j.a(i.Errors,",")):(u=i.Result,r=t.n(u)):Diag.a.a(51499462,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");n(r)},f=function(n){var t=_Ewa.W.a(n.b);Diag.a.a(51499463,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",_Ewa.j.a(t,","));r(null)};_Ewa.vn.a(t.a.c().a(),i,u,f,null,null,null)})},requestActivityFeed:function(){var n=this;return $$sc.h.toPromise$t(Array,this.j()).then(function(t){var i;return i=new _Ewa.DD,i.activityFeedItems=n.p(t),i})},j:function(){if(!this.c)return $$sc.a.a(Array,new Array(0));var n=this;return Common.eu.b(Common.App.CatchUpActivity.a,Array,this.c,function(t){return t.a(n.l())})},l:function(){var t=new RegExp("^(([^:/?#]+):)?(\\\\/\\\\/([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?"),n=t.exec(decodeURIComponent(Common.k.b(window.location.href,"WOPISrc",!0)))[5].split("/");return n[n.length-1]},h:function(n){var t=this;return new Promise(function(i,r){var f=function(n){var r=_Ewa.O.a(n)?null:n.Result,u=_Ewa.eH.a;r?u=t.k(r):Diag.a.a(39978721,0,10,"CatchUpActivityRequestManager::GetWywaActivitiesData call returned Null result.");t.b.q(r);i(u)},e=function(){Diag.a.a(39978720,0,10,"GetWywaActivitiesData call to WFE has Failed. Rejecting Promise.");t.b.q(null);r(null)},u=function(i,r,u){return _Ewa.vn.b(t.a.c().a(),n,_Ewa.p.a(i,f),_Ewa.p.b(r,e),u,null,null)};_Ewa.a.d()?t.a.f().a(new _Ewa.x(535,0,u,80,null),null):t.a.f().a(new _Ewa.bd(535,0,u,16,null),null)})},k:function(n){var t,i=(t=new _Ewa.nY,t.activities=this.r(n.ActivityList),t.actors=this.o(n.ActivityList),t.hasMore=n.HasMore,t.highWaterline=n.HighWaterline||"<WywaWaterline>DefaultWaterline<\/WywaWaterline>",t.lowWaterline=n.LowWaterline||"<WywaWaterline>DefaultWaterline<\/WywaWaterline>",t.wywaWaterline=n.WywaWaterline||"<WywaWaterline>DefaultWaterline<\/WywaWaterline>",t);return _Ewa.bt.a(i.activities)&&(Diag.a.b(39978723,0,i.lowWaterline==="<WywaWaterline>DefaultWaterline<\/WywaWaterline>","LowWaterline was not set to DefaultExcelWaterline when Activities Array was Null or Empty"),Diag.a.b(39978722,0,i.highWaterline==="<WywaWaterline>DefaultWaterline<\/WywaWaterline>","HighWaterline was not set to DefaultExcelWaterline when Activities Array was Null or Empty"),Diag.a.b(39978752,0,i.wywaWaterline==="<WywaWaterline>DefaultWaterline<\/WywaWaterline>","WywaWaterline was not set to DefaultExcelWaterline when Activities Array was Null or Empty")),Diag.a.a(42002571,0,50,"CatchUpActivityRequestManager::GetActivityRequestPayload: Count of unique authors in CatchUp pane: {0}",i.actors.length),i},n:function(n){var t,i,f,o,u;if(!n)return Diag.a.a(578110038,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),t=new _Ewa.nY,t.activities=new Array(0),t;i=this.i(n.NewActivities,2);f=this.i(n.OutstandingActivities,3);for(var e=f,s=e.length,r=0;r<s;++r)o=e[r],i.push(o);return u=new _Ewa.nY,u.activities=i,u},r:function(n){for(var t,i,e,u=[],f=n,o=f.length,r=0;r<o;++r)t=f[r],t&&(Diag.a.b(42501920,0,!(!t.Id||!t.Id.length),"CatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.Id is null or empty"),Diag.a.b(42501921,0,!_Ewa.bt.a(t.LocationList),"CatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.LocationList is null or empty"),Diag.a.b(42501922,0,!!t.DisplayTimestamp,"CatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.DisplayTimestamp is 0"),Diag.a.b(42501923,0,!!t.Person,"CatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.Person is null"),e=(i=new _Ewa.tD,i.activityId=t.Id,i.type=_Ewa.eH.h(t.Type),i.actors=this.m(t.Person),i.location=_Ewa.eH.f(t.LocationList),i.displayTimestamp=new Date(t.DisplayTimestamp),i),u.push(e));return u},i:function(n,t){var e=[],i,f,r,u;if(!n||!n.length)return e;for(var s=n,h=s.length,o=0;o<h;++o){if(i=s[o],!i){Diag.a.b(51499464,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");continue}f=_Ewa.eH.g(i.Type);f===6||f===7||f===9||f===8?e.push((r=new _Ewa.DK,r.activityId=i.Id,r.type=f,r.displayTimestamp=new Date(i.DisplayTimestamp),r.navigationId=i.NavigationId,r.actors=this.g(i.People),r.relevancy=t,r.relationship=this.q(i.Relationship),r)):e.push((u=new _Ewa.tD,u.activityId=i.Id,u.type=f,u.displayTimestamp=new Date(i.DisplayTimestamp),u.navigationId=i.NavigationId,u.actors=this.g(i.People),u.relevancy=t,u))}return e},q:function(n){switch(n){case 1:return 1;case 2:return 2;case 3:return 3}return Diag.a.a(575522897,0,10,"Unexpected Relationship."),1},p:function(n){for(var i,t,e,u=new Array(0),f=n,o=f.length,r=0;r<o;++r)i=f[r],e=(t=new _Ewa.DC,t.id=i.id,t.type=i.type,t.collectionId=i.collectionId,t.activityState=i.activityState,t.activityFeedItemPayload=i.activityFeedItemPayload,t.timestamp=i.timestamp,t),u.push(e);return u},m:function(n){return[this.d(n)]},g:function(n){var t=[],r;if(!n||!n.length)return t;for(var u=n,f=u.length,i=0;i<f;++i)(r=u[i],r)&&t.push(this.d(r));return t},d:function(n){var t;return t=new _Ewa.DI,t.id=n.Id,t.provider=n.Provider,t.displayName=n.DisplayName,t.email=n.Email,t.imageUrl=this.f.a(n.Email,n.Provider,Common.a.i,0),t.color=this.e.a(new Common.App.People.c(null,null,n.DisplayName,null,!1,null),6,!0),t},o:function(n){for(var r,u,t=new _Ewa.w(!1),f=n,e=f.length,i=0;i<e;++i)r=f[i],u=_Ewa.eH.c(r.Person),t.d(u)||t.c(u,this.d(r.Person));return t.a}};_Ewa.Hi=function(n,t){this.b=n;this.c=t;_Ewa.bi.a(this.b).a(this);this.a=!1};_Ewa.Hi.prototype={b:null,c:null,a:!1,dispose:function(){_Ewa.bi.a(this.b).b(this)},C:function(){return document.getElementById("catchUpFlyoutContainer")},bF:function(){return this.c.a&&!this.a},bm:function(){return"CUF"},K:function(n,t){if(t)return!1;var i=document.getElementById("flyoutItem0");return i?(i.focus(),this.d(i),!0):(Diag.a.a(587747732,3012,10,"Could not find firstItem in flyout when setting up focus"),!1)},ej:function(n){return this.C()?_Ewa.b.e(this.C(),n):!1},cP:function(){this.a=!0},bS:function(){this.a=!1},d:function(n){var i,t;Sys.Browser.agent===Sys.Browser.Firefox?(i=document.createEvent("KeyboardEvent"),i.initKeyEvent("keydown",!0,!0,window.self,!1,!1,!1,!1,40,0),n.dispatchEvent(i)):(t=document.createEvent("Events"),t.initEvent("keydown",!0,!0),t.keyCode=40,t.which=40,n.dispatchEvent(t))}};_Ewa.qG=function(n){this.b=!1;this.a=!1;this.e=new Date;this.d=n};_Ewa.qG.prototype={d:null,b:!1,a:!1,c:null,e:null,registerButtonClickedEvent:function(n){this.c&&Diag.a.a(587747731,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.c=n.buttonClickedCallback},onFlyoutInitialized:function(){this.b&&Diag.a.a(587747730,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var n=(new Date).getTime()-this.e.getTime();Diag.a.a(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",n);this.b=!0;_Ewa.eb.a()&&_Ewa.eb.a().c(!0)},logFlightTriggers:function(){},f:function(){if(!this.b){Diag.a.a(587747729,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.");return}if(!this.c){Diag.a.a(587747728,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered.");return}this.c()},onFlyoutVisibilityChanged:function(n){this.a!==n.flyoutIsVisible&&(this.a=n.flyoutIsVisible,_Ewa.eb.a()&&_Ewa.eb.a().c(!0),_Ewa.qE.a()&&(this.a||this.d&&this.d.c()))}};_Ewa.Hj=function(n,t,i){_Ewa.Hj.initializeBase(this,[n,t,i]);this.e=_Ewa.c.a(n);this.b=t};_Ewa.Hj.prototype={e:null,b:null,dispose:function(){this.e=null;_Ewa.on.prototype.dispose.call(this)},x:function(n){var t=this.d[0];if(t){t.h(n);return}Diag.a.b(42795991,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.b.b)},C:function(){var n=this.d[0];n&&n.f()},w:function(n){var t=this.b;this.b.i(n)},z:function(){return this.b.e!==3?null:(Diag.a.b(50606105,0,this.b.d().length===1,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1."),_Ewa.h.b(this.b.d()[0]))},g:function(n){if(n){if(!this.b)return;this.B(this.D())}_Ewa.on.prototype.g.call(this,n)},l:function(){var n=this.y();Array.add(this.d,n);return},y:function(){return new _Ewa.Hk(this)},B:function(n){if(!n){Diag.a.b(40482388,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.");return}if(!n.SheetName){Diag.a.b(41493472,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null.");return}this.e.a().b().c(null,!0);this.e.p();this.e.cy(n,3,!1,_Ewa.F.bf)},D:function(){var i,n,t;return _Ewa.bt.a(this.b.d())?(Diag.a.b(42006230,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null):(i=this.h.d().a(),Diag.a.b(42006231,0,!!i,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null."),n=this.E(i.N,this.b.d()),!n&&(n=this.A(this.b.d()),!n))?null:(t={},t.SheetName=n.SheetName,t.FirstColumn=n.FirstColumn,t.FirstRow=n.FirstRow,t.LastColumn=n.FirstColumn,t.LastRow=n.FirstRow,t)},A:function(n){var r,t,i,u;if(_Ewa.bt.a(n))return null;for(r=null,t=0;t<n.length;t++)if((i=n[t].SheetName,!_Ewa.f.b(i,r,!1))&&(r=i,u=this.h.d().b(i),u&&!u.S))return n[t];return null},E:function(n,t){var r;if(t)for(var u=t,f=u.length,i=0;i<f;++i)if(r=u[i],_Ewa.f.b(r.SheetName,n,!1))return r;return null}};_Ewa.vo=function(n,t,i,r,u){_Ewa.vo.initializeBase(this,[n,t,i,r]);this.c=u;this.f=!1};_Ewa.vo.a=function(n,t){var i=n,r=t,u;return!i.SheetName||!r.SheetName?(Diag.a.b(42006232,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0):(u=i.SheetName.localeCompare(r.SheetName),u)?u:i.FirstColumn<r.FirstColumn||i.FirstColumn===r.FirstColumn&&i.FirstRow<r.FirstRow?-1:i.FirstColumn===r.FirstColumn&&i.FirstRow===r.FirstRow?0:1};_Ewa.vo.prototype={c:null,f:!1,d:function(){return this.f||(this.c.sort(_Ewa.vo.a),this.f=!0),this.c},i:function(n){for(var r,i=n,u=i.length,t=0;t<u;++t)r=i[t],this.c.push(r)},dispose:function(){this.c=null;_Ewa.bgb.prototype.dispose.call(this)}};_Ewa.Hk=function(n){this.c=Function.createDelegate(this,this.g);this.a=n;this.a.k(this.c);this.b=[]};_Ewa.Hk.prototype={b:null,a:null,dispose:function(){this.a.p(this.c);this.b=null},h:function(n){this.b.push(n)},f:function(){Array.clear(this.b)},g:function(){switch(this.a.a.a){case 1:this.d(!0);break;case 0:this.e(!1);break;case 2:case 3:this.e(!0);break;default:Diag.a.b(42795992,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+this.a.a.a)}},d:function(n){for(var i,u,r=this.b,f=r.length,t=0;t<f;++t)i=r[t],i.className="CatchUpActivityHighlight",u=document.getElementById(String.format("{0}-{1}",i.id,"HighlightContainer")),_Ewa.b.b(u,n,!0)},e:function(n){for(var i,r=this.b,u=r.length,t=0;t<u;++t)i=r[t],i&&(n?i.className=this.a.a.a===2?"RangeCatchUpActivityHighlightHovered":"RangeCatchUpActivityHighlightSelected":this.d(!1))}};_Ewa.GZ.registerClass("_Ewa.GZ",null,_Ewa.lE);_Ewa.vl.registerClass("_Ewa.vl",_Ewa.bg);_Ewa.Ha.registerClass("_Ewa.Ha",null,_Ewa.tE);_Ewa.Hf.registerClass("_Ewa.Hf",Sys.EventArgs);_Ewa.Hb.registerClass("_Ewa.Hb",Sys.EventArgs);_Ewa.on.registerClass("_Ewa.on",_Ewa.bX);_Ewa.bgb.registerClass("_Ewa.bgb",_Ewa.bik);_Ewa.Hd.registerClass("_Ewa.Hd",Sys.EventArgs);_Ewa.CatchUpActivityManager.registerClass("_Ewa.CatchUpActivityManager",null,_Ewa.hO,Sys.IDisposable);_Ewa.vm.registerClass("_Ewa.vm",_Ewa.sR.$$(_Ewa.hO));_Ewa.He.registerClass("_Ewa.He",null,_Ewa.tF);_Ewa.Hg.registerClass("_Ewa.Hg",null,_Ewa.tH);_Ewa.eH.registerClass("_Ewa.eH",null,_Ewa.tG);_Ewa.Hi.registerClass("_Ewa.Hi",null,_Ewa.pc,Sys.IDisposable);_Ewa.qG.registerClass("_Ewa.qG");_Ewa.Hj.registerClass("_Ewa.Hj",_Ewa.on);_Ewa.vo.registerClass("_Ewa.vo",_Ewa.bgb);_Ewa.Hk.registerClass("_Ewa.Hk",null,Sys.IDisposable);var $$t_0;_Ewa.eH.a=($$t_0=new _Ewa.nY,$$t_0.activities=new Array(0),$$t_0.actors=new Array(0),$$t_0.hasMore=!1,$$t_0.highWaterline="<WywaWaterline>DefaultWaterline<\/WywaWaterline>",$$t_0.lowWaterline="<WywaWaterline>DefaultWaterline<\/WywaWaterline>",$$t_0.wywaWaterline="<WywaWaterline>DefaultWaterline<\/WywaWaterline>",$$t_0);_Ewa.eH.b=", ";Type.registerNamespace("_Ewa");_Ewa.bfZ=function(){};_Ewa.bfZ.a=function(){_Ewa.n.a(function(n){_Ewa.qF.a("Begin");_Ewa.vm.a(n);_Ewa.vl.a(n)})};_Ewa.bfZ.a();Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Microsoft.Office.Excel.WebUI.Client.a=function(){};Microsoft.Office.Excel.WebUI.Client.a.registerInterface("Microsoft.Office.Excel.WebUI.Client.a");Microsoft.Office.Excel.WebUI.Client.b=function(n,t,i){Microsoft.Office.Excel.WebUI.Client.b.initializeBase(this,[n,t]);this.r=i};Microsoft.Office.Excel.WebUI.Client.b.prototype={r:null,k:function(n){return this.r.a(),_Ewa.WorkflowActivity.prototype.k.call(this,n)}};Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager=function(n){this.d=Function.createDelegate(this,this.h);this.b=n;_Ewa.a.a(747)&&this.b.b().X()&&!Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a&&(this.i(),Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.b?Diag.a.a(572400704,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):this.j());Diag.a.a(578076752,0,50,"LineageTeachingCalloutTriggerManager is initialized.")};Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.prototype={b:null,c:!1,dispose:function(){this.e();this.b=null;Diag.a.a(578076751,0,50,"LineageTeachingCalloutTriggerManager is disposed.")},a:function(){Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a||(Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a=!0,Diag.a.a(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.e()},j:function(){if(_Ewa.a.a(743)&&_Ewa.a.a(737)&&!this.b.cT()){var n=this,t=function(t){if(!n.b){Diag.a.a(570770392,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.");return}var i=t.Result;Diag.a.a(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",i);Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.b=!0;i&&n.f(0)},r=this,i=function(){Diag.a.a(578557779,0,10,"CheckLineageWywaChanges service call failed.")};_Ewa.k.I(this.b.c().a(),t,i,null,null)}},i:function(){_Ewa.a.a(742)&&(this.g()||(this.b.b().r(this.d),this.c=!0))},g:function(){return this.b.b()&&this.b.b().m()&&this.b.b().m().ShouldTriggerLineageCalloutOnMerge?(Diag.a.a(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.f(1),!0):!1},h:function(){this.g()},f:function(n){if(Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a){Diag.a.a(578557777,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");return}if(Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a=!0,Diag.a.a(578557776,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",n),this.e(),_Ewa.a.a(563)){var t=new _Ewa.J(-847286761,_Ewa.H.a,this.b.q(),0,"Help");this.b.h().a(t,{CalloutName:5},null)}},e:function(){this.c&&(this.c=!1,this.b.b().s(this.d))}};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Microsoft.Office.Excel.WebUI.Client.Lineage.g=function(n,t){this.a=n;this.b=t;var i=[new _Ewa.r("cw81",1038647878,0,0,2061,!1,0),new _Ewa.r("cw0",1038647878,0,1,0,!1,0)];_Ewa.R.a(this.a).j(new _Ewa.md("cw80","cw0",i),new Microsoft.Office.Excel.WebUI.Client.b("cw81","cw0",t))};Microsoft.Office.Excel.WebUI.Client.Lineage.g.prototype={b:null,a:null,B:function(){return!1},z:function(n,t,i){var r=!1;switch(t.a){case 1834994092:t.b===9&&this.e();this.c(t,i);r=!0;break;case-409942531:this.d();r=!0}return r?$$sc.a.a(Boolean,!0):_Ewa.X.a(t.a)},y:function(n,t){return t.a===1834994092||t.a===-409942531},A:function(){return!1},c:function(n,t){Diag.a.a(593854557,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",t.MenuItemId||n.b);var i=n.b===19&&!!t.MenuItemId;this.b.b(i,t.MenuItemId,n.b)},e:function(){var n=_Ewa.l.a()?"Review":this.a.l()+"Ribbon.Review";n!==_Ewa.bN.a(this.a).a().a()&&_Ewa.bN.a(this.a).a().b(n)},d:function(){var n=this,t=function(){var i=_Ewa.R.a(n.a).a(),t=_Ewa.j.b(3,1,2058,2059,2060,1038647878,"LineageConfirmClearHistory");t.HelpTopicId="978ceea7-bbf6-4337-bca7-22e7cc9892e8";t.HelpDescription=_Ewa.ClientStringManager.a().a(1227);i.d([t])};_Ewa.z.a(this.a).c(new _Ewa.cU("cw80",5,t))}};Microsoft.Office.Excel.WebUI.Client.Lineage.c=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.c.initializeBase(this,[n])};Microsoft.Office.Excel.WebUI.Client.Lineage.c.a=function(n){_Ewa.bg.a(363,new Microsoft.Office.Excel.WebUI.Client.Lineage.c(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.c.prototype={m:function(){var n=this;_Ewa.g.a(_Ewa.m.b(Microsoft.Office.Excel.WebUI.Client.a,this.i.a(),366,367,this.j,null),function(t){var i=t.a();n.n([new Microsoft.Office.Excel.WebUI.Client.Lineage.g(n.i,i)],null)},this.h(),3,null,null)}};Microsoft.Office.Excel.WebUI.Client.Lineage.h=function(n,t,i,r){this.l=Function.createDelegate(this,this.bc);this.v=Function.createDelegate(this,this.bg);this.i=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.bf);this.q=Function.createDelegate(this,this.Y);this.t=Function.createDelegate(this,this.bd);this.w=Function.createDelegate(this,this.bi);this.F=Function.createDelegate(this,this.V);this.E=Function.createDelegate(this,this.U);this.C=Function.createDelegate(this,this.S);this.D=Function.createDelegate(this,this.T);this.H=Function.createDelegate(this,this.X);this.I=Function.createDelegate(this,this.bb);this.J=Function.createDelegate(this,this.bh);this.G=Function.createDelegate(this,this.W);this.B=Function.createDelegate(this,this.R);this.K=Function.createDelegate(this,this.br);this.s=Function.createDelegate(this,this.ba);this.r=Function.createDelegate(this,this.Z);this.c=n;t.b(Microsoft.Office.Excel.WebUI.Client.a,366,this);this.f=_Ewa.c.a(this.c);this.e=i;this.n=this.e.m();this.x=50;this.g=r;this.h=this.c.n().b("UserAction","LineagePaneLoadingShimmerStopWatch");this.p=Common.Utils.a.a().a(Common.App.People.i,null);this.Q();this.N()};Microsoft.Office.Excel.WebUI.Client.Lineage.h.prototype={e:null,c:null,d:null,x:0,n:null,f:null,p:null,o:0,j:0,g:null,h:null,dispose:function(){this.bn();this.c=null;this.e&&(this.e.n(this.r),this.e.o(this.s),this.e=null);this.d=null;this.n=null;this.p=null;this.h=null},b:function(n,t,i){var u,f,r;if(this.e.b()){if(i===9&&_Ewa.a.b("OfficeVSO:4998263_PreventLineagePaneClosingOnTeachingUX")){Diag.a.a(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!n){this.e.k();return}}this.h.d();this.g&&(_Ewa.D.a().c(this.h.c(),this.g.c(),_Ewa.bh.toString(0),_Ewa.bh.toString(0),!0),this.g.a(),this.g=null);this.e.e()||Diag.a.a(591161311,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",n?t:i);this.j=this.c.b().d();u=null;n&&(f=_Ewa.h.d(this.f.a().a().b(),this.c),u=(r=new _Ewa.nj,r.rangeList=t.toString()==="GridContextMenu"?this.k(f.Ranges):null,r.sheetName=f.SheetName,r));this.d.createLineagePane(this.n,u);this.e.d(!0);this.c.w(-71295319,-1,0,null)},a:function(){var r={paneVisible:this.e.b()},n,i,t;Otel.Telemetry.a((n=new Otel.b,n.name="Office.Excel.Online.Lineage.ClearHistoryConfirmed",n.dataFields=Common.F.a(r,null,null),n));i=this;t=function(n,t,r){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.b(i.c.c().a(),n,t,r,null,null)};_Ewa.a.d()?this.c.f().a(new _Ewa.x(1018,0,t,64,null),null):this.c.f().a(new _Ewa.bd(1018,0,t,0,null),null)},Q:function(){var n,i=(n=new _Ewa.OP,n.tryParseRangeInfo=this.K,n.isFeatureEnabled=this.B,n.onCardSelected=this.G,n.onVersionHistoryButtonClicked=this.J,n.onRangeFilterInputEnabled=this.I,n.onLearnMoreLinkClicked=this.H,n.lineageOpenPaneOrChangeFilterRequest=this.D,n.lineageLoadMoreRequest=this.C,n.lineageRefreshViewRequest=this.E,n.lineageUpdateViewRequest=this.F,n),t=this;Common.cP.a(function(){var n;t.d=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController((n=new _Ewa.OR,n.clientBatchSize=t.x,n.filterableSheetList=t.m(),n.uiCulture=t.c.e().UICultureTag,n.dataCulture=t.c.e().DataCultureTag,n.logger=new UlsExternalLogger,n.lineageAppCallbacks=i,n))})},T:function(n,t){var i,f,r,u;this.h.a();_Ewa.ba.a(this.c).a(_Ewa.y.bn,{},null,!1);this.bo();f=(i=new _Ewa.Eg,i.ClientViewCapacity=n.clientViewCapacity,i);r=null;t&&(r=(u=new _Ewa.Eh,u.FilterSheetMultiRange=this.bq(t.filterSheetMultiRange),u));var h=this,s=function(n){var t=_Ewa.W.a(n.b);Diag.a.a(575447172,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",_Ewa.j.a(t,","))},e=this,o=function(n,t,i){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.d(e.c.c().a(),f,r,_Ewa.p.a(n,e.y("LineageOpenPaneOrChangeFilter")),_Ewa.p.b(t,s),i,null,null)};_Ewa.a.d()?this.c.f().a(new _Ewa.x(1010,0,o,80,null),null):this.c.f().a(new _Ewa.bd(1010,0,o,16,null),null)},S:function(n){_Ewa.ba.a(this.c).a(_Ewa.y.bm,{},null,!1);var u=this,r=function(n){var t=_Ewa.W.a(n.b);Diag.a.a(575447171,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",_Ewa.j.a(t,","))},t=this,i=function(i,u,f){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.c(t.c.c().a(),n,_Ewa.p.a(i,t.y("LineageLoadMore")),_Ewa.p.b(u,r),f,null,null)};_Ewa.a.d()?this.c.f().a(new _Ewa.x(1011,0,i,80,null),null):this.c.f().a(new _Ewa.bd(1011,0,i,16,null),null)},U:function(){_Ewa.ba.a(this.c).a(_Ewa.y.bo,{},null,!1);var r=this,i=function(n){var t=_Ewa.W.a(n.b);Diag.a.a(575447170,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",_Ewa.j.a(t,","))},n=this,t=function(t,r,u){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.e(n.c.c().a(),_Ewa.p.a(t,n.y("LineageRefreshView")),_Ewa.p.b(r,i),u,null,null)};_Ewa.a.d()?this.c.f().a(new _Ewa.x(1012,0,t,80,null),null):this.c.f().a(new _Ewa.bd(1012,0,t,16,null),null)},y:function(n){var t=this;return function(i){var r=_Ewa.O.a(i)?null:i.Result,f,u,e;if(!r){Diag.a.b(592724495,0,!!r,"LineageManager."+n+" returned null response.");return}f={CountOfActivities:r.ActivityList.length};f.WebRequestName=n;_Ewa.ba.a(t.c).a(_Ewa.y.bl,f,null,!1);e=(u=new _Ewa.ON,u.activityList=t.A(r.ActivityList),u.latestActivityId=r.LastSearchedActivityId,u.oldestActivityId=r.FirstSearchedActivityId,u.serverMessageCode=r.LineageResponseCode,u.lastSearchedActivityTimestamp=new Date(r.EcmaLastSearchedDate),u.serverFirstActivityId=r.ServerFirstActivityId,u.serverLastActivityId=r.ServerLastActivityId,u.showLoadPrevious=r.ShowLoadPrevious,u.eolCorrelationId=r.EolCorrelationId,u.eolDateHideHistory=new Date(r.EolDateHideHistory),u.eolPersonHideHistory=t.z(r.EolPersonHideHistory),u);t.d.onLineageActivitiesResponse(e)}},V:function(){var n=this,t=function(t){var i=_Ewa.O.a(t)?null:t.Result,u,r,f;if(!i){Diag.a.b(575447168,0,!!i,"LineageManager.LineageUpdateView returned null response.");return}u={CountOfUpdatedActivities:i.LineageActivitiesResponse.ActivityList.length};_Ewa.ba.a(n.c).a(_Ewa.y.bp,u,null,!1);f=(r=new _Ewa.OO,r.activityList=n.A(i.LineageActivitiesResponse.ActivityList),r.latestActivityId=i.LineageActivitiesResponse.LastSearchedActivityId,r.oldestActivityId=i.LineageActivitiesResponse.FirstSearchedActivityId,r.serverMessageCode=i.LineageActivitiesResponse.LineageResponseCode,r.lastSearchedActivityTimestamp=new Date(i.LineageActivitiesResponse.EcmaLastSearchedDate),r.hasNewActivities=i.HasNewActivities,r.filterSheetMultiRange=n.bp(i.LineageActivitiesResponse.FilterSheetMultiRange),r.serverFirstActivityId=i.LineageActivitiesResponse.ServerFirstActivityId,r.serverLastActivityId=i.LineageActivitiesResponse.ServerLastActivityId,r.showLoadPrevious=i.LineageActivitiesResponse.ShowLoadPrevious,r.eolCorrelationId=i.LineageActivitiesResponse.EolCorrelationId,r.eolDateHideHistory=new Date(i.LineageActivitiesResponse.EolDateHideHistory),r.eolPersonHideHistory=n.z(i.LineageActivitiesResponse.EolPersonHideHistory),r);n.d.onLineageActivitiesUpdateResponse(f)},r=this,i=function(n){var t=_Ewa.W.a(n.b);Diag.a.a(575447139,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",_Ewa.j.a(t,","))};Microsoft.Office.Excel.WebUI.Client.Lineage.a.f(this.c.c().a(),t,i,null,null,null)},bp:function(n){if(_Ewa.bt.a(n.Ranges)&&_Ewa.f.a(n.SheetName))return null;var t;return t=new _Ewa.nj,t.rangeList=this.k(n.Ranges),t.sheetName=n.SheetName,t},k:function(n){for(var i,t,e,u=[],f=n,o=f.length,r=0;r<o;++r)i=f[r],e=(t=new _Ewa.zo,t.firstCol=i.FirstColumn,t.firstRow=i.FirstRow,t.lastRow=i.LastRow,t.lastCol=i.LastColumn,t),u.push(e);return u},bq:function(n){if(!n)return null;var t={};return t.Ranges=this.O(n.rangeList),t.SheetName=n.sheetName,t},O:function(n){var r=[],i,t;if(_Ewa.bt.a(n))return r;for(var f=n,e=f.length,u=0;u<e;++u)i=f[u],t={},t.FirstColumn=i.firstCol,t.FirstRow=i.firstRow,t.LastRow=i.lastRow,t.LastColumn=i.lastCol,r.push(t);return r},W:function(n,t){var i=n.rangeHighlightLocation,r,u,f,e,o,s,h,c;if(i){if(t){if(c=(h=_Ewa.h.g(t,null,e={val:u},o={val:f},s={val:r}),u=e.val,f=o.val,r=s.val,h),c){this.L(i.sheetName,this.k([_Ewa.h.t(r)]));return}Diag.a.b(556799200,0,!1,"The produced subCellLocation string "+t+" is not valid.")}i.rangeList.length?this.L(i.sheetName,i.rangeList):this.P(i.sheetName)}else return},P:function(n){var t=this.c.d().b(n);if(t){if(!!t.S)return;t.d(!0)}return},L:function(n,t){for(var r,i,e,s,u=[],o=t,h=o.length,f=0;f<h;++f)r=o[f],i={},i.FirstColumn=r.firstCol,i.FirstRow=r.firstRow,i.LastRow=r.lastRow,i.LastColumn=r.lastCol,u.push(_Ewa.h.b(i));e=u.length-1;s=u[e].e();_Ewa.c.a(this.c).bg(u,e,n,null,s,null,null,3,_Ewa.F.bb,!0,!0,null,!0,!0)},X:function(){if(_Ewa.a.b("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var n=new _Ewa.J(-859308420,_Ewa.H.a,this.c.q(),12,null),t={CommandValueId:"HelpID=XLO_LineageTS",InputMethod:_Ewa.H.a,MenuItemId:"HelpArticle",ShouldCanvasTakeFocus:!0};this.c.h().a(n,t,null)}},bh:function(n){this.c.h().a(new _Ewa.J(-1112508866,n,this.c.q(),12,null),null,null)},R:function(n){switch(n){case"ScrollToIndexAndSeparatorEnabled":return _Ewa.a.b("OfficeVSO:4879296_ScrollToIndexAndSeparatorEnabled");case"EolCorrelationIdCheckEnabled":return _Ewa.a.b("OfficeVSO:5197331_EolCorrelationIdCheckEnabled");default:return!1}},bm:function(){this.d&&this.e.b()&&(this.j=this.c.b().d(),this.d.onRefreshRequired())},bi:function(){var n=this.c.b().m().LineageVersion;n!==this.o&&(Diag.a.a(591696593,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",n,this.o),this.o=n,this.bm())},N:function(){this.e.f(this.r);this.e.i(this.s);this.c.b().r(this.w);this.c.b().h(this.t);this.c.b().E(this.q);var n=this.c.d();n.k(this.u);n.n(this.i);n.p(this.v);n.t(this.i)},bn:function(){this.c.b().s(this.w);this.f.a().o(this.l);this.c.b().j(this.t);this.c.b().H(this.q);var n=this.c.d();n.m(this.u);n.o(this.i);n.q(this.v);n.B(this.i)},M:function(){this.d.onStaleActivitiesDetected()},bd:function(n,t){this.d&&!this.e.e()&&t.a&&(Diag.a.a(587220563,0,50,"LineageManager::SessionIdChanged detected."),this.M())},Y:function(){this.d&&!this.e.e()&&(Diag.a.a(587220562,0,50,"LineageManager::LoadOnDemandOccurred detected."),this.M())},bf:function(){var n=this.m();this.d.onFilterableSheetListChange(n)},bg:function(){var n=this.m();this.d.onFilterableSheetListChange(n)},be:function(){var n=this.m();this.d.onFilterableSheetListChange(n)},m:function(){for(var n,u=this.c.d(),f=u.j(),i=[],r=f,e=r.length,t=0;t<e;++t)n=r[t],n.j()&&!_Ewa.C.e(n)&&i.push(n.b());return i},Z:function(){this.d.onPaneClosed();var t=this,n=function(n){var t=_Ewa.W.a(n.b);Diag.a.a(575022273,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",_Ewa.j.a(t,","))};Microsoft.Office.Excel.WebUI.Client.Lineage.a.a(this.c.c().a(),null,n,null,null,null)},bb:function(n){n?this.f.a().n(this.l):this.f.a().o(this.l)},bc:function(){var i=this.f.a().a().e(),t=_Ewa.h.e(i,this.c),n,r=(n=new _Ewa.nj,n.rangeList=this.k(t.Ranges),n.sheetName=t.SheetName,n);this.d.onSelectedRangeUpdated(r)},br:function(n){var r,t,e,o,s,h,c,y=(c=_Ewa.h.g(n,this.c.d(),o={val:t},s={val:e},h={val:r}),t=o.val,e=s.val,r=h.val,c),l,a,u,f,i,v;return y?(t||(l=this.c.d(),a=l.a(),t=a.b()),u=[],u.push(r),f=_Ewa.h.l(t,null,u),v=(i=new _Ewa.nj,i.rangeList=this.k(f.Ranges),i.sheetName=f.SheetName,i),v):null},ba:function(){var n=this.j!==this.c.b().d();this.d&&this.e.b()&&n&&(this.j=this.c.b().d(),this.d.onRefreshRequired())},bo:function(){var n,i,t;_Ewa.a.a(747)&&(n=this.c.a().a(_Ewa.ne,403,!1,null),n&&n.a(),i=new _Ewa.J(-847286761,_Ewa.H.a,this.c.q(),0,"Help"),t={InputMethod:_Ewa.H.a},t.CalloutName=6,this.c.h().a(i,t,null))},A:function(n){for(var t,i,e,u=[],f=n,o=f.length,r=0;r<o;++r)t=f[r],e=(i=new _Ewa.OS,i.activityId=Number.parseLocale(t.UserActivity.Id),i.activityGuid=t.Uid,i.activityType=t.UserActivity.Type,i.author=this.z(t.UserActivity.Person),i.sheetName=t.SheetName,i.displayTimestamp=new Date(t.UserActivity.DisplayTimestamp),i.gridLocation=t.DisplayLocation,i.valueChanges=this.bl(t.LineageValueChangeList),i.isBulkEditOverflow=t.IsBulkEditOverFlow,i.rangeHighlightLocation=this.bk(t.UserActivity.LocationList,t.UserActivity.Type),i.nestedActivityList=this.bj(t.NestedActivityList),i),u.push(e);return u},bk:function(n,t){var r,u,e,f,i,p,o;if(!n)return Diag.a.a(593601666,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!n.length)return Diag.a.a(593601665,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var s=[],h=[],c="";t===21?h.push(n[0]):h=n;for(var v=h,w=v.length,l=0;l<w;++l){r=v[l];switch(r.Type){case 1:break;case 2:c=r.SheetName;break;case 0:if(u=r,!u.RangeList){Diag.a.a(593601635,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}c=u.RangeList[0].SheetName;e=[];t===21?e.push(u.RangeList[0]):e=u.RangeList;for(var y=e,b=y.length,a=0;a<b;++a)f=y[a],p=(i=new _Ewa.zo,i.firstCol=f.FirstColumn,i.firstRow=f.FirstRow,i.lastRow=f.LastRow,i.lastCol=f.LastColumn,i),s.push(p);break;default:Diag.a.a(593601634,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",r.Type)}}return!s.length,o=new _Ewa.nj,o.sheetName=c,o.rangeList=s,o},bl:function(n){for(var t,i,e,u=[],f=n,o=f.length,r=0;r<o;++r)t=f[r],e=(i=new _Ewa.OT,i.hasNewValue=t.HasNewValue,i.hasOldValue=t.HasOldValue,i.newValue=t.HasNewValue?t.NewValue:null,i.oldValue=t.HasOldValue?t.OldValue:null,i.cellLocation=t.CellLocation,i),u.push(e);return u},bj:function(n){return n?this.A(n):null},z:function(n){var i,t;return n?(i=null,_Ewa.a.b("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&Common.a.a.a("IsUserProfilePictureResolutionEnabled")&&(i=this.p.a(n.Email,n.Provider,Common.a.i,0)),t=new _Ewa.OQ,t.id=n.Id,t.provider=n.Provider,t.displayName=n.DisplayName,t.email=n.Email,t.imageUrl=i,t):null}};Microsoft.Office.Excel.WebUI.Client.Lineage.d=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.d.initializeBase(this);this.i=n;this.l()};Microsoft.Office.Excel.WebUI.Client.Lineage.d.a=function(n){n.a().b(_Ewa.bmn.$$(Microsoft.Office.Excel.WebUI.Client.a),367,new Microsoft.Office.Excel.WebUI.Client.Lineage.d(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.d.prototype={m:null,i:null,n:null,p:function(n){var t=this;_Ewa.g.a(n,function(){t.k(t.i.a().a(Microsoft.Office.Excel.WebUI.Client.a,366,!1,null)||new Microsoft.Office.Excel.WebUI.Client.Lineage.h(t.i,t.i.a(),t.m,t.n))},this.i.g(),3,null,null)},a:function(){this.n=this.i.n().a("UserAction","LineagePaneSeenStopwatch");this.n.d();var t=_Ewa.m.b(_Ewa.jW,this.i.a(),365,364,this.j,null),i=_Ewa.cn.a(this.i),r=_Ewa.m.b(Common.bm,this.i.a(),283,284,this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([t,i,r],this.i.g(),3),function(){n.m=t.a();_Ewa.l.b(n.i)||i.a().f(_Ewa.jW,n.m);n.p($$sc.h.a(Object,r.a().a().loadScript("cellLineage")))},this.i.g(),3,null,null)}};Microsoft.Office.Excel.WebUI.Client.Lineage.f=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.f.initializeBase(this);this.i=n;this.l()};Microsoft.Office.Excel.WebUI.Client.Lineage.f.a=function(n){n.a().b(_Ewa.bmn.$$(_Ewa.ne),402,new Microsoft.Office.Excel.WebUI.Client.Lineage.f(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.f.prototype={i:null,a:function(){var n=new Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager(this.i);this.k(n)}};Microsoft.Office.Excel.WebUI.Client.Lineage.a=function(){};Microsoft.Office.Excel.WebUI.Client.Lineage.a.d=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.clientParams=t,s.lineageFilter=i,_Ewa.k.a(n,"LineageOpenPaneOrChangeFilter",s,r,u,f,e,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.c=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.fetchFromBelow=t,_Ewa.k.a(n,"LineageLoadMore",o,i,r,u,f,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.e=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"LineageRefreshView",e,t,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.f=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"LineageUpdateView",e,t,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.a=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"LineageClosePane",e,t,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.b=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"LineageHidePreviousHistory",e,t,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.b=function(n,t,i){this.s=Function.createDelegate(this,this.z);this.v=Function.createDelegate(this,this.A);this.b=this.cA;this.c=this.cy;Microsoft.Office.Excel.WebUI.Client.Lineage.b.initializeBase(this,[n,null]);this.p=t;this.r=i;this.p.E(this.v);_Ewa.bi.a(this.p).a(this);_Ewa.l.b(this.p)&&this.cy(!1)};Microsoft.Office.Excel.WebUI.Client.Lineage.b.a=function(n,t){var r=n.l(),i=document.getElementById(r+"m_LineageTaskPane"),u;return i||(i=document.createElement("div"),i.id=n.l()+"m_LineageTaskPane",Sys.UI.DomElement.addCssClass(i,"LineageActivityPane"),_Ewa.l.b(n)||(u=document.getElementById(r+"novTaskpaneBody"),u.appendChild(i))),n.a().a(Microsoft.Office.Excel.WebUI.Client.Lineage.b,365,!1,null)||n.a().b(Microsoft.Office.Excel.WebUI.Client.Lineage.b,365,new Microsoft.Office.Excel.WebUI.Client.Lineage.b(i,n,t))};Microsoft.Office.Excel.WebUI.Client.Lineage.b.prototype={r:null,p:null,q:null,x:null,u:!0,B:function(n){this.get_events().addHandler("LineageTaskPaneRemove",n)},L:function(n){this.get_events().removeHandler("LineageTaskPaneRemove",n)},i:function(n){this.cB("LineageTaskPaneVisibilityChanged",n)},o:function(n){this.cF("LineageTaskPaneVisibilityChanged",n)},f:function(n){this.get_events().addHandler("LineageTaskPaneClose",n)},n:function(n){this.get_events().removeHandler("LineageTaskPaneClose",n)},cA:function(){return _Ewa.bft.prototype.cA.call(this)},cy:function(n){var t=_Ewa.bft.prototype.cA.call(this)!==n;return t&&(_Ewa.bft.prototype.cy.call(this,n),this.cw("LineageTaskPaneVisibilityChanged",null)),n},e:function(){return this.u},bF:function(){return this.cA()},a:function(){return 15},bm:function(){return"LTP"},D:function(){return"ewanov_showChangesExcel"},E:function(){return _Ewa.ClientStringManager.a().a(989)},j:function(){return 300},w:0,I:function(){return this.w},bw:function(n){return this.w=n,n},F:function(){return!1},C:function(){return this.cu()},t:!1,bu:function(){return _Ewa.ClientStringManager.a().a(1205)},H:function(){return 15..toString()},bt:function(){var n=this,t=this,i=this,r=this;return this.r.i(this.C(),this.bu(),300,!1,function(){n.cy(!0)},function(){t.cy(!1)},function(){i.cy(!0)},function(){r.cy(!1)},300,950,null)},l:function(){},bs:function(){},g:function(){return this.t},h:function(){return this.t},J:function(){},bv:function(){return!1},cP:function(){},bS:function(){},dispose:function(){this.p&&(this.p.J(this.v),_Ewa.bi.a(this.p).b(this));this.q&&(Common.i.a().b("click",this.q,this.s),Common.h.a().d(this.q,this.x));this.p=null;this.r=null;this.q=null;_Ewa.bft.prototype.dispose.call(this)},K:function(n,t){if(!t){var i=_Ewa.b.a(this.cu(),"LineagePaneFilterButton");if(!i)return!1;_Ewa.b.c(i,!1)}return!t},ej:function(n){return _Ewa.b.e(this.C(),n)},d:function(n){var t,i;this.t=n;t=this.r;this.cy(n);n&&(this.p.r().W.c("LineagePane"),this.u=!1);_Ewa.l.b(this.p)?n?t.g(this.H(),this.bt()):t.h(this.H()):(this.r.b(),i=!!this.r.a()&&this.r.a().a().a()===15,n&&t.c().length>0&&(!i||t.e())&&t.d(Microsoft.Office.Excel.WebUI.Client.Lineage.b,this,!0));this.p.u()},m:function(){var i=this.p.l(),t=_Ewa.l.b(this.p)?this.cu():document.getElementById(i+"m_LineageTaskPane"),r=this.y(),n;return t.appendChild(r),n=CommonUI.a.b("div","LineagePaneBodyId","LineageActivityBody"),t.appendChild(n),this.G(),n},k:function(){var n=this.p.r().W.n;this.p.r().W.c(n||"app");this.u=!0;this.d(!1);this.cw("LineageTaskPaneClose",null)},G:function(){this.p.r().W.b("LineagePane",!1);var n=this.p.r().W.a("LineagePane");n.d="app";n.e=!0},A:function(n,t){t.a||this.k()},y:function(){var n=CommonUI.a.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),t=CommonUI.a.b("h1","LineagePaneTitleId","cui-taskpane cui-taskPaneTitle LineageActivityPaneTitle");return t.innerText=this.bu(),this.q=CommonUI.e.a("LineagePaneCloseButtonId","StandardButton LineageActivityCloseButton",_Ewa.ClientStringManager.a().a(10),"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(this.q,Common.a.h?"FloatLeft":"FloatRight"),Common.i.a().a("click",this.q,this.s),this.x=Common.h.a().c(this.q,this.s,13),n.appendChild(t),n.appendChild(this.q),n},z:function(){return this.k(),!0}};Microsoft.Office.Excel.WebUI.Client.Lineage.e=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.e.initializeBase(this);this.i=n;this.l()};Microsoft.Office.Excel.WebUI.Client.Lineage.e.a=function(n){n.a().b(_Ewa.bmn.$$(_Ewa.jW),364,new Microsoft.Office.Excel.WebUI.Client.Lineage.e(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.e.prototype={m:null,n:null,p:function(){if(!this.m){var n=this;this.m=_Ewa.g.a(_Ewa.cn.a(this.i),function(t){n.n=Microsoft.Office.Excel.WebUI.Client.Lineage.b.a(n.i,t.a())},this.h(),3,null,null)}return this.m},i:null,a:function(){var t=_Ewa.m.a(Sys.IDisposable,this.i.a(),203,this.h(),this.j,null),i=_Ewa.m.a(Object,this.i.a(),155,this.h(),this.j,null),r=this,n=this;_Ewa.g.a(_Ewa.g.ts(_Ewa.g.b([t,i],this.h(),3),function(){return r.p()},this.h(),3,null),function(){n.k(n.n)},this.h(),3,null,null)},dispose:function(){this.i=null;this.m=null;this.n=null;_Ewa.sR.prototype.dispose.call(this)}};Microsoft.Office.Excel.WebUI.Client.b.registerClass("Microsoft.Office.Excel.WebUI.Client.b",_Ewa.WorkflowActivity);Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.registerClass("Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager",null,_Ewa.ne,Sys.IDisposable);Microsoft.Office.Excel.WebUI.Client.Lineage.g.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.g",null,_Ewa.lE);Microsoft.Office.Excel.WebUI.Client.Lineage.c.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.c",_Ewa.bg);Microsoft.Office.Excel.WebUI.Client.Lineage.d.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.d",_Ewa.sR.$$(Microsoft.Office.Excel.WebUI.Client.a));Microsoft.Office.Excel.WebUI.Client.Lineage.f.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.f",_Ewa.sR.$$(_Ewa.ne));Microsoft.Office.Excel.WebUI.Client.Lineage.b.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.b",_Ewa.bft,_Ewa.jW,Sys.IDisposable,_Ewa.OH,_Ewa.pc);Microsoft.Office.Excel.WebUI.Client.Lineage.e.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.e",_Ewa.sR.$$(_Ewa.jW));Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a=!1;Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.b=!1;Type.registerNamespace("_Ewa");_Ewa.bmN=function(){};_Ewa.bmN.a=function(){_Ewa.n.a(function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.e.a(n);Microsoft.Office.Excel.WebUI.Client.Lineage.d.a(n);Microsoft.Office.Excel.WebUI.Client.Lineage.f.a(n);Microsoft.Office.Excel.WebUI.Client.Lineage.c.a(n)})};_Ewa.bmN.a();Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Microsoft.Office.Excel.WebUI.Client.VersionHistory.q=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.q.registerInterface("Microsoft.Office.Excel.WebUI.Client.VersionHistory.q");Microsoft.Office.Excel.WebUI.Client.VersionHistory.r=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.r.registerInterface("Microsoft.Office.Excel.WebUI.Client.VersionHistory.r");Microsoft.Office.Excel.WebUI.Client.VersionHistory.s=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.s.registerInterface("Microsoft.Office.Excel.WebUI.Client.VersionHistory.s");Microsoft.Office.Excel.WebUI.Client.VersionHistory.p=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.p.prototype={url:null,value:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.g=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.g.prototype={ulsLogger:null,actionUrl:null,hideEmbedFooter:!1,useFetch:!1};Microsoft.Office.Excel.WebUI.Client.VersionHistory.h=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.h.prototype={appBootSettings:null,rootDiv:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.i=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.i.prototype={selectedVersionInfo:null,baseVersionInfo:null,telemetryCollector:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.b=function(n,t,i,r){this.g=n;this.l=t;this.e=i;this.f={};this.h=r;this.m()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.prototype={g:null,l:null,e:null,f:null,k:null,h:"0.4",j:function(){return[Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.a]},i:function(){return this.k||(this.k=_Ewa.c.a(this.g).j())},d:function(n){n?this.i().d(this.j(),null,null):this.i().a(this.j())},b:function(){this.d(!1);this.i().j(new _Ewa.bY(null,_Ewa.C.a(this.g.i())),this.j(),!0)},c:function(n){var u,t,r,e,o;if(!this.e){Diag.a.a(41976974,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null");return}if(u=new _Ewa.bY(_Ewa.h.b(n),_Ewa.C.a(this.g.d().b(n.SheetName))),t=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(u),!(t in this.e)){Diag.a.a(41976975,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+t);return}if(!(t in this.f)){Diag.a.a(41976976,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+t);return}var s=this.e[t],i=_Ewa.Q.a(s,null),f=this.f[t];for(r in f)e={key:r,value:f[r]},o=e.value,o.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",i.c,i.b,i.a,"0.6");_Ewa.c.a(this.g).a().b().c(null,!0);_Ewa.c.a(this.g).cy(n,60,!0,_Ewa.F.bg)},a:function(n){var o=new _Ewa.bY(_Ewa.h.b(n),_Ewa.C.a(this.g.d().b(n.SheetName))),t=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(o),r,f,e;if(!(t in this.f)){Diag.a.a(41976978,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+t);return}if(!(t in this.e)){Diag.a.a(42068037,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+t);return}var s=this.e[t],i=_Ewa.Q.a(s,null),u=this.f[t];for(r in u)f={key:r,value:u[r]},e=f.value,e.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",i.c,i.b,i.a,this.h)},m:function(){var n=this;this.i().c(this.l,[Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.a],!1,function(t,i){var o,r,f,u,e;if(!t||!t.a||!t.i||!i){Diag.a.b(41244696,0,!!t,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null");Diag.a.b(41244697,0,!t||!!t.a,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null");Diag.a.b(41244698,0,!t||!!t.i,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null");Diag.a.b(41244699,0,!!i,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null");return}if(o=new _Ewa.bY(t.a,t.i),r=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(o),r in n.f||(n.f[r]={}),n.f[r][t.d.toString()]=i,!(r in n.e)){Diag.a.a(41976980,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r);return}f=n.e[r];u=_Ewa.Q.a(f,null);i.style.borderColor=f;i.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",u.c,u.b,u.a,n.h);e=document.createElement("div");e.className="ewa-vhr-rectinnerborder";i.appendChild(e)},!0)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult.prototype={Success:!1,Output:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.j=function(n,t,i,r,u){this.z=Function.createDelegate(this,this.D);this.A=Function.createDelegate(this,this.E);Microsoft.Office.Excel.WebUI.Client.VersionHistory.j.initializeBase(this,[n,t]);this.u=i;this.y=r;this.x=u};Microsoft.Office.Excel.WebUI.Client.VersionHistory.j.prototype={r:null,u:null,v:0,y:null,x:null,k:function(n){return this.r=n,this.v=3,this.C(),1},C:function(){var u=this.r.a().RVAqs,f=this.r.a().RVAvi,t={},i,n,r;t["Content-Type"]="application/json; charset=utf-8";i=String.format("{0}{1}",this.x,"restoreversion.ashx");n={};n.VersionId=f;n.QuerySignature=u;r=JSON.stringify(n);this.y.a(i,2,r,t,!1,2,this.A,this.z,null,null,!1,null,null,null,null,!1,null,!1,null)},E:function(n){var t,r,u,i;(u=this.F(n,r={val:t}),t=r.val,u)?t.Success?(Common.K.b(2138207060,!0,"",0,0,0,null),Diag.a.a(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Common.K.b(2138207060,!1,"",0,0,0,null),Diag.a.a(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",t.Output),this.s=this.u):(Common.K.b(2138207060,!1,"",0,0,0,null),this.s=this.u);i=this.r.a().RVlvrt;i&&i();this.o();this.r.f()},D:function(){if(this.v>0){Diag.a.a(42287319,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",this.v);this.v--;this.C();return}Diag.a.a(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Common.K.b(2138207060,!1,"",0,0,0,null);this.s=this.u;var n=this.r.a().RVlvrt;n&&n();this.o();this.r.f()},F:function(n,t){t.val=null;var i=n?n.b?n.b.b:null:null;return!i||!i.length?(Diag.a.a(42287321,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),!1):Common.bs.a(i,t)?!0:(Diag.a.a(42287322,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),!1)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.c=function(n,t,i){Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.initializeBase(this);this.i=n;this.m=t;this.n=i;this.l()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.a=function(n){n.a().b(_Ewa.bmn.$$(_Ewa.eq),320,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.c("cw72","cw30","cw73"))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.prototype={i:null,m:null,n:null,a:function(){this.k(new Microsoft.Office.Excel.WebUI.Client.VersionHistory.j(this.i,this.m,this.n,Common.a.e,Common.a.b().a().o()))}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.k=function(n,t){Microsoft.Office.Excel.WebUI.Client.VersionHistory.k.initializeBase(this,[n,t])};Microsoft.Office.Excel.WebUI.Client.VersionHistory.k.prototype={k:function(n){var t=n.a().RVEAssea,i=this;return t(function(){i.o();n.f()}),1}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.d=function(n,t){Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.initializeBase(this);this.i=n;this.m=t;this.l()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.a=function(n){n.a().b(_Ewa.bmn.$$(_Ewa.eq),321,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.d("cw73","cw30"))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.prototype={i:null,m:null,a:function(){this.k(new Microsoft.Office.Excel.WebUI.Client.VersionHistory.k(this.i,this.m))}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.m=function(n,t){this.a=n;this.b=t};Microsoft.Office.Excel.WebUI.Client.VersionHistory.m.prototype={a:null,b:null,B:function(){return Common.a.a.a("IsAnonymousUser")?(Diag.a.a(42813647,0,15,"Verison History Command Handler: Anonymous user."),!0):!1},z:function(n,t){Diag.a.a(41739618,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");var i=!1;switch(t.a){case-1112508866:i=this.b.bi()}return Diag.a.a(41739619,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",i),i?$$sc.a.a(Boolean,i):_Ewa.X.a(t.a)},y:function(n,t){return t.a===-1112508866&&this.a.bW()},A:function(){return!1}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.e=function(n){Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.initializeBase(this,[n])};Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.a=function(n){_Ewa.bg.a(304,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.e(n))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.prototype={m:function(){var i=this.p(),t=_Ewa.m.b(Common.S,this.i.a(),21,137,this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([i,t],this.h(),3),function(){var u=t.a(),i=Common.k.h(n.i.e().VersionHistoryActionUrl),r;i!=="*"&&u.g(i);r=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a(n.i);n.n([new Microsoft.Office.Excel.WebUI.Client.VersionHistory.m(n.i,r)],null)},this.h(),3,null,null)},p:function(){var t=this,i=this,n=_Ewa.m.f(Common.bm,this.i.a(),283,284,this.j,null).then(function(n){return n.a().loadScript("excelVersionHistory")},function(n){return Diag.a.a(41239234,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",n),Promise.reject(n)});return $$sc.h.a(Object,n)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.l=function(n,t,i){this.b=n;this.a=t;this.c=i};Microsoft.Office.Excel.WebUI.Client.VersionHistory.l.prototype={b:0,a:null,c:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager=function(n,t,i,r){if(this.A=Function.createDelegate(this,this.J),this.C=Function.createDelegate(this,this.bc),this.D=Function.createDelegate(this,this.bd),this.B=Function.createDelegate(this,this.K),this.n=Function.createDelegate(this,this.U),this.u=Function.createDelegate(this,this.Z),this.t=Function.createDelegate(this,this.Y),this.v=Function.createDelegate(this,this.ba),this.j=-1,this.f=-1,Diag.a.a(41743366,0,50,"VersionHistoryHighlightManager::Constructor."),this.a=n,this.k=r,this.d=_Ewa.c.a(this.a),this.d.a().h(this.v),this.d.L(this.t),this.d.f().d(this.u),this.be(),t&&(this.s=n.n().a("UserAction","VersionHistoryDiffManagerStopWatch"),this.z()),this.b=i,this.b){var u=Common.k.h(this.a.e().VersionHistoryActionUrl)||"*";u!=="*"&&this.b.g(u);this.b.c("IterateNext");this.b.c("IteratePrevious");this.b.c("ToggleShowChanges");this.b.b("IterateNext",this.n);this.b.b("IteratePrevious",this.n);this.b.b("ToggleShowChanges",this.n)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a=function(n){return String.format("{0}{1}",n.a,n.b)};Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.prototype={g:null,e:null,h:null,a:null,d:null,q:!1,y:0,o:0,i:100,s:null,w:"0.4",x:"#696969",b:null,k:null,l:function(){return this.j===-1?null:this.c()[this.j]},c:function(){return this.q||(this.g.sort(this.B),this.q=!0),this.g},dispose:function(){(this.G(),this.e=null,this.g=null,this.d)&&(this.d.a()&&this.d.a().k(this.v),this.d.M(this.t),this.d.f()&&this.d.f().c(this.u),this.b&&(this.b.f("IteratePrevious"),this.b.f("IterateNext"),this.b.f("ToggleShowChanges")))},T:function(n,t){if(!n){Diag.a.b(40944519,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null");return}this.G();this.j=-1;this.g=[];this.q=!1;this.e={};this.h={};this.X(t);this.N(n)},z:function(){Diag.a.a(41743367,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.o.toString(),this.i.toString());this.o++;var n=this,t=function(t,i,r){return Microsoft.Office.Excel.WebUI.Client.VersionHistory.o.a(n.a.c().a(),_Ewa.p.a(t,n.D),_Ewa.p.b(i,n.C),r,null,null)};_Ewa.a.d()?this.a.f().a(new _Ewa.x(537,0,t,80,null),null):this.a.f().a(new _Ewa.bd(537,0,t,16,null),null)},bd:function(n){var t=_Ewa.O.a(n)?null:n.Result,i,r;if(!t){this.i=this.i*2;i=this;$$sc.a.b(this.i).CW(function(){i.z()});Diag.a.a(41743368,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result.");return}t.OperationWaitingForFileDownload?this.o<20?(this.i=this.i*2,r=this,$$sc.a.b(this.i).CW(function(){r.z()})):(this.r(),Diag.a.a(41743371,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):t.ActivityList?(this.T(t.ActivityList,t.VersionAuthors),_Ewa.a.b("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?this.bb():this.I(!0),this.s.a(),Diag.a.a(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",this.s.b().toString())):(this.r(),Diag.a.a(41743370,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found."))},bc:function(){this.r();Diag.a.a(41743372,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")},I:function(n){var u=this.e,t,i,r;for(t in u){if(i={key:t,value:u[t]},r=i.value,!r){Diag.a.b(41244700,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+i.key+"view was Null");continue}r.d(n)}},G:function(){var r=this.e,n,t,i;for(n in r){if(t={key:n,value:r[n]},i=t.value,!i){Diag.a.b(41244701,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+t.key+"view was Null");continue}i.b()}this.e=null;this.g=null},H:function(n){var t,i,r,u,f,s=(f=this.Q(n,this.j,r={val:i},u={val:t}),i=r.val,t=u.val,f),e,o;if(s){if(Diag.a.b(41976982,0,!!t,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.p(),!(t.b.toString()in this.e)){Diag.a.b(41976983,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",t.b.toString()));return}e=this.e[t.b.toString()];e.c(t.a);o=_Ewa.h.b(t.a);this.k.b(!1);this.k.b(!0);this.k.a(String.format(_Ewa.ClientStringManager.a().c(111),i+1,this.c().length,o.x(!1,!1),t.c.DisplayName));this.j=i}},U:function(n){Diag.a.a(50405838,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",n.MessageId);switch(n.MessageId){case"IterateNext":this.V();this.f=(this.f+1)%this.c().length;this.m("SetCurrentChangeCount",this.f+1);break;case"IteratePrevious":this.W();this.f=this.f<0?0:this.f;this.f=(this.f+this.c().length-1)%this.c().length;this.m("SetCurrentChangeCount",this.f+1);break;case"ToggleShowChanges":var t=n.Values.ToggleValue;this.I(t)}},m:function(n,t){var i,r;if(!_Ewa.a.a(345)){Diag.a.a(50469003,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off");return}if(!this.b){Diag.a.a(50469004,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");return}i={};i.count=t;r=new Common.cu(n);r.Values=i;this.b.h(r,null)},Q:function(n,t,i,r){var u=!1,f,e;for(i.val=t,r.val=null,f=0;!u&&f<this.c().length;){if(i.val=n?this.P(i.val):this.R(i.val),r.val=this.c()[i.val],e=$$as(_Ewa.N,this.a.d().b(r.val.a.SheetName)),!e)return Diag.a.b(41980624,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),!1;e.S||(u=!0);f++}return u},P:function(n){return n===-1?this.F():(n+1)%this.c().length},R:function(n){var t=n;return t===-1&&(t=this.F()),(t+this.c().length-1)%this.c().length},N:function(n){this.M(n);this.L()},S:function(n,t){var r=[],i,e;if(!n.RangeList)return Diag.a.b(41976984,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),r;for(var f=n.RangeList,o=f.length,u=0;u<o;++u){if(i=f[u],!i||!this.a.d().f(i.SheetName)){Diag.a.b(41976985,0,!1,("VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - "+i)?" Inavlid sheet name"+i.SheetName:"Null Sheet Range");continue}e=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.l(0,i,t);r.push(e)}return r},M:function(n){for(var t,i,o,s,f=n,h=f.length,r=0;r<h;++r){if(t=f[r],!t||_Ewa.bt.a(t.LocationList)){Diag.a.a(41244702,0,50,("VersionHistoryHighlightManager.CreateUserActivityLocationList - "+t)?"Empty Location list":"Null user activity");continue}for(var e=t.LocationList,c=e.length,u=0;u<c;++u){if(i=e[u],!i){Diag.a.b(41244703,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null");continue}switch(i.Type){case 0:o=i;(s=this.g).push.apply(s,this.S(o,t.Person));break;default:Diag.a.a(41244704,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}}}},L:function(){for(var n,f,e,s,i={},r=new($$sc.v.$$(_Ewa.Em)),t=[],o=this.g,h=o.length,u=0;u<h;++u)(n=o[u],r.c(n.c)||r.b(n.c),n.b)||(f=new _Ewa.bY(_Ewa.h.b(n.a),_Ewa.C.a(this.a.d().b(n.a.SheetName))),e=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(f),e in i||t.push(f),i[e]=this.O(n.c));Diag.a.a(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.g.length,t.length,r.f.length,this.y);this.r();t.length>0&&(s=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.b(this.a,t,i,this.w),this.e["0"]=s)},r:function(){var n=this.g?this.c().length:0;this.m("SetCurrentChangeCount",0);this.m("SetTotalChangesCount",n)},bb:function(){this.m("OnVHDiffReady",0)},X:function(n){var t,f;if(!n){Diag.a.a(42550406,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null");return}var i=null,r=null,u=null;for(this.y=n.length,t=0;t<n.length;++t){if(_Ewa.a.b("OfficeVSO:5140301_HandleEmptyInitialsColor")&&_Ewa.f.a(n[t].InitialsColor)){Diag.a.a(556836888,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");continue}r=n[t].EmailAddress;u=n[t].UserName;i=null;n[t].LoginName&&(f=n[t].LoginName.split("|"),f.length===3&&(i=f[2]));i?this.h[i]=n[t].InitialsColor:r?(Diag.a.a(42341888,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.h[r]=n[t].InitialsColor):u?(Diag.a.a(42341889,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.h[u]=n[t].InitialsColor):Diag.a.a(42341890,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}},be:function(){var i,t;if(_Ewa.f.a(this.a.e().VersionHistoryHighlightsSettings)){Diag.a.a(42504652,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"));return}for(i=$$as(Array,Sys.Serialization.JavaScriptSerializer.deserialize(this.a.e().VersionHistoryHighlightsSettings)),t=0;t<i.length;t++){var n=i[t],r=n.key?n.key:n.Key?n.Key:"",u=n.value?n.value:n.Value?n.Value:"";r==="DefaultColor"?this.x=u:r==="InitialTint"?this.w=u:Diag.a.a(42504653,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}},O:function(n){return n.Email in this.h?this.h[n.Email]:n.DisplayName in this.h?this.h[n.DisplayName]:(Diag.a.a(42271374,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary")),this.x)},K:function(n,t){var i=n.a,r=t.a;return this.E(i,r)},J:function(n,t){var i=n.a,r=t;return this.E(i,r)},E:function(n,t){var r=$$as(_Ewa.N,this.a.d().b(n.SheetName)),u=$$as(_Ewa.N,this.a.d().b(t.SheetName)),i;return!r||!u?(Diag.a.a(41976986,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0):(i=_Ewa.i.h(r.W,u.W),i=i?i:_Ewa.i.h(n.FirstRow,t.FirstRow),i?i:_Ewa.i.h(n.FirstColumn,t.FirstColumn))},F:function(){var i=this.d.a().a().e(),r=this.a.d().a(),t=_Ewa.h.r(i,r),n;return t?(n=_Ewa.i.d(new _Ewa.df(this.c()),0,this.c().length,t,this.A),n<0&&(n=~n),n%this.c().length):(Diag.a.a(41976988,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0)},p:function(){if(this.l()){if(!(this.l().b.toString()in this.e)){Diag.a.b(41976989,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.l().b.toString()));return}var n=this.e[this.l().b.toString()];n.a(this.l().a)}this.j=-1},ba:function(){this.p()},Y:function(){this.p()},Z:function(){this.p()},V:function(){this.H(!0)},W:function(){this.H(!1)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.f=function(n){Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.initializeBase(this);this.i=n;this.l()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.a=function(n){n.a().b(_Ewa.bmn.$$(_Ewa.nV),306,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.f(n))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.prototype={i:null,a:function(){var t=_Ewa.m.b(_Ewa.cw,this.i.a(),211,212,this.j,null),i=_Ewa.m.b(Common.S,this.i.a(),21,137,this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([t,i],this.i.g(),3),function(){n.k(n.i.a().a(_Ewa.nV,305,!1,null)||new Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager(n.i,!0,i.a(),t.a()))},this.i.g(),3,null,null)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.n=function(n,t){Microsoft.Office.Excel.WebUI.Client.VersionHistory.n.initializeBase(this,[n,t,null]);t!=="*"&&this.g(t);this.o("IterateNext");this.o("IteratePrevious");this.x("Wac_AppCompleted");this.x("Wac_AppFailed")};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a=function(n){this.j=Function.createDelegate(this,this.bc);this.t=Function.createDelegate(this,this.R);this.z=Function.createDelegate(this,this.X);this.w=Function.createDelegate(this,this.U);this.A=Function.createDelegate(this,this.Y);this.v=Function.createDelegate(this,this.T);this.B=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.W);this.x=Function.createDelegate(this,this.V);this.u=Function.createDelegate(this,this.S);this.C=Function.createDelegate(this,this.Z);this.D=Function.createDelegate(this,this.ba);this.a=n;this.k=this.a.l()+"_excelVersionHistoryOverlay";this.o=!1;_Ewa.a.a(426)&&this.P();this.i="";this.n=0;this.h=[]};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a=function(n){if(!n)return"";return n.RevisionID?n.RevisionID:n.revisionID?n.revisionID:""};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.b=function(n){if(!n)return"";return n.DownloadUrl?n.DownloadUrl:n.downloadUrl?n.downloadUrl:""};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.prototype={a:null,k:null,l:null,m:null,b:null,g:null,f:null,e:null,G:!1,o:!1,p:!1,E:!0,r:null,q:null,s:null,d:null,h:null,F:null,i:null,n:null,c:null,J:null,dispose:function(){this.L()},bb:function(){var n=this;this.a.a().c(_Ewa.fA,15,function(t){n.m=t;n.m.a(2)},null)},P:function(){this.r=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d(this);this.q=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c(this);this.s=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e(this)},bi:function(){if(Diag.a.a(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called"),Common.a.E("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy"),Common.a.E("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu"),Common.a.E("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck"),Common.a.bs("gj946531;j6gcd431"),this.d=excelVersionHistory.FactoryGlobal.getTelemetryCollector(),this.h=[],this.d.startTimer("TimeTakenShowVersionHistoryDialogAction"),!this.b){var n=this;if(Common.cP.a(function(){var t,i;n.b=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance((i=new Common.App.VersionHistory.b,i.ulsLogger=new UlsExternalLogger,i.docId=Common.a.i,i.appSettings=(t=new Common.App.VersionHistory.a,t.appName=120,t.userSessionId=Common.a.j,t.wdEnableSaveACopy=_Ewa.a.a(394),t.wdEnableDownloadTokens=_Ewa.a.a(385),t.wacCluster=Common.a.e.c(),t.uiLocale=Common.a.A?Common.a.A:"en-us",t.wdEnableRestore=_Ewa.a.a(347)&&n.a.j(),t.wdEnableIterator=_Ewa.a.a(344)&&_Ewa.a.a(345),t.useXhr=Common.c.n(),t.wdEnableHiddenButtonsUntilVersionLoadComplete=_Ewa.a.a(471),t.disableSaveACopy=n.N(),t.wdEnableShowVersionChanges=_Ewa.a.a(344)&&_Ewa.a.a(346),t.disabledChangeGates=n.a.e().VHSDisabledChangeGates,t.wdEnableSaveACopyOverFlowMenu=_Ewa.a.a(649),t.isRtl=Common.a.h,t.wdEnableDownloadVersion=_Ewa.a.c("Microsoft.Office.ExcelOnline.VersionHistoryDownloadVersionIsEnabled",!1)||n.a.y().a(51),t),i.perfTelemetryInfos=n.h,i))}),!this.b)return Diag.a.a(41239235,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Common.K.b(429638140,!1,"",0,0,0,null),!1}return this.bj(),this.d.endTimer("TimeTakenShowVersionHistoryDialogAction"),this.d.startTimer("TimeTillVersionHistoryDialogWasOpenMs"),Diag.a.a(41739650,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success"),Common.K.b(429638140,!0,"",0,0,0,null),!0},bj:function(){if(this.bd(),!document.getElementById(this.k)){var n=document.createElement("div");n.id=this.k;n.style.width="100%";n.style.height="100%";n.style.zIndex=998;n.style.display="block";n.style.position="absolute";this.a.U().insertBefore(n,this.a.U().firstChild);this.l=this.b.createVersionHistoryDialog(n)}document.getElementById(this.k).style.display="block";this.be();this.d.startTimer("TimeTakenGetVersionsToOnVersionsReady");this.b.getVersions("")},be:function(){_Ewa.a.a(426)&&(this.r.b(),this.q.b(),this.s.b(),this.bb())},bl:function(){_Ewa.a.a(426)&&(this.r.c(),this.q.c(),this.s.c(),this.m&&this.m.a(0))},bd:function(){this.b.getVersionsReadyEvent().addListener(this.D);this.b.getVersionSelectedEvent().addListener(this.C);this.b.getCloseSelectedEvent().addListener(this.u);this.b.getFullAppErrorEvent().addListener(this.x);this.b.getIteratorSelectedEvent().addListener(this.y);this.b.getShowVersionChangesToggledEvent().addListener(this.B);_Ewa.a.a(385)&&(this.b.getDownloadTokenReadyEvent().addListener(this.v),this.o=!0);_Ewa.a.a(394)&&(this.b.getSaveACopySelectedEvent().addListener(this.A),this.b.getDownloadVersionSelectedEvent().addListener(this.w));_Ewa.a.a(347)&&this.a.j()&&(this.b.getRestoreVersionSelectedEvent().addListener(this.z),this.p=!0);this.g&&this.g.getAppErrorEvent().addListener(this.t)},bk:function(){this.b.getVersionsReadyEvent().removeListener(this.D);this.b.getVersionSelectedEvent().removeListener(this.C);this.b.getCloseSelectedEvent().removeListener(this.u);this.b.getFullAppErrorEvent().removeListener(this.x);this.b.getIteratorSelectedEvent().removeListener(this.y);this.b.getShowVersionChangesToggledEvent().removeListener(this.B);_Ewa.a.a(394)&&(this.b.getSaveACopySelectedEvent().removeListener(this.A),this.b.getDownloadVersionSelectedEvent().removeListener(this.w));this.o&&(this.b.getDownloadTokenReadyEvent().removeListener(this.v),this.o=!1);this.p&&(this.b.getRestoreVersionSelectedEvent().removeListener(this.z),this.p=!1);this.g&&this.g.getAppErrorEvent().removeListener(this.t)},bg:function(){var n=!0,t;return _Ewa.a.a(738)&&!this.a.bm()?(Diag.a.a(579631304,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.a.b().F().toString()),!0):(this.a.b().F()||_Ewa.a.a(343)||(this.Q(),this.b.setCoauthRestoreError(),n=!1,t=new _Ewa.J(-729359593,0,this.a.q(),0,null),this.a.h().a(t,null,null)),this.a.bm()&&(Diag.a.a(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),n&&(n=!1,this.bh())),n)},X:function(n){var i,r,t,u,f,e;if(Diag.a.a(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered"),!this.bg()){Common.K.b(2138207060,!1,"",0,0,0,null);return}i=this;r=function(n){Common.K.b(2138207060,!1,"",0,0,0,null);i.b.setRestoreFailedAtServer(n)};this.d&&this.d.startTimer("TimeTakenVersionRestore");t=this;u=function(){t.d.endTimer("TimeTakenVersionRestore");t.K(t.d)};this.b.setRestoreInProgress();f=this;e=function(){var t=_Ewa.R.a(f.a).a().a();t.PUOAudna="cw74";t.CWMfsc=!0;t.CWMsbc=0;t.RVAvi=n;t.RVAqs=Common.a.i;t.RVlvrt=u;t.RVEAssea=r};_Ewa.z.a(this.a).c(new _Ewa.cU("cw8",5,e))},bh:function(){var t=_Ewa.j.b(1,0,1759,1758,0,-1603358883,"RestoreVersionUnsavedChangesError"),n=this.J||new _Ewa.dq(this.a,t);n.F();n.z(!1)},ba:function(n){var t=this;this.l.then(function(n){return n.enterFocusTrapZone(),null});Diag.a.a(41739651,0,50,"VersionHistoryPaneActor: OnVersionsReady called");this.d.endTimer("TimeTakenGetVersionsToOnVersionsReady");this.d.incrementCounter("CountOnVersionsReadyCalledinOneVHSession");Diag.a.a(41739652,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",this.d.getTimerDuration("TimeTakenGetVersionsToOnVersionsReady"));this.bf(n.containerDiv);n.versions&&n.versions.length>0&&(this.F=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n.versions[n.versions.length-1]));this.f&&this.g&&this.H(this.f,this.e);Diag.a.a(41739654,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")},Z:function(n){(Diag.a.a(41739655,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n.currentVersion),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f)),this.d.incrementCounter("CountOnVersionSelectedCalledinOneVHSession"),this.f=n.currentVersion,this.e=n.baseVersion,this.G=n.noBaseToCompareTo,this.g)&&this.bm()&&(this.H(n.currentVersion,n.baseVersion),Diag.a.a(41739657,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))},bm:function(){if(Diag.a.a(42472802,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.e?Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.e):""),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f)===this.F)return Diag.a.a(42472832,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(_Ewa.a.b("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.e&&this.G)return Diag.a.a(588862345,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.e)return Diag.a.a(42472833,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var n=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.b(this.e);return(Diag.a.a(42472834,0,50,"downloadURL length {0}",n?n.length:0),!n||!n.length)?(Diag.a.a(42472835,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1):!0},T:function(n){var r,f;if(Diag.a.a(41739658,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",n&&n.versionSelected?Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n.versionSelected.currentVersion):null,n&&n.updatedVersions?n.updatedVersions.length:0,Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f)),this.d.incrementCounter("CountOnDownloadTokenReadyCalledinOneVHSession"),!this.e){Diag.a.a(41439557,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.");return}if(n&&n.updatedVersions&&n.updatedVersions.length>=2){for(var t=null,i=null,e=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f),o=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.e),s=n.updatedVersions,h=s.length,u=0;u<h;++u)if(r=s[u],f=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(r),e===f?t=r:o===f&&(i=r),t&&i)break;t&&i?(this.f=t,this.e=i,Diag.a.a(41739659,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.e)),this.H(this.f,this.e)):Diag.a.a(41439558,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",e,o)}else Diag.a.a(41439559,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");Diag.a.a(41739660,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")},N:function(){return!this.a.bn()},S:function(){Diag.a.a(41739661,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");this.O();var n=new _Ewa.J(1470556788,0,this.a.q(),0,null);this.a.h().a(n,null,null)},O:function(){document.getElementById(this.k).style.display="none";var n=new _Ewa.J(-1423792966,0,this.a.q(),0,null);this.a.h().a(n,null,null);this.L()},L:function(){this.d&&(this.d.endTimer("TimeTillVersionHistoryDialogWasOpenMs"),this.K(this.d),this.d=null);this.bk();this.bl();this.h&&(Diag.a.a(42067140,0,15,this.h.toString()),this.h=null);this.c&&(this.c.f("Wac_AppCompleted"),this.c.f("Wac_AppFailed"),this.c.f("SetCurrentChangeCount"),this.c.f("SetTotalChangesCount"),_Ewa.a.b("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.c.f("OnVHDiffReady"),this.c.dispose(),this.c=null)},Y:function(n){Diag.a.a(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var t=new _Ewa.J(-1244760097,0,this.a.q(),0,null);this.a.y().a(51)&&(Diag.a.a(593367364,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),t=new _Ewa.J(-309686558,0,this.a.q(),0,null));Common.K.b(1604651619,!0,"",0,0,0,null);this.a.h().a(t,{FileDownloadUrl:n},null)},U:function(n){var t,i;Diag.a.a(587830285,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");t=new Common.bF(n);t.a("fn",Common.a.bq);Diag.a.a(587830284,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+t.toString().length);i=this.a.r().E(!0,t.toString(),!0);i===8?(Diag.a.a(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Common.K.b(1316171850,!1,"",0,0,0,null)):Common.K.b(1316171850,!0,"",0,0,0,null)},R:function(n){this.b.setFullAppErrorCode(n)},bf:function(n){try{if(this.g)Common.gs.a(!1);else{Common.gs.a(!0);var t=this;Common.cP.a(function(){var i=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.g,r;i.ulsLogger=new UlsExternalLogger;i.actionUrl=t.a.e().VersionHistoryActionUrl;i.hideEmbedFooter=!0;i.useFetch=_Ewa.a.a(461)&&!Common.c.h();t.g=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance((r=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.h,r.appBootSettings=i,r.rootDiv=n,r))})}}catch(i){Diag.a.a(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",i)}},H:function(n){var r,t,i,u;if(Diag.a.a(42016800,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n),this.i),!n){Diag.a.a(42016801,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null");return}if(!Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n).length){Diag.a.a(42016802,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");return}if(r=(new Date).getTime(),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n)===this.i&&r-this.n<1e3){Diag.a.a(42016803,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");return}Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n)!==this.i&&(Diag.a.a(51131787,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.b.setTotalChangesCount(-1),this.b.setCurrentChangeCount(-1));t=excelVersionHistory.FactoryGlobal.getTelemetryCollector();t.addEvent("SelectVersion",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n));try{this.bn(t);this.n=r;this.i=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n);i=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.i;i.selectedVersionInfo=this.f;i.baseVersionInfo=this.e;i.telemetryCollector=t;this.g.onVersionSelectedWithParams(i);this.b&&_Ewa.a.a(394)&&this.b.setDisableSaveACopy(this.N());u=document.getElementById("vhs_frame");u&&!this.c&&(Diag.a.a(50405839,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.c=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.n(u.contentWindow,Common.k.h(this.a.e().VersionHistoryActionUrl)||"*"),this.c.b("Wac_AppCompleted",this.j),this.c.b("Wac_AppFailed",this.j),this.c.c("SetCurrentChangeCount"),this.c.c("SetTotalChangesCount"),_Ewa.a.b("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.c.c("OnVHDiffReady"),this.c.b("SetCurrentChangeCount",this.j),this.c.b("SetTotalChangesCount",this.j),_Ewa.a.b("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.c.b("OnVHDiffReady",this.j))}catch(f){this.n=0;this.i="";t.addEvent("Exception",f.toString());Diag.a.a(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",f)}finally{Diag.a.a(42016833,0,50,t?t.getJsonForLogging():"");t=null}},bn:function(n){for(var r=this.h,e=r.length,i=0;i<e;++i){var t=r[i],u=t.TelemetryEventKey?t.TelemetryEventKey:t.telemetryEventKey?t.telemetryEventKey:"",f=t.TelemetryEventData?t.TelemetryEventData:t.telemetryEventData?t.telemetryEventData:"";u&&f&&n.addEvent(u,f)}Array.clear(this.h)},V:function(n){var t;switch(n){case 101:t="VHFailedToGetDownloadToken";break;case 100:t="VHFailedToLoadVersionList";break;case 104:t="VHVersioningNotEnabled";break;case 105:t="VHFileNotFound";break;case 106:t="VHVersionTooOld";break;default:t="None"}this.d.addEvent("OnFullAppError",t);Diag.a.a(42468675,0,10,"FullApp Error Event: {0}",t)},K:function(n){Diag.a.a(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",n?n.getJsonForLogging():"")},Q:function(){for(var n,u=this.a.b().u(),t={},i=null,f=u,e=f.length,r=0;r<e;++r)n=f[r],n.UserEmail&&(t[n.UserEmail]=n.UserEmail in t?t[n.UserEmail]+1:1),n.User.UserID===this.a.b().bA()&&(i=n.UserEmail);Diag.a.a(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",u.length,i?t[i]:-1)},M:function(n){this.E=n;Diag.a.a(51175900,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",n.toString());this.I("ToggleShowChanges",{ToggleValue:n})},W:function(n){Diag.a.a(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",n);Common.K.b(1488635506,!0,"",0,0,0,null);var t={};n?this.I("IterateNext",t):this.I("IteratePrevious",t)},bc:function(n){var t,i;switch(n.MessageId){case"Wac_AppCompleted":Diag.a.a(50708956,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");_Ewa.a.a(471)&&this.b.setVersionLoadComplete();break;case"Wac_AppFailed":Diag.a.a(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case"SetCurrentChangeCount":t=n.Values.count;Diag.a.a(50469005,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",t);this.b.setCurrentChangeCount(t);break;case"SetTotalChangesCount":i=n.Values.count;Diag.a.a(50469006,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",i);this.b.setTotalChangesCount(i);break;case"OnVHDiffReady":this.M(this.E);break;default:Diag.a.a(51175901,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",n.MessageId)}},I:function(n,t){var i,r,u,f;if(Diag.a.a(50405841,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",n),!this.c){Diag.a.a(50405842,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null");return}if(i=new Common.cu(n),i.Values.wdUserSession=this.a.e().UserSessionId,t){r=t;for(u in r)f={key:u,value:r[u]},i.Values[f.key]=f.value}this.c.h(i,null)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d=function(n){this.a=n};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d.prototype={a:null,b:function(){_Ewa.bi.a(this.a.a).c("VHP")||_Ewa.bi.a(this.a.a).a(this)},c:function(){_Ewa.bi.a(this.a.a).c("VHP")&&_Ewa.bi.a(this.a.a).b(this)},bm:function(){return"VHP"},C:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')},bF:function(){return!0},ej:function(n){return _Ewa.b.e(this.C(),n)},cP:function(){var n=this.a.a.r().W.n;this.a.a.r().W.b(n,!1)},bS:function(){},K:function(n,t){if(!t){var i=this;this.a.l.then(function(n){return n.enterFocusTrapZone(),null})}return!t}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c=function(n){this.a=n};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c.prototype={a:null,b:function(){_Ewa.bi.a(this.a.a).c("VHH")||_Ewa.bi.a(this.a.a).a(this)},c:function(){_Ewa.bi.a(this.a.a).c("VHH")&&_Ewa.bi.a(this.a.a).b(this)},bm:function(){return"VHH"},C:function(){return document.querySelector('[id="vhHeader"]')},bF:function(){return!0},ej:function(n){return _Ewa.b.e(this.C(),n)},cP:function(){var n=this.a.a.r().W.n;this.a.a.r().W.b(n,!1)},bS:function(){},K:function(n,t){if(!t){var i=this;this.a.l.then(function(n){return n.enterHeaderFocusTrapZone(),null})}return!t}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e=function(n){this.a=n};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e.prototype={a:null,b:function(){_Ewa.bi.a(this.a.a).c("VHV")||_Ewa.bi.a(this.a.a).a(this)},c:function(){_Ewa.bi.a(this.a.a).c("VHV")&&_Ewa.bi.a(this.a.a).b(this)},bm:function(){return"VHV"},C:function(){return document.querySelector('[id="vhViewer"]')},bF:function(){return!0},ej:function(n){return _Ewa.b.e(this.C(),n)},cP:function(){var n=this.a.a.r().W.n;this.a.a.r().W.b(n,!1)},bS:function(){},K:function(n,t){if(!t){var i=this;this.a.l.then(function(n){return n.enterViewerFocusTrapZone(),null})}return!t}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.o=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.o.a=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetVersionHistoryHighlightActivitiesData",e,t,i,r,u,4,null,null)};Type.registerNamespace("Common.App.VersionHistory");Common.App.VersionHistory.i=function(){};Common.App.VersionHistory.h=function(){};Common.App.VersionHistory.h.registerInterface("Common.App.VersionHistory.h");Common.App.VersionHistory.g=function(){};Common.App.VersionHistory.f=function(){};Common.App.VersionHistory.a=function(){};Common.App.VersionHistory.a.prototype={appName:0,wdEnableDownloadTokens:!1,retryCount:0,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:null,wacCluster:null,uiLocale:null,isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,disabledChangeGates:null,wdEnableDownloadVersion:!1,wdEnableSaveACopyOverFlowMenu:!1,wdEnableDeleteVersions:!1,wdEnableAppColorUpdate:null};Common.App.VersionHistory.j=function(){};Common.App.VersionHistory.j.prototype={telemetryEventKey:null,telemetryEventData:null};Common.App.VersionHistory.r=function(){};Common.App.VersionHistory.r.prototype={wopiDetails:null,alternateStreamDownloadUrl:null};Common.App.VersionHistory.o=function(){};Common.App.VersionHistory.o.prototype={revisionID:null,authorID:null,authors:null,time:null,downloadUrl:null,wopiInfo:null,events:null};Common.App.VersionHistory.c=function(){};Common.App.VersionHistory.c.prototype={userName:null,logOnName:null,emailAddress:null,initialsColor:null};Common.App.VersionHistory.e=function(){};Common.App.VersionHistory.e.prototype={type:0,time:null,author:null};Common.App.VersionHistory.m=function(){};Common.App.VersionHistory.m.prototype={versions:null};Common.App.VersionHistory.n=function(){};Common.App.VersionHistory.n.prototype={data:null,correlationID:null,errorCode:0,responseStatusCode:null,message:null};Common.App.VersionHistory.k=function(){};Common.App.VersionHistory.k.prototype={data:null,correlationID:null,isDirty:!1,errorCode:null,responseStatusCode:null,message:null};Common.App.VersionHistory.b=function(){};Common.App.VersionHistory.b.prototype={ulsLogger:null,serviceBase:null,latestStreamServiceBase:null,docId:null,appSettings:null,perfTelemetryInfos:null};Common.App.VersionHistory.p=function(){};Common.App.VersionHistory.p.prototype={currentVersion:null,baseVersion:null,correlationID:null,groupName:null,noBaseToCompareTo:!1};Common.App.VersionHistory.q=function(){};Common.App.VersionHistory.q.prototype={versions:null,containerDiv:null,correlationID:null};Common.App.VersionHistory.d=function(){};Common.App.VersionHistory.d.prototype={updatedVersions:null,versionSelected:null};Common.App.VersionHistory.l=function(){};Common.App.VersionHistory.l.prototype={tipVersion:null,updatedVersions:null,containerDiv:null,correlationID:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.b",null,Microsoft.Office.Excel.WebUI.Client.VersionHistory.s);Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult");Microsoft.Office.Excel.WebUI.Client.VersionHistory.j.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.j",_Ewa.WorkflowActivity);Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.c",_Ewa.sR.$$(_Ewa.eq));Microsoft.Office.Excel.WebUI.Client.VersionHistory.k.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.k",_Ewa.WorkflowActivity);Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.d",_Ewa.sR.$$(_Ewa.eq));Microsoft.Office.Excel.WebUI.Client.VersionHistory.m.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.m",null,_Ewa.lE);Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.e",_Ewa.bg);Microsoft.Office.Excel.WebUI.Client.VersionHistory.l.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.l");Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager",null,_Ewa.nV,Sys.IDisposable);Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.f",_Ewa.sR.$$(_Ewa.nV));Microsoft.Office.Excel.WebUI.Client.VersionHistory.n.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.n",Common.di);Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d",null,_Ewa.pc);Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c",null,_Ewa.pc);Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e",null,_Ewa.pc);Common.App.VersionHistory.o.registerClass("Common.App.VersionHistory.o");Common.App.VersionHistory.p.registerClass("Common.App.VersionHistory.p");Common.App.VersionHistory.d.registerClass("Common.App.VersionHistory.d");Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.a=23;Type.registerNamespace("_Ewa");_Ewa.bru=function(){};_Ewa.bru.a=function(){_Ewa.n.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.a);_Ewa.n.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.a);_Ewa.n.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.a);_Ewa.n.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.a)};_Ewa.bru.a();