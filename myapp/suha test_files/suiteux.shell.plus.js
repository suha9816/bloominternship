var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_plus_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["plus"],{37245:function(e,t,n){"use strict";var i;n.d(t,{o:function(){return i}}),function(e){e[e.OWA=1]="OWA",e[e.TokenFactory=3]="TokenFactory"}(i||(i={}))},31286:function(e,t,n){"use strict";n.d(t,{K:function(){return v}});var i=n(80997),r=n(71133),o=n(49447),a=n(1098),s=n(76596),u=n(93897),l=n(44598),c=n(78589),p=n(92881),d=n(37245),f=n(36345),h=n(40702),g=n(46555),m=n(55106);function y(){return function(e){var t=null;try{null!=sessionStorage&&(t=sessionStorage.getItem(e))}catch(e){}return t}("shellver")}var v=function(){function e(t,n,i,r){if(void 0===r&&(r=!1),u.validateField(n,"url",u.StringTypeString,!0),u.isNullOrEmptyString(n))throw u.createInvalidParameterException("url");if(n.indexOf("?")>=0)throw u.createInvalidParameterException("url");"/"===n.charAt(0)&&(n=u.buildUrl(u.getCurrentWindowLocation(),n)),u.validateFullUrl(n,"url"),n.charCodeAt(n.length-1)==="/".charCodeAt(0)&&(n=n.substr(0,n.length-1)),n=n.toLowerCase(),this.url=n,u.getUrlDomainPart(n,!0)!==u.getUrlDomainPart(u.getCurrentWindowLocation(),!0)&&!r||window.IsO365ShellTestPage?this.mode=1:this.mode=0,this.formDigestHandlingEnabled=!1,this.iFrameSourceUrl=i,e.sIFrameInstanceCode[this.appWebProxyUrl]=t,window.addEventListener("unload",e.resetMessageListenerAttachedFlag)}return Object.defineProperty(e.prototype,"appWebProxyUrl",{get:function(){return u.buildUrl(this.url,this.iFrameSourceUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canExecuteNow",{get:function(){return null!==document.body||e.sWindowLoadCalled},enumerable:!0,configurable:!0}),e.prototype.executeAsync=function(e){return this.validateRequest(e,!1),this.executeValidatedRequestInternal(e)},e.prototype.executeCrossDomainRequestAsync=function(e,t){return void 0===t&&(t=!1),this.validateRequest(e,!0),this.executeValidatedRequestInternal(e,t)},e.prototype.ping=function(){return null!=e.sFramePinged&&e.sFramePinged[this.appWebProxyUrl]},e.prototype.registerOpxHost=function(e){this.executeOrQueueCrossDomainRequest(f.u.RegisterOpxHost,e)},e.prototype.executeOpxRequest=function(e){var t={requestObject:e};this.executeOrQueueCrossDomainRequest(f.u.OutgoingOpxMessage,t)},e.prototype.executeStorageRequest=function(t){if(1===this.mode)this.executeOrQueueCrossDomainRequest(f.u.Storage,t);else if(0===this.mode)try{var n=t.requestObject;1===n.RequestType?(0,o.jl)().tag("RequestExecutor_SuiteDataSharingDeprecated",6,-1018,s.OH):p.J.processRequest(n,(function(n){var i={responseObject:n};e.fireDataWatchSentCallback(t),null!=t.success&&t.success(i),e.fireDataWatchReceivedCallbackGivenResponseInfo(t,i,0,"")}))}catch(n){null!=t.error&&t.error({},0,n.message),e.fireDataWatchReceivedCallbackGivenResponseInfo(t,{},n.errorCode||0,n.message)}},e.prototype.executeIdentityProviderRequest=function(e){1===this.mode&&this.executeOrQueueCrossDomainRequest(f.u.UserState,e)},e.prototype.executeSignalRRequest=function(e){this.validateRequest(e,!1),e.timeout=0,this.executeOrQueueCrossDomainRequest(f.u.SignalR,e)},e.prototype.setBeforeSendRequestAction=function(e){this.beforeSendRequest=e},e.prototype.prefetchOAuthAccessToken=function(e){var t=this;g.e.Instance.configuration.IsPwa?m.g.getToken(e).catch((function(n){1===n.responseType&&t.executeOrQueueCrossDomainRequest(f.u.TokenPrefetch,e)})):this.executeOrQueueCrossDomainRequest(f.u.TokenPrefetch,e)},e.prototype.getOwaUserConfiguration=function(e){this.executeOrQueueCrossDomainRequest(f.u.OwaUserConfig,e)},e.internalProcessIFrameRequestTimeoutCallback=function(t){if(null!==e.sPostMessageIdToRequestInfoMap){var n=e.sPostMessageIdToRequestInfoMap[t];null!=n&&(e.isCurrentSiteInTrustOrLocalZone()&&(0,o.jl)().tag("RequestExecutor_IFrameLoadError",4,-1007,s.DP),e.sPostMessageIdToRequestInfoMap[t]=null,delete e.sPostMessageIdToRequestInfoMap[t],u.reportSimpleError(n.requestInfo,-1001,s.fL,"IFrameRequest"),(0,o.jl)().serverRequest(n.command,n.requestInfo.method,e.sIFrameInstanceCode[n.appWebProxyUrl].toString(),n.requestInfo.url,-1001),e.fireDataWatchReceivedCallbackGivenResponseInfo(n.requestInfo,null,-1001,s.fL))}},e.prototype.validateRequest=function(e,t){if(u.validateRequestInfo(e),u.isFullUrl(e.url)){if(!t&&u.getUrlDomainPart(e.url,!0).toLowerCase()!==u.getUrlDomainPart(this.url,!0))throw u.createInvalidParameterException("requestInfo.url")}else e.url=u.buildUrl(this.url,e.url);(e.binaryStringRequestBody||e.binaryStringResponseBody)&&u.checkBrowserBinaryDataSupport()},e.prototype.executeValidatedRequestInternal=function(e,t){return void 0===t&&(t=!1),t?this.executeQueryDirect(e):1===this.mode?this.executeOrQueueCrossDomainRequest(f.u.Query,e):this.executeQueryDirect(e),e.postMessageId},e.prototype.executeQueryDirect=function(t){var n=this,i=u.buildUrl(this.url,"_api/contextinfo");i=u.encodeUrlForXmlHttpRequest(i),e.ensureFormDigest(this.url,i,this.formDigestHandlingEnabled,t,(function(e,t){return n.executeQueryUsingXMLHttpRequest(e,t)}))},e.ensureFormDigest=function(t,n,r,a,l){t=t.toLowerCase();var c=new Date;if(!r||"GET"===a.method.toUpperCase()||null!=e.sFormDigestExpirationCache[t]&&e.sFormDigestExpirationCache[t]>c.getTime())l(e.sFormDigestValueCache[t],a);else{var p=u.getXMLHttpRequest();p.open("POST",n),p.setRequestHeader("accept","application/json;odata=verbose");var d=Date.now(),h=0;a.timeout>0&&(h=window.setTimeout((function(){p.onreadystatechange=function(){};try{p.abort()}catch(e){}u.reportSimpleError(a,-1001,s.fL,"ensureFormDigest"),(0,o.jl)().serverRequest(f.u.Query,a.method,null,a.url,-1001,a.isTokenGeneratedFromWorkload)}),a.timeout)),p.onreadystatechange=function(){if(4===p.readyState){var n=Date.now()-d;if(0!==h&&window.clearTimeout(h),p.onreadystatechange=function(){},200!==p.status||null===p.getResponseHeader("content-type")||p.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){var r=(0,i.Uw)(s.vK,p.status.toString(),p.getResponseHeader("content-type"));u.reportSimpleError(a,-1002,r),(0,o.jl)().tag("RequestExecutor_UnexpectedResponse",6,-1002,p.status.toString(),p.getResponseHeader("content-type")),(0,o.jl)().serverRequest(f.u.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(p))}else{var c=JSON.parse(p.responseText);if(null!=c){var g=c.d.GetContextWebInformation.FormDigestValue,m=c.d.GetContextWebInformation.FormDigestTimeoutSeconds,y=(new Date).getTime()+750*m;e.sFormDigestValueCache[t]=g,e.sFormDigestExpirationCache[t]=y,l(g,a),(0,o.jl)().serverRequest(f.u.Query,a.method,null,a.url,p.status,a.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(p))}else u.reportSimpleError(a,-1002,s.OX),(0,o.jl)().tag("RequestExecutor_UnableToParseJson",6,-1002,s.OX,p.status.toString(),p.responseText),(0,o.jl)().serverRequest(f.u.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,n,u.getXMLHttpResponseLength(p))}}},p.send("")}},e.prototype.executeOrQueueCrossDomainRequest=function(t,n){e.sMessageListenerAttached=!!e.sMessageListenerAttached||u.ensureAttachMessageListener(e.internalOnMessage),e.fireDataWatchSentCallback(n),n.postMessageId=e.getPostMessageId(),this.canExecuteNow?this.executeCommandByIFrame(t,this.appWebProxyUrl,n):e.addToRequestExecutorQueue(this,n)},e.prototype.executeCommandByIFrame=function(t,n,i){var r={command:t,postMessageId:i.postMessageId,appWebProxyUrl:n,requestInfo:i,timeoutId:null},o=e.sPendingRequestInfo[n];null==o&&(o=[],e.sPendingRequestInfo[n]=o),e.sPostMessageIdToRequestInfoMap[r.postMessageId]=r,r.requestInfo.timeout>0&&(r.timeoutId=window.setTimeout((function(){return e.internalProcessIFrameRequestTimeoutCallback(r.postMessageId)}),r.requestInfo.timeout));var a=u.getFrameElement(e.sIFrameInstanceCode[n]);null!=a?e.sFrameLoaded[n]&&e.sFramePinged[n]?e.sendPostMessage(r):o.push(r):(o.push(r),a=e.createIFrame(n))},e.createIFrame=function(t){var n=e.sIFrameInstanceCode[t],i=u.getFrameID(n);switch(n){case d.o.OWA:(0,o.jl)().perfMarker("OwaIframeLoadStarted");break;case d.o.TokenFactory:(0,o.jl)().perfMarker("TokenFactoryIframeLoadStarted")}var r=document.createElement("iframe");r.src=t,r.id=i,r.name=i,r.style.display="none",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");r.addEventListener("load",(function(){e.internalProcessIFrameOnload(t)})),document.body.appendChild(r);var a=window.setTimeout((function(){delete e.sFrameLoadTimeoutId[t],e.processPingTimeoutOrIFrameLoadTimeout(t)}),this.IFrameLoadTimeout);return e.sFrameLoadTimeoutId[t]=a,r},e.prototype.executeQueryUsingXMLHttpRequest=function(t,n){var i=u.getXMLHttpRequest(),r=u.encodeUrlForXmlHttpRequest(n.url);i.open(n.method,r);var a=!1;if(null!=n.headers)for(var l=0,p=Object.keys(n.headers);l<p.length;l++){var d=p[l];null!=d&&(i.setRequestHeader(d,n.headers[d]),"x-requestdigest"===d.toLowerCase()&&(a=!0))}a||null==t||i.setRequestHeader("X-RequestDigest",t),n.binaryStringResponseBody&&(i.responseType="arraybuffer");var h=0;n.timeout>0&&(h=window.setTimeout((function(){return e.internalProcessXMLHttpRequestTimeoutCallback(i,n)}),n.timeout)),i.onreadystatechange=function(){return e.internalProcessXMLHttpRequestOnreadystatechange(i,n,h)};var g=n.body;if(n.binaryStringRequestBody&&(g=u.convertBinaryStringToXmlHttpRequestBody(n.body)),null!=this.beforeSendRequest&&this.beforeSendRequest(i,null,null),!c.W.isAllowedApi(r))return u.reportSimpleError(n,-1009,s.H1),void(0,o.jl)().serverRequest(f.u.Query,n.method,null,r,-1009);e.fireDataWatchSentCallback(n),n.requestSentTime=Date.now(),i.send(g)},e.sendPostMessage=function(t){u.validateField(t.postMessageId,"requestInfo.postMessageId",u.StringTypeString,!0),u.validateField(t.appWebProxyUrl,"requestInfo.appWebProxyUrl",u.StringTypeString,!0);var n=u.getFrameElement(e.sIFrameInstanceCode[t.appWebProxyUrl]);if(null==n)throw(0,o.jl)().tag("RequestExecutor_IFrameNull",6,-2002,s.Dm,t.appWebProxyUrl),new a.F(s.Dm,-2002);null==e.sPostMessageIdToRequestInfoMap&&(e.sPostMessageIdToRequestInfoMap={}),e.sPostMessageIdToRequestInfoMap[t.postMessageId]=t;var i={command:t.command,url:t.requestInfo.url,resource:t.requestInfo.resource,method:t.requestInfo.method,body:t.requestInfo.body,headers:t.requestInfo.headers,postMessageId:t.postMessageId,timeout:t.requestInfo.timeout,binaryStringRequestBody:t.requestInfo.binaryStringRequestBody,binaryStringResponseBody:t.requestInfo.binaryStringResponseBody,requestObject:t.requestInfo.requestObject,getPerformanceTrace:t.requestInfo.getPerformanceTrace},r=JSON.stringify(i),l=t.appWebProxyUrl;t.requestInfo.requestSentTime=Date.now(),g.e.isUnitTestMode||n.contentWindow.postMessage(r,l)},e.getPostMessageId=function(){return e.sPostMessageIdCount++,u.PostMessageIdPrefix+e.sPostMessageIdCount.toString()},e.internalProcessWindowLoad=function(){e.sWindowLoadCalled=!0;var t=e.sRequestExecutorQueue;e.sRequestExecutorQueue=null;var n=e.sRequestExecutorParameterQueue;if(e.sRequestExecutorParameterQueue=null,null!==t)for(var i=0;i<t.length;i++)t[i].executeAsync(n[i])},e.resetMessageListenerAttachedFlag=function(){e.sMessageListenerAttached=!1},e.internalProcessIFrameOnload=function(t){e.sFrameLoaded[t]=!0,null!=e.sFrameLoadTimeoutId[t]&&(window.clearTimeout(e.sFrameLoadTimeoutId[t]),delete e.sFrameLoadTimeoutId[t]),u.ensureAttachMessageListener(e.internalOnMessage),null!=e.sFramePingTimeoutId[t]&&(window.clearTimeout(e.sFramePingTimeoutId[t]),delete e.sFramePingTimeoutId[t]);var n={requestObject:{upn:g.e.Instance.configuration.CurrentUserUpn,puid:g.e.Instance.configuration.CurrentUserPuid,shellConfig:{enableOpx:g.e.Instance.configuration.OpxEnabled}}},i=y();i&&window.O365ShellBootInfo&&(n.requestObject.overrideRequest=u.buildIframeResourceData(i,window.O365ShellBootInfo));var r={command:f.u.Ping,postMessageId:e.getPostMessageId(),appWebProxyUrl:t,timeoutId:-1,requestInfo:n};e.sPostMessageIdToRequestInfoMap[r.postMessageId]=r;var o=window.setTimeout((function(){delete e.sFrameLoadTimeoutId[t],e.processPingTimeout(r.postMessageId,t)}),e.IFramePingTimeout);r.timeoutId=o,g.e.isUnitTestMode||(e.sFramePingTimeoutId[t]=o),e.sendPostMessage(r)},e.internalOnMessage=function(t){if(null!=t){var n=t.origin,i=t.data;if(null!=n&&""!==n&&null!=i&&""!==i)try{var r=JSON.parse(i);e.isPostMessageResponseInfo(r)&&e.onResponseMessageReceived(n,r)}catch(t){}}},e.isPostMessageResponseInfo=function(e){var t=e;return null!=t.postMessageId&&null!=t.command},e.onResponseMessageReceived=function(t,n){var i=Date.now();if(null!=e.sPostMessageIdToRequestInfoMap&&null!=n.postMessageId){var r=e.sPostMessageIdToRequestInfoMap[n.postMessageId];if(null!=r){var a=u.getUrlDomainPart(t,!0),s=u.getUrlDomainPart(r.appWebProxyUrl,!0);if(a.toLowerCase()===s.toLowerCase()){var l=n.postMessageId,c=i-r.requestInfo.requestSentTime,p=n.command===f.u.Query&&0===n.errorCode&&3===n.readyState,d=n.command===f.u.Notification&&null==n.errorMessage;if(p||d||(delete e.sPostMessageIdToRequestInfoMap[l],null!=r.timeoutId&&(window.clearTimeout(r.timeoutId),r.timeoutId=0,delete r.timeoutId)),n.command===f.u.Ping)e.processPingMessage(r.appWebProxyUrl,n),e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(r.requestInfo,n),(0,o.jl)().serverRequest(r.command,r.requestInfo.method,e.sIFrameInstanceCode[r.appWebProxyUrl].toString(),u.getUrlDomainPart(r.appWebProxyUrl),0===n.errorCode?200:n.errorCode,r.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0);else if(n.command===f.u.Query){var h={responseAvailable:n.responseAvailable,body:n.responseText||"",statusCode:n.statusCode,statusText:n.statusText,contentType:n.contentType,state:r.requestInfo.state,allResponseHeaders:n.allResponseHeaders,headers:u.parseResponseHeaders(n.allResponseHeaders),binaryStringResponseBody:n.binaryStringResponseBody},g=0,m=null;0!==n.errorCode?(g=n.errorCode,m=n.errorMessage):n.statusCode>=200&&n.statusCode<300||1223===n.statusCode||(g=-1003,m=n.statusCode),0===g?4===n.readyState?(h.performanceTrace=n.performanceTrace,null!=r.requestInfo.success&&r.requestInfo.success(h),e.fireDataWatchReceivedCallbackGivenResponseInfo(r.requestInfo,h,0,null),(0,o.jl)().serverRequest(r.command,r.requestInfo.method,e.sIFrameInstanceCode[r.appWebProxyUrl].toString(),r.requestInfo.url,n.statusCode,r.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0)):3===n.readyState&&null!=r.requestInfo.loading&&r.requestInfo.loading(h):4!==n.readyState&&0!==n.readyState&&null!=n.readyState||(h.performanceTrace=n.performanceTrace,null!=r.requestInfo.error&&r.requestInfo.error(h,g,m),(0,o.jl)().tag("RequestExecutor_IFrameError",4,g,m),e.fireDataWatchReceivedCallbackGivenResponseInfo(r.requestInfo,h,g,m),(0,o.jl)().serverRequest(r.command,r.requestInfo.method,e.sIFrameInstanceCode[r.appWebProxyUrl].toString(),r.requestInfo.url,g,r.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0))}else if(n.command===f.u.Storage||n.command===f.u.TokenPrefetch||n.command===f.u.OwaUserConfig){h={responseObject:n.responseObject},g=n.errorCode,m=n.errorMessage;0===g&&u.isNullOrEmptyString(m)?(null!=r.requestInfo.success&&r.requestInfo.success(h),e.fireDataWatchReceivedCallbackGivenResponseInfo(r.requestInfo,h,0,null)):(null!=r.requestInfo.error&&r.requestInfo.error(h,g,m),e.fireDataWatchReceivedCallbackGivenResponseInfo(r.requestInfo,h,g,m)),(0,o.jl)().serverRequest(r.command,r.requestInfo.method,e.sIFrameInstanceCode[r.appWebProxyUrl].toString(),r.requestInfo.url,0!==g?g:200,r.requestInfo.isTokenGeneratedFromWorkload,c,n.responseText?n.responseText.length:0)}else n.command===f.u.Notification?(0!==n.errorCode&&null!=r.requestInfo.error&&r.requestInfo.error({responseObject:n.responseObject},n.errorCode,n.errorMessage),e.NotificationCallback(JSON.stringify(n.responseObject)),e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(r.requestInfo,n)):n.command===f.u.RegisterOpxHost&&null!=r.requestInfo.success&&r.requestInfo.success(null)}}}},e.internalProcessXMLHttpRequestTimeoutCallback=function(t,n){t.onreadystatechange=function(){};try{t.abort()}catch(e){}u.reportSimpleError(n,-1001,s.fL,"XMLHttpRequest"),(0,o.jl)().serverRequest(f.u.Query,n.method,null,n.url,-1001),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,null,-1001,s.fL)},e.internalProcessXMLHttpRequestOnreadystatechange=function(t,n,i){if(4===t.readyState){var r=Date.now();0!==i&&window.clearTimeout(i),t.onreadystatechange=function(){};var a={state:n.state,responseAvailable:!0,body:n.binaryStringResponseBody?u.convertArrayBufferToBinaryString(t.response):t.responseText,statusCode:t.status,statusText:t.statusText,contentType:t.getResponseHeader("content-type"),allResponseHeaders:t.getAllResponseHeaders(),headers:u.parseResponseHeaders(t.getAllResponseHeaders()),performanceTrace:null},s=r-n.requestSentTime;if(n.getPerformanceTrace){var l=performance.getEntriesByName(n.url);null!=l&&l.length>0&&(a.performanceTrace=l[0])}t.status>=200&&t.status<300||1223===t.status?(null!=n.success&&n.success(a),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,a,0,null),(0,o.jl)().serverRequest(f.u.Query,n.method,null,n.url,a.statusCode,n.isTokenGeneratedFromWorkload,s,u.getXMLHttpResponseLength(t))):(null!=n.error&&n.error(a,-1003,t.statusText),e.fireDataWatchReceivedCallbackGivenResponseInfo(n,a,-1003,t.statusText),(0,o.jl)().serverRequest(f.u.Query,n.method,null,n.url,t.status,n.isTokenGeneratedFromWorkload,s,u.getXMLHttpResponseLength(t)))}},e.isCurrentSiteInTrustOrLocalZone=function(){if(!e.isTrustedSiteEvaluated){if(r.isBrowserIE()){var t=window.status,n=window.status+(new Date).getTime();window.status=n,e.isTrustedSite=window.status===n,window.status=t}e.isTrustedSiteEvaluated=!0}return e.isTrustedSite},e.processPingTimeout=function(t,n){null==e.sPostMessageIdToRequestInfoMap[t]&&(e.sFramePinged[n]||((0,o.jl)().tag("PingTimeout",0,e.sIFrameInstanceCode[n].toString()),e.sPostMessageIdToRequestInfoMap[t]=null,delete e.sPostMessageIdToRequestInfoMap[t],e.processPingTimeoutOrIFrameLoadTimeout(n)))},e.processPingTimeoutOrIFrameLoadTimeout=function(t){switch(e.sIFrameInstanceCode[t]){case d.o.OWA:(0,o.jl)().perfMarker("OwaIframeLoadFailed");break;case d.o.TokenFactory:(0,o.jl)().perfMarker("TokenFactoryIframeLoadFailed")}var n=u.getUrlDomainPart(t,!0);if(n.toLowerCase()===u.getUrlDomainPart(g.e.Instance.configuration.SuiteServiceUrl,!0)){var r=e.isCurrentSiteInTrustOrLocalZone()?l.v.SecurityZoneMismatched:l.v.IframeLoadError;h.t.Instance.blockSuiteServiceCalls(r,n)}var a=(0,i.Uw)(s.EE,n);e.reportFrameLoadError(t,a)},e.reportFrameLoadError=function(t,n,i){void 0===i&&(i=-1007),e.sFrameLoadError[t]=!0;var r=e.sPendingRequestInfo[t];e.sPendingRequestInfo[t]=[];var a=!1;if(a=e.isTrustedSiteEvaluated?e.isTrustedSite:e.isCurrentSiteInTrustOrLocalZone(),(0,o.jl)().tag("RequestExecutor_IFrameLoadError",4,i,n,"isTrustedSite: "+a),null!=e.sFrameLoadTimeoutId[t]&&(window.clearTimeout(e.sFrameLoadTimeoutId[t]),delete e.sFrameLoadTimeoutId[t]),e.removeIFrame(t),null!=r)for(var s=0,l=r;s<l.length;s++){var c=l[s],p=c.postMessageId;null!=e.sPostMessageIdToRequestInfoMap[p]&&(e.sPostMessageIdToRequestInfoMap[p]=null,delete e.sPostMessageIdToRequestInfoMap[p],null!=c.timeoutId&&window.clearTimeout(c.timeoutId),u.reportSimpleError(c.requestInfo,i,n),(0,o.jl)().serverRequest(c.command,c.requestInfo.method,e.sIFrameInstanceCode[t].toString(),c.requestInfo.url,-1007))}},e.removeIFrame=function(t){var n=u.getFrameElement(e.sIFrameInstanceCode[t]);null!=n&&null!=n.parentNode&&n.parentNode.removeChild(n),null!=e.sPendingRequestInfo&&delete e.sPendingRequestInfo[t],null!=e.sFrameLoadTimeoutId&&delete e.sFrameLoadTimeoutId[t],null!=e.sFrameLoaded&&delete e.sFrameLoaded[t],null!=e.sFramePinged&&delete e.sFramePinged[t],null!=e.sFramePingTimeoutId&&delete e.sFramePingTimeoutId[t],null!=e.sFrameLoadError&&delete e.sFrameLoadError[t]},e.processPingMessage=function(t,n){switch(e.sIFrameInstanceCode[t]){case d.o.OWA:(0,o.jl)().perfMarker("OwaIframeLoadCompleted");break;case d.o.TokenFactory:(0,o.jl)().perfMarker("TokenFactoryIframeLoadCompleted")}if(n.errorCode&&0!==n.errorCode)e.reportFrameLoadError(t,n.errorMessage,n.errorCode);else{e.sFramePinged[t]=!0;var i=e.sPendingRequestInfo[t];if(null!=i){e.sPendingRequestInfo[t]=[];for(var r=0,a=i;r<a.length;r++){var s=a[r];null!=e.sPostMessageIdToRequestInfoMap[s.postMessageId]&&e.sendPostMessage(s)}}}},e.addToRequestExecutorQueue=function(t,n){null===e.sRequestExecutorQueue&&(e.sRequestExecutorQueue=[]),null===e.sRequestExecutorParameterQueue&&(e.sRequestExecutorParameterQueue=[]),e.sRequestExecutorQueue.push(t),e.sRequestExecutorParameterQueue.push(n)},e.fireDataWatchSentCallback=function(t){null!==e.DataWatchSentCallback&&(e.DataWatchRequestId++,t.dataRequestId=e.DataWatchRequestId,e.DataWatchSentCallback(e.DataWatchRequestId,t))},e.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo=function(t,n){if(null!=e.DataWatchReceivedCallback){var i={body:n.responseText,responseAvailable:n.responseAvailable,statusCode:n.statusCode,statusText:n.statusText,contentType:n.contentType,allResponseHeaders:n.allResponseHeaders,headers:u.parseResponseHeaders(n.allResponseHeaders),binaryStringResponseBody:n.binaryStringResponseBody,responseObject:n.responseObject,state:t.state,performanceTrace:n.performanceTrace};e.fireDataWatchReceivedCallbackGivenResponseInfo(t,i,n.errorCode,n.errorMessage)}},e.fireDataWatchReceivedCallbackGivenResponseInfo=function(t,n,i,r){null!==e.DataWatchReceivedCallback&&null!=t.dataRequestId&&e.DataWatchReceivedCallback(t.dataRequestId,n,i,r)},e.DefaultTimeout=6e4,e.IFrameLoadTimeout=15e3,e.IFramePingTimeout=1e4,e.sPendingRequestInfo={},e.sFrameLoaded={},e.sFramePinged={},e.sFramePingTimeoutId={},e.sFrameLoadTimeoutId={},e.sFrameLoadError={},e.sPostMessageIdToRequestInfoMap={},e.sIFrameInstanceCode={},e.sFormDigestValueCache={},e.sFormDigestExpirationCache={},e.sPostMessageIdCount=0,e.sWindowLoadCalled=!1,e.sRequestExecutorQueue=[],e.sRequestExecutorParameterQueue=[],e.DataWatchSentCallback=null,e.DataWatchRequestId=0,e.DataWatchReceivedCallback=null,e}()},57942:function(e,t,n){"use strict";n.d(t,{Ou:function(){return l}});var i=n(80997),r=n(78589),o=n(37245),a=n(31286),s=n(46555),u="SuiteServiceProxy.aspx",l=function(){function e(){}return Object.defineProperty(e,"OwaInstance",{get:function(){return null==e.suiteSvcInstance?e.createOwaRequestExecutor():e.suiteSvcInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OauthTokenFactoryInstance",{get:function(){return null==e.tokenFactoryInstance?e.createOauthTokenFactoryRequestExecutor():e.tokenFactoryInstance},enumerable:!0,configurable:!0}),e.setOauthTokenFactoryInstanceForTesting=function(t){s.e.isUnitTestMode&&(e.tokenFactoryInstance=t)},e.resetAllInstancesForTesting=function(){e.tokenFactoryInstance=null,e.suiteSvcInstance=null},e.createOauthTokenFactoryRequestExecutor=function(){if(s.e.assertInitialized(),null!=s.e.Instance.configuration.TokenFactoryIframeOrigin){var t=(0,i.Uw)("{0}//{1}",window.location.protocol,window.location.host),n=(0,i.Uw)(e.TokenFactoryIframePath,encodeURIComponent(t),encodeURIComponent(s.e.Instance.configuration.ShellSID),encodeURIComponent(e.TokenFactoryIframeApiVersion),encodeURIComponent(s.e.Instance.configuration.ClientShellVersion));s.e.Instance.configuration.UserDisambiguationEnabled&&(n+="&upn="+encodeURIComponent(s.e.Instance.configuration.CurrentUserUpn));var r="https://consumer.suite.office.com"===s.e.Instance.configuration.TokenFactoryIframeOrigin;e.tokenFactoryInstance=new a.K(o.o.TokenFactory,s.e.Instance.configuration.TokenFactoryIframeOrigin,n,r)}return e.tokenFactoryInstance},e.createOwaRequestExecutor=function(){if(s.e.assertInitialized(),null!=s.e.Instance.suiteServiceHostPageBaseUrl&&s/* .SessionData.Instance.configuration.UserHasExchangeLicense */.e.Instance.configuration.UserHasExchangeLicense){var t=void 0;t=s.e.Instance.configuration.HintUserName?(0,i.Uw)("{0}?suiteServiceUserName={1}&{2}={3}&{4}",u,encodeURIComponent(s.e.Instance.configuration.CurrentUserUpn),e.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),e.SuiteServiceProxyIframeApiVersion):(0,i.Uw)("{0}?{1}={2}&{3}",u,e.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),e.SuiteServiceProxyIframeApiVersion),e.suiteSvcInstance=new a.K(o.o.OWA,s.e.Instance.suiteServiceHostPageBaseUrl,t),e.suiteSvcInstance.setBeforeSendRequestAction(r.W.onBeforeSendRequestSuiteService)}return e.suiteSvcInstance},e.TokenFactoryIframePath="/iframe/TokenFactoryIframe?origin={0}&shsid={1}&apiver={2}&cshver={3}",e.TokenFactoryIframeApiVersion="oneshell",e.SuiteServiceProxyIframeApiVersion="apiver=1",e.SuiteServiceReturnUrlParam="suiteServiceReturnUrl",e}()},40702:function(e,t,n){"use strict";n.d(t,{t:function(){return v}});var i=n(49447),r=n(85675),o=n(80997),a=n(1098),s=n(64681),u=n(93897),l=n(44598),c=n(67564),p=n(46555),d=function(){function e(e){this.service=e,this.NumMinutesToADReplication=2}return e.prototype.setTargetServerReceivedTime=function(e){if(!p.e.isUnitTestMode)throw new a.P("Operation not allowed if it is not a unit test",-2002);this.targetServerReceivedTime=e},e.prototype.beforeSuiteServiceCall=function(t){null!=this.targetServer&&((new Date).getTime()-this.targetServerReceivedTime.getTime()<=60*this.NumMinutesToADReplication*1e3&&(t[e.TargetServerHeader]=this.targetServer))},e.prototype.afterSuiteServiceSuccess=function(t){null==this.targetServer&&null!=t[e.TargetServerHeader]&&(this.targetServer=t[e.TargetServerHeader],this.targetServerReceivedTime=new Date)},e.prototype.afterSuiteServiceError=function(t,n){null!=t[v.XSuiteError]&&t[v.XSuiteError]===e.ShardNotFoundException?(this.service.blockSuiteServiceCalls(l.v.ShardNotDetected),n(c.convertErrorToException(null,-1010,l.v.ShardNotDetected.toString()))):n(t)},e.TargetServerHeader="X-TARGETSERVER",e.ShardNotFoundException="InvalidOrUnavailableMailboxException",e}(),f=n(31286),h=n(57942),g=n(55106),m=function(){function e(){var e=this;this.handleMessage=function(t){var n=!1;if(null!=t)for(var i=0;!n&&i<e.handlers.length;i++)if(t&&t.data&&t.origin){var r=e.handlers[i];if(r.validateOrigin(t.origin)){var o=t.data;r.validateMessage(o)&&(n=r.handleMessage(o))}}},this.handlers=[],(0,u.ensureAttachMessageListener)(this.handleMessage)}return e.prototype.registerHandler=function(e){this.handlers.push(e)},e}(),y=function(e,t,n){this.RequestExecutor=e,this.RequestInfo=t,this.ErrorCallback=n},v=function(){function e(){this.firstDataRequestSent=!1,this.startupCallbacks=[],this.owsStartupActionCompleted=!1,this.queuedCalls=[],this.messageDispatcher=new m}return Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConnectionEstablished",{get:function(){return this.owsStartupActionCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AreSuiteServiceCallsBlocked",{get:function(){return null!=this.suiteServiceCallsBlockedReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShouldQueueOwsCalls",{get:function(){return!this.owsStartupActionCompleted&&!p.e.Instance.configuration.IsOwa},enumerable:!0,configurable:!0}),e.prototype.registerPostMessageHandler=function(e){this.messageDispatcher.registerHandler(e)},e.prototype.setStartupActionCompleted=function(){this.owsStartupActionCompleted=!0;for(var e=0,t=this.queuedCalls;e<t.length;e++){var n=t[e];try{n.RequestExecutor.executeAsync(n.RequestInfo)}catch(e){}}this.queuedCalls=[],this.callStartupCallbacks()},e.setInstanceForTesting=function(e){p.e.isUnitTestMode&&(this.instance=e)},e.prototype.callOwaIframeAction=function(e,t,n){return void 0===n&&(n=!0),this.callOwaIframeActionWithAdditionalHeaders(e,t,null,n)},e.prototype.callOwaIframeResourceUrl=function(t,n,i){var o=this;return new Promise((function(a,l){r.throwOnNullOrEmpty(t,"resourceUrl"),r.throwOnUndefined(i,"method"),null!==o.owaCallsInterceptor||p/* SessionData.Instance.configuration.UserHasExchangeLicense */.e.Instance.configuration.UserHasExchangeLicense||(o.owaCallsInterceptor=new d(o)),i===s.F.PUT&&r.throwOnUndefined(n,"data");var c={};null!==p.e.Instance.configuration.CurrentUserUpn&&(c[e.UPNAnchorMailboxHeaderKey]=p.e.Instance.configuration.CurrentUserUpn);var f=p.e.Instance.configuration.SuiteServiceUrl.replace(u.OwsRelativePath,t);null!=o.owaCallsInterceptor&&o.owaCallsInterceptor.beforeSuiteServiceCall(c);var h=l;null!=o.owaCallsInterceptor&&(h=function(e){o.owaCallsInterceptor.afterSuiteServiceError(e,l)}),o.callOwaIframeWithOrWithoutRetry(f,c,n,i).then((function(e){return a(""!==e?JSON.parse(e):"")})).catch(h)}))},e.prototype.callOwaIframeActionWithAdditionalHeaders=function(t,n,i,a){var u=this;return void 0===a&&(a=!0),new Promise((function(l,c){r.throwOnNullOrEmpty(t,"action"),r.throwOnUndefined(n,"data");var d=p.e.Instance.configuration.SuiteServiceUrl,f="suiteservice.svc",h=-1!==d.toLowerCase().indexOf(f,d.length-f.length)?"{0}/?action={1}":"{0}?action={1}",g=u.isUserInitiatedCall(t)?t:t+"&UA=0",m=(0,o.Uw)(h,d,g);null===i&&(i={}),i[e.ActionHeaderKey]=t,u.callOwaIframeWithOrWithoutRetry(m,i,n,s.F.POST,a).then((function(e){return l(""!==e?JSON.parse(e):"")})).catch(c)}))},e.prototype.prefetchAccessToken=function(e,t){void 0===t&&(t=null);var n={url:e,resource:t};return new Promise((function(e,t){n.error=function(e,n,i){t(c.convertErrorToException(e,n,i))},n.success=function(t){return e(t)};var i=h.Ou.OauthTokenFactoryInstance;null!=i&&i.prefetchOAuthAccessToken(n)}))},e.prototype.registerOpxHost=function(e,t,n){return void 0===n&&(n=f.K.DefaultTimeout),new Promise((function(i,r){var o={resource:e,url:t,error:function(e,t,n){r(c.convertErrorToException(e,t,n))},success:function(e){i()},timeout:n},s=h.Ou.OauthTokenFactoryInstance;null==s?r(new a.P("OauthTokenFactoryIframe",-1011)):s.registerOpxHost(o)}))},e.prototype.callOpxIframe=function(e){var t=h.Ou.OauthTokenFactoryInstance;if(null==t)throw new a.P("OauthTokenFactoryIframe",-1011);t.executeOpxRequest(e)},e.prototype.callEndpointWithOauthToken=function(e){return new Promise((function(t,n){null==e.body&&(e.body=""),null==e.method&&(e.method="GET"),null==e.headers&&(e.headers={}),e.resource===p.e.Instance.configuration.TokenFactoryIframeOrigin&&(e.headers["x-o365suiteuxshell-workloadid"]=p.e.Instance.configuration.WorkloadId),e.success=function(e){try{var i=void 0;i=null!=e.contentType&&e.contentType.indexOf("application/json")>-1?JSON.parse(e.body):e.body,t(i)}catch(e){return void n(new a.P("Invalid response format."))}},e.error=function(e,t,i){n(c.convertErrorToException(e,t,i))};var i=h.Ou.OauthTokenFactoryInstance;null!=i?p.e.Instance.configuration.IsPwa||0===i.mode?g.g.getToken(e).then((function(t){0===t.responseType&&(e.headers.Authorization="Bearer "+t.token,null!=p.e.Instance.configuration.ServiceWorkerCacheId&&null!=p.e.Instance.configuration.ServiceWorkerCacheId&&(e.headers["X-SW-OHP-UserCacheId"]=p.e.Instance.configuration.ServiceWorkerCacheId,e.headers["X-SW-OHP-FetchStrategy"]=p.e.Instance.configuration.ServiceWorkerFetchStrategy),e.isTokenGeneratedFromWorkload=!0,delete e.headers["x-o365suiteuxshell-workloadid"],i.executeCrossDomainRequestAsync(e,!0))})).catch((function(t){1===t.responseType&&i.executeCrossDomainRequestAsync(e)})):i.executeCrossDomainRequestAsync(e):n(new a.P("OauthTokenFactoryIframe",-1011))}))},e.prototype.callWebClientShellServiceFunction=function(e,t,n,i){var r=(0,o.Uw)("{0}/{1}",p.e.Instance.configuration.TokenFactoryIframeOrigin,"/"===e.charAt(0)?e.substr(1):e);null==n&&(n={}),"Content-Type"in n||(n["Content-Type"]="application/json;charset=UTF-8"),"Accept"in n||(n.Accept="application/json");var a={method:t,url:r,resource:p.e.Instance.configuration.TokenFactoryIframeOrigin,body:JSON.stringify(i),headers:n};return this.callEndpointWithOauthToken(a)},e.prototype.owaSessionStorageRequest=function(e){var t=this;return new Promise((function(n,i){if(r.throwOnUndefined(e,"data"),t.shouldBlockCall(4))i(new a.P("SuiteService",-1011));else{var o={url:p.e.Instance.suiteServiceHostPageBaseUrl,requestObject:e,timeout:3e4,success:function(e){return n(e.responseObject)},error:function(e,t,n){return i(new a.P(n,-2002))}},s=h.Ou.OwaInstance;null==s?i(new a.P("SuiteService",-1011)):s.executeStorageRequest(o)}}))},e.prototype.callOwaIframeWithOrWithoutRetry=function(t,n,i,r,o){var s=this;void 0===o&&(o=!0);var u={};if(null!=n)for(var l=0,d=Object.keys(n);l<d.length;l++){var f=d[l];u[f]=n[f]}u.Accept="application/json",u["Content-Type"]="application/json; charset=utf-8";var g=p.e.Instance.MailboxGuid,m=p.e.Instance.configuration.ShellSID,y=g||m,v=c.generateCorrelationId(y);u["X-OWA-CorrelationId"]=v;var S=JSON.stringify(i);return new Promise((function(i,l){if(null!=s.suiteServiceCallsBlockedReason){var p=new a.P(s.suiteServiceCallsBlockedReason,-1010);return l(p)}var d=h.Ou.OwaInstance;if(null!==d){s.firstDataRequestSent||(!0,s.firstDataRequestSent=!0);var f=function(e){null!=s.owaCallsInterceptor&&s.owaCallsInterceptor.afterSuiteServiceSuccess(e.headers),i(e.body)};s.owaHttpRequest(d,t,S,u,r).then(f).catch(o?function(i){449===i.HttpStatus?s.owaHttpRequest(d,t,S,u,r).then(f).catch((function(e){return s.executeErrorCallback(n,l,e)})):null!=i[e.XSuiteError]&&i[e.XSuiteError]===e.WrongServerException?(v=c.generateCorrelationId(y),u["X-OWA-CorrelationId"]=v,s.owaHttpRequest(d,t,S,u,r).then((function(e){f(e)})).catch((function(e){s.executeErrorCallback(n,l,e)}))):l(i)}:function(){l()})}else s.executeErrorCallback(n,l,c.convertErrorToException(null,-1011,"OwaIframe"))}))},e.prototype.owaHttpRequest=function(t,n,o,a,u){var p=this;return new Promise((function(d,f){if(r.throwOnNullOrUndefined(n,"url"),p.shouldBlockCall(p.getExchangeServiceToCall(n)))return f(c.convertErrorToException(null,-1010,p.suiteServiceCallsBlockedReason));var h=null,g={headers:a,url:n,method:u.toString(),body:u!==s.F.GET?o:void 0,success:function(e){var t=c.getOwaError(e.headers);if(null!=t)return p.checkAndHandleBlockingOwaErrors(t),void f(c.convertErrorToException(e,e.statusCode,t));try{d(e)}catch(e){}null!=h&&h()},error:function(t,n,r){var o=c.getOwaError(t.headers);null!=o&&p.checkAndHandleBlockingOwaErrors(o),t.statusCode!==e.HttpStatusCodeTokenExpired&&t.statusCode!==e.HttpStatusCodeUnauthorized||(p.blockSuiteServiceCalls(l.v.TokenExpired,n,r),(0,i.Lo)().invoke("AuthenticationExpired")),f(c.convertErrorToException(t,n,r))}};if(p.ShouldQueueOwsCalls)if(p.isStartupAction(a))h=function(){p.setStartupActionCompleted(),h=null};else if(2===p.getExchangeServiceToCall(g.url))return void p.queuedCalls.push(new y(t,g,f));t.executeAsync(g)}))},e.prototype.registerAuthenticationExpiredCallback=function(e){(0,i.Lo)().subscribe("AuthenticationExpired",e,!0)},e.prototype.registerCultureNotSetCallback=function(e){(0,i.Lo)().subscribe("CultureNotSet",e,!0)},e.prototype.guaranteeConnectionEstablished=function(e){this.ConnectionEstablished||p.e.Instance.configuration.IsOwa?e():this.startupCallbacks.push(e)},e.prototype.blockSuiteServiceCalls=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];
// the more important blocking reasons are evaluated first e.g. NoExoLicense etc
null!=this.suiteServiceCallsBlockedReason&&e!==l.v.ShardNotDetected||(this.suiteServiceCallsBlockedReason=e.toString(),(0,i.jl)().tag("RequestExecuter_SuiteServiceCallsBlocked",4,l.v[e],t))},e.prototype.stopBlockingCalls=function(){this.suiteServiceCallsBlockedReason=null},e.prototype.callStartupCallbacks=function(){for(var e=0,t=this.startupCallbacks;e<t.length;e++){var n=t[e];null!=n&&n()}this.startupCallbacks=[]},e.prototype.checkAndHandleBlockingOwaErrors=function(e){e.indexOf("OwaInvalidUserLanguageException")>-1?(this.blockSuiteServiceCalls(l.v.LanguageNotSet,e),(0,i.Lo)().invoke("CultureNotSet")):"InvalidMailbox"===e?this.blockSuiteServiceCalls(l.v.InvalidMailbox,e):"ShardMailbox"===e&&this.blockSuiteServiceCalls(l.v.ShardMailbox,e)},e.prototype.getExchangeServiceToCall=function(e){var t=null!=e?u.getUrlPath(e):null;if(t){var n=function(e,t){return e.substr(0,t.length)===t};if(n(t,u.SuiteServiceApiRelativePath))return 3;if(n(t,u.OwsRelativePath))return 2;if(n(t,u.DevFabricOwsRelativePath))return 2}var r=new Error("Cannot Acquire Exchange Service to Call");throw(0,i.jl)().exception("Service_ExchangeServiceAcquireFail",6,r,t),r},e.prototype.shouldBlockCall=function(t){return null!=this.suiteServiceCallsBlockedReason&&!(2!==t&&e.callBlockingReasonsSpecificToOws.indexOf(this.suiteServiceCallsBlockedReason))},e.prototype.executeErrorCallback=function(e,t,n){try{t(n)}catch(e){}if(!this.owsStartupActionCompleted&&this.isStartupAction(e)){var i=n.errorCode||0,r=-1005===i?l.v.CallerOriginNotAllowed:l.v.InitFailed;this.blockSuiteServiceCalls(r,i,n.message);for(var o=c.convertErrorToException(null,-1010,"App initialization failed, call canceled",i,n.message),a=0,s=this.queuedCalls;a<s.length;a++){var u=s[a];try{u.ErrorCallback(o)}catch(e){}}this.queuedCalls=[]}},e.prototype.isUserInitiatedCall=function(t){return e.userInitiatedCalls.indexOf(t.toLowerCase())>=0},e.prototype.isStartupAction=function(t){var n=p.e.Instance.configuration.StartupActionName;return null!=n&&n===t[e.ActionHeaderKey]},e.ActionHeaderKey="Action",e.UPNAnchorMailboxHeaderKey="X-UpnAnchorMailbox",e.XSuiteError=c.XSuiteError,e.HttpStatusCodeUnauthorized=401,e.HttpStatusCodeTokenExpired=440,e.WrongServerException="WrongServerException",e.instance=new e,e.callBlockingReasonsSpecificToOws=[l.v.LanguageNotSet.toString(),l.v.InitFailed.toString(),l.v.InvalidMailbox.toString(),l.v.ShardMailbox.toString()],e.userInitiatedCalls=["getowauserconfiguration"],e}()},46555:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=function(){function e(e){this.suiteServiceHostPageBaseUrl=e.SuiteServiceUrl.substring(0,e.SuiteServiceUrl.lastIndexOf("/")),this.configuration=e}return e.Initialize=function(t){this.instance=new e(t)},Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!0,configurable:!0}),e.assertInitialized=function(){if(null===e.Instance)throw new Error("SessionData not initialized.")},e.isUnitTestMode=!1,e}()},55106:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var i=n(49447),r=n(46555),o=function(){function e(){}return e.getToken=function(e){return new Promise((function(t,n){if(r.e.Instance.configuration.GetTokenRequestDictionary){var o=r.e.Instance.configuration.GetTokenRequestDictionary(),a=function(e){e?t({token:e,responseType:0}):((0,i.jl)().tag("GetAccessToken_Empty",6),n({responseType:2}))},s=function(e){(0,i.jl)().exception("GetAccessToken_Failed",6,e),n({responseType:2,exception:e})};if(o[e.resource]){var u=o[e.resource];"function"==typeof u?u().then((function(e){a(e)})).catch((function(e){s(e)})):u.then((function(e){a(e)})).catch((function(e){s(e)}))}else n({responseType:1})}else n({responseType:1})}))},e}()},54458:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var i,r=n(70655),o=n(80997),a=n(93897),s='{ "kty": "oct", "k": "{0}", "extractable": true }',u=void 0!==typeof btoa,l=function(){function e(){}return e.loadCryptoModule=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,new Promise((function(e){void 0!==i?e():null!=window.crypto?(i=window.crypto,e()):n.e("msrcrypto").then(n.t.bind(n,44815,23)).then((function(t){i=t,e()}))}))]}))}))},e.computeSHA256=function(t,n){return void 0===n&&(n=!0),(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.loadCryptoModule()];case 1:return r.sent(),[2,new Promise((function(r,o){try{var a=e.textToUInt8Array(t,n),s=i.subtle.digest({name:"SHA-256"},a);s.then((function(t){if(e.verifyResult(t,o)){var n=Array.prototype.map.call(new Uint8Array(t),(function(e){return("00"+e.toString(16)).slice(-2)})).join("");r(e.toBase64(n))}}),(function(t){e.verifyResult(t,o)&&o(t.toString())}))}catch(e){o(e.toString())}}))]}}))}))},e.encryptAES=function(t,n,a){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.loadCryptoModule()];case 1:return r.sent(),[2,new Promise((function(r,u){try{var l=(0,o.Uw)(s,e.base64ToBase64Url(t)),c=i.subtle.importKey("jwk",JSON.parse(l),{name:"AES-CBC"},!0,["encrypt","decrypt"]);c.then((function(t){try{var o=t,s=e.textToUInt8Array(e.base64ToString(n),!1),l=e.textToUInt8Array(a,!0),c={name:"AES-CBC",iv:s},p=i.subtle.encrypt(c,o,l);p.then((function(t){try{e.verifyResult(t,u)&&r(e.toBase64(e.bytesToText(t,!1)))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t)}))}catch(e){u(e.toString())}}))]}}))}))},e.decryptAES=function(t,n,a){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.loadCryptoModule()];case 1:return r.sent(),[2,new Promise((function(r,u){try{var l=(0,o.Uw)(s,e.base64ToBase64Url(t)),c=i.subtle.importKey("jwk",JSON.parse(l),{name:"AES-CBC"},!0,["encrypt","decrypt"]);c.then((function(t){try{var o=t,s=e.textToUInt8Array(e.base64ToString(n),!1),l=e.textToUInt8Array(e.base64ToString(a),!1),c={name:"AES-CBC",iv:s},p=i.subtle.decrypt(c,o,l);p.then((function(t){try{e.verifyResult(t,u)&&r(e.bytesToText(t,!0))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}),(function(t){e.verifyResult(t,u)&&u(t.toString())}))}catch(e){u(e.toString())}}))]}}))}))},e.textToUInt8Array=function(e,t){e=t?encodeURI(e):e;for(var n=[],i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return new Uint8Array(n)},e.bytesToText=function(e,t){var n=(0,a.convertArrayBufferToBinaryString)(e);return t?decodeURI(n):n},e.base64ToBase64Url=function(e){return e.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")},e.verifyResult=function(e,t){return null!=e||(t("result undefined"),!1)},e.base64ToString=function(e){if(!u)return i.base64ToString(e);for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return atob(e)},e.toBase64=function(e,t){if(!u)return i.toBase64(e);var n="";return t||(t=!1),n=btoa(e),t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):n},e}()},1098:function(e,t,n){"use strict";n.d(t,{P:function(){return r},F:function(){return o}});var i=n(70655),r=function(e,t,n){if(void 0===e&&(e=""),this.message=e,this.errorCode=t,this.errorInfo=n,this.name="ShellException",null!=n)for(var i=0,r=Object.keys(n);i<r.length;i++){var o=r[i];this[o]=n[o]}},o=function(e){function t(t,n,i){void 0===t&&(t="");var r=e.call(this,t,n,i)||this;return r.message=t,r.errorCode=n,r.errorInfo=i,r.name="RequestExecutorException",r}return(0,i.__extends)(t,e),t}(r)},64681:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var i=function(){function e(){}return e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE",e}()},76596:function(e,t,n){"use strict";n.d(t,{fL:function(){return i},e1:function(){return r},lq:function(){return o},EE:function(){return a},YG:function(){return s},OH:function(){return u},UU:function(){return l},OX:function(){return c},vK:function(){return p},H1:function(){return d},DP:function(){return f},Dm:function(){return h},JP:function(){return g}});var i="Request was aborted or timed out",r="Browser not supported",o="Invalid field or parameter {0}",a="Cannot access {0}",s="Binary data not supported",u="Invalid operation",l="Session storage error",c="Unable to parse json",p="Status:{0}, Content-type:{1}",d="Access denied",f="Timeout due to trusted sites",h="Could not find IFrame element.",g="Message listener is not attached."},93897:function(e,t,n){"use strict";n.r(t),n.d(t,{StringTypeString:function(){return c},BooleanTypeString:function(){return p},FunctionTypeString:function(){return d},NumberTypeString:function(){return f},OwaIFrameID:function(){return h},TokenFactoryIFrameID:function(){return g},SuiteServiceApiRelativePath:function(){return m},OwsRelativePath:function(){return y},DevFabricOwsRelativePath:function(){return v},PostMessageIdPrefix:function(){return S},validateField:function(){return T},isFullUrl:function(){return C},validateFullUrl:function(){return I},getCurrentWindowLocation:function(){return w},createInvalidParameterException:function(){return b},isNullOrEmptyString:function(){return A},buildUrl:function(){return D},getUrlDomainPart:function(){return P},getUrlPath:function(){return O},getUrlAuthorityPart:function(){return x},buildIframeResourceData:function(){return E},getXMLHttpRequest:function(){return k},validateRequestInfo:function(){return R},convertArrayBufferToBinaryString:function(){return L},convertBinaryStringToXmlHttpRequestBody:function(){return U},parseQueryString:function(){return N},parseResponseHeaders:function(){return F},startsWith:function(){return B},endsWith:function(){return W},checkBrowserBinaryDataSupport:function(){return q},ensureAttachMessageListener:function(){return H},reportSimpleError:function(){return G},encodeUrlForXmlHttpRequest:function(){return j},urlEncodeCore:function(){return z},getFrameElement:function(){return V},getFrameID:function(){return Z},getXMLHttpResponseLength:function(){return Q}});var i=n(80997),r=n(49447),o=n(40218),a=n(31286),s=n(1098),u=n(76596),l=n(37245),c="string",p="boolean",d="function",f="number",h="o365shellowaframe",g="o365shellwcssframe",m="O365SuiteService/api/",y="owa/service.svc",v="SuiteService.svc",S="SP.RequestExecutor",_="https://";function T(e,t,n,r){if(r){if(null==e||typeof e!==n)throw new s.F((0,i.Uw)(u.lq,t),-2001)}else if(null!=e&&typeof e!==n)throw new s.F((0,i.Uw)(u.lq,t),-2001)}function C(e){return e.substr(0,_.length).toLowerCase()===_}function I(e,t){if(!C(e))throw b(t)}function w(){return window.location.href}function b(e){return new s.F((0,i.Uw)(u.lq,e),-2001)}function A(e){return""===e||null==e}function D(e,t){if(I(e,"baseUrl"),C(t))return t;if("/"===t.charAt(0)){var n=e.indexOf("://");return(n=e.indexOf("/",n+3))>0&&(e=e.substr(0,n)),e+t}return"/"!==e.charAt(e.length-1)&&(e+="/"),e+t}function P(e,t){void 0===t&&(t=!1),t&&I(e,"url");var n=e.indexOf("://");return(n=e.indexOf("/",n+3))>0&&(e=e.substr(0,n)),e.substr(0,_.length).toLowerCase()===_&&":443"===e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),e}function O(e){var t=P(e),n=e.indexOf("?");return n>t.length+1?e.substring(t.length+1,n):e.substring(t.length+1,e.length)}function x(e){return(e=P(e)).substr(0,_.length).toLowerCase()===_&&(e=e.substr(_.length)),e.toLowerCase()}function E(e,t){var n=(0,o.BL)(t.ShellResources.tokenfactoryiframe),i=(0,o.BL)(t.ShellResources.crossdomainproxyiframe),r=(0,o.BL)(t.ShellResources.msaltokenfactoryiframe);return{version:e,tokenfactoryJsHash:n.hash,crossdomainproxyJsHash:i.hash,msaltokenfactoryJsHash:r.hash,resourceCatalogHostUrl:t.ResourceCatalogHostUrl}}function k(){if(!("XMLHttpRequest"in window))throw new s.F(u.e1,-2003);return new XMLHttpRequest}function R(e){if(null==e)throw b("requestInfo");if(T(e.url,"requestInfo.url",c,!0),T(e.body,"requestInfo.body",c,!1),T(e.success,"requestInfo.success",d,!1),T(e.error,"requestInfo.error",d,!1),T(e.timeout,"requestInfo.timeout",f,!1),T(e.method,"requestInfo.method",c,!1),T(e.binaryStringRequestBody,"requestInfo.BinaryRequestBody",p,!1),T(e.binaryStringResponseBody,"requestInfo.BinaryResponseBody",p,!1),A(e.method)?e.method="GET":e.method=e.method.toUpperCase(),null==e.timeout&&(e.timeout=a.K.DefaultTimeout),e.timeout<0)throw b("requestInfo.timeout");if(A(e.url))throw b("requestInfo.url")}function L(e){for(var t="",n=new Uint8Array(e),i=0;i<n.length;i++)t+=String.fromCharCode(n[i]);return t}function U(e){var t=null;if(typeof e===c){for(var n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=255&e.charCodeAt(r);var o=new Blob([n]);t=o||n}return t}function N(e){var t="",n=e.indexOf("?");return n>0&&(t=e.substr(n+1,e.length)),t}function F(e){var t={};if(null!=e)for(var n=new RegExp("\r?\n"),i=0,r=e.split(n);i<r.length;i++){var o=r[i];if(null!=o){var a=o.indexOf(":");if(a>0){var s=o.substr(0,a),u=o.substr(a+1);s=M(s),u=M(u),t[s.toUpperCase()]=u}}}return t}function M(e){return e.replace(/^\s+|\s+$/g,"")}function B(e,t){return 0===e.lastIndexOf(t,0)}function W(e,t){return e.lastIndexOf(t)===e.length-t.length}function q(){if(!("ArrayBuffer"in window))throw(0,r.jl)().tag("RequestExecutor_ArrayBufferNotSupported",6,-2003,u.YG),new s.F(u.YG,-2003);if(!("Uint8Array"in window))throw(0,r.jl)().tag("RequestExecutor_Uint8ArrayNotSupported",6,-2003,u.YG),new s.F(u.YG,-2003);if(!("BlobBuilder"in window)&&!("MozBlobBuilder"in window)&&!("Blob"in window))throw(0,r.jl)().tag("RequestExecutor_BlobBuilderNotSupported",6,-2003,u.YG),new s.F(u.YG,-2003)}function H(e){if(window.addEventListener)return window.addEventListener("message",e,!1),!0;throw new s.F(u.JP,-2002)}function G(e,t,n,i){if(null!=e.error){var o={state:e.state,body:""};i&&(n=n+" target: "+i),e.error(o,t,n)}else(0,r.jl)().tag("RequestExecutor_NoErrorCallback",6,t.toString(),n)}function j(e){return z(e,!0,!0)}var K=128;function z(e,t,n){var i="";if(A(e)||void 0===e||0===e.length)return"";for(var r=0;r<e.length;r++){var o=e.charCodeAt(r),a=e.charAt(r);if(t&&("#"===a||"?"===a)){i+=e.substr(r);break}if(o<=127)n||o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o>=32&&o<=95&&" \"%<>'&".indexOf(a)<0?i+=a:o<=15?i+="%0"+o.toString(16).toUpperCase():o<=127&&(i+="%"+o.toString(16).toUpperCase());else if(o<=2047)i+="%"+(192|o>>6).toString(16).toUpperCase(),i+="%"+(K|63&o).toString(16).toUpperCase();else if(55296!=(64512&o))i+="%"+(224|o>>12).toString(16).toUpperCase(),i+="%"+(K|(4032&o)>>6).toString(16).toUpperCase(),i+="%"+(K|63&o).toString(16).toUpperCase();else if(r<e.length-1){o=(1023&o)<<10,r++,o|=1023&e.charCodeAt(r),i+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase(),i+="%"+(K|(258048&o)>>12).toString(16).toUpperCase(),i+="%"+(K|(4032&o)>>6).toString(16).toUpperCase(),i+="%"+(K|63&o).toString(16).toUpperCase()}}return i}function V(e){return document.getElementById(Z(e))}function Z(e){switch(e){case l.o.OWA:return h;case l.o.TokenFactory:return g;default:return(0,r.jl)().tag("RequestExecutor_UnsupportedFrameCodeSpecified",6),""}}function Q(e){return"arraybuffer"===e.responseType?e.response?e.response.byteLength:0:e.responseText?e.responseText.length:0}},44598:function(e,t,n){"use strict";var i;n.d(t,{v:function(){return i}}),function(e){e[e.NoExoLicense=1]="NoExoLicense",e[e.Brs=2]="Brs",e[e.TokenExpired=3]="TokenExpired",e[e.LanguageNotSet=4]="LanguageNotSet",e[e.InitFailed=5]="InitFailed",e[e.SecurityZoneMismatched=6]="SecurityZoneMismatched",e[e.IframeLoadError=7]="IframeLoadError",e[e.CallerOriginNotAllowed=8]="CallerOriginNotAllowed",e[e.InvalidMailbox=9]="InvalidMailbox",e[e.ShardMailbox=10]="ShardMailbox",e[e.ShardNotDetected=11]="ShardNotDetected",e[e.Pwa=12]="Pwa"}(i||(i={}))},78589:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var i=n(93897),r=n(93954),o=(n(36345),function(){function e(){}return e.onBeforeSendRequestSuiteService=function(e,t,n){if(null!=n&&null!=n.userMailboxType&&null!=t&&-1!==i.parseQueryString(t.url.toLowerCase()).indexOf("getowauserconfiguration"))try{JSON.parse(n.userMailboxType)}catch(e){}var o="X-OWA-CANARY",a="X-OWA-CANARY-DEBUG",s=(0,r.e)(o),u=(0,r.e)(a);return null!=s&&e.setRequestHeader(o,s),null!=u&&e.setRequestHeader(a,u),null},e.validateOriginWithAllowedEndpoints=function(t,n){for(var r=[],o=0;o<n.length;o++)r[o]=n[o].host;return e.validateOrigin(i.getUrlAuthorityPart(t),r)},e.validateOrigin=function(e,t){if(null==t||e.length>253)return!1;for(var n=!1,i=0;i<t.length;i++)if(""!==t[i]&&new RegExp(t[i],"i").test(e)){n=!0;break}return n},e.validatePathWithAllowedEndpoints=function(e,t){if(i.isNullOrEmptyString(e))return!1;for(var n=!1,r=i.getUrlAuthorityPart(e),o=i.getUrlPath(e),a=0,s=t;a<s.length;a++){var u=s[a];if(new RegExp(u.host,"i").test(r)){if(null==u.paths)return!1;for(var l=0,c=u.paths;l<c.length;l++){var p=c[l];if(new RegExp(p,"i").test(o)){n=!0;break}}break}}return n},e.validatePathWithAllowedResources=function(e,t,n){if(null==e||i.isNullOrEmptyString(t)||null==n)return!1;for(var r=!1,o=i.getUrlAuthorityPart(e),a=i.getUrlAuthorityPart(t),s=0,u=n;s<u.length;s++){var l=u[s],c=!1;if("^"===l.resource.charAt(0))c=new RegExp(l.resource,"i").test(o);else c=i.getUrlAuthorityPart(l.resource)===o;if(c){if(null==l.hosts)return!1;for(var p=0,d=l.hosts;p<d.length;p++){var f=d[p],h=!1;if("^"===f.charAt(0))h=new RegExp(f,"i").test(a);else h=i.getUrlAuthorityPart(f)===a;if(h){r=!0;break}}break}}return r},e.isAllowedApi=function(t){if(null==t)return!1;var n=i.getUrlPath(t);if(n in e.allowedPath){if(!e.allowedPath[n])return!0;if(i.parseQueryString(t).replace("&UA=0","")in e.allowedListOfApi)return!0}else if(i.startsWith(n,i.SuiteServiceApiRelativePath))return!0;return("owa/ev.owa2"===n||"ev.owa2"===n)&&e.checkAllowedPgmParameters(t)},e.checkAllowedPgmParameters=function(t){if(i.isNullOrEmptyString(t)||""===t.trim())return!1;var n=t.split("?");if(2===n.length){var r=n[1];if(i.isNullOrEmptyString(r)||""===r.trim())return!1;for(var o=0,a=r.split("&");o<a.length;o++){var s=a[o].split("=");if(2!==s.length)return!1;if(!(s[0]in e.AllowedPgmQueryStringParametersList))return!1}return!0}return!1},e.createAllowedPgmParamters=function(){return{ecnsq:!0,brwnm:!0,cid:!0,syncFnshRq:!0,ns:!0,ev:!0,Fn:!0,UA:!0,"UX-E4E-CANARY":!0,"X-OWA-CANARY":!0,"X-OWA-CANARY-DEBUG":!0,"X-E4E-CANARY-DEBUG":!0}},e.createAllowedApiList=function(){return{"action=GetReminders":!0,"action=GetOwaUserConfiguration":!0,"action=SetNotificationSettings":!0,"action=FindItem":!0,"action=GetUserAvailabilityInternal":!0,"action=GetCalendarFolders":!0,"action=ProcessSuiteStorage":!0,"action=SubscribeToNotification":!0,"action=PerformReminderAction":!0,"action=GetOwaUserOofSettings":!0,"action=SetUserTheme":!0,"action=SetUserLocale":!0,"action=UnsubscribeToNotification":!0,"action=GetDaysUntilPasswordExpiration":!0,"action=GetModernGroups":!0,"action=GetModernGroup":!0,"action=GetModernGroupUnseenItems":!0,"action=GetCalendarFolderConfiguration":!0,"action=SubscribeToGroupUnseenNotification":!0,"action=SubscribeToGroupNotification":!0,"action=GetSocialActivityNotifications":!0,"action=GetSocialActivityNotifications2":!0,"action=MarkSocialActivityNotificationsAsSeen":!0,"action=MarkSocialActivityNotificationsAsSeen2":!0,"action=GetBingHelpSearchResults":!0,"action=GetMailboxRegionalConfiguration":!0,"action=SetMailboxRegionalConfiguration":!0,"format=json":!0,"api-version=1":!0,"action=TestAddReminders":!0,"action=TestDeleteAllReminders":!0,"action=TestAddItems":!0,"action=TestDeleteAllItems":!0,"action=TestAddCalendarFolders":!0,"action=TestAddCalendarGroups":!0,"action=TestDeleteAllCalendarFolders":!0,"action=TestDeleteAllCalendarGroups":!0,"action=TestAddUserAvailability":!0,"action=TestDeleteAllUserAvailability":!0,"action=TestAddOwaUserOofSettings":!0,"action=TestDeleteNotifications":!0,"action=TestAddNotifications":!0,"action=TestGetSettings":!0}},e.createAllowedPath=function(){var e;return(e={})[i.OwsRelativePath]=!0,e["SuiteService.svc/"]=!0,e["SuiteService.svc"]=!0,e["owa/ev.owa2"]=!0,e["ev.owa2"]=!0,e["Microsoft.Online.BOX.Admin.UI.SystemAlert.GetAlerts.model"]=!0,e["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model"]=!0,e["Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model"]=!0,e["api/myapps/GetAllApps"]=!1,e["api/myapps/GetAppDetails"]=!1,e["api/myapps/GetCompleteAppData"]=!1,e["api/myapps/ExecuteAppCustomAction"]=!1,e["api/myapps/ActivatePendingProvisioningApps"]=!1,e["owa/service.svc/s/GetPersonaPhoto"]=!1,e["api/settings/cards"]=!1,e["api/settings/cards/data"]=!1,e["api/settings/theme"]=!1,e["api/settings/darkmode"]=!1,e["api/settings/language"]=!1,e["api/settings/contactPreferences"]=!1,e["api/NotificationsSettings/User"]=!1,e["api/settings/SPO/MySiteUrl"]=!1,e["api/settings/regiontimezone"]=!1,e["api/profile/photo"]=!1,e["v1.0/me/photo/$value"]=!1,e["api/storage/CustomerContent/Tenant/CustomSupportData"]=!0,e},e.allowedPath=e.createAllowedPath(),e.allowedListOfApi=e.createAllowedApiList(),e.AllowedPgmQueryStringParametersList=e.createAllowedPgmParamters(),e}())},67564:function(e,t,n){"use strict";n.r(t),n.d(t,{XSuiteError:function(){return d},convertErrorToException:function(){return v},generateCorrelationId:function(){return g},genericServiceExceptionLog:function(){return _},genericServiceRejection:function(){return T},getOwaError:function(){return y},getOwaServerName:function(){return m},isCallsBlockedException:function(){return S}});var i=n(80997),r=n(49447),o=n(46555),a=n(1098),s=function(){function e(e){this.value=e}return e.newSuid=function(){var t=(new Date).getTime();return e.disambiguationIndex=99===e.disambiguationIndex?0:e.disambiguationIndex+1,new e(100*t+e.disambiguationIndex)},e.disambiguationIndex=-1,e}(),u="X-OWA-ERROR",l="X-OWA-CORRELATIONID",c="X-FESERVER",p="X-BESERVER",d="X-SUITE-ERROR",f="FE_{0}_BE_{1}",h=[l,c,p,u,d];function g(e){return e+"_"+s.newSuid().value.toString()}function m(){return(0,i.Uw)(f,o.e.Instance.OwaFrontEndServerName,o.e.Instance.OwaBackEndServerName)}function y(e){return null==e?null:(null!=e[c]&&(o.e.Instance.OwaFrontEndServerName=e[c]),null!=e[p]&&(o.e.Instance.OwaBackEndServerName=e[p]),e[u])}function v(e,t,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];var o=C(e);o.errorCode=t;for(var s=0,u=0,l=i;u<l.length;u++){var c=l[u];o["arg"+s]=c,s++}return new a.P(n,t,o)}function S(e){return-1010===e.errorCode||-1007===e.errorCode}function _(e,t,n){if(n){var o=n.errorCode||"",a=n.errorInfo&&n.errorInfo.HttpStatus?n.errorInfo.HttpStatus:"",s=n[u]||n[d]||"",h=null!=n[c]&&null!=n[p]?(0,i.Uw)(f,n[c],n[p]):"",g=n[l]||"";(0,r.jl)().exception(e,t,n,o,a,s,h,g)}else(0,r.jl)().exception(e,t,n)}function T(e,t,n,i){S(n)&&_(e,t,n),i(n)}function C(e){var t={};if(null!=e&&(t.HttpStatus=e.statusCode,null!=e.headers))for(var n=0,i=h;n<i.length;n++){var r=i[n];null!=e.headers[r]&&(t[r]=e.headers[r])}return t}},92881:function(e,t,n){"use strict";n.d(t,{J:function(){return c}});var i=n(93897),r=n(93954),o=n(1098),a=n(76596),s=n(54458),u="$",l="CurrentUserId",c=function(){function e(){}return e.processRequest=function(t,n){var u,c,p={},d=(0,r.e)("SuiteServiceProxyKey");if(i.isNullOrEmptyString(d)){if(d=(0,r.e)("ClientStorageCookie"),i.isNullOrEmptyString(d))throw new o.P(a.UU,-2007);d=decodeURIComponent(d)}var f=d.split("&");if(2!==f.length)throw new o.P(a.UU,-2007);if(u=f[0],c=f[1],i.isNullOrEmptyString(t.UserId))throw new o.P(a.UU,-2004);var h=window.sessionStorage;if(null==h)throw new o.P(a.UU,-2005);try{var g=t.UserId;s.F.computeSHA256(g).then((function(i){var r=h.getItem(l);null!=r&&i!==r&&e.doClear({Clear:!0},p,h),h.setItem(l,i),e.doClear(t,p,h),e.doClearAll(t,p,h),e.doDeletes(t,p,h),e.doWritesAndReads(t,u,c,h,p,n)})).catch((function(e){var t=null==e?a.UU:e;p.ResetError=new o.P(t,-2008),n(p)}))}catch(e){p.ResetError=e,n(p)}},e.doClear=function(t,n,r){try{if(!0===t.Clear){var o=Object.keys(r).filter((function(e){return!i.startsWith(e,"adal.")}));e.doDeletes({Deletes:o},n,r)}}catch(e){n.ClearError=e}},e.doClearAll=function(t,n,i){try{if(!0===t.ClearAll){var r=Object.keys(i);e.doDeletes({Deletes:r},n,i)}}catch(e){n.ClearError=e}},e.doDeletes=function(e,t,n){try{if(null!=e.Deletes)for(var i=0,r=e.Deletes;i<r.length;i++){var o=r[i];n.removeItem(o)}}catch(e){t.DeleteError=e}},e.doWritesAndReads=function(t,n,i,r,o,a){try{null!=t.Writes?e.encryptWrites(n,i,t.Writes,0,r,(function(){e.doReads(t,n,i,r,o,a)}),(function(s){o.WriteError=s,e.doReads(t,n,i,r,o,a)})):e.doReads(t,n,i,r,o,a)}catch(s){o.WriteError=s,e.doReads(t,n,i,r,o,a)}},e.doReads=function(t,n,i,r,o,a){try{if(null!=t.Reads){e.decryptReads(n,i,t.Reads,0,{},r,(function(e){o.Reads=e,a(o)}),(function(e){o.ReadError=e,a(o)}))}}catch(e){o.ReadError=e,a(o)}},e.encryptWrites=function(t,n,i,r,l,c,p){null!=i&&r<i.length?null==t?(l.setItem(i[r].Key,i[r].Value),e.encryptWrites(t,n,i,r+1,l,c,p)):s.F.encryptAES(t,n,u+i[r].Value+u).then((function(o){l.setItem(i[r].Key,o),e.encryptWrites(t,n,i,r+1,l,c,p)})).catch((function(e){var t=null==e?a.UU:e;p(new o.P(t,-2009))})):c()},e.decryptReads=function(t,n,r,a,l,c,p,d){if(null!=r&&a<r.length){var f=r[a],h=c.getItem(f);null===h?e.decryptReads(t,n,r,a+1,l,c,p,d):(null===t&&(l[f]=h,e.decryptReads(t,n,r,a+1,l,c,p,d)),s.F.decryptAES(t,n,h).then((function(o){null==o||!i.startsWith(o,u)||!i.endsWith(o,u)||o.length<2?e.doClear({Clear:!0},{},c):l[f]=o.substr(1,o.length-2),e.decryptReads(t,n,r,a+1,l,c,p,d)})).catch((function(i){"OperationError"===i?(e.doClear({Clear:!0},{},c),e.decryptReads(t,n,r,a+1,l,c,p,d)):d(new o.P(i))})))}else p(l)},e}()},74240:function(e,t,n){"use strict";n.d(t,{Pp:function(){return s.P},FH:function(){return p.F},uJ:function(){return h.u},Ou:function(){return r.Ou},xX:function(){return u},t6:function(){return o.t},vj:function(){return d.v},LU:function(){return f},es:function(){return a.e},fO:function(){return c},$_:function(){return y}});var i=n(31286),r=n(57942),o=n(40702),a=n(46555),s=n(1098),u=(n(78589),n(93897)),l=n(76596),c=function(){function e(){}return e.checkScope=function(t,n){if(null!=t&&!(0,u.startsWith)(t,n+e.DictionaryStringPartsSeparator))throw new s.P(l.H1,-2010)},e.SuiteScope="O365S",e.DictionaryStringPartsSeparator="//",e}(),p=n(64681),d=n(44598),f=(n(92881),n(54458),n(67564)),h=n(36345),g=null;try{window.MSA&&window.MSA.MeControl&&(g=window.MSA.MeControl.UserStateModel)}catch(e){}var m=g;(function(){function e(){}e.createUserStateModel=function(e){return null!=window.MSA?new m(e):null}})(),function(){function e(){}e.MSA="msa",e.AAD="aad",e.MSAFed="msaFed"}();function y(){"complete"===document.readyState?i.K.internalProcessWindowLoad():window.onload=i.K.internalProcessWindowLoad}},56623:function(e,t,n){"use strict";var i,r;n.d(t,{C:function(){return i},A:function(){return r}}),function(e){e.LifeCycle="LifeCycle",e.DataProviderResponseNotification="DataProviderResponseNotification",e.ChallengeToken="ChallengeToken"}(i||(i={})),function(e){e.GetConfig="GetConfig",e.RefreshToken="RefreshToken",e.PageReady="PageReady",e.Closed="Closed",e.FatalError="FatalError"}(r||(r={}))},36345:function(e,t,n){"use strict";var i;n.d(t,{u:function(){return i}}),function(e){e.Ping="Ping",e.Query="Query",e.OwaUserConfig="OwaUserConfig",e.TokenPrefetch="TokenPrefetch",e.Storage="Storage",e.Notification="Notification",e.UserState="UserState",e.SignalR="SignalR",e.IncomingOpxMessage="IncomingOpxMessage",e.OutgoingOpxMessage="OutgoingOpxMessage",e.RegisterOpxHost="RegisterOpxHost"}(i||(i={}))},60321:function(e,t,n){"use strict";n.d(t,{o0:function(){return u},yX:function(){return l},AQ:function(){return c},e9:function(){return p},UN:function(){return d},W3:function(){return f}});var i,r=n(99464),o=n(49447),a=n(85920),s=n(4245),u={IsVirtual:!0,ParallelView:!0,Style:"o365shell",CanCollapse:!0,SuppressBackgroundRinging:!0};function l(e,t){!t&&swc&&(e?swc.API.triggerEvent(r.X_.ApiRecentsShown):swc.API.triggerEvent(r.X_.ApiRecentsHidden))}function c(e,t){!t&&swc&&swc.SDK.Recents.refreshDOM(e)}function p(e,t,n){!n&&swc?(swc.API.registerEvent(r.X_.ApiRecentsReady,t),swc.create(r.PO.Recents,{},e)):n&&(i=e)}function d(e,t){TeamsClient&&TeamsClient.client&&TeamsClient.client.conversations.get().then((function(n){n.render(i).then(e),n.subscribe((function(e){e.type===s.q.ConversationOpened&&t(!1,a.vP)}))}))}function f(e,t){swc&&swc.getPresence().then((function(t){t.setMyStatus(e.key)})).catch((function(e){(0,o.jl)().exception("UserPresence_SetMyStatus_Exception",6,e),t()}))}},99464:function(e,t,n){"use strict";var i,r,o;n.d(t,{X_:function(){return i},l$:function(){return r},PO:function(){return o}}),function(e){e.ChatCoreReady="swc:core:ready",e.ChatAPIReady="swc:ready",e.ApiRecentsReady="recentsReady",e.ApiRecentsShown="recentsShown",e.ApiRecentsHidden="recentsHidden",e.ApiUnreadConversationUpdate="unreadConversationsUpdate",e.ApiStartChat="startChat",e.ApiOnCallStart="onCallStart",e.ApiRecentItemsLoaded="recentItemsLoaded",e.ApiOnRecentItemSelected="onRecentItemSelected"}(i||(i={})),function(e){e.ChatRecents="skype-recents",e.ChatWrapper="chat-wrapper"}(r||(r={})),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(o||(o={}))},4245:function(e,t,n){"use strict";var i,r;n.d(t,{k:function(){return i},q:function(){return r}}),function(e){e[e.UnreadCounterUpdate=0]="UnreadCounterUpdate"}(i||(i={})),function(e){e.TeamsChatAPIReady="ms-teams-sdk-loaded",e.ConversationOpened="conversationOpened"}(r||(r={}))},33237:function(e,t,n){"use strict";n.d(t,{q:function(){return i},D:function(){return r},nZ:function(){return o},YI:function(){return a}});var i="suiteux-chat.UPDATE_IS_CHAT_RECENTS_INITIALIZED",r="suiteux-chat.UPDATE_IS_CHAT_API_INITIALIZED",o="suiteux-chat.UPDATE_UNREAD_CONVERSATION_COUNT",a="suiteux-chat.UPDATE_IS_TEAMS_CHAT_ACTIVATED"},36952:function(e,t,n){"use strict";n.d(t,{Ou:function(){return u.Ou},xV:function(){return d.x},Zo:function(){return f.Z},tw:function(){return W.t},BH:function(){return T.B},Eg:function(){return b.E},GI:function(){return p.G},ri:function(){return u.ri},Q:function(){return u.Q},lD:function(){return _},hs:function(){return u.hs},C1:function(){return u.C1},__:function(){return u.__},Eb:function(){return w},Zp:function(){return M},yw:function(){return D.yw},aM:function(){return N},y3:function(){return o},mI:function(){return c},iv:function(){return A.i},Jb:function(){return s.Jb},Mq:function(){return F},RF:function(){return B},vo:function(){return U},M1:function(){return a},Y5:function(){return L.Y5},GS:function(){return k},g6:function(){return P},Uw:function(){return E.Uw},ef:function(){return i.e},Wu:function(){return E.Wu},xH:function(){return E.xH},pG:function(){return O},Vz:function(){return l},sG:function(){return R.s},nJ:function(){return D.nJ},Cj:function(){return s.Cj},Te:function(){return D.Te},bv:function(){return s.bv},ir:function(){return D.ir},YA:function(){return r.Y},NN:function(){return x},gJ:function(){return s.gJ},uS:function(){return s.uS}});var i=n(1359),r=n(7328),o=(n(79233),{timestamp:null,appsUpdateTimeSpan:null,appDataCache:null,moreAppDataAvailable:null,doNotCallGetAllAppsUntil:null}),a=(n(32255),n(9676),{activeButtonId:"",customFlexPanes:{},customFlexPaneHash:void 0,customHeaderButtonFlexPaneTriggers:{},customHeaderButtons:[],badgeValues:{}}),s=n(29778),u=n(24286),l={notificationsEnabled:!1,toastsMuted:!1,bellHeaderButtonInLayout:!0,isSubscriptionReady:!1,systemNotificationsDisabled:!0,notifications:[]},c={isChatAPIInitialized:null,isChatRecentsPaneInitialized:!1,unreadBadgeValue:0,chatEnabled:!1,chatWebLink:null,webChatSDKUrl:null,isTeamsChatActivated:!1},p=n(80278),d=n(92053),f=n(62920),h=n(70655),g=n(20690),m=n(364),y=n(3798),v=n(68461),S=n(74965),_=function(e){function t(t){var n=e.call(this,t)||this;return n.setRef=function(e){return n.searchControl=e},n.SearchBarKey=function(e){var t=e.currentTarget.value;n.setState((function(){return{currentSearchText:t,showDismissButton:!0}})),n.props.onSearch(t)},n.DismissDefaultText=function(){n.state.clearTextOnFocus?n.setState((function(){return{currentSearchText:"",showDismissButton:!1}})):n.setState((function(){return{showDismissButton:!0,clearTextOnFocus:!0}}))},n.DefaultSearchText=function(){""===n.state.currentSearchText?n.setState((function(){return{currentSearchText:n.props.defaultText,showDismissButton:!1}})):n.setState((function(){return{clearTextOnFocus:!1}}))},n.ButtonClearText=function(){n.searchControl.focus(),n.searchControl.placeholder="",n.setState((function(){return{currentSearchText:"",showDismissButton:!1}})),n.props.onSearch("")},n.moveCursor=function(){n.searchControl.focus()},n.props.currentSearchText?n.state={currentSearchText:n.props.currentSearchText,showDismissButton:!0,clearTextOnFocus:!1}:n.state={currentSearchText:n.props.defaultText,showDismissButton:!1,clearTextOnFocus:!0},n}return(0,h.__extends)(t,e),t.prototype.getSearchResultAriaLabel=function(){return(0,E.xH)(this.state.currentSearchText)?"":(0,E.Uw)(m.b.SearchBoxResultAriaLabel,""+this.props.searchResultCount)},t.prototype.render=function(){var e=(0,v.j)(),t=(0,S.w)();return g.createElement("div",{className:(0,A.i)(y.SearchControl,t?y.SearchControlZoomMargin:null,e.neutral.foregroundAlt.background)},g.createElement("div",{"aria-live":"polite",style:{position:"absolute",left:"-999em",top:"0em"}},this.getSearchResultAriaLabel()),this.state.showDismissButton?g.createElement("button",{onClick:this.ButtonClearText,"aria-label":m.b.SearchBoxClearButtonText,title:m.b.SearchBoxClearButtonText},g.createElement(T.B,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--ChromeClose",fontSize:"12"})):g.createElement("button",{onClick:this.moveCursor,tabIndex:-1,"aria-hidden":!0},g.createElement(T.B,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--Search",fontSize:"12"})),g.createElement("input",{className:(0,A.i)(y.inputBox,e.neutral.dark.font),type:"text",onFocus:this.DismissDefaultText,value:this.state.currentSearchText,onChange:this.SearchBarKey,onBlur:this.DefaultSearchText,ref:this.setRef,placeholder:this.props.defaultText,id:"appLauncherSearch",autoComplete:"off","aria-label":this.props.ariaLabel||this.props.defaultText}))},t}(g.Component),T=n(6696),C=(n(42539),n(70152)),I=n(49447),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,h.__extends)(t,e),t.prototype.render=function(){var e,t=(0,v.j)();if(null!=this.props.unseenItemCount&&0!==this.props.unseenItemCount){var n=(0,A.i)(C.unseenCount,t.accent.border,((e={})[t.badge]=!this.props.isParentHovered,e)),i={};return this.props.isParentHovered&&(i.boxSizing="border-box",i={backgroundColor:(0,I.q4)().getThemeData().AccentHover||"white",border:"1px solid",color:"#106EBE"}),g.createElement("div",{className:(0,A.i)(C.unseenitems,this.props.badgeStyles)},g.createElement("span",{style:i,className:n},this.props.unseenItemCount>0&&this.props.unseenItemCount,this.props.children))}return null},t}(g.Component),b=n(93250),A=n(11833),D=n(326),P=n(50591),O=n(21987);function x(e,t,n){return void 0===n&&(n=","),e=e?e.toLowerCase().trim():"",(t?t.toLowerCase().split(n):[]).some((function(t){return t.trim()===e}))}var E=n(80997);function k(e,t,n){void 0===n&&(n=0);for(var i=-1,r=n;r<e.length;r++)if(t(e[r])){i=r;break}return i}var R=n(37187),L=n(93401),U=n(85675);function N(e,t,n){var i="?";return e.indexOf(i)>-1&&(i="&"),e+i+t+"="+n}function F(e){return e?encodeURI(e).replace(/#/g,"%23"):""}var M=n(71133),B=n(57165),W=n(26244);n(42480)},85675:function(e,t,n){"use strict";function i(e,t){if(null===e)throw new Error("Error: "+t+" is null.")}function r(e,t){if(void 0===e)throw new Error("Error: "+t+" is undefined.")}function o(e,t){i(e,t),r(e,t)}function a(e,t){if(o(e,t),0===e.length)throw new Error("Error: "+t+" is an empty string.")}function s(e,t){if(o(e,t),0===e.length)throw new Error("Error: "+t+" is a null or empty array.")}n.r(t),n.d(t,{throwOnNull:function(){return i},throwOnUndefined:function(){return r},throwOnNullOrUndefined:function(){return o},throwOnNullOrEmpty:function(){return a},throwOnNullOrEmptyArray:function(){return s}})},18902:function(e,t,n){"use strict";n.d(t,{r2:function(){return r},WA:function(){return o},Gj:function(){return a},wW:function(){return s},P2:function(){return u}});var i=n(49447),r="OPX",o="https://outlook.office.com",a=[o,"https://to-do.office.com","https://outlook-sdf.office.com"];function s(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}function u(){var e="hiddenOpxContainer",t=document.getElementById(e);if(!t){var n=(0,i.aH)();if(n){var r=document.getElementById(n.top);r&&((t=document.createElement("div")).id=e,t.style.display="none",r.appendChild(t))}}return t}},68034:function(e,t,n){"use strict";n.d(t,{rP:function(){return i},yo:function(){return r},tL:function(){return o}});var i=6e4,r=60*i,o=24*r},63775:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});var i=n(26970);function r(e){return{type:i.k,dttProps:e}}},26970:function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i="suiteux-dtt.UPDATE_PROPS"},6323:function(e,t,n){"use strict";function i(e){return null!=e&&0!==e.length&&e.some((function(e){return r(e)}))}function r(e){return!(null==e||o(e.Id)||o(e.Text)||o(e.Url)&&null==e.Action)}function o(e){return""===e||null==e}n.d(t,{q:function(){return i},l:function(){return r}})},74965:function(e,t,n){"use strict";n.d(t,{J:function(){return r},w:function(){return o}});var i=n(49447),r=240;function o(){var e=(0,i.aH)(),t=e&&e.shyHeaderActivationHeight?e.shyHeaderActivationHeight:r;return window.matchMedia("(max-height: "+t+"px)").matches}},37305:function(e,t,n){"use strict";var i;n.d(t,{l:function(){return i}}),function(e){e[e.SystemAlert=0]="SystemAlert",e[e.ReminderNotification=1]="ReminderNotification"}(i||(i={}))},74569:function(e,t,n){"use strict";n.r(t);var i=n(49447),r=n(20690),o=n(39669),a=n(37974),s=n(36952),u=n(64999),l=n(94875),c=n(70655),p=n(74240),d=n(74153),f=n(30399),h=n(84293);function g(e){return new Promise((function(t,n){var r=(0,s.Uw)("/api/myapps/GetIcon?appDataJson={0}",encodeURIComponent(JSON.stringify({Id:e.Id,CollectorId:e.CollectorId,Properties:e.Properties})));f.nR.Instance.Service.callWebClientShellServiceFunction(r,"GET",null,null).then((function(e){t(e)})).catch((function(e){p.LU.isCallsBlockedException(e)||(0,i.jl)().exception("AppsManager_GetAppIcon_Failed",6,e),n(e)}))}))}var m="AppsPinnedData",y=["FirstParty","SharePoint","Graph","LineOfBusiness","Dynamics"],v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastAppsPinnedDataWriteTimestampKey=new h.Qt("User","Suite","LastAppsPinnedDataWriteTimestamp"),t.cachedAppsDataKey=new h.Qt("User","Suite","CachedAppsData"),t}return(0,c.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;window.O365Shell.OnSuiteAPILoaded((function(){e.initializeInternal()}))},t.prototype.componentDidUpdate=function(e){this.props.appsPinnedData&&e.appsPinnedData&&this.props.appsPinnedData!==e.appsPinnedData&&((!this.props.appsPinnedData.timestamp||!e.appsPinnedData.timestamp||this.props.appsPinnedData.timestamp>=e.appsPinnedData.timestamp)&&this.hasAppsPinnedDataChanged(e.appsPinnedData)&&this.saveCustomization())},t.prototype.render=function(){return null},t.prototype.initializeInternal=function(){var e=this,t=this.props.appsPinnedData;this.props.disableSessionStorageCache?this.updateAppsFromStorage():null!=t?Date.now()-this.props.timestamp<6e4?this.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync().then((function(n){n&&t.timestamp<n?e.readAppsPinnedData(1):e.updateApps(t,!0)})).catch((function(){e.readAppsPinnedData(3)})):this.readAppsPinnedData(2):this.readAppsPinnedData(0);var n=(0,i.Lo)();n.subscribe("AppIconRequested",(function(t){g(t).then((function(n){e.props.onSetImageDataUrl(t.CollectorId,t.Id,"data:"+n.MimeType+";base64,"+n.Base64EncodedImage)})).catch((function(){}))})),n.subscribe("AppDataDetailsRequested",(function(t){e.getAppDataDetailsAsync(t).then((function(n){n.CollectorId=t.CollectorId,e.props.onSetAppDataDetails(n)})).catch((function(){}))}),!0),n.subscribe("AppsReset",(function(){e.props.onSetAppsPinnedData({apps:[]})})),n.subscribe("AppsUpdate",(function(){e.updateAppsFromCollectors()}))},t.prototype.readAppsPinnedData=function(e){var t=this;this.readAppsPinnedDataFromStorageAsync().then((function(e){t.updateApps(e,!0)})).catch((function(){t.updateApps(t.props.appsPinnedData,!1),(0,i.jl)().tag("AppsManager_ReadAppsPinnedDataFromStorageReason",1,e)}))},t.prototype.updateApps=function(e,t){var n=this;e&&e!==this.props.appsPinnedData&&this.props.onSetAppsPinnedData(e),t&&this.props.onEnableCustomization(),this.readCachedAppsFromSessionStorageAsync().then((function(e){if(e)if(Date.now()-e.timestamp>n.props.appsUpdateTimeSpan||e.cultureName!==n.props.cultureName)n.updateAppsFromStorage();else{var t=!0;n.props.appDataCache&&!n.props.moreAppDataAvailable&&n.props.timestamp>=e.timestamp&&(t=!1),t&&n.updateMyApps(e.apps,1)}else n.updateAppsFromStorage()})).catch((function(){n.updateAppsFromStorage()}))},t.prototype.updateAppsFromStorage=function(){var e=this;this.props.appDataCache&&!this.props.moreAppDataAvailable?this.updateAppsFromCollectors():this.readAppDataCacheFromStorageAsync().then((function(t){e.onReadAppDataCacheSucceeded(t)})).catch((function(){e.updateAppsFromCollectors()}))},t.prototype.onReadAppDataCacheSucceeded=function(e){for(var t={},n=function(n){var r=e[n];if(r&&r.Apps)t[n]=r.Apps;else{var o=i.props.appsData.filter((function(e){return e.CollectorId===n}));o.length>0&&(t[n]=o)}},i=this,r=0,o=y;r<o.length;r++){n(o[r])}this.onAppDataDictionaryFetched(t,2),this.updateAppsFromCollectors()},t.prototype.updateAppsFromCollectors=function(){var e=this;this.props.doNotCallGetAllAppsUntil&&this.props.doNotCallGetAllAppsUntil>Date.now()||this.getAllAppsFromCollectorsAsync().then((function(t){e.onGetAllAppsSucceeded(t)})).catch((function(){e.invokeAppsUpdatedEvent(null,0,3)}))},t.prototype.onGetAllAppsSucceeded=function(e){if(0!==Object.keys(e).length){for(var t=function(t){if(!e[t]){var i=n.props.appsData.filter((function(e){return e.CollectorId===t}));i.length>0&&(e[t]=i)}},n=this,i=0,r=y;i<r.length;i++){t(r[i])}this.onAppDataDictionaryFetched(e,3)}},t.prototype.onAppDataDictionaryFetched=function(e,t){e.FirstParty&&(e.FirstParty=this.getFirstPartyAppsFromAppsData(this.props.appsData,e.FirstParty)),this.updateMyApps(e,t),this.writeCachedAppsToSessionStorageAsync({timestamp:Date.now(),apps:e,cultureName:this.props.cultureName}).catch((function(){}))},t.prototype.getFirstPartyAppsFromAppsData=function(e,t){for(var n=[],i=0,r=e.filter((function(e){return"FirstParty"===e.CollectorId}));i<r.length;i++){var o=r[i],a=(0,d.Bl)(t,"FirstParty",o.Id);null!=a&&(o.AlternateNames=a.AlternateNames,o.DateInstalled=a.DateInstalled),n.push(o)}if(!n.some((function(e){return"Partner"===e.Id}))){var s=(0,d.Bl)(t,"FirstParty","Partner");null!=s&&n.push(s)}return n},t.prototype.updateMyApps=function(e,t){var n=this.aggregateAppDatas(e);this.props.onSetAppsData(n,t)},t.prototype.invokeAppsUpdatedEvent=function(e,t,n){var r={Apps:e,DataSource:t,FailureReason:n},o=null!=e?"AppsRetrievalSucceeded":"AppsRetrievalFailed";(0,i.Lo)().invoke(o,r)},t.prototype.hasAppsPinnedDataChanged=function(e){var t=this.props.appsPinnedData.apps,n=e.apps;if(t.length!==n.length)return!0;for(var i=0;i<t.length;i++)if(t[i].CollectorId!==n[i].CollectorId||t[i].Id!==n[i].Id)return!0;return!1},t.prototype.saveCustomization=function(){var e=this,t=this.props.appsPinnedData.apps.map((function(e){return e.Id}));(0,i.jl)().tag("AppsManager_SavingAppsCustomizationData",1,t.join());var n=Date.now();if("number"==typeof n)this.props.appsPinnedData.timestamp=n,this.props.appsPinnedData.cultureName=this.props.cultureName,this.writeAppsPinnedDataToStorageAsync(this.props.appsPinnedData).then((function(){e.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(e.props.appsPinnedData.timestamp).catch((function(){}))})).catch((function(){}));else{var r=null;try{r=Date.now.toString()}catch(e){}(0,i.jl)().tag("AppsManager_InvalidDateNowFunction",6,n,r)}},t.prototype.aggregateAppDatas=function(e){for(var t=[],n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];e[r]&&t.push.apply(t,e[r])}return t},t.prototype.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync=function(){var e=this;return new Promise((function(t,n){var r=f.nR.Instance.WebShellStorage.createWebShellStorageRequest();r.requestRead(e.lastAppsPinnedDataWriteTimestampKey),f.nR.Instance.WebShellStorage.readSessionStorage(r).then((function(n){n.hasValue(e.lastAppsPinnedDataWriteTimestampKey)?t(n.getValue(e.lastAppsPinnedDataWriteTimestampKey)):t()})).catch((function(e){(0,i.jl)().exception("AppsManager_ReadLastAppsPinnedDataWriteTimestamp_Failed",6,e),n(e)}))}))},t.prototype.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync=function(e){var t=this;return new Promise((function(n,i){var r=f.nR.Instance.WebShellStorage.createWebShellStorageRequest();r.requestWrite(e,t.lastAppsPinnedDataWriteTimestampKey),f.nR.Instance.WebShellStorage.writeSessionStorage(r).then((function(){n()})).catch((function(e){p.LU.genericServiceRejection("AppsManager_WriteLastAppsPinnedDataWriteTimestamp_Failed",6,e,i)}))}))},t.prototype.readAppsPinnedDataFromStorageAsync=function(){return new Promise((function(e,t){f.nR.Instance.WebShellStorage.readStorage(h.gD.User,h.rq.SystemMetadata,m).then((function(t){var n=t.value;n&&"string"==typeof n.timestamp&&(n.timestamp=(0,s.sG)(n.timestamp).getTime()),e(n)})).catch((function(e){p.LU.genericServiceRejection("AppsManager_ReadPinnedAppsData_Failed",6,e,t)}))}))},t.prototype.writeAppsPinnedDataToStorageAsync=function(e){if(e&&e.apps){var t=e.apps.length;e.apps=(0,d.Mj)(e.apps),t>e.apps.length&&(0,i.jl)().tag("AppsManager_WriteAppsPinnedData_Deduped",4,t,e.apps.length)}return new Promise((function(t,n){f.nR.Instance.WebShellStorage.writeStorage(h.gD.User,h.rq.SystemMetadata,m,e).then((function(){t()})).catch((function(e){p.LU.isCallsBlockedException(e)||(0,i.jl)().exception("AppsManager_WriteAppsPinnedData_Failed",6,e),n(e)}))}))},t.prototype.readAppDataCacheFromStorageAsync=function(){var e=this;return new Promise((function(t,n){var r=(0,s.Uw)("/api/myapps/GetAppDataCache?hasMailboxInCloud={0}&culture={1}",e.props.hasMailboxInCloud.toString(),e.props.cultureName);f.nR.Instance.Service.callWebClientShellServiceFunction(r,"GET",null,null).then((function(e){t(e)})).catch((function(e){p.LU.isCallsBlockedException(e)||(0,i.jl)().exception("AppsManager_ReadAppDataCacheFromWCSS_Failed",6,e),n(e)}))}))},t.prototype.getAllAppsFromCollectorsAsync=function(){var e=this;return new Promise((function(t,n){var r=(0,s.Uw)("/api/myapps/GetAllApps?culture={0}",e.props.cultureName);f.nR.Instance.Service.callWebClientShellServiceFunction(r,"GET",null,null).then((function(e){t(e)})).catch((function(e){p.LU.isCallsBlockedException(e)||(0,i.jl)().exception("AppsManager_AppCollectorFetch_Failed",6,e),n(e)}))}))},t.prototype.readCachedAppsFromSessionStorageAsync=function(){var e=this;return new Promise((function(t,n){var r=f.nR.Instance.WebShellStorage.createWebShellStorageRequest();r.requestRead(e.cachedAppsDataKey),f.nR.Instance.WebShellStorage.readSessionStorage(r).then((function(n){n.hasValue(e.cachedAppsDataKey)?t(n.getValue(e.cachedAppsDataKey)):t()})).catch((function(e){p.LU.isCallsBlockedException(e)||(0,i.jl)().exception("AppsManager_ReadCacheAppsData_Failed",6,e,e.errorCode),n(e)}))}))},t.prototype.writeCachedAppsToSessionStorageAsync=function(e){var t=this;return new Promise((function(n,i){var r=f.nR.Instance.WebShellStorage.createWebShellStorageRequest();r.requestWrite(e,t.cachedAppsDataKey),f.nR.Instance.WebShellStorage.writeSessionStorage(r).then((function(){n()})).catch((function(e){p.LU.genericServiceRejection("AppsManager_WriteCacheAppsData_Failed",6,e,i)}))}))},t.prototype.getAppDataDetailsAsync=function(e){var t=this;return new Promise((function(n,r){var o=(0,s.Uw)("/api/myapps/GetAppDetails?culture={0}",t.props.cultureName),a={CollectorId:e.CollectorId,Id:e.Id,Title:e.Title,Properties:e.Properties};f.nR.Instance.Service.callWebClientShellServiceFunction(o,"POST",null,a).then((function(e){n(e)})).catch((function(e){p.LU.isCallsBlockedException(e)||(0,i.jl)().exception("Apps_FetchDetailsForCollector_Failed",6,e),r(e)}))}))},t}(r.Component),S=(0,a.$j)((function(e){return{appsData:e.appsDataState.apps,appsPinnedData:e.appLauncherState.appsPinnedData,cultureName:e.userState.cultureName,timestamp:e.appsManagerState.timestamp,appsUpdateTimeSpan:e.appsManagerState.appsUpdateTimeSpan,hasMailboxInCloud:e.userState.hasMailboxInCloud,appDataCache:e.appsManagerState.appDataCache,moreAppDataAvailable:e.appsManagerState.moreAppDataAvailable,doNotCallGetAllAppsUntil:e.appsManagerState.doNotCallGetAllAppsUntil,disableSessionStorageCache:(0,l.So)(e.shellInitDataState.clientData.WorkloadId,e.shellInitDataState.navBarData.CurrentMainLinkElementID)}}),(function(e){return{onSetAppsData:function(t,n){e((0,s.Cj)(t,n))},onSetAppsPinnedData:function(t){e((0,u.$W)(t))},onEnableCustomization:function(){e((0,u.wc)())},onSetImageDataUrl:function(t,n,i){e((0,s.bv)(t,n,i))},onSetAppDataDetails:function(t){e((0,u.lH)(t))}}}))(v);function _(e,t){return t?(0,c.__assign)((0,c.__assign)({},e),{appsUpdateTimeSpan:t.AppsUpdateTimeSpan,timestamp:t.Timestamp,appDataCache:t.AppDataCache,moreAppDataAvailable:t.MoreAppDataAvailable,doNotCallGetAllAppsUntil:t.DoNotCallGetAllAppsUntil}):e}var T={appsManagerState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=_(s.y3,n.clientData)}switch(t.type){case s.ri:return _(e,t.shellClientData);default:return e}}},C=n(46146),I=n(35989),w=(0,s.ef)(),b=function(){function e(){this.callbackPairings=[]}return e.prototype.IsCustomizationEnabled=function(){return w.getState().appLauncherState.isCustomizable},e.prototype.IsPinned=function(e,t){return null!=I.K2(w.getState().appLauncherState.pinnedAppTiles,e,t)},e.prototype.Pin=function(e,t){var n;"string"==typeof e?n=d.Bl(w.getState().appsDataState.apps,e,t):((0,i.jl)().tag("AppLauncher_PinnedCalledWithAppData",1),n=d.Bl(w.getState().appsDataState.apps,e.CollectorId,e.Id)),n&&w.dispatch((0,C.iR)(n))},e.prototype.Unpin=function(e,t){w.dispatch((0,C.v5)(e,t))},e.prototype.Reset=function(){(0,i.Lo)().invoke("AppsReset")},e.prototype.Update=function(){(0,i.Lo)().invoke("AppsUpdate")},e.prototype.OnAppsUpdated=function(e){var t=this,n=function(n){e(t.deepCloneAppsUpdatedEventArgs(n))},r=(0,i.Lo)(),o=r.subscribe("AppsRetrievalSucceeded",n,!0),a=r.subscribe("AppsRetrievalFailed",n,!0);return this.callbackPairings.push({successCallbackToken:o,failureCallbackToken:a}),o},e.prototype.RemoveOnAppsUpdated=function(e){for(var t=0,n=(0,i.Lo)(),r=0,o=this.callbackPairings;r<o.length;r++){var a=o[r];if(a.successCallbackToken===e){n.unsubscribe("AppsRetrievalSucceeded",a.successCallbackToken),n.unsubscribe("AppsRetrievalFailed",a.failureCallbackToken);break}t++}t<this.callbackPairings.length&&this.callbackPairings.splice(t,1)},e.prototype.GetAuthenticatedAppIcon=function(e,t){null==e.FontIconCss&&null==e.IconAnonymousUrl?g(e).then(t).catch((function(){t(null)})):t(null)},e.prototype.deepCloneAppsUpdatedEventArgs=function(e){var t=JSON.parse(JSON.stringify(e));if(t.Apps)for(var n=0,i=t.Apps;n<i.length;n++){var r=i[n];"FirstParty"===r.CollectorId&&(r.Id=d._X(r.Id,"add"))}return t},e}();function A(e,t){if(e.IsAuthenticated&&t.Timestamp>0){(0,i.Lo)().unsubscribe("ShellDataUpdated",A);var n=(0,s.ef)();o.render(r.createElement(a.zt,{store:n},r.createElement(S,null)),document.createElement("div"))}}var D,P=n(93401);n(37305);var O=n(3113),x=n(49074),E=n(85920),k=n(42049),R=n(32035),L=n(35420),U=n(364),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,c.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&(0,i.jl)().perfMarker("HelpTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:U.b.Help_Title,affordanceMenuItemText:U.b.Help,iconID:this.props.flipHelpIcon?"HelpMirrored":"Help",iconFontSize:L.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?r.createElement(R.sO,(0,c.__assign)({},e)):r.createElement(R.b,(0,c.__assign)({},e))},t}(r.Component),F=(0,a.$j)((function(e,t){var n,i;return{isAvailable:!(null===(i=null===(n=e.shellInitDataState)||void 0===n?void 0:n.clientData)||void 0===i?void 0:i.HelpPaneDisabled),id:t&&t.id,isActive:e.flexPaneState&&"Help"===e.flexPaneState.activeProviderKey,flipHelpIcon:e.headerState&&e.headerState.flipHelpIcon,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),(0,i.jl)().click("Help","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),e((0,s.uS)(t&&t.currentTarget&&t.currentTarget.id));var r=(0,i.aH)();!r||null!=r.OnHelpButtonClick&&r.OnHelpButtonClick()||e((0,x.yG)("Help")),n.onClick&&n.onClick(t)}}}),(function(e,t,n){var i=(0,c.__assign)((0,c.__assign)({},n),e);return(0,c.__assign)((0,c.__assign)((0,c.__assign)({},i),t),{onClick:function(e){return t.onClick(e,i)},onDimensionsChanged:function(){return t.onDimensionsChanged(i)}})}))(N);var M=n(36076),B=n(81887),W=n(40218),q=n(83911),H=null,G=function(){function e(e,t,n,i,r){this.serverRequestInfluxControl=r,this.context={};var o={disableCookiesUsage:!0};t&&t.length>0&&(o.collectorUri=t),M.CT.setTransmitProfile(M.on),this.ariaLogger=M.CT.initialize(e,o),n||(n="undefined"),i||(i="undefined"),this.registerContextParam("AppInfo.Id",n),this.registerContextParam("AppInfo.Version",i),this.serverRequestInfluxControl||(this.serverRequestInfluxControl=5),this.serverRequestInfluxControl<0&&(this.serverRequestInfluxControl=0),this.serverRequestInfluxControl>100&&(this.serverRequestInfluxControl=100)}return e.prototype.registerContextParam=function(e,t,n){void 0===n&&(n=0),this.context[e]=t,this.ariaLogger.setContextWithPii(e,t,0===n?M.uO.NotSet:M.uO.GenericData)},e.prototype.writeEvent=function(e){if(null!=e){if(!(e.name!==B.F5.Impression&&e.name!==B.F5.Click||"true"!==this.context.Context_IsConsumer||"ToDo"!==this.context.Context_Site&&"StickyNotes"!==this.context.Context_Site))return;if(e.name===B.F5.ServerRequest){var t=e.properties.filter((function(e){return"ServerRequest_Status"===e.name}));if(t.length>0&&t[0].value>=200&&t[0].value<300)if(Math.floor(100*Math.random())+1>this.serverRequestInfluxControl)return}var n=new M.hh(B.F5[e.name]);n.setType(B.hi[e.type]),n.setTimestamp(e.timestamp),e.properties.forEach((function(e){n.setPropertyWithPii(e.name,e.value,0===e.piiKind?M.uO.NotSet:M.uO.GenericData)})),this.ariaLogger.logEvent(n);0}},e}();function j(e,t){null==H&&t.AriaTelemetryEnabled&&t.AriaTelemetryTenantToken&&(!t.IsConsumerShell&&t.PUID?(0,q.C)(t)&&t.TID&&K(e,t):K(e,t))}function K(e,t){var n=window.O365ShellVerStr||"unknown",r=t.Environment||"unknown",o=t.AriaTelemetryTenantToken||"c6c190a1b73c4a63bba89835d546cf28-f2a0482f-a00d-48d9-822e-e89cc89eb64d-7688",a=(0,i.aH)();a&&a.testTraffic&&(o="c0c8ed88b81549bd84e261ebe62ccaae-cea55197-8121-49f9-826d-f682812729c3-7350"),(H=new G(o,t.AriaTelemetryUri,"OneShell",n,t.AriaTelemetryServerRequestInfluxControl)).registerContextParam("Context_Env",r),H.registerContextParam("Context_Site",t.WorkloadId),H.registerContextParam("Context_SiteSubId",e.CurrentMainLinkElementID),H.registerContextParam("Context_WorkloadAppId",(0,l.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL)),H.registerContextParam("Context_SID",t.SHSID),window.O365ShellContext.SID=t.SHSID;var s=B.cO.getNewID();H.registerContextParam("Context_PID",s),window.O365ShellContext.PID=s,H.registerContextParam("Context_TID",t.TID),H.registerContextParam("Context_UID",t.UID),H.registerContextParam("Context_PUID",t.PUID?t.PUID.toUpperCase():""),H.registerContextParam("Context_IsConsumer",t.IsConsumerShell?"true":"false"),H.registerContextParam("Context_Flights",e.FlightName),H.registerContextParam("Context_FlightRings",t.FlightRing),H.registerContextParam("Context_Segment",t.ActiveExperiences),H.registerContextParam("UserInfo.OMSTenantId",t.TID),H.registerContextParam("UserInfo.Id",t.PUID?t.PUID.toUpperCase():""),H.registerContextParam("UserInfo.IdType",t.IsConsumerShell?"MSAPUID":"OrgIdPUID"),a.correlationID&&(H.registerContextParam("Context_CID",W.Eu(a.correlationID)),window.O365ShellContext.CID=a.correlationID),a.workloadContext&&H.registerContextParam("Context_WorkloadContext",W.Eu(a.workloadContext));var u=(0,i.jl)();u.registerService(H),u.IsConsumer=t.IsConsumerShell,(0,i.Lo)().unsubscribe("ShellDataUpdated",j),window.addEventListener("beforeunload",z),window.O365ShellContext.Aria={createLogger:function(e){var t=new M.bC(e);return t.logSession(M.D.Started),t}}}function z(){try{M.CT.flushAndTeardown()}catch(e){}}function V(e,t){if(t.OTelTelemetryEnabled){var r=function(){return n.e("otellogging").then(n.bind(n,28903))};!t.IsConsumerShell&&t.PUID?(0,q.C)(t)&&t.TID&&r().then((function(n){n.initializeLogging(e,t),(0,i.Lo)().unsubscribe("ShellDataUpdated",V)})):r().then((function(n){n.initializeLogging(e,t),(0,i.Lo)().unsubscribe("ShellDataUpdated",V)}))}}var Z=!1;function Q(e,t){var n;!Z&&t&&t.FootprintTelemetryEnabled&&(Z=!0,s.Zp.isMobileClient()||(0,s.NN)(t.WorkloadId,t.FootprintWorkloadExcludeList)||(n="https://r4.res.office365.com/footprint/v3.2/scripts/fp-min.js",new Promise((function(e,t){var i=encodeURI(n),r=document.createElement("script");r.src=i,r.type="text/javascript",r.crossOrigin="anonymous",r.onerror=function(e){t({ResourceName:n,Details:e.message})},r.onload=function(){e()},document.body.appendChild(r)}))).then((function(){var n="",r=(0,l.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL);t.IsConsumerShell?n="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa":t.TID&&(n=t.TID);try{Footprint.start("O365se",["config.fp.measure.office.com/conf/v2/o365se/fpconfig.min.json","r4.res.office365.com/footprint/v3.2/scripts/fpconfig.json"],1e4,JSON.stringify([{TenantId:n,AppId:r}]))}catch(e){(0,i.jl)().tag("Footprint_StartFailed",6,e||"")}})).catch((function(e){(0,i.jl)().tag("Footprint_LoadFailed",4,e.ResourceName,e.Details)})),(0,i.Lo)().unsubscribe("ShellDataUpdated",Q))}var X=n(36215),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,c.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&(0,i.jl)().perfMarker("SettingsTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:U.b.Settings,affordanceMenuItemText:U.b.Settings,iconID:"Settings",iconFontSize:L.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?r.createElement(R.sO,(0,c.__assign)({},e)):r.createElement(R.b,(0,c.__assign)({},e))},t}(r.Component),Y=n(54566),$=(0,a.$j)((function(e,t){var n=!1;e.shellInitDataState.layout&&(n=!!e.shellInitDataState.clientData.SettingsPaneEnabled&&(0,Y.F)((0,c.__assign)((0,c.__assign)({},e.shellInitDataState.clientData),{CurrentMainLinkElementID:e.shellInitDataState.navBarData.CurrentMainLinkElementID}),null,e.settingsFlexPaneState.workloadSettingLinks).length>0);return{isAvailable:n,id:t&&t.id,isActive:e.flexPaneState&&"Settings"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),(0,i.jl)().click("Settings","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),n.onClick&&n.onClick(t),e((0,s.uS)(t.currentTarget&&t.currentTarget.id)),e((0,x.yG)("Settings"))}}}),(function(e,t,n){var i=(0,c.__assign)((0,c.__assign)({},n),e);return(0,c.__assign)((0,c.__assign)((0,c.__assign)({},i),t),{onClick:function(e){return t.onClick(e,i)},onDimensionsChanged:function(){return t.onDimensionsChanged(i)}})}))(J),ee=n(6323),te=n(97019),ne=n(62992),ie=n(27660),re=n(48116),oe=n(80997),ae=n(85675),se="UTC",ue="tzone://Microsoft/Utc",le=function(){function e(){this.timeZones=null,this.timeZoneOffsets=[]}return Object.defineProperty(e.prototype,"isInitialized",{get:function(){return null!=this.timeZones&&this.timeZoneOffsets.length>0},enumerable:!0,configurable:!0}),e.prototype.initializeTimeZoneConverter=function(e){this.timeZoneOffsets=e,this.timeZones={}},e.prototype.convert=function(e,t,n){if(null===this.timeZones)throw Error("LoadTimeZoneOffsets must be called before convert.");if(e===ue&&(e=se),t===ue&&(t=se),null==n||e===t)return n;var i=he.parseISO8601DateTime(n),r=0;e===se?(r=this.findOffsetInUTC(t,i),i=i.addMinutes(r)):t===se?(r=this.findOffsetInLocal(e,i),i=i.addMinutes(0-r)):(r=this.findOffsetInLocal(e,i),i=i.addMinutes(0-r),r=this.findOffsetInUTC(t,i),i=i.addMinutes(r));var o=-1===n.indexOf(".")?he.generateISO8601DateTimeString(i):he.generateISO8601DateTimeMsString(i);if(t===se)o+="Z";else{var a=Math.abs(r),s=Math.floor(a/60),u=a%60;o+=(r<0?"-":"+")+(s<10?"0"+s:s.toString())+":"+(u<10?"0"+u:u.toString())}return o},e.prototype.findOffsetInLocal=function(e,t){var n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(var i=0,r=n;i<r.length;i++){var o=r[i];if(t.compare(o.localStart)>=0&&t.compare(o.localEnd)<0)return o.offset}throw new Error("Could not find an offset for this time stamp")},e.prototype.findOffsetInUTC=function(e,t){var n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(var i=0,r=n;i<r.length;i++){var o=r[i];if(t.compare(o.utcStart)>=0&&t.compare(o.utcEnd)<0)return o.offset}throw new Error("Could not find an offset for this time stamp")},e.prototype.ConvertDateTimeMembersTimeZone=function(e,t,n,i,r,o){throw new Error("Unimplemented.")},e.prototype.getTimeZoneRanges=function(e){var t=this.timeZones[e];return null==t&&(this.loadOffsetsForTimezone(e),t=this.timeZones[e]),t},e.prototype.loadOffsetsForTimezone=function(e){for(var t,n=0,r=this.timeZoneOffsets;n<r.length;n++){var o=r[n];if(e===o.TimeZoneId){t=o.OffsetRanges;break}}if(t&&0!==t.length){var a=t.map((function(e){return{utcStart:he.parseISO8601DateTime(e.UtcTime),offset:e.Offset}}));a.forEach((function(e,t){if(0===t?(e.utcStart=he.MinValue,e.localStart=he.MinValue):e.localStart=e.utcStart.addMinutes(e.offset),t+1===a.length)e.utcEnd=he.MaxValue,e.localEnd=he.MaxValue;else{var n=a[t+1];e.utcEnd=n.utcStart,e.localEnd=e.utcEnd.addMinutes(Math.max(e.offset,n.offset))}})),this.timeZones[e]=a}else(0,i.jl)().tag("TimeZoneConverter_NoIncomingOffsetRanges",6,e)},e}(),ce={TimeFormat:"hh:mm tt",DateFormat:"MM/dd/yyyy",TimeZone:"Pacific Standard Time",UserCulture:"default",WeekStartDay:0,FirstWeekOfYear:0,get TimeZoneOffsets(){return[{TimeZoneId:this.TimeZone,OffsetRanges:[{UtcTime:"1970-01-01T00:00:00Z",Offset:-180}]}]}},pe=function(){function e(e){var t=e.UserOptions||{},n=t.MailboxTimeZoneOffset;this.timeFormat=t.TimeFormat||ce.TimeFormat,this.dateFormat=t.DateFormat||ce.DateFormat,this.timeZone=t.TimeZone||ce.TimeZone,this.userCulture=null!=e.SessionSettings?e.SessionSettings.UserCulture:ce.UserCulture,this.weekStartDay=null!=t.WeekStartDay?t.WeekStartDay:ce.WeekStartDay,this.firstWeekOfYear=null!=t.FirstWeekOfYear?t.FirstWeekOfYear:ce.FirstWeekOfYear,this.timeZoneConverter=new le,this.timeZoneConverter.initializeTimeZoneConverter(null!=n?n:ce.TimeZoneOffsets)}return Object.defineProperty(e,"Instance",{get:function(){return null==e.instance&&(e.instance=new e({})),e.instance},enumerable:!0,configurable:!0}),e.populate=function(t){e.instance=new e(t)},e}(),de=n(68034),fe=864e13,he=function(){function e(t,n,i,r,o,a,s,u){if(void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),n<0||n>11||i<0||i>31||r<0||r>23||o<0||o>59||a<0||a>59||s<0||s>999)throw new Error("Date part out of range.");this.localTime=new Date(Date.UTC(t,n,i,r,o,a,s)),this.utcOffsetInMinutes=null==u?e.timeZoneConverter.findOffsetInLocal(e.timeZone,e.fromNativeDateTime(this.localTime)):u,e.throwIfDateOutOfRange(this)}return Object.defineProperty(e.prototype,"date",{get:function(){return this.localTime.getUTCDate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return this.localTime.getUTCMonth()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"year",{get:function(){return this.localTime.getUTCFullYear()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hour",{get:function(){return this.localTime.getUTCHours()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.localTime.getUTCSeconds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minute",{get:function(){return this.localTime.getUTCMinutes()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"millisecond",{get:function(){return this.localTime.getUTCMilliseconds()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"timeZone",{get:function(){return pe.Instance.timeZone},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Now",{get:function(){var t=e.timeZoneConverter.convert(se,e.timeZone,e.generateISO8601DateTimeMsStringWithOffset(e.UTCNow));return e.parseISO8601DateTime(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"timeZoneConverter",{get:function(){return pe.Instance.timeZoneConverter},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UTCNow",{get:function(){return e.fromNativeDateTime(new Date).toUTC()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"now",{get:function(){var t=e.timeZoneConverter.convert(se,e.timeZone,e.generateISO8601DateTimeMsStringWithOffset(e.UTCNow));return e.parseISO8601DateTime(t)},enumerable:!0,configurable:!0}),e.fromNativeDateTime=function(t){return new e(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),-t.getTimezoneOffset())},e.prototype.format=function(t){return re(this.localTime,e.getDateFormatMask(t),!0)},e.parseISO8601DateTime=function(t){void 0===t&&(t="");var n=e.isoRegex.exec(t);if(null==n||15!==n.length)throw new Error((0,oe.Uw)("Unexpected datetime format (value: {0}).",t));var i=parseInt(n[1],10),r=parseInt(n[2],10),o=parseInt(n[3],10),a=0,s=0,u=0,l=0,c=0;return null!=n[5]&&null!=n[6]&&null!=n[7]&&(a=parseInt(n[5],10),s=parseInt(n[6],10),u=parseInt(n[7],10),null!=n[9]&&(l=parseInt(n[9],10))),null!=n[10]&&"Z"!==n[10].toUpperCase()&&(c+=60*parseInt(n[13],10),c+=parseInt(n[14],10),"-"===n[12]&&(c=-c)),new e(i,r-1,o,a,s,u,l,c)},e.generateISO8601DateTimeString=function(t){return e.generateISO8601DateTimeMsString(t,!1)},e.generateISO8601DateTimeMsString=function(e,t){void 0===t&&(t=!0);var n="yyyy-MM-dd'T'HH:mm:ss"+(t?".l":"");return e.format(n)},e.generateISO8601DateTimeMsStringWithOffset=function(t){return e.generateISO8601DateTimeMsString(t)+t.getUtcOffsetDisplayString()},e.prototype.getUtcOffsetDisplayString=function(){if(0===this.utcOffsetInMinutes)return"Z";var e=Math.floor(Math.abs(this.utcOffsetInMinutes)/60),t=Math.abs(this.utcOffsetInMinutes)%60,n=this.utcOffsetInMinutes<0?"-":"+";return(0,oe.Uw)("{0}{1}:{2}",n,ge(e,2),ge(t,2))},e.areDatePartsEqual=function(e,t){return null===e&&null===t||null!==e&&null!=t&&0===e.compareDatePart(t)},e.prototype.compare=function(e){return ae.throwOnNullOrUndefined(e,"other"),this.localTime.getTime()-e.localTime.getTime()},e.prototype.clone=function(){var t=new e(0,0,0,0,0,0,0,0);return t.localTime.setTime(this.localTime.getTime()),t.utcOffsetInMinutes=this.utcOffsetInMinutes,t},e.prototype.addMilliseconds=function(t){e.throwIfNotNumber(t);var n=this.clone(),i=n.localTime.getTime()+t;return n.localTime.setTime(i),e.throwIfDateOutOfRange(n),n},e.prototype.Subtract=function(e){return ae.throwOnNullOrUndefined(e,"value"),this.localTime.getTime()-e.localTime.getTime()},e.prototype.addSeconds=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(1e3*t)},e.prototype.addMinutes=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*de.rP)},e.prototype.addHours=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*de.yo)},e.prototype.addDays=function(t){return e.throwIfNotNumber(t),this.addMilliseconds(t*de.tL)},e.prototype.toUTC=function(){if(0===this.utcOffsetInMinutes)return this;var e=this.addMinutes(-this.utcOffsetInMinutes);return e.utcOffsetInMinutes=0,e},e.prototype.getNativeDateTime=function(){return new Date(this.toUTC().getUTCMilliseconds())},e.prototype.getUTCMilliseconds=function(){return this.toUTC().localTime.getTime()},e.prototype.GetMilliseconds=function(){return this.localTime.getTime()},e.prototype.compareDatePart=function(t){return e.getDatePartHashValue(this)-e.getDatePartHashValue(t)},e.throwIfNotNumber=function(e){if("number"!=typeof e)throw Error("Argument must be of type number, but is type "+typeof e)},e.throwIfDateOutOfRange=function(t){if(!e.isValidDate(t))throw new Error("The resulting DateTime is less than MinValue or greater than MaxValue")},e.isValidDate=function(e){return null!=e&&!isNaN(e.localTime.getTime())&&e.localTime.getTime()>=-864e13&&e.localTime.getTime()<=fe},e.getDatePartHashValue=function(e){return e.date+(e.month<<5)+(e.year<<9)},e.getDateFormatMask=function(e){var t=!1;return e.replace(/[mMtT']/g,(function(e){if(t)return t="'"!==e,e;switch(e){case"'":return t=!0,e;case"m":return"M";case"M":return"m";case"t":return"T";case"T":return"t";default:return e}}))},e.isoRegex=/^(\d{4})-(\d{2})-(\d{2})(T(\d{2}):(\d{2}):(\d{2})([,\.](\d{3})\d*){0,1}){0,1}(Z|(([-\+])(\d{2}):?(\d{2}))){0,1}$/,e.MaxValue=new e(275760,8,13,0,0,0,0,0),e.MinValue=new e(-271821,3,20,0,0,0,0,0),e}();function ge(e,t){for(var n=e.toString();n.length<t;)n="0"+n;return n}function me(e,t,n,r){return e?(0,c.__assign)((0,c.__assign)({},e),{workloadData:n,workloadSettingLinksTitle:e.workloadSettingLinksTitle||r&&r.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:(0,c.__spreadArrays)(t.CurrentWorkloadSettingsSubLinks||[],r&&r.workloadSettingsSubLinks||[])}):(0,c.__assign)((0,c.__assign)({},e),{themeCardState:{selectedThemeId:(0,i.q4)().getCurrentThemeId(),themeData:[],preferOfficeTheme:(0,i.q4)().getThemeState().preferOfficeTheme,fullBleedThemesEnabled:n&&n.EduThemingEnabled&&(n.ActiveExperiences||"").split(",").some((function(e){return"edu"===e.toLowerCase()}))},languageAndRegionCardState:{selectedLanguage:"",selectedDateFormat:"",selectedTimeFormat:"",selectedTimeZone:"",languageChoices:[],timeZoneChoices:[],dateFormatChoices:[],timeFormatChoices:[],savedLanguage:"",savedDateFormat:"",savedTimeFormat:"",savedTimeZone:""},aboutCardState:{correlationID:r&&r.correlationID?r.correlationID:U.b.NotAvailable,sessionID:r&&r.sessionID?r.sessionID:U.b.NotAvailable,version:r.version?r.version:U.b.NotAvailable},workloadData:n,workloadId:n&&n.WorkloadId?n.WorkloadId:"",expandO365Settings:!1,workloadSettingLinksTitle:r&&r.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:(0,c.__spreadArrays)(t.CurrentWorkloadSettingsSubLinks||[],r&&r.workloadSettingsSubLinks||[]),cards:[]})}function ye(e){var t=-1!==e.indexOf("HH");return new he(2018,8,1,t?21:9,5).format(e).replace("Sep",U.b.SeptemberAbbrev).replace("September",U.b.September)}var ve={settingsFlexPaneState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=me(null,n.navBarData,n.clientData,n.renderSettings)}switch(t.type){case s.ri:var r=t;return me(e,r.navBarData,r.shellClientData,r.renderSettings);case ie.do:return function(e,t){var n=t,i=(0,s.GS)(e.workloadSettingLinks,(function(e){return e.Id===n.newWorkloadSettingLink.Id}));if(!(0,ee.l)(n.newWorkloadSettingLink))return e;return i>=0?(0,c.__assign)((0,c.__assign)({},e),{workloadSettingLinks:(0,c.__spreadArrays)(e.workloadSettingLinks.slice(0,i),[n.newWorkloadSettingLink],e.workloadSettingLinks.slice(i+1))}):(0,c.__assign)((0,c.__assign)({},e),{workloadSettingLinks:e.workloadSettingLinks.concat(n.newWorkloadSettingLink)})}(e,t);case ie.w0:return function(e,t){var n=t,i=(0,s.GS)(e.workloadSettingLinks,(function(e){return e.Id===n.settingLinkID}));if(i>=0)return(0,c.__assign)((0,c.__assign)({},e),{workloadSettingLinks:(0,c.__spreadArrays)(e.workloadSettingLinks.slice(0,i),e.workloadSettingLinks.slice(i+1))});return e}(e,t);case ie.K4:return function(e,t){var n=t.newWorkloadSettingsLinks.filter((function(e){return(0,ee.l)(e)}));if(0===n.length)return e;return(0,c.__assign)((0,c.__assign)({},e),{workloadSettingLinks:n})}(e,t);case ie.SL:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{cards:n.cardData})}(e,t);case s.hs:return function(e,t){var n=t,r=(0,i.q4)().getUserPersonalizationAllowed(),o=(0,ne.bp)(n.themeData||[],e.themeCardState.selectedThemeId,e.themeCardState.preferOfficeTheme,r);return(0,c.__assign)((0,c.__assign)({},e),{themeCardState:(0,c.__assign)((0,c.__assign)({},e.themeCardState),{themeData:o})})}(e,t);case s.Ou:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{themeCardState:(0,c.__assign)((0,c.__assign)({},e.themeCardState),{selectedThemeId:n.themeInfo.ThemeId||te.DefaultThemeId,preferOfficeTheme:n.themeInfo.PreferOfficeTheme})})}(e,t);case ie.Cr:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage,savedLanguage:n.selectedLanguage})})}(e,t);case ie.EF:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{languageChoices:n.languageChoices.map((function(e){return{id:e.Locale,text:e.DisplayName,language:e.Locale}}))})})}(e,t);case ie.J5:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage})})}(e,t);case ie.lj:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{selectedTimeZone:n.timeZoneChoice,selectedDateFormat:n.dateFormatChoice,selectedTimeFormat:n.timeFormatChoice,savedTimeZone:n.timeZoneChoice,savedDateFormat:n.dateFormatChoice,savedTimeFormat:n.timeFormatChoice})})}(e,t);case ie.rg:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{timeZoneChoices:n.timeZoneChoices.map((function(e){return{id:e.alias,text:e.displayName}}))})})}(e,t);case ie.$w:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{selectedTimeZone:n.selectedTimeZone})})}(e,t);case ie.$I:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{dateFormatChoices:n.dateFormatChoices.map((function(e){return{id:e,text:ye(e)}}))})})}(e,t);case ie.Oy:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{selectedDateFormat:n.selectedDateFormat})})}(e,t);case ie.i1:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{timeFormatChoices:n.timeFormatChoices.map((function(e){return{id:e,text:ye(e)}}))})})}(e,t);case ie.sI:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},e.languageAndRegionCardState),{selectedTimeFormat:n.selectedTimeFormat})})}(e,t);case ie.NS:return function(e){var t=e.languageAndRegionCardState;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},t),{savedLanguage:t.selectedLanguage,savedTimeZone:t.selectedTimeZone,savedDateFormat:t.selectedDateFormat,savedTimeFormat:t.selectedTimeFormat})})}(e);case ie.M9:return function(e){var t=e.languageAndRegionCardState;return(0,c.__assign)((0,c.__assign)({},e),{languageAndRegionCardState:(0,c.__assign)((0,c.__assign)({},t),{selectedLanguage:t.savedLanguage,selectedTimeZone:t.savedTimeZone,selectedDateFormat:t.savedDateFormat,selectedTimeFormat:t.savedTimeFormat})})}(e);case ie.Vx:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{parentCardId:n.cardId})}(e,t);case ie.nl:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{expandO365Settings:n.isExpanded})}(e,t);default:return e}}},Se=n(13942),_e=function(){function e(){}return e.prototype.AddOrUpdateWorkloadSettingLink=function(e){(0,s.ef)().dispatch((0,Se.jG)(e))},e.prototype.RemoveWorkloadSettingLink=function(e){(0,s.ef)().dispatch((0,Se.N0)(e))},e.prototype.SetWorkloadSettingsLinks=function(e){(0,s.ef)().dispatch((0,Se.eV)(e))},e}();function Te(e,t){var n=(0,i.aH)().layout,r=(0,s.ef)().getState().settingsFlexPaneState.workloadSettingLinks;if(!n){var o=t.SettingsPaneEnabled&&(0,Y.F)((0,c.__assign)((0,c.__assign)({},t),{CurrentMainLinkElementID:e.CurrentMainLinkElementID}),null,r).length>0,a=document.getElementById(E.JT);a&&o&&(a.style.display="block")}}var Ce=n(85764),Ie=n(60321),we=n(33237);function be(e,t){return(0,c.__assign)((0,c.__assign)({},e),{webChatSDKUrl:t.WebChatSDKUrl||null,chatWebLink:t.ChatWebLink||null,chatEnabled:!!t.ChatEnabled&&!s.Zp.isMobileClient()})}var Ae={chatState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=be(s.mI,n.clientData||{})}switch(t.type){case s.ri:return be(e,t.shellClientData);case s.__:return function(e,t){var n=t;return(0,Ie.yX)(n.isRecentsOpen,e.isTeamsChatActivated),(0,c.__assign)((0,c.__assign)({},e),{isChatRecentsPaneOpen:n.isRecentsOpen})}(e,t);case we.q:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{isChatRecentsPaneInitialized:n.isRecentsInitialized})}(e,t);case we.D:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{isChatAPIInitialized:n.isChatAPIInitialized})}(e,t);case we.nZ:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{unreadBadgeValue:n.unreadBadgeValue})}(e,t);case we.YI:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{isTeamsChatActivated:n.isTeamsChatActivated})}(e,t);default:return e}}};var De=!1;function Pe(e,t){if(!De){De=!0;var u=(0,s.ef)(),l=(0,i.aH)()&&(0,i.aH)().layout;if(l)l.centerCustomizationRegion&&(0,s.Y5)("ChatIcon",l.centerCustomizationRegion.children)&&n.e("chat").then(n.bind(n,35029)).then((function(e){var t=e.ChatHeaderButtonConnector;(0,i.Lo)().invoke("LazyComponentLoaded",Ce.U,t),e.initializeChatComponent()}));else{var c=document.getElementById(E.en);c&&n.e("chat").then(n.bind(n,35029)).then((function(e){e.initializeChatComponent();var t=e.ChatIconConnector;o.render(r.createElement(a.zt,{store:u},r.createElement(t,null)),c)}))}}}var Oe=n(39655),xe=n(50074),Ee=function(e){function t(t){var n=e.call(this,t)||this;return n.preventEscPropagation=function(e){27===e.keyCode&&e.stopPropagation()},n.state={isShyHeaderActive:!1},(0,i.Lo)().subscribe("ShyHeaderActivated",(function(e){n.setState({isShyHeaderActive:e})}),!0),n}return(0,c.__extends)(t,e),t.prototype.onComponentVisible=function(){e.prototype.onComponentVisible.call(this),(0,i.jl)().impression("CustomFlexPane","FlexPane",0,void 0,"Loaded"),this.props.onFlexPaneOpen&&this.props.onFlexPaneOpen(),this.customRenderContainer&&this.props.render&&this.props.render(this.customRenderContainer)},t.prototype.onComponentHide=function(){e.prototype.onComponentHide.call(this),this.props.onFlexPaneClose&&this.props.onFlexPaneClose()},t.prototype.componentWillUnmount=function(){this.customRenderContainer&&o.unmountComponentAtNode(this.customRenderContainer),e.prototype.componentWillUnmount.call(this)},t.prototype.render=function(){var e,t,n=this;return r.createElement(x.Ou,{isActive:this.props.isActive,title:this.props.flexPaneTitle(),customTitle:this.props.customTitle,flexPaneProviderID:this.props.flexPaneProviderID,className:this.props.className},r.createElement("div",{id:"CustomFlexPane_"+this.props.flexPaneProviderID,role:"region",className:(0,s.iv)(xe.flexPaneContentContainer,(e={},e[xe.flexPaneContentContainerForThinHeader]=this.props.isThinHeader,e),(t={},t[xe.flexPaneContentContainerForShyHeader]=this.state.isShyHeaderActive,t)),onKeyDown:this.props.customEscapeKeyHandling&&this.preventEscPropagation,ref:function(e){return n.customRenderContainer=e}}))},t}(x.yJ),ke=(0,a.$j)((function(e,t){var n=e.extensibilityState.customFlexPanes[t.flexPaneProviderID];return n?(0,c.__assign)((0,c.__assign)({},t),{className:n.containerClassName,flexPaneTitle:function(){return"function"==typeof n.flexPaneTitle?n.flexPaneTitle():n.flexPaneTitle},isThinHeader:(0,i.aH)().isThinHeader,customTitle:n.customTitle,render:n.render,customEscapeKeyHandling:n.customEscapeKeyHandling,onFlexPaneOpen:n.onFlexPaneOpen,onFlexPaneClose:n.onFlexPaneClose,triggerControlID:n.triggerControlID}):((0,i.jl)().tag("UnrecognizedCustomFlexPane",6,t.flexPaneProviderID),null)}))(Ee),Re=n(79437),Le=n(42514);function Ue(e){return!!e&&"iconFontName"in e}var Ne="ShellFabricMDL2IconsLite,ShellFabricMDL2Icons",Fe=function(e){function t(t){var n=e.call(this,t)||this;return n.setClickableElement=function(e){n.headerButtonElement=e},n.onClick=function(e){n.props.isStateless&&n.props.onShow&&n.props.onShow(e.currentTarget.getBoundingClientRect()),n.props.onClick&&n.props.onClick(e)},n.state={isHovered:!1},n}return(0,c.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.isActive&&!e.isActive&&null!=this.headerButtonElement?this.props.onShow&&this.props.onShow(this.headerButtonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide&&this.props.onHide()},t.prototype.getArialLabel=function(){var e="function"==typeof this.props.ariaLabel?this.props.ariaLabel():this.props.ariaLabel;return void 0!==this.props.badgeValue&&0!==this.props.badgeValue?(0,s.Uw)(U.b.UnreadBadge_Count,""+e,""+this.props.badgeValue):e},t.prototype.render=function(){var e=this,t={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getArialLabel(),affordanceMenuItemText:"function"==typeof this.props.affordanceMenuItemText?this.props.affordanceMenuItemText():this.props.affordanceMenuItemText,iconData:this.props.iconData?Ue(this.props.iconData)?{iconFontName:this.props.iconData.iconFontName,iconFontFamily:this.props.iconData.iconFontFamily||Ne,iconFontSize:L.GX.toString()}:this.props.iconData:{iconFontName:this.props.iconFontName,iconFontFamily:this.props.iconFontFamily||Ne,iconFontSize:L.GX.toString()},isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged,setClickableElement:this.setClickableElement};return 0===this.props.renderContext?r.createElement(R.sO,(0,c.__assign)({},t),r.createElement(s.Eb,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:Le.headerButtonBadgePosition})):r.createElement(R.b,(0,c.__assign)({},t),r.createElement(s.Eb,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:Re.affordanceContextMenuItemBadgePosition}))},t}(r.Component),Me=(0,a.$j)((function(e,t){return(0,c.__assign)((0,c.__assign)({},t),{badgeValue:e.extensibilityState.badgeValues[t.id],isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId,flexPaneProviderID:e.extensibilityState.customHeaderButtonFlexPaneTriggers[t.id]})}),(function(e,t){return{onClickDispatch:function(n,i){i.stopPropagation(),t.onClick&&t.onClick(i),t.isStateless||e((0,s.uS)(i.currentTarget&&i.currentTarget.id)),n&&e((0,x.yG)(n))}}}),(function(e,t){return(0,c.__assign)((0,c.__assign)((0,c.__assign)({},e),t),{onClick:function(n){t.onClickDispatch(e.flexPaneProviderID,n)}})}))(Fe),Be="suiteux-extensibility.SET_BADGE_VALUE",We=n(97715);function qe(e,t){var n=(0,c.__assign)((0,c.__assign)({},e),{customFlexPanes:{},customFlexPaneHash:void 0});if(t&&t.flexPaneCollection){t.flexPaneCollection.forEach((function(e){var t=e;t.render&&(n.customFlexPanes[t.flexPaneID]=t)}));var i=Object.keys(n.customFlexPanes).sort();n.customFlexPaneHash=(0,s.Wu)(JSON.stringify(i))}return n}var He={extensibilityState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=qe(s.M1,n.layout)}switch(t.type){case s.C1:return function(e,t){var n=t.buttonId;e.activeButtonId===n&&(n="");return(0,c.__assign)((0,c.__assign)({},e),{activeButtonId:n})}(e,t);case s.Q:return qe(e,t.shellLayout);case"suiteux-extensibility.UPDATE_CUSTOMHEADERBUTTON":return function(e,t){var n=(0,c.__assign)({},e),i=(0,s.GS)(e.customHeaderButtons,(function(e){return e.id===t.buttonData.id}));i>=0?n.customHeaderButtons=(0,c.__spreadArrays)(e.customHeaderButtons.slice(0,i),[t.buttonData],e.customHeaderButtons.slice(i+1)):(n.customHeaderButtons=(0,c.__spreadArrays)(e.customHeaderButtons),n.customHeaderButtons.unshift(t.buttonData));return n}(e,t);case We.Ve:return function(e,t){var n=e;t.newProvider.shellControlID&&e.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]!==t.newProvider.key&&((n=(0,c.__assign)((0,c.__assign)({},e),{customHeaderButtonFlexPaneTriggers:(0,c.__assign)({},e.customHeaderButtonFlexPaneTriggers)})).customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]=t.newProvider.key);return n}(e,t);case Be:return function(e,t){var n=e;e.badgeValues[t.buttonID]!==t.badgeValue&&((n=(0,c.__assign)((0,c.__assign)({},e),{badgeValues:(0,c.__assign)({},e.badgeValues)})).badgeValues[t.buttonID]=t.badgeValue);return n}(e,t);default:return e}}},Ge=n(42539),je=n(84597),Ke=n(68461),ze=n(14557),Ve=function(e){function t(t){var n=e.call(this,t)||this;return n.onEntryPointClick=function(){n.props.isStateless?n.props.onShow(n.buttonElement.getBoundingClientRect()):n.props.onToggleButtonState(n.props.id)},n}return(0,c.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.isActive&&!e.isActive&&this.buttonElement?this.props.onShow(this.buttonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide()},t.prototype.render=function(){var e,t=this,n=(0,Ke.j)(),i=(0,s.iv)(Le.button,je.customHeaderButton,n.headerButton,((e={})[n.activeHeaderButton]=this.props.isActive,e)),o=this.props.iconData;return r.createElement(Ge.u,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},r.createElement("div",{className:je.customHeaderButtonWrapper},r.createElement("button",{className:(0,s.iv)(i,ze.N),type:"button",id:"CustomHeader_"+this.props.id,ref:function(e){return t.buttonElement=e},onClick:this.onEntryPointClick,"aria-label":this.props.ariaLabel,style:Ue(o)?{fontFamily:o.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},Ue(o)?r.createElement(s.BH,{fontSize:"16",fontValue:o.iconFontName}):o.element)))},t}(r.Component),Ze=(0,a.$j)((function(e,t){return(0,c.__assign)((0,c.__assign)({},t),{isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId})}),(function(e){return{onToggleButtonState:function(t){e((0,s.uS)(t))}}}))(Ve),Qe=[];var Xe=(0,s.ef)(),Je=function(){function e(){}return e.prototype.AddOrUpdateCustomHeaderButton=function(e){(0,i.jl)().tag("AddOrUpdateCustomHeaderButton",1,e.id,e.iconData?Ue(e.iconData)?e.iconData.iconFontName:"SVG element":e.iconFontName),function(e){var t=(0,s.ef)(),n=(0,s.GS)(Qe,(function(t){return t.id===e.id}));if(n>=0?Qe=(0,c.__spreadArrays)(Qe.slice(0,n),[e],Qe.slice(n+1)):Qe.push(e),t.getState().shellInitDataState.layout){var u=(0,i.bf)();u.DefaultLayoutState.CustomHeaderButtons=Qe,(0,i.Lo)().invoke("ShellLayoutUpdated",u.GetDefaultLayout())}else{var l=(0,c.__spreadArrays)(Qe).reverse().map((function(e){var t;return r.createElement(Ze,{key:e.id,id:e.id,iconData:null!==(t=e.iconData)&&void 0!==t?t:{iconFontName:e.iconFontName,iconFontFamily:e.iconFontFamily},onHide:e.onHide,onShow:e.onShow,isStateless:e.isStateless,ariaLabel:"function"==typeof e.ariaLabel?e.ariaLabel():e.ariaLabel})})),p=document.getElementById("O365_CustomHeaderButtonsContainer");(0,i.aH)().isThinHeader&&(p.style.height="48px"),o.render(r.createElement(a.zt,{store:t},r.createElement("div",{className:je.customHeaderButtonsContainer},l)),p)}}(e)},e.prototype.UpdateButtonState=function(e,t){var n=(0,s.ef)(),i=n.getState().extensibilityState;i.activeButtonId!==e||t?i.activeButtonId!==e&&t&&n.dispatch((0,s.uS)(e)):n.dispatch((0,s.uS)(""))},e.prototype.SetCustomHeaderButtonBadgeValue=function(e,t){Xe.dispatch(function(e,t){return{type:Be,buttonID:e,badgeValue:t}}(e,t))},e}();var Ye=!1,$e=function(){function e(){}return e.prototype.Init=function(e,t,n,r,o){Ye||(Ye=!0,this.Timeout=e,this.SigninState=t,this.Controls=n,this.SessionId=r,this.DisableTrackEvents=o,(0,i.Lo)().subscribe("ShellDataUpdated",et,!0))},e}();function et(e,t){t.PUID&&(t.AuthAbtEnabled&&(Ye=!0,window.LoadAbtPromptJs={Download:tt},n.e("abt").then(n.bind(n,85587)).then((function(n){var i=n.Environment.WorldWide;(0,oe.pn)(t.Environment.toLowerCase(),"tbprod")?i=n.Environment.Trailblazer:(0,oe.pn)(t.Environment.toLowerCase(),"pfprod")&&(i=n.Environment.Pathfinder),n.initializeAbt({market:e.CultureName||"en-US",workloadName:(0,l.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),environment:i,userId:t.PUID,authType:t.IsConsumerShell?n.AuthType.Msa:n.AuthType.Aad,timeout:window.O365Shell.Abt.Timeout,trackEvents:!window.O365Shell.Abt.DisableTrackEvents,enableLogging:!0,sessionId:window.O365Shell.Abt.SessionId,tenantId:t.TID,signinState:window.O365Shell.Abt.SigninState,controls:window.O365Shell.Abt.Controls})}))),(0,i.Lo)().unsubscribe("ShellDataUpdated",et))}function tt(e){n.e("abtprompt").then(n.t.bind(n,82029,23)).then((function(t){e&&e()}))}var nt=n(33641),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,c.__extends)(t,e),t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:U.b.FeatureFlags_Title,affordanceMenuItemText:U.b.FeatureFlags_Title,iconID:"FeatureFlagsLogo",iconFontSize:L.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?r.createElement(R.sO,(0,c.__assign)({},e)):r.createElement(R.b,(0,c.__assign)({},e))},t}(r.Component),rt=(0,a.$j)((function(e,t){return{id:t&&t.id,isAvailable:!0,isActive:e.flexPaneState&&"FeatureFlags"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),n.onClick&&n.onClick(t),e((0,s.uS)(t.currentTarget&&t.currentTarget.id)),e((0,x.yG)("FeatureFlags"))}}}),(function(e,t,n){var i=(0,c.__assign)((0,c.__assign)({},n),e);return(0,c.__assign)((0,c.__assign)((0,c.__assign)({},i),t),{onClick:function(e){return t.onClick(e,i)},onDimensionsChanged:function(){return t.onDimensionsChanged(i)}})}))(it),ot="suiteux-mecontrol.UPDATE_WORKLOAD_FEATURE_FLAG_LIST";var at=function(){function e(){}return e.prototype.AddFeatureFlags=function(e){e?(0,s.ef)().dispatch(function(e){return{type:ot,workloadFeatureFlagList:e}}(e)):(0,i.jl)().tag("FeatureFlags_Shim_FeatureFlags_Param_Invalid",6)},e.prototype.SubscribeToFeatureFlagStatusChange=function(e){return(0,i.Lo)().subscribe("FeatureFlagChanged",e,!1)},e}();var st={featureFlagsState:function(e,t){switch(e||(e={enabled:!1,workloadFeatureFlagList:{}}),t.type){case ot:return function(e,t){var n=t;return(0,c.__assign)((0,c.__assign)({},e),{workloadFeatureFlagList:n.workloadFeatureFlagList})}(e,t);default:return e}}};function ut(e,t){if(t.FeatureFlagsEnabled){var r=(0,O.k)((function(){return n.e("featureflags").then(n.bind(n,25840)).then((function(e){return e.FeatureFlagsFlexPanePanelConnector}))})),o=(0,i.aH)().layout,a={component:r,key:"FeatureFlags",width:x.yh};if(o)(0,i.Lo)().invoke("LazyComponentLoaded",nt.$,rt),a.nativeControlID="FeatureFlags";else a.btnId=E.F_;(0,s.ef)().dispatch((0,x.wd)(a))}}var lt,ct,pt,dt,ft,ht,gt,mt,yt,vt,St,_t,Tt,Ct,It=n(26244),wt=n(45003),bt=n(9263);function At(e,t,n){lt=(0,i.Lo)(),ct=window.matchMedia("(max-height: "+t+"px)"),mt=0,yt=0,Tt=n,vt=e,window.addEventListener(It.t.RESIZE,Dt),vt.addEventListener(It.t.MOUSEENTER,Et),vt.addEventListener(It.t.MOUSELEAVE,kt),vt.addEventListener(It.t.FOCUS,Rt,!0),vt.addEventListener(It.t.BLUR,Lt,!0),lt.subscribe("ContextMenuPopup",Ut),lt.subscribe("ShyHeaderActivated",Nt,!0),Dt()}function Dt(){Ft()?(0!==mt&&window.clearTimeout(mt),mt=window.setTimeout((function(){Ft()&&null!=vt&&null!=Tt&&(Ct||function(){if(null!=Tt&&null!=vt){var e=(0,Ke.j)();(St=(0,L.nV)(wt.shyHeader+" o365cs-base "+e.navbar,"O365_ShyHeader")).setAttribute("tabindex","0"),_t=(0,L.nV)(wt.shyHeaderOverlay);var t=(0,L.nV)(wt.shyHeaderGripper+" "+e.shyHeader);St.appendChild(_t),St.appendChild(t),Tt.appendChild(St),St.addEventListener(It.t.MOUSEDOWN,Ot),St.addEventListener(It.t.FOCUS,xt),(0,L.nj)(vt,wt.headerAnimations),(0,L.nj)(Tt,wt.workloadDivAnimations),Ct=!0}}(),(0,L.bO)(vt,wt.headerSlideIn),(0,L.bO)(Tt,wt.workloadDivSlideIn),(0,L.nj)(vt,wt.headerSlideOut),(0,L.nj)(Tt,wt.workloadDivSlideOut),vt.onanimationend=function(e){"headerSlideOutFrames"===e.animationName&&(lt.invoke("ShyHeaderActivated",!0),pt=!0)})}),2e3)):ct.matches&&!gt||Pt()}function Pt(e){pt&&null!=St&&null!=vt&&null!=Tt&&(St.style.visibility="hidden",St.style.display="none",_t.style.visibility="hidden",_t.style.display="none",vt.style.display="flex",(0,L.bO)(vt,wt.headerSlideOut),(0,L.bO)(Tt,wt.workloadDivSlideOut),(0,L.nj)(vt,wt.headerSlideIn),(0,L.nj)(Tt,wt.workloadDivSlideIn),vt.onanimationend=function(t){"headerSlideInFrames"===t.animationName&&(lt.invoke("ShyHeaderActivated",!1),pt=!1,e&&document.getElementById(bt.pG).focus())})}function Ot(e){ft=!0}function xt(e){Pt(!ft),ft=!1}function Et(e){dt=!0}function kt(e){dt=!1,Dt()}function Rt(e){ht=!0}function Lt(e){ht=!1,0!==yt&&window.clearTimeout(yt),yt=window.setTimeout((function(){ht||Dt()}),50)}function Ut(e){gt=e,e||Dt()}function Nt(e){e&&null!=St&&null!=vt&&(St.style.visibility="visible",St.style.display="flex",_t.style.visibility="visible",_t.style.display="flex",vt.style.display="none")}function Ft(){return ct.matches&&!pt&&!dt&&!ht&&!gt}var Mt=n(74965),Bt=!1;function Wt(e,t){if(!Bt){var n=(0,i.aH)();if(n&&n.supportShyHeaderMode){var r=document.getElementById(n.top);At(document.getElementById(E.WZ),n.shyHeaderActivationHeight?n.shyHeaderActivationHeight:Mt.J,r),Bt=!0}}}var qt=n(64964),Ht=n(1359),Gt=n(1886),jt=n(37086),Kt=n(68973),zt=n(57914),Vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,c.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&(0,i.jl)().perfMarker("MyDayTimeToInteractive")},t.prototype.render=function(){var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:U.b.MyDay,affordanceMenuItemText:U.b.MyDay,iconID:"EventToDoLogo",iconFontSize:L.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?r.createElement(Kt.s,(0,c.__assign)({},e)):r.createElement(zt.b,(0,c.__assign)({},e))},t}(r.Component),Zt=(0,a.$j)((function(e,t){var n;return{isAvailable:e.shellInitDataState.clientData.OpxEnabled&&e.shellInitDataState.clientData.MyDayOpxEnabled,id:null==t?void 0:t.id,isActive:"MyDay"===(null===(n=e.flexPaneState)||void 0===n?void 0:n.activeProviderKey),controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){var r;t.stopPropagation(),(0,i.jl)().click("MyDay","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),e((0,s.uS)(null===(r=t.currentTarget)||void 0===r?void 0:r.id)),e((0,Gt.yG)("MyDay")),n.onClick&&n.onClick(t)}}}),(function(e,t,n){var i=(0,c.__assign)((0,c.__assign)({},n),e);return(0,c.__assign)((0,c.__assign)((0,c.__assign)({},i),t),{onClick:function(e){return t.onClick(e,i)},onDimensionsChanged:function(){return t.onDimensionsChanged(i)}})}))(Vt);function Qt(e,t){if(t.OpxEnabled&&t.MyDayOpxEnabled&&!(0,l.So)(t.WorkloadId,e.CurrentMainLinkElementID)){(0,i.Lo)().unsubscribe("ShellDataUpdated",Qt);var r={component:(0,O.k)((function(){return n.e("myday").then(n.bind(n,30365)).then((function(e){return e.MyDayFlexPaneConnector}))})),key:"MyDay",width:qt.y};(0,i.Lo)().invoke("LazyComponentLoaded",jt.q,Zt),r.nativeControlID="MyDay",(0,Ht.e)().dispatch((0,Gt.wd)(r))}}var Xt=n(63775),Jt=n(58129),Yt="LazyDocumentTitleComponentName",$t=((0,Jt.Q)(Yt),!1),en=function(){function e(){}return e.prototype.SetProps=function(e){($t?Promise.resolve():n.e("dtt").then(n.bind(n,40043)).then((function(e){$t=!0,(0,i.Lo)().invoke("LazyComponentLoaded",Yt,e.DocumentTitleConnector)}))).then((function(){return(0,s.ef)().dispatch((0,Xt.L)(e))}))},e}();var tn,nn,rn,on,an,sn,un,ln,cn,pn,dn,fn,hn=n(82661),gn=function(){function e(){}return e.prototype.UpdateAccount=function(e,t,n){if(window.MastInteraction)try{window.MastInteraction.UpdateAccount(e,t,n)}catch(e){(0,i.jl)().exception("MAST_UpdateAccount_Failed",6,e)}},e.prototype.SetActiveAccount=function(e){if(window.MastInteraction)try{window.MastInteraction.SetActiveAccount(e)}catch(e){(0,i.jl)().exception("MAST_SetActiveAccount_Failed",6,e)}},e.prototype.UpdateMastConfiguration=function(e){if(window.MastInteraction)try{window.MastInteraction.UpdateConfiguration(e)}catch(e){(0,i.jl)().exception("MAST_UpdateConfiguration_Failed",6,e)}},e.prototype.Init=function(){(0,i.Lo)().subscribe("ShellDataUpdated",mn,!0)},e}();function mn(e,t){var r,o=(0,i.aH)();if(!t.DisableAccountSwitchingGlobally&&t.AccountSwitchingEnabled&&o.shellAuthProviderConfig){tn=null===(r=null==e?void 0:e.SignOutLink)||void 0===r?void 0:r.Url;var a,s=o.shellAuthProviderConfig.login_Hint,u={authenticatedState:1,upn:s||t.UPN,idp:t.IsConsumerShell?"msa":"aad"},l={isMSAAccount:t.IsConsumerShell,puid:t.PUID,upn:t.UPN},p=_n(t.AppHeaderLinkText);void 0===p.postAccountSwitchRedirectUri&&(a={modifySwitchAccountRedirectUriFunction:yn}),void 0===p.postLogoutRedirectUri&&(a=(0,c.__assign)((0,c.__assign)({},a),{modifySignoutRedirectUriFunction:vn})),window.LoadMastPromptJs={Download:Sn},n.e("mast").then(n.bind(n,4589)).then((function(n){new n.MultiAccountSessionTracker(p,a),nn.UpdateAccount(t.PUID,u,!0),window.addEventListener("message",Tn.bind(self,l,e.SignOutLink),!1),(0,i.Lo)().subscribe("AppNameChanged",Cn,!0)})).catch((function(e){return(0,i.jl)().exception("MASTPackage_DownLoad_Failed",6,e)})),(0,i.Lo)().unsubscribe("ShellDataUpdated",mn)}}function yn(e,t,n){var r=(0,i.aH)().shellAuthProviderConfig;if(r&&r.appSwitchToUrl&&"function"==typeof r.appSwitchToUrl){var o={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0},nextAccount:{type:"msa"===t.idp?"msa":"aad",login_hint:t.upn,memberName:t.upn,authenticatedState:"signedIn",cid:void 0}};return(0,i.jl)().impression("Switch","Mast"),r.appSwitchToUrl(o)}}function vn(e,t){var n=(0,i.aH)().shellAuthProviderConfig;if(n&&"function"==typeof n.appSignOutUrl){var r={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0}};return(0,i.jl)().impression("SignOut","Mast"),n.appSignOutUrl(r)}}function Sn(e){n.e("mastprompt").then(n.t.bind(n,78344,23)).then((function(){e&&e()})).catch((function(e){return(0,i.jl)().exception("MASTPromptPackage_DownLoad_Failed",6,e)}))}function _n(e){var t=(0,i.aH)(),n=void 0,r=!0,o=t.shellAuthProviderConfig,a=o.appSwitchToUrl||o.appSignInUrl;a&&"string"==typeof a?n=a:r=!1;var s=o.appSignOutUrl;return{appFriendlyName:e,enablePageRedirect:!0,postLogoutRedirectUri:s&&"string"==typeof s?s:tn,postAccountSwitchRedirectUri:n,mastPromptLocalizedStrings:{appFriendlyName:e,switchAccountTitle:U.b.SwitchAccountTitle,switchAccountDescriptionWithUpn:U.b.SwitchAccountDescriptionWithUpn,switchAccountDescriptionWithoutUpn:U.b.SwitchAccountDescriptionWithoutUpn,switchAccountSubDescription:"",switchAccountButtonText:U.b.SwitchAccountButtonText,signOutTitle:U.b.SignOutTitle,signOutDescriptionWithUpn:U.b.SignOutDescriptionWithUpn,signOutDescriptionWithoutUpn:U.b.SignOutDescriptionWithoutUpn,signOutSubDescription:"",signOutButtonText:U.b.SignOutButtonText},appendLoginHint:r,enableConsoleLogging:!1,enableAutomaticPopup:!t.shellDataOverrides.DisableMASTPopup}}function Tn(e,t,n){if(null!==n.data)if("SwitchAccountRedirect"===n.data.request)null!==n.data.url&&void 0!==n.data.url&&((0,i.jl)().click("Switch","Mast"),window.removeEventListener("message",Tn.bind(n,e,t),!1),(0,hn.x)().then((function(){})).catch((function(e){(0,i.jl)().exception("MAST_Switch_ClearSessionStorage_Failed",6,e)})),(0,i.Lo)().invoke("AccountSwitchInitiated",e));else if("SignOutBackToLanding"===n.data.request&&null!==n.data.url&&void 0!==n.data.url){(0,i.jl)().click("SignOut","Mast"),window.removeEventListener("message",Tn.bind(n,e,t),!1),null!=t.Action&&t.Action();var r={triggerEvent:n};(0,i.Lo)().invoke("SignOut",r)}}function Cn(e){var t=_n(e);nn.UpdateMastConfiguration(t)}(an=(0,s.ef)().getState()).userState.isConsumer||s.YA.register(T),rn=new b,on=window.O365Shell.Apps,window.O365Shell.Apps=rn,on.applyCalls(rn),an.userState.isConsumer||(0,i.Lo)().subscribe("ShellDataUpdated",A,!0),D=(0,i.Lo)().subscribe("ShellDataUpdated",(function(e,t){if(t.NotificationsEnabled){(0,i.Lo)().unsubscribe("ShellDataUpdated",D);var r=function(){return n.e("notifications").then(n.bind(n,69201)).catch((function(e){return(0,i.jl)().exception("NotificationsPackage_LoadFail",6,e)}))},o=(0,i.aH)();o&&o.layout?o.layout.centerCustomizationRegion&&(0,P.Y5)("NotificationBellIcon",o.layout.centerCustomizationRegion.children)&&r():r()}}),!0),function(){var e=function(){return n.e("extraflexpane").then(n.bind(n,43300))},t=window.O365Shell.NFD;t.registerShimCallback&&t.registerShimCallback((function(){e()}),["OpenHelp","OpenFeedback"]);var r=(0,O.k)((function(){return e().then((function(e){return e.HelpFlexPanePanelConnector}))})),o=(0,i.aH)(),a={component:r,key:"Help",width:x.yh,overrideOnClick:o.OnHelpButtonClick};o.layout?((0,i.Lo)().invoke("LazyComponentLoaded",k.d,F),a.nativeControlID="HelpIcon"):a.btnId=E.rm,(0,s.ef)().dispatch((0,x.wd)(a));var u=(0,O.k)((function(){return e().then((function(e){return e.FeedbackFlexPaneConnector}))}));(0,s.ef)().dispatch((0,x.wd)({component:u,key:"Feedback",width:x.yh}))}(),(0,i.Lo)().subscribe("ShellDataUpdated",j,!0),(0,i.Lo)().subscribe("ShellDataUpdated",V,!0),(0,i.Lo)().subscribe("ShellDataUpdated",Q,!0),function(){var e,t;s.YA.register(ve),e=new _e,t=window.O365Shell.Settings,window.O365Shell.Settings=e,t.applyCalls(e);var r=(0,O.k)((function(){return n.e("extraflexpane").then(n.bind(n,50061)).then((function(e){return e.SettingsFlexPanePanelConnector}))}));(0,i.Lo)().subscribe("ShellDataUpdated",Te,!0);var o=(0,i.aH)().layout,a={component:r,key:"Settings",width:x.yh};o?((0,i.Lo)().invoke("LazyComponentLoaded",X.F,$),a.nativeControlID="SettingsIcon"):a.btnId=E.JT,(0,s.ef)().dispatch((0,x.wd)(a))}(),s.YA.register(Ae),(0,i.Lo)().subscribe("ShellDataUpdated",Pe,!0),function(){var e,t;s.YA.register(He),e=new Je,t=window.O365Shell.Extensibility,window.O365Shell.Extensibility=e,t.applyCalls(e);var n,r=(0,s.ef)();function o(){var e=r.getState();n!==e.extensibilityState.customFlexPaneHash&&Object.keys(e.extensibilityState.customFlexPanes).forEach((function(t){if(!e.flexPaneState.registeredProviders.some((function(e){return e.key===t}))){var n=e.extensibilityState.customFlexPanes[t];r.dispatch((0,x.wd)({component:ke,btnId:n.triggerControlID,shellControlID:n.triggerControlID,key:t,width:x.yh}))}}));n=e.extensibilityState.customFlexPaneHash}o(),(0,i.Lo)().invoke("LazyComponentLoaded",Oe.B,Me),r.subscribe(o)}(),(0,p.$_)(),sn=function(){return n.e("diagnostics").then(n.bind(n,82495))},(un=window.O365Shell.Diagnostics).registerShimCallback&&un.registerShimCallback((function(){sn()}),["GetServiceDiagnostics","GetClientDiagnostics"]),window.O365ShellContext.DiagnosticsEnabled&&sn(),function(){var e=new $e,t=window.O365Shell.Abt;window.O365Shell.Abt=e,t.applyCalls(e);var n=(0,i.aH)();n.abtTimeout&&window.O365Shell.Abt.Init(n.abtTimeout,n.abtSigninState,n.abtControls,n.abtSessionId,n.abtDisableTrackEvents)}(),s.YA.register(st),ln=new at,cn=window.O365Shell.FeatureFlags,window.O365Shell.FeatureFlags=ln,cn.applyCalls(ln),(0,i.Lo)().subscribe("ShellDataUpdated",ut,!0),(0,i.Lo)().subscribe("ShellDataUpdated",Wt,!0),(pn=(0,i.aH)())&&pn.layout&&pn.layout.centerCustomizationRegion&&(0,P.Y5)("MyDay",pn.layout.centerCustomizationRegion.children)&&(0,i.Lo)().subscribe("ShellDataUpdated",Qt,!0),dn=new en,fn=window.O365Shell.DTT,window.O365Shell.DTT=dn,fn&&fn.applyCalls(dn),(0,i.aH)().shellAuthProviderConfig&&(nn=new gn).Init(),(0,ze.v)(),(0,i.Lo)().invoke("PlusLoaded"),(0,i.jl)().perfMarker("shell_plus_executioncomplete")},29026:function(e,t,n){"use strict";var i;n.d(t,{K:function(){return i}}),function(e){e.Theme="theme",e.LanguageAndRegion="languageandregion",e.NavBarDataLinks="navbardatalinks",e.ChangePassword="changepassword",e.ContactPreferences="contactpreferences",e.AboutBase="aboutbase",e.About="about",e.DarkMode="darkmode",e.CPNIPin="cpnipin"}(i||(i={}))},13942:function(e,t,n){"use strict";n.d(t,{jG:function(){return r},N0:function(){return o},eV:function(){return a},Q5:function(){return s},AF:function(){return u},rw:function(){return l},CR:function(){return c},nf:function(){return p},R6:function(){return d},gR:function(){return f},Jf:function(){return h},FF:function(){return g},iM:function(){return m},$y:function(){return y},i7:function(){return v},qe:function(){return S},zS:function(){return _},zt:function(){return T}});var i=n(27660);function r(e){return{type:i.do,newWorkloadSettingLink:e}}function o(e){return{type:i.w0,settingLinkID:e}}function a(e){return{type:i.K4,newWorkloadSettingsLinks:e}}function s(e){return{type:i.SL,cardData:e}}function u(e){return{type:i.Cr,selectedLanguage:e}}function l(e){return{type:i.EF,languageChoices:e}}function c(e){return{type:i.$w,selectedTimeZone:e}}function p(e,t,n){return{type:i.lj,timeZoneChoice:e,dateFormatChoice:t,timeFormatChoice:n}}function d(e){return{type:i.rg,timeZoneChoices:e}}function f(e){return{type:i.J5,selectedLanguage:e}}function h(e){return{type:i.Oy,selectedDateFormat:e}}function g(e){return{type:i.$I,dateFormatChoices:e}}function m(e){return{type:i.sI,selectedTimeFormat:e}}function y(e){return{type:i.i1,timeFormatChoices:e}}function v(){return{type:i.NS}}function S(){return{type:i.M9}}function _(e){return{type:i.Vx,cardId:e}}function T(e){return{type:i.nl,isExpanded:e}}},27660:function(e,t,n){"use strict";n.d(t,{NS:function(){return i},M9:function(){return r},do:function(){return o},w0:function(){return a},K4:function(){return s},SL:function(){return u},Cr:function(){return l},EF:function(){return c},$w:function(){return p},lj:function(){return d},rg:function(){return f},J5:function(){return h},Oy:function(){return g},$I:function(){return m},sI:function(){return y},i1:function(){return v},Vx:function(){return S},nl:function(){return _}});var i="suiteux-settings.SAVE_SELECTIONS",r="suiteux-settings.CANCEL_SELECTIONS",o="suiteux-settings.ADDORUPDATE_WORKLOADSETTINGLINK",a="suiteux-settings.REMOVE_WORKLOADSETTINGLINK",s="suiteux-settings.SET_WORKLOADSETTINGSLINKS",u="suiteux-settings.INITIALCARDS_AVAILABLE",l="suiteux-settings.LANGUAGECHOICE_AVAILABLE",c="suiteux-settings.LANGUAGECHOICES_AVAILABLE",p="suiteux-settings.SELECTEDTIMEZONE_CHANGED",d="suiteux-settings.TIMEZONEANDFORMATSCHOICE_AVAILABLE",f="suiteux-settings.TIMEZONECHOICES_AVAILABLE",h="suiteux-settings.SELECTEDLANGUAGE_CHANGED",g="suiteux-settings.SELECTEDDATEFORMAT_CHANGED",m="suiteux-settings.DATEFORMATCHOICES_AVAILABLE",y="suiteux-settings.SELECTEDTIMEFORMAT_CHANGED",v="suiteux-settings.TIMEFORMATCHOICES_AVAILABLE",S="suiteux-settings.NAVIGATE_TO_CARD",_="suiteux-settings.O365_SETTINGS_EXPANDED"},54566:function(e,t,n){"use strict";n.d(t,{F:function(){return d}});var i=n(70655),r=n(94875),o=n(6323);var a,s=n(29026),u=[s.K.LanguageAndRegion,s.K.ChangePassword,s.K.ContactPreferences,s.K.NavBarDataLinks],l={default:[s.K.NavBarDataLinks,s.K.Theme,s.K.LanguageAndRegion,s.K.DarkMode,s.K.ChangePassword,s.K.ContactPreferences],iwapp:[s.K.NavBarDataLinks,s.K.Theme,s.K.LanguageAndRegion,s.K.DarkMode,s.K.ChangePassword,s.K.ContactPreferences],exchange:[],officepwa:[s.K.Theme,s.K.DarkMode,s.K.AboutBase,s.K.NavBarDataLinks],botdesigner:[s.K.NavBarDataLinks,s.K.Theme,s.K.ChangePassword,s.K.ContactPreferences],dynamics365:[s.K.NavBarDataLinks,s.K.Theme,s.K.LanguageAndRegion,s.K.ChangePassword,s.K.ContactPreferences],dynamics365ci:[s.K.NavBarDataLinks,s.K.Theme,s.K.ChangePassword,s.K.ContactPreferences],dynamics365fraudprotection:[s.K.NavBarDataLinks,s.K.Theme,s.K.ChangePassword,s.K.ContactPreferences],dynamics365powerplatform:[s.K.NavBarDataLinks,s.K.Theme,s.K.ChangePassword,s.K.ContactPreferences],dynamics365productinsights:[s.K.NavBarDataLinks,s.K.ChangePassword,s.K.ContactPreferences],adminportal:[s.K.NavBarDataLinks,s.K.Theme,s.K.LanguageAndRegion,s.K.ChangePassword,s.K.ContactPreferences,s.K.CPNIPin],flow:[s.K.NavBarDataLinks,s.K.Theme,s.K.ChangePassword,s.K.ContactPreferences],teamsappstudio:[s.K.NavBarDataLinks,s.K.LanguageAndRegion,s.K.ChangePassword,s.K.ContactPreferences],wordonline:u,powerpointonline:u,excelonline:u,visioonline:u,onenoteonline:u,wac:u},c=n(364),p=((a={})[s.K.NavBarDataLinks]={EnableConsumer:!0},a[s.K.Theme]={Title:c.b.Themes,EnableConsumer:!0},a[s.K.ChangePassword]={Title:c.b.Password,Description:c.b.PasswordDescription,EnableConsumer:!1,ChangePasswordCardData:[{WorkloadId:"dynamics365businesscentral",QueryStringData:[{Key:"ru",Value:"https://businesscentral.dynamics.com?redirectedfromsignup=1"}]}]},a[s.K.ContactPreferences]={Title:c.b.ContactPreferences,Description:c.b.ContactPreferencesDescription,EnableConsumer:!1},a[s.K.LanguageAndRegion]={Title:c.b.LanguageAndTimeZone,Description:c.b.LanguageAndTimeZoneDescription,EnableConsumer:!1},a[s.K.AboutBase]={Title:c.b.About,EnableConsumer:!0,ChildCardIds:[s.K.About]},a[s.K.About]={Title:c.b.About,EnableConsumer:!0},a[s.K.DarkMode]={Title:c.b.DarkThemeTitle,EnableConsumer:!1},a[s.K.CPNIPin]={Title:c.b.CPNIPinCardTitle,EnableConsumer:!1},a);function d(e,t,n){var a,u,c=((a={})[s.K.LanguageAndRegion]=function(e){return!e.UseSimplifiedLanguageCard&&1==(1&e.UserType)&&!(0,r.o5)(e.WorkloadId)}(e),a[s.K.NavBarDataLinks]=function(e){return!(0,o.q)(e)}(n),a[s.K.Theme]=function(e){return!(!e.IsConsumerShell||e.CSSExperiencesEnabled&&e.ConsumerThemingEnabled)}(e),a[s.K.ContactPreferences]=function(e){return!e.ShowContactPreferencesCard}(e),a);u=e.CurrentMainLinkElementID&&"shellofficedotcom"===e.CurrentMainLinkElementID.toLowerCase()?"iwapp":e.CurrentMainLinkElementID&&"shellofficepwa"===e.CurrentMainLinkElementID.toLowerCase()?"officepwa":e.WorkloadId.toLowerCase();var d=null!=t?p[t].ChildCardIds:l[u]?l[u]:l.default,f=e.IsConsumerShell;return d?d.filter((function(t){return!e.IsGuestMode||t===s.K.NavBarDataLinks})).filter((function(e){return!f||p[e].EnableConsumer})).filter((function(e){return!c[e]})).map((function(e){return(0,i.__assign)({Id:e},p[e])})):[]}},97410:function(e,t,n){"use strict";n.d(t,{n:function(){return M}});var i,r=n(70655),o=n(74240),a=n(49447),s=n(85675),u=n(36952),l=n(59838),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){},t.prototype.getMruDocuments=function(e,t){var n=this;return new Promise((function(i,r){var s=(0,u.Uw)("{0}?rs={1}&show={2}&sort=date",n.SuiteApi.Configuration.MruOauthEndpointUrl,n.SuiteApi.Configuration.CultureName,e.toString());null!=t&&(s+="&apps="+t);var l={method:o.FH.GET,resource:n.SuiteApi.Configuration.MruOauthResourceUrl,url:s};n.SuiteApi.Service.callEndpointWithOauthToken(l).then((function(e){(0,a.jl)().perfMarker("shell_mru_fetch_complete"),i(e)})).catch((function(e){o.LU.genericServiceRejection("Documents_GetMRUDocuments_Failed",6,e,r)}))}))},t.prototype.prefetchMruAccessToken=function(){null!=this.SuiteApi.Configuration.MruOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.MruOauthResourceUrl)},t.prototype.initializeGraphApi=function(){null!=this.SuiteApi.Configuration.GraphOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthEndpointUrl,this.SuiteApi.Configuration.GraphOauthResourceUrl)},t.prototype.createNewDocument=function(e){var t=this,n={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},i={method:o.FH.POST,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthEndpointUrl,headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(n)};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(i).then(e).catch((function(e){o.LU.genericServiceRejection("Documents_CreateNewDocument_Failed",4,e,n)}))}))},t.prototype.getDocumentUrl=function(e,t){var n,i=this;return new Promise((function(r){null!=e?i.createNewDocument(e).then((function(e){null!=e&&null!=e.webUrl?-1===(n=e.webUrl.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf("action=editnew")&&(n=(0,u.aM)(n,"action","editnew")):n=t,r(n)})):r(n=t)}))},t}(l.V),p=n(1852),d=n(56623),f=n(93897);!function(e){e.UpdateConfig="UpdateConfig",e.UpdateToken="UpdateToken",e.ChangeTheme="ChangeTheme",e.UpdateData="UpdateData"}(i||(i={}));var h=n(18902),g=function(e){function t(){var t=e.call(this)||this;return t.opxFrameToComponentMap={},t.opxComponentData={},t.opxTimers={},t.opxOutstandingOpxQueries={},t.currentOpxQueryID=0,t.OpxInitializationTimeout=15e3,t.handleIncomingOpxMessage=function(e){var n,i=!1,r=t.opxFrameToComponentMap[e.instanceId];if(null!=r)switch(e.notificationType){case d.C.LifeCycle:switch(e.asyncContext){case d.A.GetConfig:var o=null===(n=t.opxComponentData[r])||void 0===n?void 0:n.opxComponentConfiguration;null!=o&&(i=t.onGetConfigRequest(e.instanceId,o));break;case d.A.RefreshToken:i=t.onRefreshTokenRequest(e.instanceId);break;case d.A.Closed:i=t.onOpxClosedRequest(r);break;case d.A.PageReady:case d.A.FatalError:i=t.onReadyOrError(r,e)}break;case d.C.ChallengeToken:i=t.onRefreshTokenRequest(e.instanceId);break;case d.C.DataProviderResponseNotification:var a=e.asyncContext;if(a.success){var s=t.opxOutstandingOpxQueries[e.instanceId];if(s)Object.keys(s).filter((function(e){return s[e].queryType===a.type})).forEach((function(e){s[e].onQueryComplete(a.response)}))}}return i},t.validateIncomingOpxMessage=function(e){return e.apiName===h.r2},t.validateIncomingOpxMessageOrigin=function(e){return e.toLowerCase()===t.SuiteApi.Configuration.TokenFactoryIframeOrigin},t.onGetConfigRequest=function(e,n){return t.SuiteApi.Service.callOpxIframe({opxHostUrl:t.opxHostUrl,targetOpxInstance:e,message:{eventType:i.UpdateConfig,asyncResult:n}}),!0},t.onRefreshTokenRequest=function(e){return t.SuiteApi.Service.callOpxIframe({opxHostUrl:t.opxHostUrl,targetOpxInstance:e,message:{eventType:i.UpdateToken,asyncResult:null}}),!0},t.onOpxClosedRequest=function(e){var t=null;switch(e){case p.x.MyDay:t="MyDay"}return null!=t&&window.O365Shell.FlexPane.CloseFlexPaneForProvider(t),!0},t.onReadyOrError=function(e,n){var i=t.opxComponentData[e];if(!i)throw new Error("Message received for an OPX component that no longer exists.");if(i.initCompleteCallback&&!i.initializationResult){var r=n.asyncContext===d.A.PageReady?0:5;i.initCompleteCallback(r)}else i.messageListener&&i.messageListener(n);return!0},t}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){this.opxHostUrl=this.SuiteApi.Configuration.OpxHostUrl,this.opxResourceUrl=this.SuiteApi.Configuration.OpxResourceUrl,this.opxSystemConfigurationPromise=this.initializeOpxOrchestrator()},t.prototype.prefetchOpxAccessToken=function(e){var t=this;this.opxSystemConfigurationPromise.then((function(n){null==t.opxSystemConfiguration&&(t.opxSystemConfiguration=n);var i=t.opxSystemConfiguration.OpxEndpoints[e];void 0!==i&&t.SuiteApi.Service.prefetchAccessToken(i.OpxOAuthResourceUrl,i.OpxOAuthResourceUrl)})).catch((function(e){(0,a.jl)().tag("OwaPoweredExperiences_PrefetchAccessTokenFailed",1,e)}))},t.prototype.initializeOpx=function(e,t,n,i){var r=this,o=document.getElementById(t);if(!o)return Promise.resolve(2);this.prefetchOpxAccessToken(p.x.MyDay);var s=new Promise((function(s){r.opxSystemConfigurationPromise.then((function(u){null==r.opxSystemConfiguration&&(r.opxSystemConfiguration=u),r.opxFrameToComponentMap[t]=e,r.opxComponentData[e]={frameID:t,opxComponentConfiguration:n,initCompleteCallback:function(t){switch(t){case 0:case 5:r.opxComponentData[e].initializationResult=t}s(t)},messageListener:i},o.onerror=function(e,t,n,i,r){var o=JSON.stringify(null!=e?e:"Script error");(0,a.jl)().exception(o,6,r,t,n,i),s(3)},o.src=r.createOpxFrameUrl(e,t)})).catch((function(){s(1)}))}));return Promise.race([new Promise((function(t){s.then((function(n){clearTimeout(r.opxTimers[e]),t(n)}))})),new Promise((function(t){clearTimeout(r.opxTimers[e]),r.opxTimers[e]=window.setTimeout((function(){clearTimeout(r.opxTimers[e]),t(4)}),r.OpxInitializationTimeout)}))])},t.prototype.changeTheme=function(e,t,n){var r=this.opxComponentData[e];if(0!==r.initializationResult)throw new Error("Theme cannot be changed before OPX is in the operational state.");var o=r.frameID,a={UseDarkMode:n};n?a.DarkPalette=t:a.LightPalette=t,this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:o,message:{eventType:i.ChangeTheme,asyncResult:a}})},t.prototype.updateData=function(e,t,n){var r=this.opxComponentData[e];if(!r||0!==r.initializationResult)return Promise.reject(new Error("UpdateData cannot be called before OPX is in the operational state."));var o={type:t,request:n};return this.queryOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:r.frameID,message:{eventType:i.UpdateData,asyncResult:o}})},t.prototype.createOpxFrameUrl=function(e,t){if(null==this.opxSystemConfiguration||null==this.opxSystemConfiguration.OpxRootUrlLowerCase||null==this.opxSystemConfiguration.OpxEndpoints[e]||null==this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)throw new Error("OPX system configuration incomplete.");return""+this.opxSystemConfiguration.OpxRootUrlLowerCase+this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl+"?hostApp=o365shell&frameName="+f.TokenFactoryIFrameID+"&opxInstanceId="+t},t.prototype.initializeOpxOrchestrator=function(){var e=this;return new Promise((function(t,n){e.fetchSystemConfiguration().then((function(i){e.SuiteApi.Service.registerOpxHost(e.opxResourceUrl,e.opxHostUrl,e.OpxInitializationTimeout).then((function(){e.registerOpxMessageListener(),t(i)})).catch((function(e){(0,a.jl)().exception("OPX_RegisterOpxHost_Failure",6,e),n(e)}))})).catch((function(e){(0,a.jl)().exception("OPX_FetchSystemConfiguration_Failure",6,e),n(e)}))}))},t.prototype.fetchSystemConfiguration=function(){return Promise.resolve({OpxEndpoints:{MyDay:{OpxEndpointUrl:"/calendar/opxdeeplink/myday",OpxOAuthResourceUrl:this.opxResourceUrl},ExchangeData:{OpxEndpointUrl:"/calendar/opxdeeplink/dataprovider",OpxOAuthResourceUrl:this.opxResourceUrl}},OpxRootUrlLowerCase:this.opxHostUrl.toLowerCase(),OpxSupported:!0})},t.prototype.registerOpxMessageListener=function(){this.SuiteApi.Service.registerPostMessageHandler({handleMessage:this.handleIncomingOpxMessage,validateMessage:this.validateIncomingOpxMessage,validateOrigin:this.validateIncomingOpxMessageOrigin})},t.prototype.queryOpxIframe=function(e,t){var n=this;void 0===t&&(t=5e3);var i=e.message.asyncResult;return new Promise((function(r,o){n.SuiteApi.Service.callOpxIframe(e),null==n.opxOutstandingOpxQueries[e.targetOpxInstance]&&(n.opxOutstandingOpxQueries[e.targetOpxInstance]={});var a=n.currentOpxQueryID++,s=n.opxOutstandingOpxQueries[e.targetOpxInstance],u=setTimeout((function(){delete s[a],o(new Error("Query timeout."))}),t);s[a]={id:a,opxFrameID:e.targetOpxInstance,queryType:i.type,onQueryComplete:function(e){clearTimeout(u),delete s[a],r(e)}}}))},t}(l.V);var m=n(98271),y=n(80997),v=n(97019),S=n(27826),_=function(){function e(e){this.userTheme=e}return e.prototype.GetUserThemeId=function(){return(0,a.q4)().getCurrentThemeId()},e.prototype.ChangeTheme=function(e){},e.prototype.SaveTheme=function(e,t){var n=this;return new Promise((function(i,r){n.userTheme.setUserTheme(e,t).then((function(e){e.O365Success||e.OwaSuccess?i():r(new Error("SaveThemeFailure"))})).catch(r)}))},e.prototype.SaveDarkTheme=function(e){var t=this;return new Promise((function(n,i){t.userTheme.setUserThemeSettingsInWCSS(e).then((function(e){e.O365Success||e.OwaSuccess?n():i(new Error("SaveThemeFailure"))})).catch(i)}))},e.prototype.GetModeLogo=function(e){var t=this;return new Promise((function(n,i){t.userTheme.getModeLogo(e).then((function(e){if(e){var t="";e.HasTenantLogo&&(e.LogoUrl?t=e.LogoUrl:e.LogoData&&(t=e.LogoData));var r={isLogoVisible:!0,logoUrl:t,logoNavigationUrl:e.HomePageUrl?e.HomePageUrl:""};return n(r)}return i(new Error("GetModeLogoFailure"))})).catch(i)}))},e.prototype.SetUserThemesData=function(e){(0,u.ef)().dispatch((0,u.gJ)(e))},e}(),T="{0}/api/settings/darkmode",C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){var e=this;(0,a.q4)().setUserThemesHandler(new _(this)),this.SuiteApi.User.IsInitialized&&this.SuiteApi.Configuration.IsConsumer&&(0,a.Lo)().subscribe("ConsumerShellDataAvailable",(function(t){var n=t.ShellClientData.ThemeData.ThemeSettings.ThemeID;e.SuiteApi.User.getOwaUserConfiguration().then((function(t){t&&(null!=n&&n===t.UserOptions.ThemeStorageId||e.setUserThemeInWCSS(""===t.UserOptions.ThemeStorageId?"Base":t.UserOptions.ThemeStorageId,!0))})).catch((function(){}))}),!0)},t.prototype.loadUserThemeChoices=function(){return this.checkInitialized(),(0,a.q4)().loadAllThemeJson()},t.prototype.setUserTheme=function(e,t){var n=this;this.checkInitialized(),this.clearUserThemeCache();var i,r=e=e.replace(/^\w/,(function(e){return e.toUpperCase()}));return e.toLowerCase()===v.DefaultThemeId&&t&&(r=v.BasePreferOfficeThemeIdOWA),i=m.X((function(){return n.setUserThemeInWCSS(e,e.toLowerCase()===v.DefaultThemeId&&t)}),2),this.SuiteApi.Configuration.IsPwa?i:i.then((function(){return m.X((function(){return n.setUserThemeInExchange(r,!0)}),2)}))},t.prototype.setUserThemeInWCSS=function(e,t){var n=this;return new Promise((function(i,r){var s={url:(0,y.Uw)(n.SuiteApi.Configuration.IsConsumer?T:"{0}/api/settings/theme",n.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:n.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.FH.PUT,headers:S.A,body:JSON.stringify({ThemeID:e,PreferOfficeTheme:t})};(0,a.jl)().impression("SetUserThemeStart","WCSS"),n.SuiteApi.Service.callEndpointWithOauthToken(s).then((function(e){(0,a.jl)().impression("SetUserThemeSuccess","WCSS"),i({OwaSuccess:void 0,O365Success:!0})})).catch((function(e){o.LU.genericServiceRejection("Settings_SetUserThemeInWCSS_Failed",6,e,r)}))}))},t.prototype.setUserThemeSettingsInWCSS=function(e){var t=this;return new Promise((function(n,i){var r={url:(0,y.Uw)(T,t.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.FH.PUT,headers:S.A,body:JSON.stringify({IsDarkmode:e})};t.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){n({O365Success:!0})})).catch((function(e){o.LU.genericServiceRejection("Settings_SetUserThemeSettingsInWCSS_Failed",6,e,i)}))}))},t.prototype.getModeLogo=function(e){var t=this;return new Promise((function(n,i){var r={url:(0,y.Uw)("{0}/api/theme/tenant?useDarkMode="+e,t.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.FH.GET,headers:S.A};t.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){n(e)})).catch((function(e){o.LU.genericServiceRejection("Settings_GetModeLogoFromWCSS_Failed",6,e,i)}))}))},t.prototype.setUserThemeInExchange=function(e,t){var n=this;return new Promise((function(i,r){(0,a.q4)().getUserThemeByID(e).then((function(a){(n.SuiteApi.Configuration.OpxEnabled&&n.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!n.SuiteApi.Configuration.IsOwa?n.setUserThemeViaOpx(e,t):n.setUserThemeViaSuiteServiceProxy(e,t,a)).then((function(e){i({OwaSuccess:e.OwaSuccess,O365Success:e.O365Success||t})})).catch((function(e){o.LU.genericServiceRejection("Settings_SetUserThemeInExchange_Failed",6,e,r)}))}))}))},t.prototype.setUserThemeViaOpx=function(e,t){return n.e("exchangedata").then(n.bind(n,74343)).then((function(n){return n.setUserTheme(e,t)}))},t.prototype.setUserThemeViaSuiteServiceProxy=function(e,t,n){var i=this,o={ThemeId:e,SkipO365Call:t};n&&e!==v.BasePreferOfficeThemeIdOWA&&(o.UserThemeJson=JSON.stringify(n));var a,s={request:(a=o,(0,r.__assign)({__type:"SetUserThemeRequest:#Exchange"},a))};return new Promise((function(e,t){i.SuiteApi.User.getOwaUserConfiguration().then((function(t){var n=i.SuiteApi.Service.callOwaIframeAction("SetUserTheme",s);e(n)})).catch((function(e){t(e)}))}))},t.prototype.clearUserThemeCache=function(){var e=this;this.SuiteApi.Configuration.ClearThemeCacheData&&0!==this.SuiteApi.Configuration.ClearThemeCacheData.length&&this.SuiteApi.Configuration.ClearThemeCacheData.map((function(t){if(null!=t.WorkloadUrl&&t.WorkloadUrl.length>0&&(!t.NoRequestInSameWorkload||e.SuiteApi.Configuration.WorkloadId.toLowerCase()!==t.WorkloadId.toLowerCase())&&null!=t.RequestType&&t.RequestType.length>0&&("img"===t.RequestType.toLowerCase()||"iframe"===t.RequestType.toLowerCase())){var n=document.createElement(t.RequestType);n.setAttribute("src",t.WorkloadUrl),n.setAttribute("style","display:none"),"iframe"===t.RequestType.toLowerCase()&&(n.addEventListener("load",(function(){return document.body.removeChild(n)})),document.body.appendChild(n))}}))},t}(l.V);function I(e){return(0,r.__assign)({__type:"JsonRequestHeaders:#Exchange"},e)}function w(e){return(0,r.__assign)({__type:"TimeZoneContext:#Exchange"},e)}var b={baseUrl:"/owa",isFeatureEnabled:function(){return!1},prefetchTaskQueue:new(function(){function e(e){void 0===e&&(e={maxParallelTasks:1,taskQuanta:0}),this.config=e,this.taskList={},this.numberOfTasksRunning=0}return e.prototype.add=function(e,t){var n=this;return void 0===t&&(t=0),this.taskList[t]||(this.taskList[t]=[]),new Promise((function(i,r){n.taskList[t].unshift({func:e,resolve:i,reject:r}),n.scheduleTask()}))},e.prototype.clear=function(){this.taskList={}},e.prototype.scheduleTask=function(){var e=this;this.config.taskQuanta<0?this.tryRunTask():setTimeout((function(){e.tryRunTask()}),this.config.taskQuanta||0)},e.prototype.tryRunTask=function(){var e=this,t=Object.keys(this.taskList);if(this.numberOfTasksRunning<(this.config.maxParallelTasks||1)&&t.length>0){var n=Math.min.apply(null,t.map((function(e){return parseInt(e)}))),i=this.taskList[n].pop();this.taskList[n]&&0!=this.taskList[n].length||delete this.taskList[n],this.numberOfTasksRunning++,i.func().then((function(t){i.resolve(t),e.onTaskComplete()})).catch((function(t){i.reject(t),e.onTaskComplete()})),this.scheduleTask()}},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e}())({taskQuanta:-1}),timeoutMS:9e4,disableAllRequests:!1},A=b;function D(e){return e||(e=A.timezone),I(e?{RequestServerVersion:"V2018_01_08",TimeZoneContext:w({TimeZoneDefinition:(t={Id:e},(0,r.__assign)({__type:"TimeZoneDefinitionType:#Exchange"},t))})}:{RequestServerVersion:"V2018_01_08"});var t}var P=n(24443),O=null,x=o.xX.SuiteServiceApiRelativePath+"LanguageTimezone",E=null,k=null,R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){null!=(O=this.SuiteApi.Configuration.GraphOauthResourceUrl)&&(O=(0,u.Uw)("{0}/{1}",O,"v1.0/me"),E=(0,u.Uw)("{0}/{1}",O,"outlook/supportedLanguages"),k=(0,u.Uw)("{0}/{1}",O,"outlook/supportedTimeZones"))},t.prototype.getLanguageAndTimeZone=function(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageAndTimeZone():this.getSuiteLanguage()},t.prototype.getLanguageChoices=function(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageChoices():this.getSuiteLanguageChoices()},t.prototype.getTimeZoneChoices=function(){var e=this;return new Promise((function(t,n){var i={url:k,method:o.FH.GET};e.SuiteApi.Service.callEndpointWithOauthToken(i).then((function(e){t(e.value)})).catch((function(e){o.LU.genericServiceRejection("Settings_GetTimeZoneChoices_Failed",6,e,n)}))}))},t.prototype.getDateTimeFormats=function(e){var t=this;return new Promise((function(n,i){var r={url:(0,u.Uw)("{0}/api/settings/datetimeformats?cultureName={1}",t.SuiteApi.Configuration.TokenFactoryIframeOrigin,e),resource:t.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:o.FH.GET,headers:S.A};t.SuiteApi.Service.callEndpointWithOauthToken(r).then(n).catch((function(e){o.LU.genericServiceRejection("Settings_GetDateTimeFormats_Failed",6,e,i)}))}))},t.prototype.setLanguageAndTimeZone=function(e){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.setOwaLanguageAndTimeZone(e):this.setSuiteLanguage(e.CurrentCultureName)},t.prototype.setSuiteLanguage=function(e){var t=this;return new Promise((function(n,i){var r={url:O,method:o.FH.PATCH,headers:S.D,body:JSON.stringify({preferredLanguage:e})};t.SuiteApi.Service.callEndpointWithOauthToken(r).then((function(e){n()})).catch((function(e){o.LU.genericServiceRejection("Settings_SetSuiteLanguage_Failed",6,e,i)}))}))},t.prototype.setOwaLanguageAndTimeZone=function(e){var t=this;return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise((function(n,i){e.CurrentCultureLcid=null;var a,s={Language:e.CurrentCultureName,TimeZone:e.CurrentTimeZone,DateFormat:e.CurrentDateFormat,TimeFormat:e.CurrentTimeFormat},u=(a={Header:D(),Options:s},(0,r.__assign)({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},a));t.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("SetMailboxRegionalConfiguration",u,null).then((function(i){t.setSuiteLanguage(e.CurrentCultureName),n()})).catch((function(e){o.LU.genericServiceRejection("Settings_SetOwsOwaLanguageAndTimeZone_Failed",6,e,i)}))})):new Promise((function(n,i){e.CurrentCultureLcid=null,t.SuiteApi.Service.callOwaIframeResourceUrl(x,e,o.FH.PUT).then(n).catch((function(e){o.LU.genericServiceRejection("Settings_SetLanguageAndTimeZoneViaOwa_Failed",6,e,i)}))}))},t.prototype.getSuiteLanguageChoices=function(){return new Promise((function(e,t){P?e(P):t(new Error("Supported languages not found"))}))},t.prototype.getOwaLanguageChoices=function(){var e=this;return new Promise((function(t,n){var i={url:E,method:o.FH.GET};e.SuiteApi.Service.callEndpointWithOauthToken(i).then((function(e){var n=e.value.map((function(e){return{Locale:e.locale,DisplayName:e.displayName}}));t(n)})).catch((function(e){o.LU.genericServiceRejection("Settings_GetOwaLanguageChoices_Failed",6,e,n)}))}))},t.prototype.getSuiteLanguage=function(){var e=this;return new Promise((function(t,n){var i={url:O,method:o.FH.GET};e.SuiteApi.Service.callEndpointWithOauthToken(i).then((function(e){var n={CurrentCultureName:e.preferredLanguage};t(n)})).catch((function(e){o.LU.genericServiceRejection("Settings_GetSuiteLanguage_Failed",6,e,n)}))}))},t.prototype.getOwaLanguageAndTimeZone=function(){var e=this;return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise((function(t,n){var i,a=(i={Header:D(),VerifyDefaultFolderNameLanguage:!1},(0,r.__assign)({__type:"GetMailboxRegionalConfigurationRequest:#Exchange"},i));e.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("GetMailboxRegionalConfiguration",a,null).then((function(e){var n=e.Options,i={CurrentCultureLcid:0,CurrentCultureName:n.Language,CurrentTimeZone:n.TimeZone,CurrentDateFormat:n.DateFormat,CurrentTimeFormat:n.TimeFormat};t(i)})).catch((function(e){o.LU.genericServiceRejection("Settings_GetOwsOwaLanguageAndTimeZone_Failed",6,e,n)}))})):new Promise((function(t,n){e.SuiteApi.Service.callOwaIframeResourceUrl(x,null,o.FH.GET).then((function(e){var n=e.Body.Configuration;t(n)})).catch((function(e){o.LU.genericServiceRejection("Settings_GetOwaLanguageAndTimeZone_Failed",6,e,n)}))}))},t}(l.V),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){this.userTheme=null==this.SuiteApi.Configuration.IUserThemeOverride?new C:this.SuiteApi.Configuration.IUserThemeOverride,this.languageAndTimeZone=null==this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride?new R:this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride,this.userTheme.initialize(this.SuiteApi),this.languageAndTimeZone.initialize(this.SuiteApi)},t.prototype.loadUserThemeChoices=function(){return this.userTheme.loadUserThemeChoices()},t.prototype.setUserTheme=function(e,t){return this.userTheme.setUserTheme(e,t)},t.prototype.getLanguageAndTimeZone=function(){return this.languageAndTimeZone.getLanguageAndTimeZone()},t.prototype.getLanguageChoices=function(){return this.languageAndTimeZone.getLanguageChoices()},t.prototype.getTimeZoneChoices=function(){return this.languageAndTimeZone.getTimeZoneChoices()},t.prototype.getDateTimeFormats=function(e){return this.languageAndTimeZone.getDateTimeFormats(e)},t.prototype.setLanguageAndTimeZone=function(e){return this.languageAndTimeZone.setLanguageAndTimeZone(e)},t}(l.V),U=n(84293),N="/v1.0/me/photo/$value",F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initializeComponent=function(){},Object.defineProperty(t.prototype,"OwaUserConfig",{get:function(){return this.userConfig},enumerable:!0,configurable:!0}),t.prototype.getOwaUserConfiguration=function(){null==this.userConfigPromise&&(this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.userConfigPromise=this.getOwaUserConfigurationViaOpx():this.userConfigPromise=this.getOwaUserConfigurationViaSuiteServiceProxy());var e=window.setTimeout((function(){return(0,a.jl)().tag("User_GetOwaUserConfiguration_MessageTimeout",6)}),15e3);return this.userConfigPromise.then((function(){return window.clearTimeout(e)})).catch((function(){return window.clearTimeout(e)})),this.userConfigPromise},t.prototype.getOwaUserConfigurationViaOpx=function(){return n.e("exchangedata").then(n.bind(n,74343)).then((function(e){return e.getOwaUserConfig()})).catch((function(e){throw(0,a.jl)().exception("User_GetOwaUserConfigurationViaOpx_Failed",4,e),e}))},t.prototype.getOwaUserConfigurationViaSuiteServiceProxy=function(){var e=this;return new Promise((function(t,n){var i={command:o.uJ.OwaUserConfig,timeout:1e4},r=function(){e.SuiteApi.Service.callOwaIframeAction("GetOwaUserConfiguration",{}).then((function(i){if(e.userConfig=i,null!=e.userConfig&&""!==e.userConfig)e.onOwaUserConfigSucceeded(t);else{var r=new o.Pp("null OwaUserConfiguration received from server");(0,a.jl)().exception("User_GetOwaUserConfiguration_NullConfig",4,r),n(r)}})).catch((function(e){o.LU.genericServiceRejection("User_GetOwaUserConfiguration_Failed",4,e,n)}))};if(e.SuiteApi.Configuration.IsOwa)r();else{i.success=function(n){e.userConfig=n.responseObject,"GetOwaUserConfiguration"===o.es.Instance.configuration.StartupActionName&&e.SuiteApi.Service.setStartupActionCompleted(),e.onOwaUserConfigSucceeded(t)},i.error=function(e,t,n){(0,a.jl)().exception("GetOwaUserConfiguration_ContextUnavailable",4,new o.Pp(n,t)),r()};var s=o.Ou.OwaInstance;null==s?n(new o.Pp("OwaIframe",-1011)):s.getOwaUserConfiguration(i)}}))},t.prototype.getPhotoFromGraph=function(){var e=this,t={method:o.FH.GET,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+N,binaryStringResponseBody:!0};return new Promise((function(n,i){e.SuiteApi.Service.callEndpointWithOauthToken(t).then((function(e){n(window.btoa(e))})).catch((function(e){404===e.errorInfo.HttpStatus?n(""):o.LU.genericServiceRejection("User_GetPhotoFromGraph_Failed",4,e,i)}))}))},t.prototype.prefetchGraphToken=function(){var e=this;return new Promise((function(t,n){null!=e.SuiteApi.Configuration.GraphOauthResourceUrl?e.SuiteApi.Service.prefetchAccessToken(e.SuiteApi.Configuration.GraphOauthResourceUrl+N,e.SuiteApi.Configuration.GraphOauthResourceUrl).then(t).catch(n):n()}))},t.prototype.uploadPhotoToGraph=function(e){var t=this,n=e.split(","),i=n[0].split(":")[1].split(";")[0],r=n[1],a={method:o.FH.PUT,headers:{"Content-Type":i},timeout:7e3,body:window.atob(r),resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+N,binaryStringRequestBody:!0};return new Promise((function(e,n){t.SuiteApi.Service.callEndpointWithOauthToken(a).then(e).catch((function(e){o.LU.genericServiceRejection("User_UploadPhotoToGraph_Failed",6,e,n)}))}))},t.prototype.onOwaUserConfigSucceeded=function(e){null!=this.userConfig.SessionSettings?o.es.Instance.MailboxGuid=this.userConfig.SessionSettings.MailboxGuid:(0,a.jl)().tag("User_GetOwaUserConfiguration_SessionSettingsNull",4),e(this.userConfig)},t}(l.V),M=function(){function e(e){this.configuration=e,this.StartupActionName="GetOwaUserConfiguration",this.validateConfiguration(e),this.owaUrlSpecialHandling(e),o.es.Initialize((0,r.__assign)((0,r.__assign)({},e),{StartupActionName:this.StartupActionName})),this.service=o.t6.Instance,this.storage=null==e.IStorageOverride?new U.Ke:e.IStorageOverride,this.webShellStorage=null==e.IWebShellStorageOverride?new U.RQ:e.IWebShellStorageOverride,this.user=null==e.IUserOverride?new F:e.IUserOverride,this.settings=null==e.ISettingsOverride?new L:e.ISettingsOverride,this.documentsModule=null==e.IDocumentsOverride?new c:e.IDocumentsOverride,this.owaPoweredExperiences=null==e.IOwaPoweredExperiencesOverride?new g:e.IOwaPoweredExperiencesOverride,this.service=o.t6.Instance,e.UserHasExchangeLicense?e.SuiteServiceCallsDisabled?this.service.blockSuiteServiceCalls(o.vj.Brs):e.IsPwa&&this.service.blockSuiteServiceCalls(o.vj.Pwa):this.service.blockSuiteServiceCalls(o/* ServiceCallsBlockingReason.NoExoLicense */.vj.NoExoLicense),this.storage.initialize(this),this.webShellStorage.initialize(this),this.user.initialize(this),this.documentsModule.initialize(this),this.settings.initialize(this),e.OpxEnabled&&this.owaPoweredExperiences.initialize(this)}return Object.defineProperty(e.prototype,"Configuration",{get:function(){return this.configuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Service",{get:function(){return this.service},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"User",{get:function(){return this.user},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Storage",{get:function(){return this.storage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WebShellStorage",{get:function(){return this.webShellStorage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DocumentsModule",{get:function(){return this.documentsModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OwaPoweredExperiences",{get:function(){return this.owaPoweredExperiences},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this.settings},enumerable:!0,configurable:!0}),e.CreateInstance=function(t){if(null!=this.instance){var n=new Error("Instance already exists.");throw(0,a.jl)().exception("SuiteApi_InstanceAlreadyExists",6,n),n}return this.instance=new e(t),this.instance},e.isInitialized=function(){return null!=this.instance},Object.defineProperty(e,"Instance",{get:function(){if(null==e.instance)throw new Error("Instance not yet created.");return e.instance},enumerable:!0,configurable:!0}),e.clearInstanceForTesting=function(){o.es.isUnitTestMode&&(e.instance=null,o.Ou.resetAllInstancesForTesting())},e.prototype.validateConfiguration=function(e){s.throwOnNullOrUndefined(e,"configuration"),s.throwOnNullOrUndefined(e.SuiteServiceUrl,"SuiteApiConfiguration.SuiteServiceUrl")},e.prototype.owaUrlSpecialHandling=function(e){if(e.IsOwa){var t=e.SuiteServiceUrl.toLowerCase(),n=o.xX.getUrlDomainPart(t),i=o.xX.getUrlDomainPart(window.location.href).toLowerCase();n!==i&&(e.SuiteServiceUrl=t.replace(n,i))}},e}()},59838:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var i=n(85675),r=n(74240),o=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"SuiteApi",{get:function(){return this.suiteApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsInitialized",{get:function(){return this.isInitialized},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e){i.throwOnNullOrUndefined(e,"suiteApi"),this.IsInitialized||(this.suiteApi=e,this.initializeComponent(),this.isInitialized=!0)},e.prototype.checkInitialized=function(){if(!this.isInitialized)throw new r.Pp("SuiteApiComponent_InvalidInitializationCheck",-2002)},e}()},27826:function(e,t,n){"use strict";n.d(t,{A:function(){return i},D:function(){return r}});var i={Accept:"application/json","Content-Type":"application/json; charset=utf-8"},r={Accept:"application/json","Content-Type":"application/json; charset=utf-8"}},67934:function(e,t,n){"use strict";n.d(t,{y:function(){return r},p:function(){return o}});var i=n(74240);function r(e){return new i.Pp("Argument Exception: "+e,-2001)}function o(e){return new i.Pp("Invalid Operation: "+e,-2002)}},30399:function(e,t,n){"use strict";n.d(t,{nR:function(){return a.n}});var i=n(49447),r=n(18902),o=n(94875),a=n(97410);n(67934);function s(e,t){var n,i,o=null!==(n=t.OpxDefaultHostUrl)&&void 0!==n?n:r.WA,a=null!==(i=t.OpxAlternateHostUrls)&&void 0!==i?i:r.Gj;return null!=e.opxHostUrlOverride&&a.indexOf(e.opxHostUrlOverride)>=0&&(o=e.opxHostUrlOverride),o}(0,i.Lo)().subscribe("ShellDataUpdated",(function e(t,n){var u;if(n.SuiteServiceUrl&&(n.IsConsumerShell||n.TokenFactoryIframeOrigin)&&!a.n.isInitialized()){var l=(0,i.aH)(),c={SuiteServiceUrl:n.SuiteServiceUrl,AdminServiceUrl:n.PortalUrl,CurrentUserUpn:n.UPN,CurrentUserPuid:n.PUID,UserHasExchangeLicense:n.HasEXOLicense,SuiteServiceCallsDisabled:n.SuiteServiceCallsDisabled,TokenFactoryIframeOrigin:n.TokenFactoryIframeOrigin,IsOwa:(0,o.o5)(n.WorkloadId),ShellSID:n.SHSID,HintUserName:null!=n.EnableUsernameHinting&&n.EnableUsernameHinting,CultureName:t.CultureName,MruOauthEndpointUrl:n.MruOauthEndpointUrl,MruOauthResourceUrl:n.MruOauthResourceUrl,GraphOauthEndpointUrl:n.GraphOauthEndpointUrl,GraphOauthResourceUrl:n.GraphOauthResourceUrl,NotificationsEnabled:n.NotificationsEnabled&&n.HasEXOLicense,WorkloadId:n.WorkloadId,ClientShellVersion:window.O365ShellVerStr,IsPwa:(0,o.So)(n.WorkloadId,t.CurrentMainLinkElementID),IsOwsLanguageTimezoneCallEnabled:n.OwsLanguageTimezoneCallEnabled,GetTokenRequestDictionary:l.GetTokenRequestDictionary,ServiceWorkerCacheId:l.serviceWorkerCacheId,ServiceWorkerFetchStrategy:l.serviceWorkerFetchStrategy,UserDisambiguationEnabled:n.AADDisambiguationEnabled,ClearThemeCacheData:null!=n.ClearUserThemeCacheUrls&&n.ClearUserThemeCacheUrls.length>0?JSON.parse(n.ClearUserThemeCacheUrls):[],IsConsumer:n.IsConsumerShell,CSSExperiencesEnabled:n.CSSExperiencesEnabled,OpxEnabled:n.OpxEnabled&&!(0,o.So)(n.WorkloadId,t.CurrentMainLinkElementID),OpxHostUrl:s(l,n),OpxResourceUrl:null!==(u=n.OpxDefaultHostUrl)&&void 0!==u?u:r.WA,ExchangeDataOpxEnabled:n.ExchangeDataOpxEnabled};a.n.CreateInstance(c);var p=(0,i.Lo)();p.invoke("SuiteAPILoaded",a.n.Instance),p.unsubscribe("ShellDataUpdated",e)}}),!0)},1852:function(e,t,n){"use strict";var i;n.d(t,{x:function(){return i}}),function(e){e.MyDay="MyDay",e.ExchangeData="ExchangeData"}(i||(i={}))},88210:function(e,t,n){"use strict";var i,r;n.d(t,{r:function(){return i},g:function(){return r}}),function(e){e.SystemMetadata="SystemMetadata",e.CustomerContent="CustomerContent"}(i||(i={})),function(e){e.User="User",e.Tenant="Tenant"}(r||(r={}))},84293:function(e,t,n){"use strict";n.d(t,{Ke:function(){return y},rq:function(){return v.r},Qt:function(){return c},RQ:function(){return w},gD:function(){return v.g}});var i=n(70655),r=n(74240),o=n(59838),a=n(67934),s=r.xX.SuiteServiceApiRelativePath+"NotificationsSettings/User",u=function(){function e(e){this.suiteApi=e}return e.prototype.readNotificationSettings=function(){var e=this;return new Promise((function(t,n){e.suiteApi.Service.callOwaIframeResourceUrl(s,null,r.FH.GET).then((function(e){t(e)})).catch((function(e){r.LU.genericServiceRejection("ReadNotificationSettings",6,e,n)}))}))},e.prototype.writeNotificationSettings=function(e){var t=this;return new Promise((function(n,i){if(null==e)throw(0,a.y)("settingValue");t.suiteApi.Service.callOwaIframeResourceUrl(s,e,r.FH.PUT).then((function(){n()})).catch((function(e){r.LU.genericServiceRejection("WriteNotificationSettings",6,e,i)}))}))},e}(),l=n(85675),c=function(){function e(e,t,n){this.Scope=e,this.Namespace=t,this.Name=n,(0,l.throwOnNullOrEmpty)(e,"keyScope"),(0,l.throwOnNullOrEmpty)(t,"keyNamespace"),(0,l.throwOnNullOrEmpty)(n,"keyName")}return e.prototype.toString=function(){return this.Scope+r.fO.DictionaryStringPartsSeparator+this.Namespace+r.fO.DictionaryStringPartsSeparator+this.Name},e.fromDictionaryKey=function(t){(0,l.throwOnNullOrEmpty)(t,"keyString");var n=t.split(r.fO.DictionaryStringPartsSeparator);if(n.length<3)throw(0,a.p)("Malformed keyString: Expected format <Scope>//<Namespace>//<Name>");return new e(n[0],n[1],n[2])},e}(),p=function(e,t){this.Key=e,this.Value=t,(0,l.throwOnNull)(e,"key"),(0,l.throwOnNull)(t,"value")},d=function(e){function t(t,n){var i=e.call(this,t)||this;return i.Header=t,i.Body=n,i}return(0,i.__extends)(t,e),t}((function(e){this.Header=e})),f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,i.__extends)(t,e)}((function(){})),"Cannot remove a key needed for read or write."),h=function(){function e(e,t,n,i,r){var o=this;void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=[]),void 0===i&&(i={}),void 0===r&&(r=[]),this.clear=e,this.clearAll=t,this.writes=i,this.reads={},this.removes={},n.forEach((function(e){return o.reads[e.toString()]=e})),r.forEach((function(e){return o.removes[e.toString()]=e}))}return e.prototype.getReadStorageKeys=function(){var e=this;return Object.keys(this.reads).map((function(t){return e.reads[t]}))},e.prototype.getWriteStorageKeyValues=function(){var e=this;return Object.keys(this.writes).map((function(t){return e.writes[t]}))},e.prototype.getRemoveStorageKeys=function(){var e=this;return Object.keys(this.removes).map((function(t){return e.removes[t]}))},e.prototype.requestRead=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(0,l.throwOnNullOrEmptyArray)(e,"keys");for(var n=0,i=e;n<i.length;n++){var o=i[n];if((0,l.throwOnNull)(o,"key"),this.isRemoveRequested(o))throw new r.Pp(f,-2002);this.reads[o.toString()]=o}},e.prototype.requestWrite=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];(0,l.throwOnUndefined)(e,"value"),(0,l.throwOnNullOrEmptyArray)(t,"keys");for(var i=0,o=t;i<o.length;i++){var a=o[i];if((0,l.throwOnNull)(a,"key"),this.isRemoveRequested(a))throw new r.Pp(f,-2002);this.writes[a.toString()]=new p(a,e)}},e.prototype.requestRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(0,l.throwOnNullOrEmptyArray)(e,"keys");for(var n=0,i=e;n<i.length;n++){var o=i[n];if((0,l.throwOnNull)(o,"key"),o.toString()in this.reads||o.toString()in this.writes)throw new r.Pp(f,-2002);this.removes[o.toString()]=o}},e.prototype.requestClear=function(){this.clear=!0},e.prototype.requestClearAll=function(){this.clearAll=!0},e.prototype.combine=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(0,l.throwOnNullOrEmptyArray)(t,"requests");for(var i=new e(this.clear,this.clearAll),r=0,o=t.concat(this);r<o.length;r++){var a=o[r];a.getReadStorageKeys().length&&i.requestRead.apply(i,a.getReadStorageKeys());for(var s=0,u=Object.keys(a.writes);s<u.length;s++){var c=u[s];i.requestWrite(a.writes[c].Value,a.writes[c].Key)}a.getRemoveStorageKeys().length&&i.requestRemove.apply(i,a.getRemoveStorageKeys())}return i},e.prototype.valueToBeWritten=function(e){(0,l.throwOnNullOrUndefined)(e,"key");var t=this.writes[e.toString()];if(null==t)throw new r.Pp("Cannot read key without value.",-2002);return t.Value},e.prototype.isRemoveRequested=function(e){return(0,l.throwOnNullOrUndefined)(e,"key"),e.toString()in this.removes},e.prototype.isClearRequested=function(){return this.clear},e.prototype.isClearAllRequested=function(){return this.clearAll},e.prototype.toStorageServerJsonRequest=function(){var e={ReadSettings:this.getReadStorageKeys().slice(),WriteSettings:this.getWriteStorageKeyValues().map((function(e){return new p(e.Key,JSON.stringify(e.Value))}))};return new d({},e)},e.prototype.toStorageDataRequest=function(e){return{UserId:e,Clear:this.clear,ClearAll:this.clearAll,Reads:this.getReadStorageKeys().map((function(e){return e.toString()})),Writes:this.getWriteStorageKeyValues().map((function(e){return{Key:e.Key.toString(),Value:JSON.stringify(e.Value)}})),Deletes:this.getRemoveStorageKeys().map((function(e){return e.toString()})),RequestType:0}},e}(),g=function(){function e(e){void 0===e&&(e={}),this.values=e}return e.fromStorageSessionResponseData=function(t){l.throwOnNullOrUndefined(t,"data");for(var n=new e({}),i=0,r=Object.keys(t.Reads);i<r.length;i++){var o=r[i],a=new p(c.fromDictionaryKey(o),JSON.parse(t.Reads[o]));n.values[a.Key.toString()]=a.Value}return n},e.fromStorageServerResponseData=function(t){l.throwOnNullOrUndefined(t,"data");for(var n=new e({}),i=0,r=t.Settings;i<r.length;i++){var o=r[i],a=new p(o.Key,JSON.parse(o.Value));n.values[a.Key.toString()]=a.Value}return n},e.prototype.hasKey=function(e){return l.throwOnNullOrUndefined(e,"key"),e.toString()in this.values},e.prototype.value=function(e){if(l.throwOnNullOrUndefined(e,"key"),!(e.toString()in this.values))throw new r.Pp("Key value missing.",-2002);return this.values[e.toString()]},e.prototype.getStorageKeyValues=function(){var e=this;return Object.keys(this.values).map((function(t){return e.values[t]}))},e}(),m=n(49447),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.initializeComponent=function(){this.NotificationsStorage=new u(this.SuiteApi)},t.prototype.createStorageRequest=function(){return this.checkInitialized(),new h},t.prototype.submitStorageRequestToOwaSessionStorage=function(e,t){var n=this;return this.checkInitialized(),new Promise((function(i,o){if(null==e)return o(a.y("request"));n.SuiteApi.Service.owaSessionStorageRequest(e.toStorageDataRequest(n.SuiteApi.Configuration.CurrentUserUpn)).then((function(e){n.checkStorageResponseErrors(e,o)||i(g.fromStorageSessionResponseData(e))})).catch((function(e){r.LU.isCallsBlockedException(e)||(0,m.jl)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,e.errorCode),o(e)})),null!=t&&window.setTimeout((function(){var e=new Error("Session Storage Request Timeout");(0,m.jl)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,-1001),o(e)}),t)}))},t.prototype.isServerStorageEnabled=function(e){return r/* SessionData.Instance.configuration.UserHasExchangeLicense */.es.Instance.configuration.UserHasExchangeLicense||e},t.prototype.readNotificationSettings=function(){return this.checkInitialized(),this.NotificationsStorage.readNotificationSettings()},t.prototype.writeNotificationSettings=function(e){return this.checkInitialized(),this.NotificationsStorage.writeNotificationSettings(e)},t.prototype.checkStorageResponseErrors=function(e,t){var n=e;return n.ClearError,n.WriteError,n.ReadError,null!=n.ResetError&&(t(n.ResetError),!0)},t}(o.V),v=n(88210),S=n(36952),_=n(40218),T=n(27826),C=function(){function e(e){void 0===e&&(e=new h),this.storageRequest=e}return e.prototype.requestRead=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.storageRequest).requestRead.apply(e,t)},e.prototype.requestWrite=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(t=this.storageRequest).requestWrite.apply(t,(0,i.__spreadArrays)([e],n))},e.prototype.toStorageDataRequest=function(e){return this.storageRequest.toStorageDataRequest(e)},e.prototype.requestClear=function(){this.storageRequest.requestClear()},e.prototype.requestClearAll=function(){this.storageRequest.requestClearAll()},e}(),I=function(){function e(e){void 0===e&&(e=void 0),this.value=e}return e.prototype.fromStorageSessionResponseData=function(e){this.storageResponse=g.fromStorageSessionResponseData(e)},e.prototype.hasValue=function(e){return S.vo.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.hasKey(e)&&null!=this.storageResponse.value(e)},e.prototype.getValue=function(e){return S.vo.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.value(e)},e}(),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.initializeComponent=function(){},t.prototype.createWebShellStorageRequest=function(){return this.checkInitialized(),new C},t.prototype.readStorage=function(e,t,n){this.checkInitialized();var i=this.createTokenFactoryRequest(t,e,n,r.FH.GET);return this.useStorage(i)},t.prototype.batchReadStorage=function(e,t,n){this.checkInitialized();var i=this.createTokenFactoryBatchRequest(t,e,n,r.FH.GET);return this.useStorage(i)},t.prototype.writeStorage=function(e,t,n,i){this.checkInitialized();var o=this.createTokenFactoryRequest(t,e,n,r.FH.PUT);return o.body=JSON.stringify(i),this.useStorage(o)},t.prototype.removeStorage=function(e,t,n){this.checkInitialized();var i=this.createTokenFactoryRequest(t,e,n,r.FH.DELETE);return this.useStorage(i)},t.prototype.readSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.writeSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.removeSessionStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.readLocalStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.writeLocalStorage=function(e){return this.checkInitialized(),this.useBrowserStorage(e)},t.prototype.removeLocalStorage=function(e){return Promise.reject(new Error("not implemented"))},t.prototype.createTokenFactoryRequest=function(e,n,i,r){S.vo.throwOnNullOrEmpty(i,"keyName");var o=(0,S.Uw)("{0}/api/storage/{1}/{2}/{3}?api-version={4}&shellType=OneShell",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,n,encodeURIComponent(i),t.ApiVersion);return this.createTokenFactoryRequestHelper(o,r)},t.prototype.createTokenFactoryBatchRequest=function(e,n,i,r){S.vo.throwOnNullOrEmptyArray(i,"keyNames");var o=(0,S.Uw)("{0}/api/storage/{1}/{2}/{3}?api-version={4}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,n,encodeURIComponent(i.join(",")),t.ApiVersion);return this.createTokenFactoryRequestHelper(o,r)},t.prototype.createTokenFactoryRequestHelper=function(e,t){return{url:e,resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:t,headers:T.A}},t.prototype.useStorage=function(e){var t=this;return new Promise((function(n,i){t.SuiteApi.Service.callEndpointWithOauthToken(e).then((function(e){n(new I(e))})).catch(i)}))},t.prototype.useBrowserStorage=function(e){var t=this;return new Promise((function(n,i){S.vo.throwOnNull(e,"StorageRequest");var o=!1,s=e.toStorageDataRequest(t.SuiteApi.Configuration.CurrentUserUpn),u={url:r.es.Instance.configuration.TokenFactoryIframeOrigin,requestObject:s,timeout:3e4,success:function(e){o=!0;var r=e.responseObject;if(!t.checkStorageResponseErrors(r,i)){var a=new I;a.fromStorageSessionResponseData(r),n(a)}},error:function(e,t,n){o=!0;var r=_.Eu(n);(0,m.jl)().tag("StorageApi_RequestError",6,t,r),i((0,a.p)(r))}},l=null;t.SuiteApi.Service.AreSuiteServiceCallsBlocked||(l=r.Ou.OauthTokenFactoryInstance),null!=l?(setTimeout((function(){if(!o){o=!0;var e=new Error("StorageTimeout");(0,m.jl)().exception("StorageApi_TimeoutError",6,e),i(e)}}),u.timeout),l.executeStorageRequest(u)):i(new r.Pp("OauthTokenFactoryIframe",-1011))}))},t.prototype.checkStorageResponseErrors=function(e,t){var n=e;if(!n){var i=new Error("Empty response received.");(0,m.jl)().exception("StorageApi_NoResponse",6,i),t(i)}if(null!=n.ClearError)t(n.ClearError);else if(null!=n.WriteError)t(n.WriteError);else if(null!=n.ReadError)t(n.ReadError);else{if(null==n.ResetError)return!1;t(n.ResetError)}return!0},t.ApiVersion="1",t}(o.V)},71247:function(e,t){"use strict";
/**
* bond_const.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},96601:function(e,t,n){"use strict";
/**
* microsoft.bond.encoding.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var i=n(91953),r=n(88833),o=n(71486);t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],r=e.length%3,o=0,a=e.length-r;o<a;o+=3){var s=(e[o]<<16)+(e[o+1]<<8)+e[o+2];i.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(r){case 1:s=e[e.length-1];i.push(n.charAt(s>>2)),i.push(n.charAt(s<<4&63)),i.push("==");break;case 2:var u=(e[e.length-2]<<8)+e[e.length-1];i.push(n.charAt(u>>10)),i.push(n.charAt(u>>4&63)),i.push(n.charAt(u<<2&63)),i.push("=")}return i.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},t._Double_GetBytes=function(e){if(o.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],i=0;i<8;++i)n.push(t.getUint8(i));return n}return r.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=i.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,r=n<<1|t>>>31,o=t<<1;2147483648&n&&(r=~r,o=~o);var a=new i.UInt64("0");return a.low=o,a.high=r,a}},88833:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* microsoft.bond.floatutils.ts
* Copyright: Microsoft 2016
*
* This class will be used to convert float/double to byte array on browsers which don't support html5.
*
* Format: IEEE-754, littleEndian, http://en.wikipedia.org/wiki/IEEE_754-1985
*
*  \note
* 1. Don't have negative zero. All zero will be positive zero.
* 2. If the buffer array passed to ConvertArrayToFloat() is actual NaN or Inifinity value,
*    exception will be raised.
*/
var n=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,r=1-i,o=i,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),u=e-s,l=2*(i+2)+n,c=new Array(l),p=0;p<l;)c[p++]=0;for(p=i+2;p&&s;)c[--p]=s%2,s=Math.floor(s/2);for(p=i+1;p<l-1&&u>0;)(u*=2)>=1?(c[++p]=1,--u):c[++p]=0;for(var d=0;d<l&&!c[d];)d++;var f=i+1-d,h=d+n;if(c[h+1]){for(p=h;p>d&&(c[p]=1-c[p],!c);--p);p===d&&++f}if(f>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<r)return t?this._doubleZero:this._floatZero;if(t){var g=0;for(p=0;p<20;++p)g=g<<1|c[++d];for(var m=0;p<52;++p)m=m<<1|c[++d];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(g=a<<31|2147483647&(g|=f+i<<20)),g>>8&255,g>>16&255,g>>>24]}var y=0;for(p=0;p<23;++p)y=y<<1|c[++d];return[255&(y=a<<31|2147483647&(y|=f+i<<23)),y>>8&255,y>>16&255,y>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=n},46532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* microsoft.bond.io.ts
* Copyright: Microsoft 2016
*/
var i=n(91953),r=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(i.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=r},85347:function(e,t,n){"use strict";
/**
* microsoft.bond.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var i=n(71247);t._BondDataType=i._BondDataType;var r=n(96601);t._Encoding=r;var o=n(46532);t.IO=o;var a=n(91953);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=r._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=r._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(r._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=r._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?i._BondDataType._BT_STOP_BASE:i._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=r._Varint_GetBytes(a.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=r._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(a.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},91953:function(e,t){"use strict";
/**
* microsoft.bond.primitives.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=n;var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=i;var r=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=r},71486:function(e,t){"use strict";
/**
* microsoft.bond.utils.ts
* Copyright: Microsoft 2016
*/Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=n},36100:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTClockSkewManager.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var n=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=n},87350:function(e,t){"use strict";
/**
* AWTKillSwitch.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var i=1e3*parseInt(t,10),r=0;r<n.length;++r)this._killedTokenDictionary[n[r]]=Date.now()+i}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=n},93870:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){i.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},i=this,r=0;r<this.listeners.length;++r)n(r)},e.eventsDropped=function(e,t){for(var n=this,i=function(i){r.listeners[i].eventsDropped&&setTimeout((function(){return n.listeners[i].eventsDropped(e,t)}),0)},r=this,o=0;o<this.listeners.length;++o)i(o)},e.eventsRetrying=function(e){for(var t=this,n=function(n){i.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},i=this,r=0;r<this.listeners.length;++r)n(r)},e.eventsRejected=function(e,t){for(var n=this,i=function(i){r.listeners[i].eventsRejected&&setTimeout((function(){return n.listeners[i].eventsRejected(e,t)}),0)},r=this,o=0;o<this.listeners.length;++o)i(o)},e.listeners=[],e}();t.default=n},77400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(81239),r=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===i.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=r},23854:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTRetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var n=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=n},89687:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTSerializer.ts
* @author Brent Erickson (brericks) and Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var i=n(85347),r=n(81239),o=n(93870),a=n(40458),s=2936012,u=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,u=!1,l=new i.IO.MemoryStream,c=new i.CompactBinaryProtocolWriter(l);for(var p in c._WriteFieldBegin(i._BondDataType._BT_MAP,3,null),c._WriteMapContainerBegin(t,i._BondDataType._BT_STRING,i._BondDataType._BT_LIST),e)if(u)n||(n={}),n[p]=e[p],delete e[p];else if(e.hasOwnProperty(p)){c._WriteString(p);var d=e[p];c._WriteContainerBegin(1,i._BondDataType._BT_STRUCT),c._WriteFieldBegin(i._BondDataType._BT_STRING,2,null),c._WriteString("act_default_source"),c._WriteFieldBegin(i._BondDataType._BT_STRING,5,null),c._WriteString(a.newGuid()),c._WriteFieldBegin(i._BondDataType._BT_INT64,6,null),c._WriteInt64(a.numberToBondInt64(Date.now())),c._WriteFieldBegin(i._BondDataType._BT_LIST,8,null);var f=l._GetBuffer().length+1;c._WriteContainerBegin(e[p].length,i._BondDataType._BT_STRUCT);for(var h=l._GetBuffer().length-f,g=0;g<d.length;++g){var m=l._GetBuffer().length;if(this.writeEvent(d[g],c),l._GetBuffer().length-m>s)o.default.eventsRejected([d[g]],r.AWTEventsRejectedReason.SizeLimitExceeded),d.splice(g--,1),l._GetBuffer().splice(m),this._addNewDataPackageSize(d.length,l,h,f);else if(l._GetBuffer().length>s){l._GetBuffer().splice(m),n||(n={}),e[p]=d.splice(0,g),n[p]=d,this._addNewDataPackageSize(e[p].length,l,h,f),u=!0;break}}c._WriteStructEnd(!1)}return c._WriteStructEnd(!1),{payloadBlob:l._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,r){for(var o=i._Encoding._Varint_GetBytes(i.Number._ToUInt32(e)),a=0;a<n;++a){if(!(a<o.length)){t._GetBuffer().slice(r+a,n-a);break}t._GetBuffer()[r+a]=o[a]}},e.writeEvent=function(e,t){t._WriteFieldBegin(i._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(i._BondDataType._BT_INT64,3,null),t._WriteInt64(a.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(i._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(i._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},o=0,s={},u=0,l={},c=0,p={},d=0,f={},h=0,g={},m=0,y={},v=0;for(var S in e.properties){if(e.properties.hasOwnProperty(S))if((T=e.properties[S]).cc>0)y[S]=T,v++;else if(T.pii>0)g[S]=T,m++;else switch(T.type){case r.AWTPropertyType.String:n[S]=T.value,o++;break;case r.AWTPropertyType.Int64:s[S]=T.value,u++;break;case r.AWTPropertyType.Double:l[S]=T.value,c++;break;case r.AWTPropertyType.Boolean:p[S]=T.value,d++;break;case r.AWTPropertyType.Date:f[S]=T.value,h++}}if(o)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(o,i._BondDataType._BT_STRING,i._BondDataType._BT_STRING),n)if(n.hasOwnProperty(S)){var _=n[S];t._WriteString(S),t._WriteString(_.toString())}if(m)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(m,i._BondDataType._BT_STRING,i._BondDataType._BT_STRUCT),g)if(g.hasOwnProperty(S)){var T=g[S];t._WriteString(S),t._WriteFieldBegin(i._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(i._BondDataType._BT_INT32,2,null),t._WriteInt32(T.pii),t._WriteFieldBegin(i._BondDataType._BT_STRING,3,null),t._WriteString(T.value.toString()),t._WriteStructEnd(!1)}if(d)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(d,i._BondDataType._BT_STRING,i._BondDataType._BT_BOOL),p)if(p.hasOwnProperty(S)){_=p[S];t._WriteString(S),t._WriteBool(_)}if(h)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,i._BondDataType._BT_STRING,i._BondDataType._BT_INT64),f)if(f.hasOwnProperty(S)){_=f[S];t._WriteString(S),t._WriteInt64(a.numberToBondInt64(_))}if(u)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(u,i._BondDataType._BT_STRING,i._BondDataType._BT_INT64),s)if(s.hasOwnProperty(S)){_=s[S];t._WriteString(S),t._WriteInt64(a.numberToBondInt64(_))}if(c)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(c,i._BondDataType._BT_STRING,i._BondDataType._BT_DOUBLE),l)if(l.hasOwnProperty(S)){_=l[S];t._WriteString(S),t._WriteDouble(_)}if(v)for(var S in t._WriteFieldBegin(i._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(v,i._BondDataType._BT_STRING,i._BondDataType._BT_STRUCT),y)if(y.hasOwnProperty(S)){T=y[S];t._WriteString(S),t._WriteFieldBegin(i._BondDataType._BT_INT32,1,null),t._WriteInt32(T.cc),t._WriteFieldBegin(i._BondDataType._BT_STRING,2,null),t._WriteString(T.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return i._Encoding._Base64_GetString(e)},e}();t.default=u},53492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTStatsManager.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var i=n(40458),r=n(93870),o=n(81239),a=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,r.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case o.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case o.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==i.StatsApiKey){var r=i.getTenantId(n);this._stats[r]||(this._stats[r]={}),this._stats[r][e]?this._stats[r][e]=this._stats[r][e]+t:this._stats[r][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=a},81239:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},40458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* Utils.ts
* @author  Brent Erickson (brericks) and Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
* File containing utility functions.
*/
var i=n(91953),r=n(81239),o=/[xy]/g,a=null;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var s=a,u=a,l=a;function c(e){return"string"==typeof e}function p(e){return"number"==typeof e}function d(e){return"boolean"==typeof e}function f(e){return e instanceof Date}function h(e){return 1e4*(e+621355968e5)}function g(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function m(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function y(e){return e<10?"0"+e:e.toString()}function v(e){return void 0===e||e===a||""===e}t.numberToBondInt64=function(e){var t=new i.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=c,t.isNumber=p,t.isBoolean=d,t.isDate=f,t.msToTicks=h,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return s===a&&(s="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),s},t.isUint8ArrayAvailable=function(){return u===a&&(u="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!g()),u},t.isPriority=function(e){return!(!p(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||v(n)?a:(v(n.value)&&(n={value:n,type:r.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){if(p(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:r.AWTPropertyType.Unspecified){case r.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return r.AWTPropertyType.String;case"boolean":return r.AWTPropertyType.Boolean;case"number":return r.AWTPropertyType.Double;case"object":return f(e)?r.AWTPropertyType.Date:a}return a}(e);case r.AWTPropertyType.String:return c(e)?t:a;case r.AWTPropertyType.Boolean:return d(e)?t:a;case r.AWTPropertyType.Date:return f(e)&&NaN!==e.getTime()?t:a;case r.AWTPropertyType.Int64:return p(e)&&e%1==0?t:a;case r.AWTPropertyType.Double:return p(e)?t:a}return a}(n.value,n.type),n.type?(f(n.value)&&(n.value=h(n.value.getTime())),n.pii>0&&n.cc>0?a:n.pii?function(e){if(p(e)&&e>=0&&e<=13)return!0;return!1}(n.pii)?n:a:n.cc?function(e){if(p(e)&&e>=0&&e<=1)return!0;return!1}(n.cc)?n:a:n):a)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+y(e.getUTCMonth()+1)+"-"+y(e.getUTCDate())+"T"+y(e.getUTCHours())+":"+y(e.getUTCMinutes())+":"+y(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(l===a){var e=new XMLHttpRequest;l=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return l},t.useFetchRequest=function(){return g()||m()},t.isReactNative=g,t.isServiceWorkerGlobalScope=m},9440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTAutoCollection.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var i=n(40458),r="MicrosoftApplicationsTelemetryDeviceId",o="MicrosoftApplicationsTelemetryFirstLaunchTime",a="MSIE",s="Chrome",u="Firefox",l="Safari",c="Edge",p="Electron",d="SkypeShell",f="PhantomJS",h="Opera",g="Windows",m="Mac OS X",y="Windows Phone",v="Windows RT",S="iOS",_="Android",T="Linux",C="Chrome OS",I=/(windows|win32)/i,w=/ arm;/i,b=/windows\sphone\s\d+\.\d+/i,A=/(macintosh|mac os x)/i,D=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,P=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,O=/android/i,x=/CrOS/i,E={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},k="([\\d,.]+)",R="Unknown",L="undefined",U=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||typeof navigator===L||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(r),void this._deleteCookie(o);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(r),n=this._getData(o);t!==e&&(n=i.getISOString(new Date)),this._saveData(r,e),this._saveData(o,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(r);e||(e=i.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){typeof document!==L&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),typeof navigator!==L&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,i="+";n>0&&(i="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(i+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?h:this._userAgentContainsString(f,e)?f:this._userAgentContainsString(c,e)||this._userAgentContainsString("Edg",e)?c:this._userAgentContainsString(p,e)?p:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?a:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(l,e)?l:this._userAgentContainsString(d,e)?d:R},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=i.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===a)return this._getIeVersion(e);if(t===c){var n=this._getOtherVersion(t,e);return n===R?this._getOtherVersion("Edg",e):n}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(a+" "+k));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===l&&(e="Version");var n=t.match(new RegExp(e+"/"+k));return n?n[1]:R},e._getOsName=function(e){return e.match(b)?y:e.match(w)?v:e.match(D)?S:e.match(O)?_:e.match(P)?T:e.match(A)?m:e.match(I)?g:e.match(x)?C:R},e._getOsVersion=function(e,t){return t===g?this._getGenericOsVersion(e,"Windows NT"):t===_?this._getGenericOsVersion(e,t):t===m?this._getMacOsxVersion(e):R},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" "+k));return n?E[n[1]]?E[n[1]]:n[1]:R},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(m+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var i=this._getDelimiter(n);return i?n.split(i)[0]:n}}return R},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var i="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+i}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n],r=0;" "===i.charAt(r);)r++;if(0===(i=i.substring(r)).indexOf(e))return i.substring(e.length,i.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable=typeof document!==L&&typeof document.cookie!==L,e}();t.default=U},10392:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTEventProperties.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var i=n(40458),r=n(81239),o=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified);var o={value:t,type:n,pii:r.AWTPiiKind.NotSet,cc:r.AWTCustomerContentKind.NotSet};null!==(o=i.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:n,cc:r.AWTCustomerContentKind.NotSet};null!==(a=i.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:r.AWTPiiKind.NotSet,cc:n};null!==(a=i.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=o},28674:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(81239),r=n(89687),o=n(23854),a=n(87350),s=n(36100),u=n(15441),l=n(40458),c=n(93870),p=n(91493),d="POST",f=function(){function e(e,t,n,i,r){var o=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=i,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+u.FullVersionString,this._killSwitch=new a.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(r),l.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!l.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,i,r,a){try{if(l.useFetchRequest())fetch(e,{body:t,method:d}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),r(e.status,t)})).catch((function(e){i(0,{})}));else if(l.useXDomainRequest()){var s=new XDomainRequest;s.open(d,e),s.onload=function(){r(200,null)},s.onerror=function(){i(400,null)},s.ontimeout=function(){n(500,null)},s.send(t)}else{var u=new XMLHttpRequest;u.open(d,e,!a),u.onload=function(){r(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.onerror=function(){i(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.ontimeout=function(){n(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.send(t)}}catch(e){i(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&p.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=i.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,o){var a=this;void 0===o&&(o=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,u="";for(var p in e)e.hasOwnProperty(p)&&(this._killSwitch.isTenantKilled(p)?(c.default.eventsRejected(e[p],i.AWTEventsRejectedReason.KillSwitch),delete e[p]):(u.length>0&&(u+=","),u+=p,s++));if(s>0){var d=r.default.getPayloadBlob(e,s);d.remainingRequest&&this._requestQueue.push(d.remainingRequest);var f=this._urlString+"&x-apikey="+u+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var p in h=l.isUint8ArrayAvailable()?new Uint8Array(d.payloadBlob):r.default.base64Encode(d.payloadBlob),e)if(e.hasOwnProperty(p))for(var g=0;g<e[p].length;++g)e[p][g].sendAttempt>0?e[p][g].sendAttempt++:e[p][g].sendAttempt=1;if(this._useBeacons&&n&&l.isBeaconsSupported()&&navigator.sendBeacon(f,h))return;this._httpInterface.sendPOST(f,h,(function(i,r){a._retryRequestIfNeeded(i,r,e,s,u,t,n,o)}),(function(i,r){a._retryRequestIfNeeded(i,r,e,s,u,t,n,o)}),(function(i,r){a._retryRequestIfNeeded(i,r,e,s,u,t,n,o)}),n||o)}else n||this._handleRequestFinished(!1,{},n,o)}catch(e){this._handleRequestFinished(!1,{},n,o)}},e.prototype._retryRequestIfNeeded=function(e,t,n,r,a,s,u,l){var d=this,f=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var g=0;g<h.length;++g)c.default.eventsRejected(n[h[g]],i.AWTEventsRejectedReason.KillSwitch),delete n[h[g]],r--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,u,l);(!o.default.shouldRetryForStatus(e)||r<=0)&&(f=!1)}if(f)if(l)this._activeConnections--,n[a][0].priority=i.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(s<1){for(var m in n)n.hasOwnProperty(m)&&c.default.eventsRetrying(n[m]);setTimeout((function(){return d._sendRequest(n,s+1,!1)}),o.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,p.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,u,l)},e.prototype._handleRequestFinished=function(e,t,n,r){for(var o in e&&p.default.clearBackOff(),t)t.hasOwnProperty(o)&&(e?c.default.eventsSent(t[o]):c.default.eventsDropped(t[o],i.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,r||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),i=0;i<n.length;++i){var r=n[i].split(": ");t[r[0]]=r[1]}return t},e}();t.default=f},21647:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(81239),r=n(4224),o=n(62505),a=n(48177),s=n(91493),u=n(93870),l=n(9440),c=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,o.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(o.default.sessionEnabled=!1),l.default.addPropertyStorageOverride(this._config.propertyStorageOverride),l.default.autoCollect(o.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),o.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(r.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return o.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(r.AWTSessionState.Ended),s.default.flushAndTeardown(),o.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithPii(e,t,n,r)},e.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,r)},e.getLogger=function(e){var t=e;return t&&t!==o.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new a.default(t)),this._loggers[t]},e.addNotificationListener=function(e){u.default.addNotificationListener(e)},e.removeNotificationListener=function(e){u.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=c},62505:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTLogManagerSettings.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var i=n(10392),r=n(89259),o=function(){function e(){}return e.logManagerContext=new i.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new r.default(!0,e.logManagerContext),e}();t.default=o},48177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTLogger.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var i=n(81239),r=n(4224),o=n(10392),a=n(40458),s=n(53492),u=n(93870),l=n(91493),c=n(62505),p=n(15441),d=n(89259),f=n(9440),h=function(){function e(e){this._apiKey=e,this._contextProperties=new o.default,this._semanticContext=new d.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,r)},e.prototype.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,r)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(c.default.loggingEnabled){this._apiKey||(this._apiKey=c.default.defaultTenantToken,this._createInitId());var n=!0;a.isString(t)?t={name:t}:t instanceof o.default&&(t=t.getEvent(),n=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(c.default.sessionEnabled){var o={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(o,n),o.priority=i.AWTEventPriority.High,t===r.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=a.newGuid(),this.setContext("Session.Id",this._sessionId),o.properties["Session.State"]="Started"}else{if(t!==r.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.properties["Session.Id"]=this._sessionId,o.properties["Session.State"]="Ended",o.properties["Session.Duration"]=s.toString(),o.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}o.properties["Session.FirstLaunchTime"]=f.default.firstLaunchTime,this.logEvent(o)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,r,o,a){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,a),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,r&&(s.properties["Failure.Category"]=r),o&&(s.properties["Failure.Id"]=o),s.priority=i.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,i,r,o,a){if(t&&n){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,a),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=n,i&&(s.properties["PageView.Category"]=i),r&&(s.properties["PageView.Uri"]=r),o&&(s.properties["PageView.ReferrerUri"]=o),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=a.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof o.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&a.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(a.EventNameDotRegex,"_"),e.type&&a.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",a.EventNameAndTypeRegex.test(e.name)&&a.EventNameAndTypeRegex.test(e.type)?((!a.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,c.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",p.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),a.isPriority(e.priority)||(e.priority=i.AWTEventPriority.Normal),this._sendEvent(e)):u.default.eventsRejected([e],i.AWTEventsRejectedReason.InvalidEvent)):u.default.eventsRejected([e],i.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:i.AWTPiiKind.NotSet,type:i.AWTPropertyType.String}},e._sendEvent=function(e){l.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var i in e.properties)e.properties.hasOwnProperty(i)&&(e.properties[i]=a.sanitizeProperty(i,e.properties[i]),null===e.properties[i]&&delete e.properties[i]);var r=e;return r.id=a.newGuid(),r.apiKey=t,r},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},26610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(81239),r=n(28674),o=n(91493),a=n(77400),s=n(93870),u=n(40458),l=function(){function e(e,t,n,o){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[i.AWTEventPriority.High]=[],this._inboundQueues[i.AWTEventPriority.Normal]=[],this._inboundQueues[i.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new a.default(this._outboundQueue,500),this._httpManager=new r.default(this._outboundQueue,e,this,n,o)}return e.prototype.addEvent=function(e){u.isPriority(e.priority)||(e.priority=i.AWTEventPriority.Normal),e.priority===i.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],i.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[i.AWTEventPriority.High][0].length>0||this._inboundQueues[i.AWTEventPriority.Normal][0].length>0||this._inboundQueues[i.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):s.default.eventsDropped([e[t][n]],i.AWTEventsDroppedReason.MaxRetryLimit);o.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(i.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this._shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[i.AWTEventPriority.High][0].length+this._inboundQueues[i.AWTEventPriority.Normal][0].length+this._inboundQueues[i.AWTEventPriority.Low][0].length,this._inboundQueues[i.AWTEventPriority.High][0]=[],this._inboundQueues[i.AWTEventPriority.Normal][0]=[],this._inboundQueues[i.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[i.AWTEventPriority.High].shift(),this._inboundQueues[i.AWTEventPriority.Normal].shift(),this._inboundQueues[i.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[i.AWTEventPriority.High].push([]),this._inboundQueues[i.AWTEventPriority.Normal].push([]),this._inboundQueues[i.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=i.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],i.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=i.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(i.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&o.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=l},89259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9440),r=n(81239),o=n(4224),a="UserInfo.IdType",s="DeviceInfo.BrowserName",u="DeviceInfo.BrowserVersion",l=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(i.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.getDeviceBrowserName=function(){var e=this._properties.getPropertyMap()[s];return e?e.value.toString():""},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext(s,e)},e.prototype.getDeviceBrowserVersion=function(){var e=this._properties.getPropertyMap()[u];return e?e.value.toString():""},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext(u,e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext(a,n.toString());else{var i=void 0;switch(t){case r.AWTPiiKind.SipAddress:i=o.AWTUserIdType.SipAddress;break;case r.AWTPiiKind.PhoneNumber:i=o.AWTUserIdType.PhoneNumber;break;case r.AWTPiiKind.SmtpAddress:i=o.AWTUserIdType.EmailAddress;break;default:i=o.AWTUserIdType.Unknown}this._addContext(a,i.toString())}if(isNaN(t)||null===t||t===r.AWTPiiKind.NotSet||t>13)switch(n){case o.AWTUserIdType.Skype:t=r.AWTPiiKind.Identity;break;case o.AWTUserIdType.EmailAddress:t=r.AWTPiiKind.SmtpAddress;break;case o.AWTUserIdType.PhoneNumber:t=r.AWTPiiKind.PhoneNumber;break;case o.AWTUserIdType.SipAddress:t=r.AWTPiiKind.SipAddress;break;default:t=r.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=l},6438:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(91493),r=function(){function e(){}return e.setEventsHandler=function(e){i.default.setEventsHandler(e)},e.getEventsHandler=function(){return i.default.getEventsHandler()},e.scheduleTimer=function(){i.default.scheduleTimer()},e}();t.default=r},91493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
* AWTTransmissionManagerCore.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
*/
var i=n(49085),r=n(81239),o=n(26610),a=n(53492),s=n(10392),u=n(21647),l=n(40458),c="awt_stats",p=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new o.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),a.default.initialize((function(e,n){if(t._config.canSendStatEvent(c)){var i=new s.default(c);for(var o in i.setEventPriority(r.AWTEventPriority.High),i.setProperty("TenantId",n),e)e.hasOwnProperty(o)&&i.setProperty(o,e[o].toString());u.default.getLogger(l.StatsApiKey).logEvent(i)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var i=n;i>=0;--i)e[t][i]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var r=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(r)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===r.AWTEventPriority.Immediate_sync&&(e.priority=r.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){a.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=i.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=r.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=r.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=r.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[i.AWT_REAL_TIME]=[4,2,1],this._profiles[i.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[i.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=i.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=p},36076:function(e,t,n){"use strict";
/**
* AriaSDK.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2017
* File to export public classes, interfaces and enums.
*/
var i=n(81239);i.AWTPropertyType,t.uO=i.AWTPiiKind,i.AWTEventPriority,i.AWTEventsDroppedReason,i.AWTEventsRejectedReason,i.AWTCustomerContentKind;var r=n(4224);r.AWTUserIdType,t.D=r.AWTSessionState;var o=n(49085);o.AWT_BEST_EFFORT,t.on=o.AWT_NEAR_REAL_TIME,o.AWT_REAL_TIME;var a=n(10392);t.hh=a.default;var s=n(48177);t.bC=s.default;var u=n(21647);t.CT=u.default,n(6438).default,n(89687).default,n(89259).default,t.M6="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.Zd="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.fY="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.Ls="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.mB="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.cv="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.Pj="https://tb.pipe.aria.microsoft.com/Collector/3.0"},49085:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},4224:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},15441:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),
/**
* Version.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
* File for SDK version.
*/
t.Version="1.8.9",t.FullVersionString="AWT-Web-JS-"+t.Version},2403:function(e,t,n){(t=e.exports=n(23645)(!1)).push([e.id,'.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;border:1px solid hsla(0,0%,100%,0);box-shadow:0 1px 2px 0 rgba(0,0,0,.1);box-sizing:border-box;width:276px;padding-left:0;align-items:flex-start;margin:0 0 17px 16px}html[dir=rtl] .o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z{margin-left:0;margin-right:16px}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.1);box-shadow:0 8px 16px 0 rgba(0,0,0,.1)}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>button{min-width:30px;width:30px;height:36px;padding-left:10px;padding-right:10px;background-color:transparent;border:none;align-items:flex-start;cursor:pointer}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-ms-clear{display:none}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-cancel-button,.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-decoration,.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-results-button,.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z>input::-webkit-search-results-decoration{-webkit-appearance:none;display:none}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z ._2q8vctlvAB-f5fJQsrttcm{width:250px;height:32px;background:transparent;align-items:flex-start;border:none;display:block;font:13px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;text-overflow:ellipsis;padding-left:5px;cursor:pointer;outline:none;margin:.1em}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z ._2q8vctlvAB-f5fJQsrttcm:-internal-autofill-selected{background-color:transparent!important}.o365cs-base ._1Fcbxg1PZKNlfmnlw5wn_Z:focus{cursor:text}.o365cs-base ._18OevI2YxDgskrFdnDk1GA{margin:0 0 5px 16px}',""]),t.locals={SearchControl:"_1Fcbxg1PZKNlfmnlw5wn_Z",inputBox:"_2q8vctlvAB-f5fJQsrttcm",SearchControlZoomMargin:"_18OevI2YxDgskrFdnDk1GA"}},44341:function(e,t,n){(t=e.exports=n(23645)(!1)).push([e.id,'.o365cs-base ._2IVH-yKibpaBKTUTMsCAXW{position:absolute}.o365cs-base ._2IVH-yKibpaBKTUTMsCAXW ._3CyDPIDunf-mdxvaEXDOuM{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:16px;height:16px;line-height:15px;border-radius:1em;box-sizing:border-box;text-align:center}',""]),t.locals={unseenitems:"_2IVH-yKibpaBKTUTMsCAXW",unseenCount:"_3CyDPIDunf-mdxvaEXDOuM"}},42226:function(e,t,n){(t=e.exports=n(23645)(!1)).push([e.id,'._22TDZKfd8po04Ubj0xsW9l{display:block}._3ULy8C7ufHr_RwpL9zRMe3{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.S40eQ7RniUA3-WTWmj-z1{font-family:SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:600}.lrkLSOxXMbvez0pu7_yIi{font-family:SegoeUI-Light-final,Segoe UI Light,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}._3fVHvn0UHaxT0PpiF8GdnD{font-family:SegoeUI-SemiLight-final,Segoe UI Semilight,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}._1hfKJFEPrttZEl-210qHVZ{font-family:Arial,SegoeUI-Regular-final,Segoe UI,Segoe,Tahoma,Helvetica,sans-serif}',""]),t.locals={displayBlock:"_22TDZKfd8po04Ubj0xsW9l",segoeRegular:"_3ULy8C7ufHr_RwpL9zRMe3",segoeSemibold:"S40eQ7RniUA3-WTWmj-z1",segoeLight:"lrkLSOxXMbvez0pu7_yIi",segoeSemiLight:"_3fVHvn0UHaxT0PpiF8GdnD",arialRegular:"_1hfKJFEPrttZEl-210qHVZ"}},35846:function(e,t,n){(t=e.exports=n(23645)(!1)).push([e.id,"._2uADMJLObqU6-D8E2WMFGs{height:calc(100vh - 115px)}._2FUcIOFrpfKDLRAOeLwVBq{height:calc(100vh - 113px)}._2tOq8gUtSMT8ioGkuRDJ2y{height:calc(100vh - 73px)}",""]),t.locals={flexPaneContentContainer:"_2uADMJLObqU6-D8E2WMFGs",flexPaneContentContainerForThinHeader:"_2FUcIOFrpfKDLRAOeLwVBq",flexPaneContentContainerForShyHeader:"_2tOq8gUtSMT8ioGkuRDJ2y"}},87507:function(e,t,n){(t=e.exports=n(23645)(!1)).push([e.id,'._2fepbX3lMhlNbWhda-NpPt{font-family:ShellFabricMDL2IconsLite,ShellFabricMDL2Icons;line-height:1}._2fepbX3lMhlNbWhda-NpPt .o365cs-base [class*=" ms-Icon--"]:before,._2fepbX3lMhlNbWhda-NpPt .o365cs-base [class^=ms-Icon--]:before{font-family:inherit}.IBLY0F7ZnVavg0dPoF6Xe,.SfEVBSJxpboOJ7hk3TGrV{height:100%}',""]),t.locals={customHeaderButton:"_2fepbX3lMhlNbWhda-NpPt",customHeaderButtonsContainer:"IBLY0F7ZnVavg0dPoF6Xe",customHeaderButtonWrapper:"SfEVBSJxpboOJ7hk3TGrV"}},38689:function(e,t,n){(t=e.exports=n(23645)(!1)).push([e.id,"._18Wa9NhGvSPa8YM3XGsyAk,._20G8i4pj8np9WEPbwGQx8D{-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1)}.Ihgs_qQEHyIRBdeOPH9mY,._3jgcXZoldA7BNi00q9XlE9{width:100%;height:8px;visibility:hidden;display:none}._3jgcXZoldA7BNi00q9XlE9{background:transparent;cursor:pointer}._3jgcXZoldA7BNi00q9XlE9:hover{opacity:.4;background:#404040}._3vj3UeTtRA7c6EIC56t6j1{position:absolute;left:47.81%;right:47.81%;border-radius:6px;width:14px;height:2px;align-self:center;pointer-events:none}._3X64oCcCxE8F2x9HwerOe3{-webkit-animation-name:headerSlideInFrames;animation-name:headerSlideInFrames}._3A7N0wqrn89bSiVx66V_9n{-webkit-animation-name:headerSlideOutFrames;animation-name:headerSlideOutFrames}._1EOhrQrF_MCEBXzSuYAtMn{-webkit-animation-name:workloadDivSlideInFrames;animation-name:workloadDivSlideInFrames;animation-fill-mode:forwards}.bkpL3WQBjeVDK6fWzuvAC{-webkit-animation-name:workloadDivSlideOutFrames;animation-name:workloadDivSlideOutFrames;animation-fill-mode:forwards}@-webkit-keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@-webkit-keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@-webkit-keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}@keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}",""]),t.locals={headerAnimations:"_18Wa9NhGvSPa8YM3XGsyAk",workloadDivAnimations:"_20G8i4pj8np9WEPbwGQx8D",shyHeader:"Ihgs_qQEHyIRBdeOPH9mY",shyHeaderOverlay:"_3jgcXZoldA7BNi00q9XlE9",shyHeaderGripper:"_3vj3UeTtRA7c6EIC56t6j1",headerSlideIn:"_3X64oCcCxE8F2x9HwerOe3",headerSlideOut:"_3A7N0wqrn89bSiVx66V_9n",workloadDivSlideIn:"_1EOhrQrF_MCEBXzSuYAtMn",workloadDivSlideOut:"bkpL3WQBjeVDK6fWzuvAC"}},48116:function(e,t,n){"use strict";var i;function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(o){var a,s,u,l=arguments,c=(a=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,s=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,u=/[^-+\dA-Z]/g,function(e,t,n,i){if(1!==l.length||"string"!==g(e)||/\d/.test(e)||(t=e,e=void 0),(e=e||0===e?e:new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var r=(t=String(c.masks[t]||t||c.masks.default)).slice(0,4);"UTC:"!==r&&"GMT:"!==r||(t=t.slice(4),n=!0,"GMT:"===r&&(i=!0));var o=function(){return n?"getUTC":"get"},m=function(){return e[o()+"Date"]()},y=function(){return e[o()+"Day"]()},v=function(){return e[o()+"Month"]()},S=function(){return e[o()+"FullYear"]()},_=function(){return e[o()+"Hours"]()},T=function(){return e[o()+"Minutes"]()},C=function(){return e[o()+"Seconds"]()},I=function(){return e[o()+"Milliseconds"]()},w=function(){return n?0:e.getTimezoneOffset()},b=function(){return f(e)},A={d:function(){return m()},dd:function(){return p(m())},ddd:function(){return c.i18n.dayNames[y()]},DDD:function(){return d({y:S(),m:v(),d:m(),_:o(),dayName:c.i18n.dayNames[y()],short:!0})},dddd:function(){return c.i18n.dayNames[y()+7]},DDDD:function(){return d({y:S(),m:v(),d:m(),_:o(),dayName:c.i18n.dayNames[y()+7]})},m:function(){return v()+1},mm:function(){return p(v()+1)},mmm:function(){return c.i18n.monthNames[v()]},mmmm:function(){return c.i18n.monthNames[v()+12]},yy:function(){return String(S()).slice(2)},yyyy:function(){return p(S(),4)},h:function(){return _()%12||12},hh:function(){return p(_()%12||12)},H:function(){return _()},HH:function(){return p(_())},M:function(){return T()},MM:function(){return p(T())},s:function(){return C()},ss:function(){return p(C())},l:function(){return p(I(),3)},L:function(){return p(Math.floor(I()/10))},t:function(){return _()<12?c.i18n.timeNames[0]:c.i18n.timeNames[1]},tt:function(){return _()<12?c.i18n.timeNames[2]:c.i18n.timeNames[3]},T:function(){return _()<12?c.i18n.timeNames[4]:c.i18n.timeNames[5]},TT:function(){return _()<12?c.i18n.timeNames[6]:c.i18n.timeNames[7]},Z:function(){return i?"GMT":n?"UTC":(String(e).match(s)||[""]).pop().replace(u,"").replace(/GMT\+0000/g,"UTC")},o:function(){return(w()>0?"-":"+")+p(100*Math.floor(Math.abs(w())/60)+Math.abs(w())%60,4)},p:function(){return(w()>0?"-":"+")+p(Math.floor(Math.abs(w())/60),2)+":"+p(Math.floor(Math.abs(w())%60),2)},S:function(){return["th","st","nd","rd"][m()%10>3?0:(m()%100-m()%10!=10)*m()%10]},W:function(){return b()},WW:function(){return p(b())},N:function(){return h(e)}};return t.replace(a,(function(e){return e in A?A[e]():e.slice(1,e.length-1)}))});c.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},c.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]};var p=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},d=function(e){var t=e.y,n=e.m,i=e.d,r=e._,o=e.dayName,a=e.short,s=void 0!==a&&a,u=new Date,l=new Date;l.setDate(l[r+"Date"]()-1);var c=new Date;c.setDate(c[r+"Date"]()+1);return u[r+"FullYear"]()===t&&u[r+"Month"]()===n&&u[r+"Date"]()===i?s?"Tdy":"Today":l[r+"FullYear"]()===t&&l[r+"Month"]()===n&&l[r+"Date"]()===i?s?"Ysd":"Yesterday":c[r+"FullYear"]()===t&&c[r+"Month"]()===n&&c[r+"Date"]()===i?s?"Tmw":"Tomorrow":o},f=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var i=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-i);var r=(t-n)/6048e5;return 1+Math.floor(r)},h=function(e){var t=e.getDay();return 0===t&&(t=7),t},g=function(e){return null===e?"null":void 0===e?"undefined":"object"!==r(e)?r(e):Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()};void 0===(i=function(){return c}.call(t,n,t,e))||(e.exports=i)}(void 0)},3798:function(e,t,n){var i=n(2403);"string"==typeof i&&(i=[[e.id,i,""]]);n(14246)(i,{});i.locals&&(e.exports=i.locals)},70152:function(e,t,n){var i=n(44341);"string"==typeof i&&(i=[[e.id,i,""]]);n(14246)(i,{});i.locals&&(e.exports=i.locals)},50591:function(e,t,n){var i=n(42226);"string"==typeof i&&(i=[[e.id,i,""]]);n(14246)(i,{});i.locals&&(e.exports=i.locals)},50074:function(e,t,n){var i=n(35846);"string"==typeof i&&(i=[[e.id,i,""]]);n(14246)(i,{});i.locals&&(e.exports=i.locals)},84597:function(e,t,n){var i=n(87507);"string"==typeof i&&(i=[[e.id,i,""]]);n(14246)(i,{});i.locals&&(e.exports=i.locals)},45003:function(e,t,n){var i=n(38689);"string"==typeof i&&(i=[[e.id,i,""]]);n(14246)(i,{});i.locals&&(e.exports=i.locals)},24443:function(e){"use strict";e.exports=JSON.parse('[{"Locale":"af-NA","DisplayName":"Afrikaans (Namibië)‎"},{"Locale":"af-ZA","DisplayName":"Afrikaans (Suid-Afrika)‎"},{"Locale":"am-ET","DisplayName":"አማርኛ (ኢትዮጵያ)‎"},{"Locale":"ar-AE","DisplayName":"العربية (الإمارات العربية المتحدة)‏"},{"Locale":"ar-BH","DisplayName":"العربية (البحرين)‏"},{"Locale":"ar-DJ","DisplayName":"العربية (جيبوتي)‏"},{"Locale":"ar-DZ","DisplayName":"العربية (الجزائر)‏"},{"Locale":"ar-EG","DisplayName":"العربية (مصر)‏"},{"Locale":"ar-ER","DisplayName":"العربية (إريتريا)‏"},{"Locale":"ar-IL","DisplayName":"العربية (إسرائيل)‏"},{"Locale":"ar-IQ","DisplayName":"العربية (العراق)‏"},{"Locale":"ar-JO","DisplayName":"العربية (الأردن)‏"},{"Locale":"ar-KM","DisplayName":"العربية (جزر القمر)‏"},{"Locale":"ar-KW","DisplayName":"العربية (الكويت)‏"},{"Locale":"ar-LB","DisplayName":"العربية (لبنان)‏"},{"Locale":"ar-LY","DisplayName":"العربية (ليبيا)‏"},{"Locale":"ar-MA","DisplayName":"العربية (المملكة المغربية)‏"},{"Locale":"ar-MR","DisplayName":"العربية (موريتانيا)‏"},{"Locale":"ar-OM","DisplayName":"العربية (عمان)‏"},{"Locale":"ar-PS","DisplayName":"العربية (السلطة الفلسطينية)‏"},{"Locale":"ar-QA","DisplayName":"العربية (قطر)‏"},{"Locale":"ar-SA","DisplayName":"العربية (المملكة العربية السعودية)‏"},{"Locale":"ar-SO","DisplayName":"العربية (الصومال)‏"},{"Locale":"ar-SS","DisplayName":"العربية (جنوب السودان)‏"},{"Locale":"ar-TD","DisplayName":"العربية (تشاد)‏"},{"Locale":"ar-TN","DisplayName":"العربية (تونس)‏"},{"Locale":"as-IN","DisplayName":"অসমীয়া (ভাৰত)‎"},{"Locale":"az-Latn-AZ","DisplayName":"azərbaycan (Azərbaycan)‎"},{"Locale":"be-BY","DisplayName":"Беларуская (Беларусь)‎"},{"Locale":"bg-BG","DisplayName":"български (България)‎"},{"Locale":"bn-BD","DisplayName":"বাংলা (বাংলাদেশ)‎"},{"Locale":"bn-IN","DisplayName":"বাংলা (ভারত)‎"},{"Locale":"bs-Latn-BA","DisplayName":"bosanski (Bosna i Hercegovina)‎"},{"Locale":"ca-AD","DisplayName":"català (Andorra)‎"},{"Locale":"ca-ES","DisplayName":"català (català)‎"},{"Locale":"ca-FR","DisplayName":"català (França)‎"},{"Locale":"ca-IT","DisplayName":"català (Itàlia)‎"},{"Locale":"cs-CZ","DisplayName":"čeština (Česko)‎"},{"Locale":"cy-GB","DisplayName":"Cymraeg (Y Deyrnas Unedig)‎"},{"Locale":"da-DK","DisplayName":"dansk (Danmark)‎"},{"Locale":"da-GL","DisplayName":"dansk (Grønland)‎"},{"Locale":"de-AT","DisplayName":"Deutsch (Österreich)‎"},{"Locale":"de-BE","DisplayName":"Deutsch (Belgien)‎"},{"Locale":"de-CH","DisplayName":"Deutsch (Schweiz)‎"},{"Locale":"de-DE","DisplayName":"Deutsch (Deutschland)‎"},{"Locale":"de-IT","DisplayName":"Deutsch (Italien)‎"},{"Locale":"de-LI","DisplayName":"Deutsch (Liechtenstein)‎"},{"Locale":"de-LU","DisplayName":"Deutsch (Luxemburg)‎"},{"Locale":"el-CY","DisplayName":"Ελληνικά (Κύπρος)‎"},{"Locale":"el-GR","DisplayName":"Ελληνικά (Ελλάδα)‎"},{"Locale":"en-GB","DisplayName":"English (United Kingdom)‎"},{"Locale":"es-AR","DisplayName":"español (Argentina)‎"},{"Locale":"es-BO","DisplayName":"español (Bolivia)‎"},{"Locale":"es-BR","DisplayName":"español (Brasil)‎"},{"Locale":"es-BZ","DisplayName":"español (Belice)‎"},{"Locale":"es-CL","DisplayName":"español (Chile)‎"},{"Locale":"es-CO","DisplayName":"español (Colombia)‎"},{"Locale":"es-CR","DisplayName":"español (Costa Rica)‎"},{"Locale":"es-CU","DisplayName":"español (Cuba)‎"},{"Locale":"es-DO","DisplayName":"español (República Dominicana)‎"},{"Locale":"es-EC","DisplayName":"español (Ecuador)‎"},{"Locale":"es-ES","DisplayName":"español (España, alfabetización internacional)‎"},{"Locale":"es-GQ","DisplayName":"español (Guinea Ecuatorial)‎"},{"Locale":"es-GT","DisplayName":"español (Guatemala)‎"},{"Locale":"es-HN","DisplayName":"español (Honduras)‎"},{"Locale":"es-MX","DisplayName":"español (México)‎"},{"Locale":"es-NI","DisplayName":"español (Nicaragua)‎"},{"Locale":"es-PA","DisplayName":"español (Panamá)‎"},{"Locale":"es-PE","DisplayName":"español (Perú)‎"},{"Locale":"es-PH","DisplayName":"español (Filipinas)‎"},{"Locale":"es-PR","DisplayName":"español (Puerto Rico)‎"},{"Locale":"es-PY","DisplayName":"español (Paraguay)‎"},{"Locale":"es-SV","DisplayName":"español (El Salvador)‎"},{"Locale":"es-US","DisplayName":"español (Estados Unidos)‎"},{"Locale":"es-UY","DisplayName":"español (Uruguay)‎"},{"Locale":"es-VE","DisplayName":"español (Venezuela)‎"},{"Locale":"et-EE","DisplayName":"eesti (Eesti)‎"},{"Locale":"eu-ES","DisplayName":"euskara (euskara)‎"},{"Locale":"fa-IR","DisplayName":"فارسی (ایران)‏"},{"Locale":"fi-FI","DisplayName":"suomi (Suomi)‎"},{"Locale":"fil-PH","DisplayName":"Filipino (Pilipinas)‎"},{"Locale":"fr-BE","DisplayName":"français (Belgique)‎"},{"Locale":"fr-BF","DisplayName":"français (Burkina Faso)‎"},{"Locale":"fr-BI","DisplayName":"français (Burundi)‎"},{"Locale":"fr-BJ","DisplayName":"français (Bénin)‎"},{"Locale":"fr-BL","DisplayName":"français (Saint-Barthélemy)‎"},{"Locale":"fr-CA","DisplayName":"français (Canada)‎"},{"Locale":"fr-CF","DisplayName":"français (République centrafricaine)‎"},{"Locale":"fr-CG","DisplayName":"français (Congo)‎"},{"Locale":"fr-CH","DisplayName":"français (Suisse)‎"},{"Locale":"fr-CI","DisplayName":"français (Côte d’Ivoire)‎"},{"Locale":"fr-CM","DisplayName":"français (Cameroun)‎"},{"Locale":"fr-DJ","DisplayName":"français (Djibouti)‎"},{"Locale":"fr-DZ","DisplayName":"français (Algérie)‎"},{"Locale":"fr-FR","DisplayName":"français (France)‎"},{"Locale":"fr-GA","DisplayName":"français (Gabon)‎"},{"Locale":"fr-GF","DisplayName":"français (Guyane française)‎"},{"Locale":"fr-GN","DisplayName":"français (Guinée)‎"},{"Locale":"fr-GP","DisplayName":"français (Guadeloupe)‎"},{"Locale":"fr-GQ","DisplayName":"français (Guinée équatoriale)‎"},{"Locale":"fr-HT","DisplayName":"français (Haïti)‎"},{"Locale":"fr-KM","DisplayName":"français (Comores)‎"},{"Locale":"fr-LU","DisplayName":"français (Luxembourg)‎"},{"Locale":"fr-MA","DisplayName":"français (Maroc)‎"},{"Locale":"fr-MC","DisplayName":"français (Monaco)‎"},{"Locale":"fr-MF","DisplayName":"français (Saint-Martin)‎"},{"Locale":"fr-MG","DisplayName":"français (Madagascar)‎"},{"Locale":"fr-ML","DisplayName":"français (Mali)‎"},{"Locale":"fr-MQ","DisplayName":"français (Martinique)‎"},{"Locale":"fr-MR","DisplayName":"français (Mauritanie)‎"},{"Locale":"fr-MU","DisplayName":"français (Maurice)‎"},{"Locale":"fr-NC","DisplayName":"français (Nouvelle-Calédonie)‎"},{"Locale":"fr-NE","DisplayName":"français (Niger)‎"},{"Locale":"fr-PF","DisplayName":"français (Polynésie française)‎"},{"Locale":"fr-PM","DisplayName":"français (Saint-Pierre-et-Miquelon)‎"},{"Locale":"fr-RE","DisplayName":"français (La Réunion)‎"},{"Locale":"fr-RW","DisplayName":"français (Rwanda)‎"},{"Locale":"fr-SC","DisplayName":"français (Seychelles)‎"},{"Locale":"fr-SN","DisplayName":"français (Sénégal)‎"},{"Locale":"fr-TD","DisplayName":"français (Tchad)‎"},{"Locale":"fr-TG","DisplayName":"français (Togo)‎"},{"Locale":"fr-TN","DisplayName":"français (Tunisie)‎"},{"Locale":"fr-VU","DisplayName":"français (Vanuatu)‎"},{"Locale":"fr-WF","DisplayName":"français (Wallis-et-Futuna)‎"},{"Locale":"fr-YT","DisplayName":"français (Mayotte)‎"},{"Locale":"ga-IE","DisplayName":"Gaeilge (Éire)‎"},{"Locale":"gd-GB","DisplayName":"Gàidhlig (An Rìoghachd Aonaichte)‎"},{"Locale":"gl-ES","DisplayName":"galego (galego)‎"},{"Locale":"gu-IN","DisplayName":"ગુજરાતી (ભારત)‎"},{"Locale":"ha-Latn-NG","DisplayName":"Hausa (Najeriya)‎"},{"Locale":"he-IL","DisplayName":"עברית (ישראל)‏"},{"Locale":"hi-IN","DisplayName":"हिन्दी (भारत)‎"},{"Locale":"hr-BA","DisplayName":"hrvatski (Bosna i Hercegovina)‎"},{"Locale":"hr-HR","DisplayName":"hrvatski (Hrvatska)‎"},{"Locale":"hu-HU","DisplayName":"magyar (Magyarország)‎"},{"Locale":"hy-AM","DisplayName":"Հայերեն (Հայաստան)‎"},{"Locale":"id-ID","DisplayName":"Indonesia (Indonesia)‎"},{"Locale":"is-IS","DisplayName":"íslenska (Ísland)‎"},{"Locale":"it-CH","DisplayName":"italiano (Svizzera)‎"},{"Locale":"it-IT","DisplayName":"italiano (Italia)‎"},{"Locale":"it-SM","DisplayName":"italiano (San Marino)‎"},{"Locale":"it-VA","DisplayName":"italiano (Città del Vaticano)‎"},{"Locale":"ja-JP","DisplayName":"日本語 (日本)‎"},{"Locale":"ka-GE","DisplayName":"ქართული (საქართველო)‎"},{"Locale":"kk-KZ","DisplayName":"қазақ тілі (Қазақстан)‎"},{"Locale":"km-KH","DisplayName":"ភាសាខ្មែរ (កម្ពុជា)‎"},{"Locale":"kn-IN","DisplayName":"ಕನ್ನಡ (ಭಾರತ)‎"},{"Locale":"ko-KR","DisplayName":"한국어(대한민국)‎"},{"Locale":"kok-IN","DisplayName":"कोंकणी (भारत)‎"},{"Locale":"ky-KG","DisplayName":"Кыргыз (Кыргызстан)‎"},{"Locale":"lb-LU","DisplayName":"Lëtzebuergesch (Lëtzebuerg)‎"},{"Locale":"lo-LA","DisplayName":"ລາວ (ລາວ)‎"},{"Locale":"lt-LT","DisplayName":"lietuvių (Lietuva)‎"},{"Locale":"lv-LV","DisplayName":"latviešu (Latvija)‎"},{"Locale":"mi-NZ","DisplayName":"te reo Māori (Aotearoa)‎"},{"Locale":"mk-MK","DisplayName":"македонски (Северна Македонија)‎"},{"Locale":"ml-IN","DisplayName":"മലയാളം (ഇന്ത്യ)‎"},{"Locale":"mn-MN","DisplayName":"монгол (Монгол)‎"},{"Locale":"mr-IN","DisplayName":"मराठी (भारत)‎"},{"Locale":"ms-BN","DisplayName":"Melayu (Brunei)‎"},{"Locale":"ms-MY","DisplayName":"Melayu (Malaysia)‎"},{"Locale":"ms-SG","DisplayName":"Melayu (Singapura)‎"},{"Locale":"mt-MT","DisplayName":"Malti (Malta)‎"},{"Locale":"nb-NO","DisplayName":"norsk bokmål (Norge)‎"},{"Locale":"nb-SJ","DisplayName":"norsk bokmål (Svalbard og Jan Mayen)‎"},{"Locale":"ne-NP","DisplayName":"नेपाली (नेपाल)‎"},{"Locale":"nl-AW","DisplayName":"Nederlands (Aruba)‎"},{"Locale":"nl-BE","DisplayName":"Nederlands (België)‎"},{"Locale":"nl-BQ","DisplayName":"Nederlands (Bonaire, Sint Eustatius en Saba)‎"},{"Locale":"nl-CW","DisplayName":"Nederlands (Curaçao)‎"},{"Locale":"nl-NL","DisplayName":"Nederlands (Nederland)‎"},{"Locale":"nl-SR","DisplayName":"Nederlands (Suriname)‎"},{"Locale":"nl-SX","DisplayName":"Nederlands (Sint-Maarten)‎"},{"Locale":"or-IN","DisplayName":"ଓଡ଼ିଆ (ଭାରତ)‎"},{"Locale":"pa-IN","DisplayName":"ਪੰਜਾਬੀ (ਭਾਰਤ)‎"},{"Locale":"pl-PL","DisplayName":"polski (Polska)‎"},{"Locale":"prs-AF","DisplayName":"درى (افغانستان)‏"},{"Locale":"pt-AO","DisplayName":"português (Angola)‎"},{"Locale":"pt-BR","DisplayName":"português (Brasil)‎"},{"Locale":"pt-CH","DisplayName":"português (Suíça)‎"},{"Locale":"pt-CV","DisplayName":"português (Cabo Verde)‎"},{"Locale":"pt-GQ","DisplayName":"português (Guiné Equatorial)‎"},{"Locale":"pt-GW","DisplayName":"português (Guiné-Bissau)‎"},{"Locale":"pt-LU","DisplayName":"português (Luxemburgo)‎"},{"Locale":"pt-MO","DisplayName":"português (RAE de Macau)‎"},{"Locale":"pt-MZ","DisplayName":"português (Moçambique)‎"},{"Locale":"pt-PT","DisplayName":"português (Portugal)‎"},{"Locale":"pt-ST","DisplayName":"português (São Tomé e Príncipe)‎"},{"Locale":"pt-TL","DisplayName":"português (Timor-Leste)‎"},{"Locale":"quz-PE","DisplayName":"Runasimi (Perú)‎"},{"Locale":"ro-MD","DisplayName":"română (Republica Moldova)‎"},{"Locale":"ro-RO","DisplayName":"română (România)‎"},{"Locale":"ru-BY","DisplayName":"русский (Беларусь)‎"},{"Locale":"ru-KG","DisplayName":"русский (Киргизия)‎"},{"Locale":"ru-KZ","DisplayName":"русский (Казахстан)‎"},{"Locale":"ru-MD","DisplayName":"русский (Молдова)‎"},{"Locale":"ru-RU","DisplayName":"русский (Россия)‎"},{"Locale":"ru-UA","DisplayName":"русский (Украина)‎"},{"Locale":"sd-Arab-PK","DisplayName":"سنڌي (پاکستان)‏"},{"Locale":"si-LK","DisplayName":"සිංහල (ශ්‍රී ලංකාව)‎"},{"Locale":"sk-SK","DisplayName":"slovenčina (Slovensko)‎"},{"Locale":"sl-SI","DisplayName":"slovenščina (Slovenija)‎"},{"Locale":"sq-AL","DisplayName":"shqip (Shqipëri)‎"},{"Locale":"sq-MK","DisplayName":"shqip (Maqedonia e Veriut)‎"},{"Locale":"sq-XK","DisplayName":"shqip (Kosovë)‎"},{"Locale":"sr-Cyrl-BA","DisplayName":"српски (Босна и Херцеговина)‎"},{"Locale":"sr-Cyrl-ME","DisplayName":"српски (Црна Гора)‎"},{"Locale":"sr-Cyrl-RS","DisplayName":"српски (Србија)‎"},{"Locale":"sr-Cyrl-XK","DisplayName":"српски (Косово)‎"},{"Locale":"sr-Latn-BA","DisplayName":"srpski (Bosna i Hercegovina)‎"},{"Locale":"sr-Latn-ME","DisplayName":"srpski (Crna Gora)‎"},{"Locale":"sr-Latn-RS","DisplayName":"srpski (Srbija)‎"},{"Locale":"sr-Latn-XK","DisplayName":"srpski (Kosovo)‎"},{"Locale":"sv-AX","DisplayName":"svenska (Åland)‎"},{"Locale":"sv-FI","DisplayName":"svenska (Finland)‎"},{"Locale":"sv-SE","DisplayName":"svenska (Sverige)‎"},{"Locale":"sw-KE","DisplayName":"Kiswahili (Kenya)‎"},{"Locale":"sw-TZ","DisplayName":"Kiswahili (Tanzania)‎"},{"Locale":"sw-UG","DisplayName":"Kiswahili (Uganda)‎"},{"Locale":"ta-IN","DisplayName":"தமிழ் (இந்தியா)‎"},{"Locale":"ta-LK","DisplayName":"தமிழ் (இலங்கை)‎"},{"Locale":"ta-MY","DisplayName":"தமிழ் (மலேசியா)‎"},{"Locale":"ta-SG","DisplayName":"தமிழ் (சிங்கப்பூர்)‎"},{"Locale":"te-IN","DisplayName":"తెలుగు (భారత దేశం)‎"},{"Locale":"th-TH","DisplayName":"ไทย (ไทย)‎"},{"Locale":"tk-TM","DisplayName":"Türkmen dili (Türkmenistan)‎"},{"Locale":"tr-CY","DisplayName":"Türkçe (Kıbrıs)‎"},{"Locale":"tr-TR","DisplayName":"Türkçe (Türkiye)‎"},{"Locale":"tt-RU","DisplayName":"Татар (Россия)‎"},{"Locale":"ug-CN","DisplayName":"ئۇيغۇرچە (جۇڭخۇا خەلق جۇمھۇرىيىتى)‏"},{"Locale":"uk-UA","DisplayName":"українська (Україна)‎"},{"Locale":"ur-IN","DisplayName":"اردو (بھارت)‏"},{"Locale":"ur-PK","DisplayName":"اُردو (پاکستان)‏"},{"Locale":"uz-Arab-AF","DisplayName":"اوزبیک (افغانستان)‎"},{"Locale":"uz-Cyrl-UZ","DisplayName":"ўзбекча (Ўзбекистон)‎"},{"Locale":"uz-Latn-UZ","DisplayName":"o‘zbek (Oʻzbekiston)‎"},{"Locale":"vi-VN","DisplayName":"Tiếng Việt (Việt Nam)‎"},{"Locale":"zh-CN","DisplayName":"中文(中国)‎"},{"Locale":"zh-Hans-HK","DisplayName":"中文 (香港特别行政区)‎"},{"Locale":"zh-Hans-MO","DisplayName":"中文 (澳门特别行政区)‎"},{"Locale":"zh-HK","DisplayName":"中文(香港特別行政區)‎"},{"Locale":"zh-MO","DisplayName":"中文(澳門特別行政區)‎"},{"Locale":"zh-SG","DisplayName":"中文(新加坡)‎"},{"Locale":"zh-TW","DisplayName":"中文(台灣)‎"}]')}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_plus_end"),shellPerformance.measure("shell_plus","shell_plus_start","shell_plus_end"));