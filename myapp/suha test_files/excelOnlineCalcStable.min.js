var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=13)}([function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return l}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function u(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}s((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function l(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16);t.utils=n;var a=r(17);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(18);t.browserSupport=i;var o=r(19);t.perfWatch=o;var u=r(20);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var s=r(21);t.initStopwatchFactory=s.initStopwatchFactory;var l=r(22);t.getNewGuid=l.getNewGuid;var c=r(23);t.TextAreaVirtualKeyboardPolicy=c.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=c.TextAreaInputMode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);t.mathpack=n;var a=r(30);t.dtr=a;var i=r(7);t.isSupported=i.isSupported,r(5)._start()},function(e,t,r){"use strict";r.r(t);var n=r(0);function a(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return i(e)?e:new Error("(non-Error object) "+function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<"+t+">";case"object":return JSON.stringify(e);default:return""+e}}(e))}function u(e){return{name:e.name,message:a(e)?e.baseMessage:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(n.a)(Object(n.a)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function s(e){return i(e)?{isError:!0,value:u(e)}:{isError:!1,value:e}}var l=function(e){function t(t,r){var a,i=this.constructor,o=e.call(this,t+"; info = "+JSON.stringify(Object(n.a)(Object(n.a)({},r),{error:null===(a=r.error)||void 0===a?void 0:a.message})))||this;o.baseMessage=t,o.info=r,o.name="WorkerError";var u=i.prototype;return Object.getPrototypeOf(o)!==u&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(o,u):o.__proto__=u),o}return Object(n.c)(t,e),t.isWorkerError=a,t}(Error);var c={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){var t;if("WorkerError"===e.name)t=new l(e.message,function(e){return Object(n.a)(Object(n.a)({},e),{error:e.error?d(e.error):void 0})}(e.info));else{var r=c[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function f(e){return e.isError?d(e.value):e.value}var h;function v(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function p(e){if(h)throw new TypeError("setConfig has already been called");h=e}function m(){var e=null!=h?h:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.f)(e.importScriptUrls):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName}}function g(e){setTimeout((function(){throw e}))}function S(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function b(e){var t=S();if(void 0!==t){var r={kind:1,error:s(e)};t.postMessage(r)}else console.warn(e)}function y(e){var t;try{(null!==(t=null==h?void 0:h.onWorkerError)&&void 0!==t?t:b)(e)}catch(t){console.warn(e),g(t)}}function C(e){var t=S();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function k(e){var t;try{(null!==(t=null==h?void 0:h.onCreateWorker)&&void 0!==t?t:C)(e)}catch(e){g(e)}}var E=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return E.transfer.apply(E,Object(n.f)([e,void 0],t))};function A(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}E.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var R;function N(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function T(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function I(){return null!=R?R:R=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function F(e,t){var r=T(),n=function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function O(e){throw e}var D=-1,M=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=T();var i=function(){var e;return null===(e=a.onClose)||void 0===e?void 0:e.call(a)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r=e.funcNames;null===(t=a.onImports)||void 0===t||t.call(a,F(a.createPostProxy.bind(a),r),F(a.createCallProxy.bind(a),r))},r[3]=i,r),u=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return u[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:I()?void 0:function(e){for(var t=T();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new l("Importing Endpoint closed while waiting for "+n+" result",a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,i=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var i=r>=0?"call":"post",o={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new l("Exporting Endpoint received a "+i+" to unknown function "+n,o)}));r>=0?i.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):i.catch((function(e){var a=o(e),i={cause:"UnhandledError",idInfo:t.idInfo,error:a,callId:r,funcName:n};y(new l("Exporting Endpoint's "+n+" implementation threw or rejected",i))}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:s(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,o(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,i=t?"Exporting Endpoint failed to send "+n+" result":"Importing Endpoint failed to deserialize "+n+" result",o={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},u=new l(i,o);a.isError?y(u):this.sendResult(r,n,!1,u)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return N(r,(function(){var n=a.takeCallbacks(e);if(n){var i={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new l("Importing Endpoint's call to "+t+" timed out",i))}}),n)},e.prototype.sendCall=function(e,t,r,a){var i=this;return new Promise((function(u,s){var c=D+=1,d={kind:0,callId:c,funcName:e,args:t};i.unresolvedCalls[c]=Object(n.a)(Object(n.a)({},i.setCallTimeout(c,e,r,{resolve:u,reject:s})),{funcName:e});try{i.port.postMessage(d,a)}catch(t){var f=i.takeCallbacks(c);if(f){var h=o(t),v={cause:"MessageError",idInfo:i.idInfo,error:h,callId:c,funcName:e};f.reject(new l("Importing Endpoint failed to send call to "+e,v))}}}))},e.prototype.sendPost=function(e,t,r,n){var a={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,n)}catch(t){var i=o(t),u={cause:"MessageError",idInfo:this.idInfo,error:i,callId:-1,funcName:e};r(new l("Importing Endpoint failed to post to "+e,u))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,a=r>=0?"call":"post",i={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},o=new l("Exporting Endpoint failed to deserialize "+a+" to "+n,i),u=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==u?void 0:u.reject)&&void 0!==t?t:y)(o)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var i=this.takeCallbacks(t);if(i)(n?i.resolve:i.reject)(f(a))}else{var o={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};y(new l("Exporting Endpoint sent a result for a post to "+r,o))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(n){for(var a,i,o,u=[],s=1;s<arguments.length;s++)u[s-1]=arguments[s];if(!t.isClosed){var l=null!==(o=null!==(a=r.onPostMessageError)&&void 0!==a?a:null===(i=t.getOnPostMessageError)||void 0===i?void 0:i.call(t))&&void 0!==o?o:O;t.sendPost(e,u,l,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(n){for(var a,i,o,u=[],s=1;s<arguments.length;s++)u[s-1]=arguments[s];if(t.isClosed){var c={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new l(t.idInfo.side+" Endpoint's call."+e+" called after close",c))}var d=null!==(o=null!==(a=r.callTimeout)&&void 0!==a?a:null===(i=t.getCallTimeout)||void 0===i?void 0:i.call(t))&&void 0!==o?o:1/0;return t.sendCall(e,u,d,n)},r.callTimeout=void 0,r},e}();var w=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=O,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new l(e.side+" Endpoint's "+t+" referenced before the "+r+" Endpoint started",n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,i,o=r.port,u=r.options,s=r.createMode,c={type:"Endpoint",side:t,id:null==u?void 0:u.id};try{a=new M(c,o),i=new e(c,a,s)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var o;a.getCallTimeout=function(){return i.callTimeout},a.getOnPostMessageError=function(){return i.onPostMessageError},a.onImports=function(e,t){Object.defineProperties(i,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},a.onClose=function(){return i.close("Force")};var s,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==h?void 0:h.createTimeout)&&void 0!==r?r:3e5}(u),f=N(d,(function(){var e=new l(t+" Endpoint timed out waiting for the "+("Outside"===t?"inside":"outside")+" to start",{cause:"Timeout",idInfo:c,timeout:d});f.reject(e)}),{resolve:e,reject:r});i._closedDuringCreate=function(){f.resolve()};try{s=n(i)}catch(e){return f.reject(e)}null===(o=i._state)||void 0===o||o.setExports(s)})).then((function(){return i._closedDuringCreate=void 0,i}),(function(e){return i._closedDuringCreate=void 0,i.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new l(this._idInfo.side+" Endpoint's close called during creation",n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:o(e)};y(new l(this._idInfo.side+" Endpoint's close threw an error",n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}(),_='!function(r){var e={};function t(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)t.d(n,o,function(e){return r[e]}.bind(null,o));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=3)}([function(r,e,t){"use strict";r.exports=t(1)()?globalThis:t(2)},function(r,e,t){"use strict";r.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(r,e){var t=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};r.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(r){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},function(r,e,t){"use strict";t.r(e);var n=function(){return(n=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r}).apply(this,arguments)};function o(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;var n=Array(r),o=0;for(e=0;e<t;e++)for(var i=arguments[e],u=0,a=i.length;u<a;u++,o++)n[o]=i[u];return n}function i(r){return u(r)&&"WorkerError"===r.name&&"object"==typeof r.info}function u(r){if(null==r)return!1;if(r instanceof Error)return!0;var e=r;return"string"==typeof e.name&&"string"==typeof e.message&&(null==e.stack||"string"==typeof e.stack)}function a(r){return u(r)?r:new Error("(non-Error object) "+function(r){var e=typeof r;switch(e){case"function":case"symbol":case"undefined":return"<"+e+">";case"object":return JSON.stringify(r);default:return""+r}}(r))}function f(r){return{name:r.name,message:i(r)?r.baseMessage:r.message,stack:r.stack,info:i(r)?(e=r.info,n(n({},e),{error:e.error?f(e.error):void 0})):void 0};var e}function s(r){throw new ReferenceError(r+" is not defined")}function c(r,e,t){void 0===t&&(t=s);try{for(var n=e.split("."),o=0,i=n;o<i.length;o++){r=r[i[o]]}return null!=r?r:t(e)}catch(r){return t(e)}}var l=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return l.transfer.apply(l,o([r,void 0],e))};l.transfer=function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return{def:r,args:t,transferables:null!=e?e:[]}};var p="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(r,e,t){"Pending"===r.status&&(r.status=e,r.end=Math.max(r.start,null!=t?t:p()))}var y=t(0);self.onmessage=function(r){var e,t,n=r.data,s=n.config,l=n.port,v=n.options,g=n.script,b=n.args,m=n.featureGateDictionary;function _(){var r;if(t)return t;if(void 0===s.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return importScripts(s.typedWorkersUrl),(t=c(self,null!==(r=s.typedWorkersName)&&void 0!==r?r:"typedWorkers")).setConfig(s),t}self.onmessage=null,self.__typed_workers_thread=!0,e=function(){return m},y.__get_feature_gate_dictionary_variable,y.__get_feature_gate_dictionary_variable=e;var h={status:"Pending",start:p()};function w(r,e){var t,n={kind:0,error:r?void 0:u(t=a(e))?{isError:!0,value:f(t)}:{isError:!1,value:t},stopwatch:h};self.postMessage(n),r||setTimeout(self.close.bind(self),6e4)}try{(function(r,e){function t(e){throw d(r,i(e)&&"Timeout"===e.info.cause?"Timeout":"Error"),e}try{return e().then((function(e){var t;return null!==(t=d(r,"Success"))&&void 0!==t?t:e}),t)}catch(r){t(r)}})(h,(function(){var r,e;return importScripts.apply(void 0,o(null!==(e=null!==(r=null==v?void 0:v.importScriptUrls)&&void 0!==r?r:s.importScriptUrls)&&void 0!==e?e:[],void 0!==g.scriptUrl?[g.scriptUrl]:[])),c(self,g.insideInitName).apply(void 0,o([{config:s,importTypedWorkers:_,connection:{port:l,options:v,createMode:"Thread"}}],b))})).then((function(){return w(!0)}),(function(r){return w(!1,r)}))}catch(r){w(!1,r)}}}]);',L=r(4),P=-1;var x=function(){function e(e){var t,r;try{var n;t=function(e){var t="def"in e?e:E(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit"+(P+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var "+i+" = "+r.toString()+";"]}(e),this.script=t[0],this.args=t[1],this.transferables=t[2];var a=void 0===(n=t[3])?[_]:[n,"\n\n",_];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"})),this.worker=new Worker(this.blobUrl)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,o=e.port,u=e.options,s={type:"Thread",side:"Outside",id:u.id},c=this.worker;return A(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var h={config:m(),port:o,options:u,script:r.script,args:r.args,featureGateDictionary:Object(L.b)()};c.postMessage(h,Object(n.f)([o],r.transferables)),c.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(i(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new l(t+" received an unhandled error",n)}if(null==r.message)return new l(t+" received a non-error (worker script fetch probably failed)",{cause:"UnhandledError",idInfo:e});var o={cause:"UnhandledError",idInfo:e},u=r.message+" at "+r.filename+":"+r.lineno+":"+r.colno;return new l(t+" received an unhandled error: "+u,o)}(s,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):y(t)},c.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(f(i.error));case 1:return y(f(i.error));case 2:return k(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),B="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function U(){return{status:"Pending",start:B()}}function G(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:B()))}function j(e,t){function r(t){throw G(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=G(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function V(e){return Math.round(1e3*e)/1e3}function H(e,t,r){return e<t?t:e>r?r:e}function W(e,t,r){var n,a,i,o=H(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),u=H(null!==(a=null==e?void 0:e.end)&&void 0!==a?a:1/0,t,r);return{status:null!==(i=null==e?void 0:e.status)&&void 0!==i?i:"Pending",start:V(o-t),end:V(u-t),duration:V(u-o)}}var K=function(){return r(3)};function z(e,t,r,n,a){var i,o=new MessageChannel,u=o.port1,s=o.port2;return Promise.all([n({port:u,options:e,createMode:t}),j(r.createOutside=U(),(function(){return w.createOutside({port:s,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):s.close(),Promise.reject(e)}))}function Y(e,t,r,a){return z(e,"Local",t,(function(e){return function(e,t,r){var a="def"in r?r:E(r),i=a.def,o=a.args;if("function"!=typeof i){var u={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new l("Loading an InsideScript to create a local worker is unimplemented",u))}return Promise.resolve().then((function(){return j(t.insideInit=U(),(function(){return i.apply(void 0,Object(n.f)([{config:m(),importTypedWorkers:K,connection:e}],o)).then((function(){}))}))}))}(e,t,r)}),a)}function q(e,t,r,n){var a;t.createThread=U();try{a=new x(r)}catch(e){return G(t.createThread,"Error"),Promise.reject(e)}return G(t.createThread,"Success"),z(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function J(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==h?void 0:h.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?v()?"Thread":"Local":n}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?Y:q,o={id:e.id,createMode:n,createWorker:U()};return A(j(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,u=n.status,s=n.start,l=n.end;if("Pending"!==u&&void 0!==l)return{id:t,createMode:r,createWorker:{status:u,absStart:s,duration:V(l-s)},createThread:"Thread"===r?W(o,s,l):void 0,createOutside:W(i,s,l),insideInit:W(a,s,l)}}(o);e&&k(e)}))}r.d(t,"WorkerError",(function(){return l})),r.d(t,"isThreadingSupported",(function(){return v})),r.d(t,"setConfig",(function(){return p})),r.d(t,"dispatchWorkerError",(function(){return y})),r.d(t,"paramInsideDef",(function(){return E})),r.d(t,"Endpoint",(function(){return w})),r.d(t,"createWorker",(function(){return J}))},function(e,t,r){"use strict";var n=r(24),a={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?a:__get_feature_gate_dictionary_variable()}function o(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}function u(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t}function s(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var a=parseFloat(n);return isNaN(a)?t:a}function l(e){var t=n.__get_feature_gate_dictionary_variable;return n.__get_feature_gate_dictionary_variable=e,t}r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return l}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__growWasmMemory=t.stackRestore=t.stackAlloc=t.stackSave=t.setThrew=t.__errno_location=t._start=t.Mathpack_Pack=t.Mathpack_FormatScientific=t.Mathpack_FormatFixed=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Acos=t.Mathpack_Asin=t.Mathpack_Tan=t.Mathpack_Cos=t.Mathpack_Sin=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_Exp=t.Mathpack_Sqrt=t.Mathpack_ViewRound=t.Mathpack_Equal=t.Mathpack_GetExp32=t.Mathpack_Compare=t.Mathpack_TenTo=t.Mathpack_RoundDown=t.Mathpack_RoundUp=t.Mathpack_Round=t.Mathpack_SFix=t.Mathpack_LFix=t.Mathpack_Fix=t.Mathpack_SFloat=t.Mathpack_Float=t.Mathpack_Neg=t.Mathpack_Abs=t.Mathpack_Floor=t.Mathpack_Ceil=t.Mathpack_Trunc=t.Mathpack_TakeMathError=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Power=t.Mathpack_Add=t.Mathpack_Sub=t.Mathpack_Mul=t.Mathpack_Div=t.Mathpack_Pi=t.Mathpack_One=t.Mathpack_Zero=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToDays=t.Dtr_Days=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_Write=t.Dtr_Rounding=t.Dtr_FracSec=t.Dtr_Wdy=t.Dtr_Sec=t.Dtr_Min=t.Dtr_Hour=t.Dtr_DOM=t.Dtr_Mon=t.Dtr_Yr=t.Dtr_FromNum=t.Dtr_DaysPerMonth=t.Base_StrBufSize=t.Base_StrBuf=t.memory=void 0;var n=r(27),a=r(28),i=r(29),o=new ArrayBuffer(8),u=new Int32Array(o),s=(new Float32Array(o),new Float64Array(o));function l(e){return u[e]}function c(e,t){u[e]=t}function d(){return s[0]}function f(e){s[0]=e}var h,v=new ArrayBuffer(65536),p=(h=new Uint8Array(v),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)h[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)h[e+n]=r[n]});p(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),p(1152,"sAsAAMgLAADACwAA0As="),p(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),p(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),p(1975,"oAQ="),p(1991,"yAc="),p(2007,"+go="),p(2022,"QJwO"),p(2038,"UMMR"),p(2054,"JPQU"),p(2069,"gJaYGA=="),p(2085,"ILy+Gw=="),p(2101,"KGvuHg=="),p(2117,"+QKVIg=="),p(2132,"QLdDuiU="),p(2148,"EKXU6Cg="),p(2164,"KueEkSw="),p(2179,"gPQg5rUv"),p(2195,"oDGpX+My"),p(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),p(3728,"ME8=");var m=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),s=new e.Uint16Array(r),h=new e.Uint32Array(r),v=(new e.Float32Array(r),new e.Float64Array(r)),p=e.Math.imul,m=(e.Math.fround,e.Math.abs),g=e.Math.clz32,S=e.Math.min,b=(e.Math.max,e.Math.floor),y=e.Math.ceil,C=e.Math.sqrt,k=t.abort,E=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),A=t.Base_LocaleGetOrdinal,R=t.Base_LocaleDecimalSeparator,N=t.Math_log10,T=t.Math_log,I=(C=t.Math_sqrt,t.Math_sin),F=t.Math_cos,O=t.Math_tan,D=t.Math_atan,M=t.Math_exp,w=t.proc_exit,_=20112,L=0;function P(){}function x(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function B(e,t){var r,u,c=0,d=0,h=0,p=0;if(d=3680,_=r=_-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,v[460]=e,u=z(e),v[460]=u,be(u,r+40|0,r,15),s[r+42>>1]){c=(0|(c=de(t)<<16))<0?100:c>>16,f(+t),h=0|l(1),l(0),(p=-65536&h)&&(2146435072!=(2146435072&h)?c=(0|p)<1?0-c|0:c:i[922]=1);e:{if(!((0|(c=a[r+40>>1]+c|0))>=a[r+42>>1])){if((0|c)<1){d=3e3;break e}(255&c)>>>0>=o[r+30|0]||(n[r+30|0]=c)}Se(3100,3680,r)}e=v[d>>3]}return _=r+48|0,e}function U(e,t){var r,n=0,a=0,o=0;if(v[460]=e,f(+e),a=0|l(1),l(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[922]=1,a=0)),i[921]=2147483647&o,te(v[374]),n=-65536&(o=i[921]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return Y(8),0}else i[922]=1;r=re(v[374],e),v[460]=re(v[372],r),ne(r),ve();e:{t:{if((n=i[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[922]=1}if(t){if(i[920]=0,i[921]=0,!a)break e;return t=i[741],i[920]=i[740],i[921]=t,v[460]}if(n=i[747],i[920]=i[746],i[921]=n,t=n,1^a|n>>>0<65536)break e;return i[921]=-2147483648^t,v[460]}ke(e),pe(),t&&(v[460]=re(v[373],v[460]))}return v[460]}function G(e,t,r,n){var u,l=0,c=0,d=0,f=0,h=0,v=0,m=0;if(l=i[e+4>>2],h=-2146827284,!((0|(u=(c=s[e>>1])+(e=(0|(d=a[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|u)||((d=d+p(e,-12)<<16>>16)+-1&65535)>>>0>11|(!l|1900==(0|u)&2==(0|d)&29==(0|l)?!r:0))){if(v=(0|(e=(f=(0|(c=u+1e4|0))/4|0)<<2))%100|0,m=(0|e)%400|0,l=(((f=p(f,1461)+l|0)+((0|(l=e+-1|0))/-100|0)|0)+((0|l)/400|0)|0)-1|0,c=(p(c-e|0,12)+d|0)-1|0)for(c=c+(e=m?v?0:12:0)|0;l=o[e+1072|0]+l|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=l+-4346385|0,!((0|u)>1900|(0|d)>=3))break e;e=l+-4346384|0}else e=l+-4346384|0;e>>>0>2958465||(i[n>>2]=e,h=0)}return h}function j(e,t,r){var n,u,s,l=0,c=0,d=0;c=d=Te(e,t,711573504,201),i[r+28>>2]=(c+1>>>0)%7,l=c+p(n=(c>>>0)/146097|0,-146097)|0,u=(p(l,100)+75>>>0)/3652425|0,l=((s=p(u,-36524)+l|0)>>>0)/1461|0,c=(((c+(((l=((p(u,100)+p(n,400)|0)+(l<<2)|0)+((p(s+p(l,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(l>>>2)|0)-((l>>>0)/400|0)|0)+p(l,-365)|0,d=Ne(d,L,-864e5,-1),e=Te(e,t,1e4,0)+d|0,d=!(((t=l+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=o[c+1568|0])<<1)|0:1536+((t=o[c+1168|0])<<1)|0,i[r+12>>2]=(e>>>0)/36e5,i[r+4>>2]=t+1,i[r>>2]=l+1601,t=(e>>>0)/1e3|0,i[r+20>>2]=(t>>>0)%60,i[r+16>>2]=((e>>>0)/6e4>>>0)%60,i[r+24>>2]=e-p(t,1e3),i[r+8>>2]=1+(c-a[d>>1]|0)}function V(e,t){var r=0,n=0,o=0,u=0,s=0,l=0,c=0,d=0,f=0,h=0,v=0,m=0;return(0|(u=i[e+4>>2]))<1||(d=u+-1|0)>>>0>11||(n=(r=i[e>>2])+-1601|0)>>>0>29226||(0|(s=i[e+8>>2]))<1||(o=1536,((l=65535&r)>>>0)%400&&(o=3&r?1936:(l>>>0)%100|0?1536:1936),(f=i[e+24>>2])>>>0>999||(l=i[e+20>>2])>>>0>59||(h=i[e+16>>2])>>>0>59||(v=i[e+12>>2])>>>0>23||(s=s+-1|0)>>>0>=a[o+(u<<1)>>1]-a[o+(d<<1)>>1]>>>0||(o=n>>>2,u=p(n,365),n=((e=65535&n)>>>0)/400|0,m=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((c>>>0)%100)|3&r)||(e=1536),c=1,r=(r=p(p(p(v,60)+h|0,60)+l|0,1e3)+f|0)+(n=Ne(e=a[(d<<1)+e>>1]+(n+((s+(u+o|0)|0)-m|0)|0)|0,e>>31,864e5,0))|0,e=L,i[t>>2]=Ne(r,r>>>0<n>>>0?e+1|0:e,1e4,0),i[t+4>>2]=L)),c}function H(e,t,r,n){var a,o=0,u=0,s=0,l=0;_=a=_-112|0,j(r,n,a+80|0);e:{if(i[e>>2]){if(!V(e,t))break e}else{if((0|(u=i[e+8>>2]))>5|!u)break e;if(r=i[e+4>>2],n=i[e+28>>2],o=i[a+80>>2],i[a+56>>2]=1,i[a+52>>2]=r,i[a+48>>2]=o,i[a+60>>2]=i[e+12>>2],i[a+64>>2]=i[e+16>>2],i[a+68>>2]=i[e+20>>2],e=i[e+24>>2],i[a+76>>2]=0,i[a+72>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=n+8|0,r=n+1|0,s=(0|u)<2,j(i[a+8>>2],i[a+12>>2],a+16|0),l=a;t:{if((0|n)<(0|(o=i[a+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}i[l+56>>2]=e}t:if(!s&&(r=e+7|0,i[a+56>>2]=r,o=1,V(a+48|0,a+8|0)))for(;;){if(j(i[a+8>>2],i[a+12>>2],a+16|0),e=i[a+24>>2],(0|u)==(0|(o=o+1|0)))break t;if(r=r+7|0,i[a+56>>2]=r,!V(a+48|0,a+8|0))break}if(i[a+56>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=i[a+12>>2],i[t>>2]=i[a+8>>2],i[t+4>>2]=e}o=1}return _=a+112|0,o}function W(e,t,r){var n,o=0,u=0,l=0,c=0,d=0;if(_=n=_-16|0,r&&(l=r>>31,l^=l+r))for(r=(0|r)>0?1952:2448;(o=15&l)&&(u=a[(o=(o<<4)+r|0)+8>>1],d=K(v[e>>3],v[o>>3],n),t=t+u|0,a[n+14>>1]<=0?(o=s[n+6>>1],u=s[n+8>>1]):(u=i[n+4>>2],o=s[n+6>>1]<<1,a[n+6>>1]=o,c=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|c>>>31,u=c<<1|u>>>31,i[n+8>>2]=u,t=t+-1|0),(65535&o|1&u|0!=(0|d))>>>0<32769||(u=(o=i[n+8>>2])+1|0,i[n+8>>2]=u,u>>>0>=o>>>0||(u=(o=i[n+12>>2])+1|0,i[n+12>>2]=u,u>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,l>>=4;);return _=n+16|0,t}function K(e,t,r){var n,i,o,u=0,s=0,c=0,d=0,h=0,v=0,m=0,g=0,S=0,b=0,y=0,C=0;return f(+t),d=0|l(1),h=65535&(s=0|l(0)),f(+e),b=0|l(1),u=0|l(0),c=b,i=p(g=65535&u,h),a[r>>1]=i,o=((65535&(y=p(S=u>>>16,h)))+(i>>>16)|0)+(65535&(m=p(s>>>=16,g)))|0,a[r+2>>1]=o,y=(((v=((65535&(u=p(n=65535&c,h)))+(y>>>16)|0)+(m>>>16)|0)+(65535&(m=p(s,S)))|0)+(65535&(C=p(b=65535&d,g)))|0)+(o>>>16)|0,a[r+4>>1]=y,m=(((((((65535&(v=p(d>>>=16,g)))+(u>>>16)|0)+(65535&(c=p(u=c>>>16,h)))|0)+(m>>>16)|0)+(C>>>16)|0)+(65535&(h=p(b,S)))|0)+(65535&(g=p(s,n)))|0)+(y>>>16)|0,a[r+6>>1]=m,S=((((((C=(c>>>16)+(v>>>16)|0)+(65535&(c=p(d,S)))|0)+(h>>>16)|0)+(g>>>16)|0)+(65535&(v=p(u,s)))|0)+(65535&(s=p(b,n)))|0)+(m>>>16)|0,a[r+8>>1]=S,v=((s=(((65535&(h=p(d,n)))+(c>>>16)|0)+(v>>>16)|0)+(s>>>16)|0)+(65535&(c=p(u,b)))|0)+(S>>>16)|0,a[r+10>>1]=v,u=(((65535&(d=p(u,d)))+(h>>>16)|0)+(c>>>16)|0)+(v>>>16)|0,a[r+12>>1]=u,a[r+14>>1]=(u>>>16)+(d>>>16),65535&(i|o|y)}function z(e){var t,r,n=0,a=0,o=0,u=0,s=0,c=0;return _=t=_-16|0,v[t+8>>3]=e,f(+e),n=0|l(1),a=0|l(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,u=(n=p(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=W(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(h[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=W(t+8|0,o,1),a=i[t+8>>2],u=n+-15|0),n=u,u=(u=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=u,u>>>0>=a>>>0||(c=(s=i[t+12>>2])+1|0,i[t+12>>2]=c,c>>>0>=s>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=u&0-(a<<1),o=W(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(u=(n=i[t+12>>2])+1|0,i[t+12>>2]=u,o=(u>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=v[t+8>>3]),_=t+16|0,e}function Y(e){var t;return t=i[922],i[922]=e,t}function q(){var e,t,r;return e=i[920],t=i[921],$(1048576),$(2146435072),a[1843]<0?(i[920]=e,i[921]=t,-2147483648):(r=ce(),i[920]=e,i[921]=t,-2147483648^r)}function J(e){var t,r=0,n=0,a=0,i=0;if(f(+e),r=0|l(1),t=0|l(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|i),+d();i&=n,c(0,0),c(1,0|i),a=+d()}return a}function Q(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[920]=0,i[921]=-2147483648,n=W(3680,1,e),r=i[920],e=i[921],3071&r&&(t=i[921],(e=i[920]+1024|0)>>>0<1024&&(t=t+1|0),i[920]=e,i[921]=t,r=e,e=t),i[920]=e<<21|r>>>11,void(i[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[922]=1),i[920]=0,i[921]=0}function X(e,t,r,n){var o=0,u=0,l=0;e:{t:{r:{n:{if(!n){if(s[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return i[t>>2]=1,void(i[r>>2]=0)}if(s[(n<<1)+e>>1]<=52)break e;for(;;){if(l=s[(u=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[u>>1]=l,58!=(65535&l))break e;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==s[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=i[920],t=-65536&(e=i[921])){if(2146435072==(2146435072&e))return i[922]=1,void me();if((0|t)<1)break e}return void me()}me(),(0|r)==i[920]&&i[921]==(0|e)||te(1)}function $(e){v[460]=ee(v[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[922]=1,e=v[375]),e}function te(e){v[460]=re(v[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[922]=1,e=v[375]),e}function ne(e){v[460]=ae(v[460],e)}function ae(e,t){var r,n=0,a=0,o=0;return f(+e*t),n=0|l(1),r=0|l(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[750]:r,n=a?i[751]:n,c(0,0|o),c(1,0|n),+d()):(i[922]=1,n=i[751],c(0,i[750]),c(1,0|n),+d())}function ie(e){v[460]=oe(v[460],e)}function oe(e,t){var r=0,n=0,a=0,o=0;if(f(+t),r=0|l(1),l(0),2146435072&r){if(n=1,f(+e/t),r=0|l(1),a=0|l(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[750]:a,r=n?i[751]:r,c(0,0|a),c(1,0|r),+d()}else n=4;return i[922]=n,r=i[751],c(0,i[750]),c(1,0|r),+d()}function ue(e){v[460]=e>>>0}function se(e){v[460]=0|e}function le(){var e,t;e=+T(+v[460]),v[460]=e,f(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[922]=8)}function ce(){return de(v[460])}function de(e){var t,r=0,n=0,a=0,i=0;return f(+e),i=1106247680==(0|(a=2146435072&(r=0|l(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|l(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(a=m(e)>=1?e>0?~~S(b(e/4294967296),4294967295)>>>0:~~y((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return he(v[460])}function he(e){var t=0,r=0;return f(+e),t=0|l(1),l(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=m(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function ve(){var e,t;e=+C(+v[460]),v[460]=e,f(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[922]=8)}function pe(){var e,t;e=+D(+v[460]),v[460]=e,f(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[922]=8)}function me(){v[460]=J(v[460])}function ge(){var e,t;e=+M(+v[460]),v[460]=e,f(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[922]=1)}function Se(e,t,r){return function(e,t,r){var n=0,u=0,c=0,d=0;if(n=o[r+30|0]){for(u=r;d=10*d+ +(0|Fe[i[i[e>>2]+4>>2]](e,s[u>>1])),u=u+2|0,c=(0|n)>1,n=n+-1|0,c;);if(f(+d),n=0|l(1),e=0|l(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=W(t,(n>>>20&2047)-1022|0,((32767&s[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(u=i[t>>2])?(e=u+1024|0,i[t>>2]=e,u>>>0<4294966272||(c=(u=i[t+4>>2])+1|0,i[t+4>>2]=c,n=(c>>>0<u>>>0)+n|0)):e=u,!((0|n)<=-1022))return(0|(u=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|u|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function be(e,t,r,o){!function(e,t,r,o){var u,c,d=0,h=0,m=0,g=0,S=0,b=0,y=0,C=0,k=0,E=0;_=u=_-16|0,v[u+8>>3]=e,c=t,f(+e),h=0|l(1),m=0|l(0),g=d=h;e:if(h=2146435072&d){if(h=p(S=(h>>>20)-1022|0,39457)>>17,a[r+32>>1]=h+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+h|0)|0))<=-1){n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(i[u+8>>2]=m<<11,i[u+12>>2]=g<<11|m>>>21|-2147483648,(0|(d=W(u+8|0,S,-1^h)))>=1)for(m=r+32|0;h=s[m>>1],a[m>>1]=h+1&32767|32768&h,(0|(d=W(u+8|0,d,-1)))>0;);if(d?(h=(m=i[u+12>>2])>>>(g=0-d|0),i[u+12>>2]=h,d=m<<d+32|i[u+8>>2]>>>g,i[u+8>>2]=d):(d=i[u+8>>2],h=i[u+12>>2]),d=(m=h>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,i[u+8>>2]=d,d>>>0<m>>>0&&(h=h+1|0,i[u+12>>2]=h),(0|o)<1)m=r;else{for(b=d>>>16,y=s[u+14>>1],C=r+32|0,E=15==(0|o),m=r,g=1;;){S=o;t:{r:{for(;;){if(o=p(b,10)+(p(65535&d,10)>>>16)>>>16,k=p(y,10)+(o+p(65535&h,10)>>>16)>>>16|48,a[m>>1]=k,y=(h=o+p(h,10)|0)>>>16,b=(d=p(d,10))>>>16,1&(-1^g|48!=(0|k)))break r;if(o=s[C>>1],a[C>>1]=o+-1&32767|32768&o,!E)break}g=1;break t}m=m+2|0,g=0}if(o=S+-1|0,!((0|S)>1))break}i[u+12>>2]=h,i[u+8>>2]=d}d=(o=m-r|0)>>1;t:{if((0|o)<=29){if((0|h)<=-1){a[m>>1]=57,h=d+1|0;break t}a[m>>1]=48}for(;;){if(h=d,(0|d)<1)break t;if(d=h+-1|0,48!=s[(m=m+-2|0)>>1])break}}n[r+30|0]=h,a[t+2>>1]=h,t=(32767&s[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[c>>1]=t,_=u+16|0}(e,t,r,o)}function ye(e){return re(v[460],e)}function Ce(e){return oe(v[460],e)}function ke(e){v[460]=oe(e,v[460])}function Ee(e,t){v[460]=oe(e,t)}function k(){w(1),k()}function Ae(e,t){var r,n;r=0|e,n=0|t,u[0]=r,u[1]=n}function Re(e,t,r,n){var a=0,i=0;return r=function(e,t,r,n){var a=0,i=0,o=0,u=0,s=0,l=0,c=0,d=0,f=0,h=0;e:{t:{r:{n:{a:{i:{o:{u:{s:{l:{if(o=t){if(!(a=r))break l;if(!(i=n))break s;if((a=g(i)-g(o)|0)>>>0<=31)break u;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ae(e-p(t=(e>>>0)/(r>>>0)|0,r)|0,0),L=0,t}if(a=n,!e)break o;if(!a)break i;if((i=a+-1|0)&a)break i;return Ae(e,o&i),e=o>>>(31&Ie(a)),L=0,e}if(!((i=a+-1|0)&a))break a;s=(g(a)+33|0)-g(o)|0,l=0-s|0;break r}s=a+1|0,l=63-a|0;break r}return Ae(0,o-p(e=(o>>>0)/(a>>>0)|0,a)|0),L=0,e}if((a=g(a)-g(o)|0)>>>0<31)break n;break t}if(Ae(e&i,0),1==(0|a))break e;return r=Ie(a),n=e,e=31&r,32<=(63&r)>>>0?(a=0,e=t>>>e):(a=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),L=a,e}s=a+1|0,l=63-a|0}if(i=t,f=e,o=31&(a=63&s),32<=(63&a)>>>0?(a=0,u=i>>>o):(a=i>>>o,u=((1<<o)-1&i)<<32-o|f>>>o),i=a,o=e,e=31&(a=63&l),32<=(63&a)>>>0?(a=o<<e,e=0):(a=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=a,s)for(a=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(a=a+1|0),l=a;a=i<<1|u>>>31,i=u<<1,f=a,a=(u=l-((o>>>0<(i|=t>>>31)>>>0)+a|0)|0)>>31,u=(d=i)-(i=r&(c=u>>31))|0,i=f-((n&a)+(d>>>0<i>>>0)|0)|0,a=t<<1|e>>>31,e=h|e<<1,t=0|a,d=0,h=c&=1,s=s+-1|0;);return Ae(u,i),L=(a=t<<1|e>>>31)|d,e=c|e<<1}Ae(e,t),e=0,t=0}return L=t,e}((e^=a=t>>31)-a|0,i=((i=t>>31)^t)-((e>>>0<a>>>0)+i|0)|0,(r^=e=n>>31)-e|0,((a=n>>31)^n)-((r>>>0<e>>>0)+a|0)|0),L=((e=(t^=n)>>31)^L)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}function Ne(e,t,r,n){return e=function(e,t,r,n){var a,i,o,u,s=0,l=0;return u=p(s=r>>>16,l=e>>>16),s=(65535&(l=((o=p(a=65535&r,i=65535&e))>>>16)+p(l,a)|0))+p(s,i)|0,e=(((p(t,r)+u|0)+p(e,n)|0)+(l>>>16)|0)+(s>>>16)|0,L=e,t=65535&o|s<<16}(e,t,r,n)}function Te(e,t,r,n){return e=Re(e,t,r,n)}function Ie(e){return e?31-g(e+-1^e)|0:32}var Fe=[null,function(e,t){return 0,0!=(0|E(0|(t|=0)))|0},function(e,t){return 0,0|A(0|(t|=0))},function(e){return 0,0|R()},function(e,t){return 0,(t|=0)+-48|0},P];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((p(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,u){return e=+e,t|=0,n|=0,u|=0,r=p(r|=0,20)+3616|0,a[r>>1]=0,t=function(e,t,r,n,u){var h=0,m=0,g=0,S=0,b=0,y=0,C=0,k=0,E=0;e:if(!s[e>>1]){if(v[460]=t,f(+t),h=0|l(1),g=0|l(0),y=h,E=-65536&h)if(2146435072!=(2146435072&h)){if(!((0|E)>=1))return-2147467259}else i[922]=1;b=i[770],C=i[771],S=-1;t:{if(!((0|h)<(0|(m=C))||(S=1,(0|h)>(0|m)))){if((0|b)==(0|(m=g)))break t;S=m>>>0<b>>>0?-1:1}if(m=-2147467259,1==(0|((y&C)>-1?S:0-S|0)))break e}t:{if(b=i[772],m=i[773],C=m,S=-1,!((0|h)<(0|m)||(S=1,(0|h)>(0|C)))){if((0|g)==(0|b))break t;S=g>>>0<b>>>0?-1:1}if(b=S,-1==(0|((m&y)>-1?b:0-b|0)))return-2147467259}t:{r:{if(!(u|!E))if(2146435072!=(2146435072&h)){if((0|E)<1)break r}else i[922]=1;$(v[i[1056+(r<<2)>>2]>>3]),k=v[460];break t}Z(),te(t),y=i[921],g=y,c(0,0|(h=i[920])),c(1,0|g),k=+d(),i[750]==(0|h)&&i[751]==(0|g)||(m=i[921])>>>0<65536||(i[921]=-2147483648^m,f(+(k=v[460])),g=0|l(1),h=0|l(0)),y=g,b=g,g=i[1056+(r<<2)>>2],C=i[g+4>>2],m=i[g>>2],S=-1;r:{if(!((0|b)<(0|(g=C))||(S=1,(0|b)>(0|g)))){if((0|h)==(0|m)){v[460]=t;break r}S=h>>>0<m>>>0?-1:1}if(b=S,v[460]=t,-1==(0|((y&C)>-1?b:0-b|0)))break t}te(v[374])}if(a[e+18>>1]=r,h=fe(),m=-2147467259,!Y(0)){if(n){if((0|h)>2957003)break e;h=h+1462|0}else if(h+4346018>>>0>7304483)break e;if(a[e+14>>1]=1+((h+6|0)%7|0),!u|h)if(h){if((0|h)<=-1?(g=-4-((n=(-1^h)/1461|0)<<2)|0,m=1461+(p(n,1461)+h|0)|0):(g=(n=(h+-1|0)/1461|0)<<2,m=p(n,-1461)+h|0),!(u&&(0|g)<=199))if((0|(m=(((0|(n=g+-101|0))/100|0)-((0|n)/400|0)|0)+m|0))>=1462){h=3&(n=g+1900|0);t:if(u){if(h|(0|g)<200)break t;h=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else h||(h=!((0|n)%100)&0!=((0|n)%400|0));g=g+4|0,m=(12==(0|p(h,12))?-1460:-1461)+m|0}else(0|m)>0||(g=g+-4|0,m=m+1461|0);h=3&(n=g+1900|0);t:if(u){if(h|(0|g)<200)break t;h=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else h||(h=!((0|n)%100)&0!=((0|n)%400|0));for(y=p(h,12),h=y;u=h,h=h+1|0,(0|(m=(n=m)-o[u+1072|0]|0))>0;);u=((m=u)-((0|y)<(0|(u=u+-11|0))?y:u)>>>0)/12|0,a[e>>1]=1900+(u+g|0),a[e+2>>1]=(p(u,-12)+h|0)-y}else i[e>>2]=788331,n=30;else i[e>>2]=67436;if(i[e+4>>2]=n,v[460]=k,me(),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(k),ne(v[379]),t=v[460],n=ce(),a[e+8>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(v[380]),t=v[460],n=ce(),a[e+10>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(v[380]),!r)return r=ce(),a[e+16>>1]=0,a[e+12>>1]=r,0;t=v[460],n=ce(),a[e+12>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(v[i[1152+(r<<2)>>2]>>3]),v[460]=z(v[460]),a[e+16>>1]=ce(),m=0}}return m}(r,e,t,0!=(0|n),0!=(0|u)),i[922]=0,0|t},Dtr_Yr:function(e){return a[p(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return a[p(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return i[p(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return a[p(e|=0,20)+3624>>1]},Dtr_Min:function(e){return a[p(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return a[p(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return a[p(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return a[p(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return a[p(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,o,u,s,l,c,d){e|=0,t|=0,r|=0,n|=0,o|=0,u|=0,s|=0,l|=0,c|=0,d=p(d|=0,20),a[d+3634>>1]=c,a[d+3632>>1]=l,a[d+3630>>1]=s,a[d+3628>>1]=u,a[d+3626>>1]=o,a[d+3624>>1]=n,i[d+3620>>2]=r,a[d+3618>>1]=t,a[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,i[920]=0,i[921]=0,function(e,t,r){var n,o=0;_=n=_-16|0;e:{t:{r:{if((s[e+2>>1]+-32767&65535)>>>0>1){if(a[e+18>>1]>=1?(se(a[e+16>>1]),o=Ce(v[i[1152+(a[e+18>>1]<<2)>>2]>>3]),se(a[e+12>>1]),$(o)):se(a[e+12>>1]),o=Ce(v[380]),se(a[e+10>>1]),$(o),o=Ce(v[380]),se(a[e+8>>1]),$(o),o=Ce(v[379]),!((0|G(e,t,r,n+12|0))<0)){if(e=i[n+12>>2],!t)break r;if(se(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,Y(8);break e}ue(e)}$(o)}_=n+16|0}(p(e,20)+3616|0,0!=(0|t),0!=(0|r)),+v[460]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[920]=0,i[921]=0,function(e,t,r,n,o){var u,l=0;_=u=_-16|0;e:{t:{r:{if((s[e+2>>1]+-32767&65535)>>>0>1){n:if(a[e+18>>1]>=1){if(se(a[e+16>>1]),ie(v[i[1152+(a[e+18>>1]<<2)>>2]>>3]),l=v[460],2==(0|o)){v[460]=n,$(l);break n}se(a[e+12>>1]),$(l)}else 2!=(0|o)?se(a[e+12>>1]):v[460]=n;if(ie(v[380]),l=v[460],1!=(0|o)?se(a[e+10>>1]):v[460]=n,$(l),ie(v[380]),l=v[460],o?se(a[e+8>>1]):v[460]=n,$(l),ie(v[379]),n=v[460],!((0|G(e,t,r,u+12|0))<0)){if(e=i[u+12>>2],!t)break r;if(se(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,Y(8);break e}ue(e)}$(n)}_=u+16|0}(p(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|o),n),+v[460]},Dtr_Days:function(){return i[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(p(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){v[460]=e,$(v[i[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(v[380]);ne(v[380])}ne(v[379]),me()}(e=+e,t|=0,r|=0),+v[460]},Dtr_UtcToLocal:function(e,t,r,n,o,u,l,c){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,u|=0,l|=0,c|=0,_=d=_-32|0,i[d+24>>2]=u,i[d+16>>2]=n,i[d+8>>2]=t,i[d+20>>2]=(0|o)>-1?p(o,20)+3616|0:0,i[d+12>>2]=(0|r)>-1?p(r,20)+3616|0:0,e=function(e,t,r,n){var o,u=0;_=o=_-32|0,function(e,t,r){var n,o=0,u=0,l=0,c=0,d=0,f=0,h=0,v=0,m=0,g=0,S=0,b=0;if(_=n=_-96|0,i[n+64>>2]=a[t>>1],i[n+68>>2]=a[t+2>>1],i[n+72>>2]=i[t+4>>2],i[n+76>>2]=a[t+8>>1],i[n+80>>2]=a[t+10>>1],i[n+84>>2]=a[t+12>>1],i[n+92>>2]=a[t+14>>1]+-1,(o=a[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=p(a[t+16>>1],100);break e;case 1:o=p(a[t+16>>1],10);break e;case 2:break t;default:break e}o=a[t+16>>1]}i[n+88>>2]=o}t=0;e:if(V(n- -64|0,n+40|0)){if(l=Ne(l=p(i[e>>2],60),l>>31,1e7,0),d=L,(u=i[e+4>>2])&&(c=i[e+12>>2])){if(i[n+64>>2]=a[u>>1],i[n+68>>2]=a[u+2>>1],i[n+72>>2]=i[u+4>>2],i[n+76>>2]=a[u+8>>1],i[n+80>>2]=a[u+10>>1],i[n+84>>2]=a[u+12>>1],i[n+92>>2]=a[u+14>>1]+-1,(o=a[u+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[u+16>>1],100);break t;case 1:o=p(a[u+16>>1],10);break t;case 2:break r;default:break t}o=a[u+16>>1]}i[n+88>>2]=o}if(i[n+8>>2]=a[c>>1],i[n+12>>2]=a[c+2>>1],i[n+16>>2]=i[c+4>>2],i[n+20>>2]=a[c+8>>1],i[n+24>>2]=a[c+10>>1],i[n+28>>2]=a[c+12>>1],i[n+36>>2]=a[c+14>>1]+-1,(o=a[c+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[c+16>>1],100);break t;case 1:o=p(a[c+16>>1],10);break t;case 2:break r;default:break t}o=a[c+16>>1]}i[n+32>>2]=o}if(u=i[n+44>>2],c=u,o=i[n+40>>2],!H(n- -64|0,n+56|0,o,u))break e;if(!H(n+8|0,n+48|0,o,c))break e;m=i[n+40>>2],h=i[n+44>>2],g=l,S=e+16|0,b=e+8|0,v=(c=d)+i[n+52>>2]|0,(f=(o=l)+i[n+48>>2]|0)>>>0<o>>>0&&(v=v+1|0),u=f,o=p(i[e+8>>2],60),f=Ne(o,o>>31,1e7,0),o=L+v|0,v=u=u+f|0,f=o=u>>>0<f>>>0?o+1|0:o,u=d+i[n+60>>2]|0,(d=l+i[n+56>>2]|0)>>>0<l>>>0&&(u=u+1|0),e=p(i[e+16>>2],60),l=Ne(e,e>>31,1e7,0),e=L+u|0,e=(d=l+d|0)>>>0<l>>>0?e+1|0:e,l=d,e=Ne(e=p(i[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(v>>>0>=l>>>0)?((0|h)<(0|e)?1:(0|h)<=(0|e)?m>>>0>=l>>>0?0:1:0)&((0|h)>(0|f)?1:(0|h)>=(0|f)?m>>>0<v>>>0?0:1:0):((0|h)<(0|e)?1:(0|h)<=(0|e)?m>>>0>=l>>>0?0:1:0)|((0|h)>(0|f)?1:(0|h)>=(0|f)?m>>>0<v>>>0?0:1:0))?S:b)>>2],60),e>>31,1e7,0),o=L+c|0,d=o=(l=g+e|0)>>>0<e>>>0?o+1|0:o}e=i[n+40>>2],o=i[n+44>>2]-(d+(e>>>0<l>>>0)|0)|0,l=e-l|0,(0|(e=o))<0||(0|e)<=0&&!(l>>>0>=0)||(j(l,e,n- -64|0),a[r>>1]=i[n+64>>2],a[r+2>>1]=i[n+68>>2],i[r+4>>2]=i[n+72>>2],t=1,a[r+14>>1]=s[n+92>>1]+1,a[r+8>>1]=i[n+76>>2],a[r+10>>1]=i[n+80>>2],a[r+12>>1]=i[n+84>>2],e=i[n+88>>2],a[r+18>>1]=3,a[r+16>>1]=e)}return _=n+96|0,t}(n,e,o+8|0)&&(n=i[o+12>>2],i[e>>2]=i[o+8>>2],i[e+4>>2]=n,i[e+16>>2]=i[o+24>>2],n=i[o+20>>2],i[e+8>>2]=i[o+16>>2],i[e+12>>2]=n,n=e,(0|G(e,t,r,o+28|0))>=0?e=1+((i[o+28>>2]+6|0)%7|0)|0:(i[o+28>>2]=-1,e=6),a[n+14>>1]=e,u=1);return _=o+32|0,u}(p(e,20)+3616|0,0!=(0|l),0!=(0|c),d+8|0),_=d+32|0,0|e},Mathpack_Zero:function(){return+v[375]},Mathpack_One:function(){return+v[374]},Mathpack_Pi:function(){return+v[370]},Mathpack_Div:function(e,t){return+oe(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,u=0;v[460]=t,f(+t),r=0|l(1),l(0),o=r,i[921]=2147483647&r,t=v[460];e:{if(f(+ye(v[371])),r=0|l(1),n=0|l(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)v[460]=e,ve();else if(me(),f(+ye(t)),r=0|l(1),n=0|l(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=ce()))){if(v[460]=e,f(+e),n=0|l(1),l(0),(0|(n=(r=n)>>>16<<16))>=1)le(),ne(t),ge();else if(!((0|n)>-1)){if(Ee(v[374],t),u=z(v[460]),v[460]=u,me(),f(+ye(u)),65535==(0|(n=0|l(1)))&l(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;v[460]=e,i[921]=2147483647&r,le(),ne(t),ge(),(r=i[921])>>>0<65536||(i[921]=-2147483648^r)}}else v[460]=e,function(e){var t,r=0;if(!((t=a[1843])|e))return void(i[922]=4&i[922]?4:64);if(!((0|t)<1)&&10==(0|ce())){if(r=v[460],me(),te(r),!s[1843])return void Q(e);v[460]=r}r=1;for(;1&e&&(r=ae(v[460],r)),e>>>=1;)ne(v[460]);v[460]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[922]))return i[920]=0,i[921]=0,i[922]=-2&o,v[460];ke(v[374])}return v[460]}return i[922]=8,v[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|l(1),l(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,u=0,s=0;f(+(e=+e)),o=0|l(1),r=0|l(0),n=o,i=o,f(+t),a=0|l(1),o=0|l(0),s=-1;e:{if(!((0|n)<(0|(u=a))||(s=1,(0|i)>(0|u)))){if(u=0,(0|o)==(0|r))break e;s=r>>>0<o>>>0?-1:1}o=s,u=(a&n)>-1?o:0-o|0}return 0|u},Mathpack_TakeMathError:function(){var e;return e=i[922],i[922]=0,0|e},Mathpack_Trunc:function(e){return+J(e=+e)},Mathpack_Ceil:function(e){return e=+e,v[460]=e,function(){var e=0,t=0,r=0;e:{if(r=i[920],e=i[921],t=-65536&e){if(2146435072==(2146435072&e))return i[922]=1,void me();if((0|t)>0)break e}return void me()}me(),(0|r)==i[920]&&i[921]==(0|e)||$(1)}(),+v[460]},Mathpack_Floor:function(e){return e=+e,v[460]=e,Z(),+v[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|l(1),t&=2147483647,c(0,0|(0|l(0))),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,a;return f(+(e=+e)),n=-2147483648^(t=0|l(1)),c(0,0|(r=0|l(0))),c(1,0|n),a=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|he(e=+e)},Mathpack_SFix:function(e){return e=+e,v[460]=e,0|q()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,u=0,c=0,d=0;_=r=_+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,v[460]=e,f(+e),o=0|l(1),l(0);e:if(u=-65536&o)if(2146435072!=(2146435072&o)){(0|u)>0||(d=32768,o>>>0<65536||(i[921]=-2147483648^o,e=v[460])),be(e,r+56|0,r+16|0,15),s[r+58>>1]||(a[r+56>>1]=1),v[460]=t,o=(0|(o=q()))<0?100:o;t:{if(u=i[921],c=-65536&u)if(2146435072!=(2146435072&u)){if(!((0|c)>0)){if((o=i[921])>>>0>=65536&&(i[921]=-2147483648^o),(0|(o=q()))<=-1)break t;o=0-o|0}}else i[922]=1;u=a[r+56>>1],c=o+u|0,o=a[r+58>>1],(0|c)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=u,X(r+16|0,r+8|0,r+12|0,c),o=i[r+12>>2],a[r+58>>1]=o,u=i[r+8>>2],a[r+56>>1]=u),n[r+46|0]=o,a[r+48>>1]=u+16384&32767|d,Se(3100,3680,r+16|0),e=v[460];break e}e=v[375]}else i[922]=1;return _=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0;f(+e),r=0|l(1),l(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?u=(0|n)<1?-1:1:i[922]=1);if(a=B(e,t),v[460]=e,v[460]=z(e),te(a),(r=i[921])>>>0>=65536){if(2146435072==(2146435072&r))return i[922]=1,a;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|l(1),l(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[922]=1),(0|r)<=-309)return Y(8),0;Q(0-r|0),(0|u)>-1||(r=i[921])>>>0<65536||(i[921]=-2147483648^r),$(a),a=v[460]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=B(e=+e,t=+t))),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return Q(e|=0),+v[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,u=0,s=0;_=r=_-16|0,v[r+8>>3]=e,v[r>>3]=t,f(+e),n=0|l(1),a=0|l(0),o=n,f(+t),n=0|l(1),u=0|l(0),s=n;e:{if((0|a)!=(0|u)||(0|o)!=(0|n)){if((s+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=z(e),v[r+8>>3]=e,f(+e),n=0|l(1),l(0),o=n,e=z(t),v[r>>3]=e,f(+e),n=0|l(1),l(0),s=n),n=1,o=i[(u=(a=(s&o)>-1)?r+8|0:r)+4>>2],s=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|s))break e;if((0|o)<(0|s)){n=-1;break e}if(u=i[u>>2],a=i[a>>2],u>>>0>a>>>0)break e;if(n=-1,u>>>0<a>>>0)break e}n=0}return _=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|l(1),l(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return f(+(e=+e)),a=0|l(1),r=0|l(0),f(+t),n=0|l(1),0|(a=(0|r)==(0|l(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|l(1),l(0),2146435072==(2146435072&t)?(i[922]=1,-1):+z(e)},Mathpack_Sqrt:function(e){return e=+e,v[460]=e,ve(),+v[460]},Mathpack_Exp:function(e){return e=+e,v[460]=e,ge(),+v[460]},Mathpack_Ln:function(e){return e=+e,v[460]=e,le(),+v[460]},Mathpack_Log:function(e){return e=+e,v[460]=e,function(){var e,t;e=+N(+v[460]),v[460]=e,f(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[922]=8)}(),+v[460]},Mathpack_Sin:function(e){return e=+e,v[460]=e,function(){var e=0,t=0;f(+(t=v[460])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),v[460]=t,f(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+v[460]},Mathpack_Cos:function(e){return e=+e,v[460]=e,function(){var e=0,t=0;f(+(t=v[460])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+F(+t),v[460]=t,f(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+v[460]},Mathpack_Tan:function(e){return e=+e,v[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=v[460])),e=0|l(1),l(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+O(+t),v[460]=t,r=4,f(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[922]=r)}(),+v[460]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,v[460]=e,pe(),+v[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0,s=0;v[460]=e;e:{if(f(+e),r=0|l(1),l(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[922]=1}v[460]=t;t:{if(f(+t),r=0|l(1),l(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[922]=1}return Y(4),0}return se((0|n)<1?-1:1),ne(v[370]),ie(v[372]),v[460]}e:if((0|r)<=-1){f(+t),r=0|l(1),l(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[922]=1;a=v[370];break e}f(+(a=v[370])),r=0|l(1),n=0|l(0),o=-2147483648^r,c(0,0|n),c(1,0|o),u=+d(),s=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?u:s}else a=v[375];return Ee(t,e),pe(),$(a),v[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,u=0,c=0;return f(+(e=+e)),r=0|l(1),o=0|l(0),2146435072==(2146435072&r)?(i[922]=1,-1):(v[460]=e,u=3104,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(u=3104,(0|n)>0||(c>>>0>=65536&&(i[921]=-2147483648^c),u=3104,!o&-2147483648==(0|r)||(a[1552]=45,u=3106))):(i[922]=1,u=3104)),c=u,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;_=o=_-16|0,e=0|Fe[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else be(v[460],o+8|0,t,15),t=function(e,t,r,n,o,u){var l,c,d,f=0,h=0,v=0,m=0,g=0;_=c=_-16|0,l=(t<<1)+e|0,d=c+12|0;t:{r:{n:{a:if(!(v=(0|r)<5&(h=o?n:1)+3>>>0<8)){i:if(!((0|h)>(0|r))){if((0|(n=r+h|0))>=3){if((0|r)<5|(0|h)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(m=1,n=1,(0|r)<7)break n;n=r-(h+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,h))&&(n=r-((0|h)<(0|r)?(0|h)<1?2-h|0:1:0)|0)}n:{if((0|n)<(0|o)){f=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(s[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(s[(n<<1)+e>>1]<=52)break i;for(;;){if(g=s[(f=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[f>>1]=g,58!=(65535&g))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,f=h+1|0;break a}for(;(0|(o=n))>=2&&48==s[((n=o+-1|0)<<1)+e>>1];);f=h}if((-1^v)&(0|f)>(0|r)|m)break n;break r}if(f=h,!m)break r}if(i[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=l>>>0?n=r:(o=o+-1|0,i[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&k(),x(e,r,o<<1),a[r>>1]=u),n>>>0<l>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=l>>>0?o=n:(o=n+2|0,(0|f)<=0?(a[n>>1]=45,f=1-f|0):(a[n>>1]=43,f=f+-1|0)),(0|f)<100|o>>>0>=l>>>0||(e=(f>>>0)/100|0,a[o>>1]=e+48,f=f-p(e,100)|0,o=o+2|0),o>>>0<l>>>0&&(a[o>>1]=48+((0|f)/10|0),o=o+2|0),o>>>0>=l>>>0)break t;a[o>>1]=48+((0|f)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|f))if(r=o-f|0,i[d>>2]=r,(0|f)>=1){if(!((r=(n=((v=(r=(h=(0|f)>(0|t)?t:f)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=l>>>0))for(;a[n>>1]=s[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=v>>>0;);(0|f)<(0|t)&&(a[v>>1]=u),o=v+(((0|(e=l-v>>1))>(0|(t=o-h|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(o<<1)|0)|0)>>>0>=l>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=s[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<l>>>0&&(a[e>>1]=u,e=e+2|0),n=l-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return _=c+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return _=o+16|0,t}(i[256],c,3614-c>>1,(0|t)>0?t:0),i[920]=0,i[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return i[924]},Mathpack_FormatGetSign:function(){return i[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,u=0;return _=n=_+-64|0,f(+(e=+e)),o=0|l(1),l(0),2146435072!=(2146435072&o)?(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,be(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),u=a[n+56>>1],o=a[n+58>>1],i[n+8>>2]=o,t=t+u|0,i[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=i[n+8>>2]),o?((0|(r=r+(t=i[n+12>>2])|0))<(0|o)&&(i[n+8>>2]=r,o=r),(0|o)>-1||(i[922]=1)):(o=0,i[n+12>>2]=0,t=0),i[924]=t,i[925]=s[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(k(),r=i[n+8>>2]),x(3104,n+16|0,o<<1)):(i[922]=1,r=-1),_=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,u=0,c=0;if(_=n=_+-64|0,f(+(e=+e)),u=0|l(1),l(0),2146435072!=(2146435072&u)){if(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,be(e,n+56|0,n+16|0,15),c=a[n+56>>1],i[n+12>>2]=c,u=a[n+58>>1],i[n+8>>2]=u,(0|(o=t))>=2&&(o=(0|c)%(0|t)|0,o=((0|c)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|u))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(u=i[n+8>>2]))?o:u;u=o,(0|o)>=1&&48==s[(n+16|0)+((o=u+-1|0)<<1)>>1];);i[n+8>>2]=u,(0|t)<2||(0|(o=i[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|u)||(k(),u=i[n+8>>2]))}(0|u)<=-1&&(i[922]=1),i[924]=i[n+12>>2],i[925]=s[n+48>>1]>>>15^1,(o=u)>>>0>=256&&(k(),o=i[n+8>>2]),x(3104,n+16|0,u<<1)}else i[922]=1,o=-1;return _=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,_=o=_-48|0,n[o+39|0]=0,x(o+8|0,3104,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,Se(i[256],o,o+8|0)&&(i[922]=1),_=o+48|0,+v[o>>3]},_start:P,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,i[926]||(i[927]=t,i[926]=e)},stackSave:function(){return 0|_},stackAlloc:function(e){return _=e=_-(e|=0)&-16,0|e},stackRestore:function(e){_=e|=0},__growWasmMemory:function(e){return 0,0|k()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},v),g=m.memory;t.memory=g;var S=m.Base_StrBuf;t.Base_StrBuf=S;var b=m.Base_StrBufSize;t.Base_StrBufSize=b;var y=m.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=y;var C=m.Dtr_FromNum;t.Dtr_FromNum=C;var k=m.Dtr_Yr;t.Dtr_Yr=k;var E=m.Dtr_Mon;t.Dtr_Mon=E;var A=m.Dtr_DOM;t.Dtr_DOM=A;var R=m.Dtr_Hour;t.Dtr_Hour=R;var N=m.Dtr_Min;t.Dtr_Min=N;var T=m.Dtr_Sec;t.Dtr_Sec=T;var I=m.Dtr_Wdy;t.Dtr_Wdy=I;var F=m.Dtr_FracSec;t.Dtr_FracSec=F;var O=m.Dtr_Rounding;t.Dtr_Rounding=O;var D=m.Dtr_Write;t.Dtr_Write=D;var M=m.Dtr_ToNum;t.Dtr_ToNum=M;var w=m.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=w;var _=m.Dtr_Days;t.Dtr_Days=_;var L=m.Dtr_ToDays;t.Dtr_ToDays=L;var P=m.Dtr_ToTime;t.Dtr_ToTime=P;var x=m.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var B=m.Mathpack_Zero;t.Mathpack_Zero=B;var U=m.Mathpack_One;t.Mathpack_One=U;var G=m.Mathpack_Pi;t.Mathpack_Pi=G;var j=m.Mathpack_Div;t.Mathpack_Div=j;var V=m.Mathpack_Mul;t.Mathpack_Mul=V;var H=m.Mathpack_Sub;t.Mathpack_Sub=H;var W=m.Mathpack_Add;t.Mathpack_Add=W;var K=m.Mathpack_Power;t.Mathpack_Power=K;var z=m.Mathpack_Cond;t.Mathpack_Cond=z;var Y=m.Mathpack_Cond2;t.Mathpack_Cond2=Y;var q=m.Mathpack_TakeMathError;t.Mathpack_TakeMathError=q;var J=m.Mathpack_Trunc;t.Mathpack_Trunc=J;var Q=m.Mathpack_Ceil;t.Mathpack_Ceil=Q;var X=m.Mathpack_Floor;t.Mathpack_Floor=X;var Z=m.Mathpack_Abs;t.Mathpack_Abs=Z;var $=m.Mathpack_Neg;t.Mathpack_Neg=$;var ee=m.Mathpack_Float;t.Mathpack_Float=ee;var te=m.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=m.Mathpack_Fix;t.Mathpack_Fix=re;var ne=m.Mathpack_LFix;t.Mathpack_LFix=ne;var ae=m.Mathpack_SFix;t.Mathpack_SFix=ae;var ie=m.Mathpack_Round;t.Mathpack_Round=ie;var oe=m.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var ue=m.Mathpack_RoundDown;t.Mathpack_RoundDown=ue;var se=m.Mathpack_TenTo;t.Mathpack_TenTo=se;var le=m.Mathpack_Compare;t.Mathpack_Compare=le;var ce=m.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=m.Mathpack_Equal;t.Mathpack_Equal=de;var fe=m.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var he=m.Mathpack_Sqrt;t.Mathpack_Sqrt=he;var ve=m.Mathpack_Exp;t.Mathpack_Exp=ve;var pe=m.Mathpack_Ln;t.Mathpack_Ln=pe;var me=m.Mathpack_Log;t.Mathpack_Log=me;var ge=m.Mathpack_Sin;t.Mathpack_Sin=ge;var Se=m.Mathpack_Cos;t.Mathpack_Cos=Se;var be=m.Mathpack_Tan;t.Mathpack_Tan=be;var ye=m.Mathpack_Asin;t.Mathpack_Asin=ye;var Ce=m.Mathpack_Acos;t.Mathpack_Acos=Ce;var ke=m.Mathpack_Atan;t.Mathpack_Atan=ke;var Ee=m.Mathpack_Atan2;t.Mathpack_Atan2=Ee;var Ae=m.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Ae;var Re=m.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Re;var Ne=m.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Ne;var Te=m.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Te;var Ie=m.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ie;var Fe=m.Mathpack_Pack;t.Mathpack_Pack=Fe;var Oe=m._start;t._start=Oe;var De=m.__errno_location;t.__errno_location=De;var Me=m.setThrew;t.setThrew=Me;var we=m.stackSave;t.stackSave=we;var _e=m.stackAlloc;t.stackAlloc=_e;var Le=m.stackRestore;t.stackRestore=Le;var Pe=m.__growWasmMemory;t.__growWasmMemory=Pe},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a,i=r(8).createPerf();t.watchdog=(n=1/0,(a=function(e){if(void 0===e&&(e=""),i.now()>n)throw new Error("Time limit exceeded with message: "+e)}).arm=function(e){n=i.now()+e},a)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}t.createPerf=n;var a=function(){function e(e){this.perf=n(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=a},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(5),o=r(7);function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var s=((n={})[a.Over]=u(a.Over),n[a.Under]=u(a.Under),n[a.DivBy0]=u(a.DivBy0),n[a.Trans]=u(a.Trans),n);function l(e){var t;return null!==(t=s[e])&&void 0!==t?t:u(e)}function c(e){return function(t){var r=e(t),n=i.Mathpack_TakeMathError();return n===a.None?r:l(n)}}function d(e){return function(t,r){var n=e(t,r),o=i.Mathpack_TakeMathError();return o===a.None?n:l(o)}}t.mathError=l,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==i.Mathpack_Equal(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=c(i.Mathpack_Ceil),t.floor=c(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?i.Mathpack_SFloat(e):i.Mathpack_Float(e)},t.fix=function(e){return i.Mathpack_Fix(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=c(i.Mathpack_SFix),t.round=d(i.Mathpack_Round),t.roundUp=d(i.Mathpack_RoundUp),t.roundDown=d(i.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return l(a.Over);if(!isFinite(e))return l(a.Over);var t=i.Mathpack_TenTo(e),r=i.Mathpack_TakeMathError();return r===a.None?t:l(r)},t.compare=i.Mathpack_Compare,t.div=d(i.Mathpack_Div),t.mul=d(i.Mathpack_Mul),t.sub=d(i.Mathpack_Sub),t.add=d(i.Mathpack_Add),t.power=d(i.Mathpack_Power),t.cond=function(e){var t=i.Mathpack_Cond(e),r=i.Mathpack_TakeMathError();return r===a.None?t:l(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=c(i.Mathpack_ViewRound),t.sqrt=c(i.Mathpack_Sqrt),t.exp=c(i.Mathpack_Exp),t.ln=c(i.Mathpack_Ln),t.log=c(i.Mathpack_Log),t.sin=c(i.Mathpack_Sin),t.cos=c(i.Mathpack_Cos),t.tan=c(i.Mathpack_Tan),t.asin=c(i.Mathpack_Asin),t.acos=c(i.Mathpack_Acos),t.atan=c(i.Mathpack_Atan),t.atan2=d(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{o.setLocale(e);var n=i.Mathpack_FormatGeneral(t,r);return n<0?l(i.Mathpack_TakeMathError()):o.pxcharToStr(i.Base_StrBuf(),n)}finally{o.setLocale(void 0)}},t.formatFixed=function(e,t,r){var n=i.Mathpack_FormatFixed(e,t,r);if(n<0)return i.Mathpack_TakeMathError();var a=o.pxcharToStr(i.Base_StrBuf(),n),u=i.Mathpack_FormatGetExponent();return{sign:0!==i.Mathpack_FormatGetSign(),mantissa:a,exponent:u}},t.formatScientific=function(e,t,r){var n=i.Mathpack_FormatScientific(e,t,r);if(n<0)return i.Mathpack_TakeMathError();var a=o.pxcharToStr(i.Base_StrBuf(),n),u=i.Mathpack_FormatGetExponent();return{sign:0!==i.Mathpack_FormatGetSign(),mantissa:a,exponent:u}},t.pack=function(e,t,r,n){try{o.setLocale(e);var u=o.fastMin(n.length,i.Base_StrBufSize());o.strToPxchar(i.Base_StrBuf(),n.substring(0,u));var s=i.Mathpack_Pack(!!t,r,u),c=i.Mathpack_TakeMathError();return c!==a.None?l(c):isNaN(s)?l(a.Over):s}finally{o.setLocale(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),a=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,a){n.watchdog("wd0x1a9bd3");var i;if(i=e.cell_both_absolute.exec(t)){var o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o,u,0]}if(n.watchdog("wd0xa26bda"),i=e.cell_col_absolute.exec(t)){o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o,u-a,0]}if(n.watchdog("wd0x2a23e1"),i=e.cell_row_absolute.exec(t)){o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o-r,u,0]}if(n.watchdog("wd0x3ebc91"),i=e.cell_both_relative.exec(t)){o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o-r,u-a,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var a=e.cell_dependency(t,0,0),i=e.cell_dependency(r,0,0),o="R",u="C";n&&(o="",u="");var s=[];i.forEach((function(e,t,r){s.push(e-a[t])}));var l="";return e.cell_both_absolute.exec(r)?l=o+i[1]+u+i[0]:e.cell_col_absolute.exec(r)?(0===s[1]?l+=o:l+=o+"["+s[1]+"]",l+=u+i[0]):e.cell_row_absolute.exec(r)?(0===s[0]?l+=u:l+=u+"["+s[0]+"]",l=o+i[1]+l):(0===s[1]?l+=o:l+=o+"["+s[1]+"]",0===s[0]?l+=u:l+=u+"["+s[0]+"]"),l},e.formulaToR1C1=function(t,r,n){for(var a,i=t.slice(),o=e.column_index_to_name(r)+n;a=e.range_pair.exec(i);)if(a){var u=a[1];a[2];i=i.replace(a[0],e.toR1C1(o,a[1],!0)+":"+e.toR1C1(o,a[2],!0))}for(var s=null;s=e.single_dep.exec(i);)if(s){u=s[1];i=i.replace(s[0],e.toR1C1(o,u,!0))}return i=(i=i.replace(//g,"R")).replace(//g,"C")},e.extract_sheet_cell=function(t){n.watchdog("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,a,i){void 0===i&&(i=!0),n.watchdog("wd0x2f82fe");var o=null,u=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=e.range_pair.exec(t);)if(n.watchdog("wd0x784918"),o){for(var s=o[1],l=e.cell_dependency(s,r,a),c=o[2],d=e.cell_dependency(c,r,a),f=d[0]-l[0]+1,h=d[1]-l[1]+1,v=0;v<f;v++)for(var p=0;p<h;p++)u.push([v+l[0],p+l[1],0]);t=t.replace(o[0],"_")}for(var m=null;m=e.single_dep.exec(t);)if(n.watchdog("wd0x0fb232"),m){s=m[1];var g=e.cell_dependency(s,r,a);u.push(g),t=t.replace(m[0],"_")}if(i)for(var S=null;S=e.number_dep.exec(t);)n.watchdog("wd0xd82ed1"),S&&(u.push([0,0,1]),t=t.replace(S[0],"_"));return u},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var a=null;a=e.single_dep.exec(t);)a&&(t=t.replace(a[0],"_"));for(var i=null;i=e.number_dep.exec(t);)i&&(r.push(parseFloat(i)),t=t.replace(i[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,a,i,o){n.watchdog("wd0x961028");var u=[];if(t>=o.length||r>=o[0].length||t<0||r<0)return[];var s=o[t][r];return s.length>1&&"="===s[0]&&(u=e.all_cell_dependencies(s,i,a)),u},e.generate_all_references=function(t,r,a){n.watchdog("wd0x6a6002");for(var i={},o=0;o<t.length;o++)for(var u=t[o],s=0;s<u.length;s++){n.watchdog("wd0x93d412");var l=u[s];if("="===l[0])for(var c=0,d=e.all_cell_dependencies(l,0,0);c<d.length;c++){var f=d[c];if(n.watchdog("wd0x8a466e"),0===f[0]&&0===f[1]&&0!==f[2]);else{var h=f[0]-r-1,v=f[1]-a-1,p=!1;if(v>=t.length||h>=t[0].length||h<0||v<0)p=!0;else{var m=t[v][h];void 0!==m&&"="!==m[0]&&(p=!0)}p&&(i[f.join(",")]=!0)}}}return i},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),a=r(32),i=r(8),o=r(33),u=r(34),s=r(36),l=r(6);function c(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var f=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,a){l.watchdog("wd0xea1170");for(var i=JSON.stringify(n.ExcelUtils.baseVector()),o=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},u=[],s=0;s<t.length;s++){l.watchdog("wd0xa1597b");for(var c=t[s],d=0;d<c.length;d++){l.watchdog("wd0x0d7fc8");var f=c[d].toString();if(f.length>0){var h=n.ExcelUtils.all_dependencies(s,d,a+s,r+d,t),v=d+r+1,p=s+a+1;if(0===h.length)"="===f[0]&&u.push([[v,p,0],e.distinguishedZeroHash]);else{var m=h.reduce(o);if(JSON.stringify(m)===i)u.push([[v,p,0],m.toString()]);else{var g=this.hash_vector(m).toString();u.push([[v,p,0],g])}}}}}return u},e.color_all_data=function(t){for(var r=[],n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];l.watchdog("wd0xc22046");var o=i.split(","),u=Number(o[0]),s=Number(o[1]);r.push([[u,s,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,a){for(var i=[],o=0;o<t.length;o++){l.watchdog("wd0x503d57");for(var u=t[o],s=0;s<u.length;s++){l.watchdog("wd0x366ad1");var c=u[s].toString();if(c.length>0&&"="!==r[o][s][0])if(Number(c).toString()===c){var d=s+n+1,f=o+a+1;i.push([[d,f,1],e.distinguishedZeroHash])}}}return i},e.identify_ranges=function(e,t){for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];l.watchdog("wd0x770d8c"),r[i[1]]=r[i[1]]||[],r[i[1]].push(i[0])}for(var o=0,u=Object.keys(r);o<u.length;o++){var s=u[o];l.watchdog("wd0x84ae4d"),r[s].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,a=1;t||(n=1,a=0);for(var i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];l.watchdog("wd0xa372ae"),r[u]=[];for(var s=e[u].shift(),c=s,d=0,f=e[u];d<f.length;d++){var h=f[d];h[n]===c[n]&&h[a]===c[a]+1||(r[u].push([s,c]),s=h),c=h}r[u].push([s,c])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,a,i){for(var o=new Array(t),u=0;u<t;u++)o[u]=new Array(r).fill(0);for(var s=0,l=i;s<l.length;s++){var c=l[s],d=c[0],f=d[0],h=d[1],v=d[2],p=c[1],m=h-a-1,g=f-n-1,S=Number(e.distinguishedZeroHash);1===v||(S=Number(p)),o[m][g]=S}return o},e.stencilize=function(e){return s.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),a=0;a<e;a++)n[a]=new Array(t).fill(0);var i=0,o={};for(a=0;a<e;a++)for(var u=0;u<t;u++)o[r[a][u]]=o[r[a][u]]+1||1,0!==r[a][u]&&(i+=1);for(a=0;a<e;a++)for(u=0;u<t;u++)n[a][u]=o[r[a][u]]/i;var s=0,l=0;for(a=0;a<e;a++)for(u=0;u<t;u++)r[a][u]>0&&(l+=o[r[a][u]]);for(a=0;a<e;a++)for(u=0;u<t;u++)o[r[a][u]]>0&&(s+=this.entropy(o[r[a][u]]/l));Math.log2(i);return n},e.generate_suspicious_cells=function(e,t,r,n,a,i,o){void 0===o&&(o=.01);for(var u=[],s=0,l=0,c=0;c<e;c++)for(var d=0;d<t;d++){var f=d+r+1,h=c+n+1;i[c][d]>0&&(s+=a[c][d],l+=1,i[c][d]<=o&&0!==a[c][d]&&u.push([f,h,i[c][d]]))}var v=s/l;return u.sort((function(e,t){return Math.abs(t[2]-v)-Math.abs(e[2]-v)})),u},e.process_suspicious=function(t,r,a){l.watchdog("wd0x72fd38");new i.Timer("process_suspicious");var o=n.ExcelUtils.extract_sheet_cell(t),u=(o[0],o[1]),s=n.ExcelUtils.cell_dependency(u,0,0),c=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):c=e.process_formulas(r,s[0]-1,s[1]-1);var f=[],h=[],v=a.length,p=a[0].length;if(a.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var m=n.ExcelUtils.generate_all_references(r,s[0]-1,s[1]-1);f=e.color_all_data(m),h=e.process_values(a,r,s[0]-1,s[1]-1)}var g=e.identify_groups(f),S=e.identify_groups(c),b=[];return a.length<1e4&&(b=e.find_suspicious_cells(v,p,s,r,c,h,1)),d(b,S,g,e.generate_proposed_fixes(S))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var i=t[0],o=t[1],u=n[0],s=n[1],l=a.RectangleUtils.area([[i[0],i[1],0],[o[0],o[1],0]]),c=a.RectangleUtils.area([[u[0],u[1],0],[s[0],s[1],0]]),d=Math.min(l,c),f=Math.max(l,c),h=Math.min(r,e),v=Math.max(r,e),p=Math.abs(v-h)/this.Multiplier;p<1&&(p=1);var m=(1+this.entropydiff(d,f))/(p*d);return m=-m},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],i=n[0],o=n[1],u=e[r][2],s=u[0],l=u[1];t+=a.RectangleUtils.diagonal([[i[0],i[1],0],[o[0],o[1],0]]),t+=a.RectangleUtils.diagonal([[s[0],s[1],0],[l[0],l[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var a in t){if(t[a][1]>t[a][2]){var i=t[a][1];t[a][1]=t[a][2],t[a][2]=i}r[JSON.stringify(t[a][1])]=t[a],n[JSON.stringify(t[a][2])]=t[a]}var o=[],u={};for(var a in t){var s=t[a][0];if(!(-s<e.reportingThreshold/100)){var l=JSON.stringify(t[a][1]),c=JSON.stringify(t[a][2]);if(l in n||c in r){if(!u[l]&&l in n){var d=[-s*JSON.parse(n[l][0]),t[a][1],n[l][1]];o.push(d),u[l]=!0,u[c]=!0;continue}if(!u[c]&&c in r){d=[-s*JSON.parse(r[c][0]),t[a][1],r[c][2]];o.push(d),u[c]=!0,u[l]=!0}}else o.push(t[a])}}return o},e.generate_proposed_fixes=function(e){var t=u.find_all_proposed_fixes(e);return t.sort(c),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];l.watchdog("wd0x781a33");var a=e[n].slice();e[n]=this.merge_individual_groups(a)}return e},e.merge_individual_groups=function(e){var t=new i.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){l.watchdog("wd0x0a3668");for(var n=!1,o={},u=[],s=e.slice();s.length>0;)for(var c=s.shift(),d=0;d<s.length;d++)if(l.watchdog("wd0x9cf1d5"),a.RectangleUtils.is_mergeable(c,s[d])){var f=JSON.stringify(c),h=JSON.stringify(s[d]);if(!(f in o)&&!(h in o)){u.push(a.RectangleUtils.bounding_box(c,s[d])),o[f]=!0,o[h]=!0,n=!0;break}}for(d=0;d<e.length;d++)l.watchdog("wd0x1bc2bb"),JSON.stringify(e[d])in o||u.push(e[d]);if(u.sort(),!n)return u;if(e=u.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),a=Math.abs(e[1]-r),i=e[2];return this.Multiplier*(n+a+i)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var a=e[0];if(100*-a<1)return null;for(var i=e[1].map((function(e){return e.toString().padStart(10,"0")})),o=e[2].map((function(e){return e.toString().padStart(10,"0")})),u=i<o?e[1]:e[2],s=i<o?e[2]:e[1],l=u[0],c=l[0],f=l[1],h=u[1],v=(h[0],h[1],s[0]),p=(v[0],v[1],s[1]),m=p[0],g=p[1],S=c-r-1,b=f-n-1,y=m-r-1,C=g-n-1,k=!0,E=JSON.stringify(t[b][S]),A=b;A<=C;A++)for(var R=S;R<=y;R++){if(JSON.stringify(t[A][R])!==E){k=!1;break}}return d(a,u,s,k)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,a,i,o){return l.watchdog("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();t.Colorize=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(31);t.detect_errors=n.detect_errors},function(e,t,r){r(14),r(15),e.exports=r(37)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(a?a(h):S())},o="undefined"!=typeof window?window:void 0,u=o||{},s=u.MutationObserver||u.WebKitMutationObserver,l="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(h,1)}}var f=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var v,p,m,g,S=void 0;function b(e,t){var r=this,n=new this.constructor(k);void 0===n[C]&&M(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return O(a,n,o,r._result)}))}else I(r,n,e,t);return n}function y(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(k);return A(t,e),t}l?S=function(){return process.nextTick(h)}:s?(p=0,m=new s(h),g=document.createTextNode(""),m.observe(g,{characterData:!0}),S=function(){g.data=p=++p%2}):c?((v=new MessageChannel).port1.onmessage=h,S=function(){return v.port2.postMessage(0)}):S=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(h)}:d()}catch(e){return d()}}():d();var C=Math.random().toString(36).substring(2);function k(){}function E(t,r,n){r.constructor===t.constructor&&n===b&&r.constructor.resolve===y?function(e,t){1===t._state?N(e,t._result):2===t._state?T(e,t._result):I(t,void 0,(function(t){return A(e,t)}),(function(t){return T(e,t)}))}(t,r):void 0===n?N(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?A(e,r):N(e,r))}),(function(t){n||(n=!0,T(e,t))}),e._label);!n&&a&&(n=!0,T(e,a))}),e)}(t,r,n):N(t,r)}function A(e,t){if(e===t)T(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)N(e,t);else{var r=void 0;try{r=t.then}catch(t){return void T(e,t)}E(e,t,r)}var n,a}function R(e){e._onerror&&e._onerror(e._result),F(e)}function N(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(F,e))}function T(e,t){void 0===e._state&&(e._state=2,e._result=t,i(R,e))}function I(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(F,e)}function F(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?O(r,n,a,i):a(i);e._subscribers.length=0}}function O(t,r,n,a){var i=e(n),o=void 0,u=void 0,s=!0;if(i){try{o=n(a)}catch(e){s=!1,u=e}if(r===o)return void T(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&s?A(r,o):!1===s?T(r,u):1===t?N(r,o):2===t&&T(r,o))}var D=0;function M(e){e[C]=D++,e._state=void 0,e._result=void 0,e._subscribers=[]}var w=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(k),this.promise[C]||M(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&N(this.promise,this._result))):T(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===y){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===b&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===_){var u=new r(k);o?T(u,i):E(u,e,a),this._willSettleAt(u,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?T(n,r):this._result[t]=r),0===this._remaining&&N(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;I(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),_=function(){function t(e){this[C]=D++,this._result=this._state=void 0,this._subscribers=[],k!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){A(e,t)}),(function(t){T(e,t)}))}catch(t){T(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return _.prototype.then=b,_.all=function(e){return new w(this,e).promise},_.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},_.resolve=y,_.reject=function(e){var t=new this(k);return T(t,e),t},_._setScheduler=function(e){a=e},_._setAsap=function(e){i=e},_._asap=i,_.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=_},_.Promise=_,_.polyfill(),_},e.exports=n()},function(e,t){!function(e,t){"use strict";if(!e.setImmediate){var r,n,a,i,o,u=1,s={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){h(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){h(e.data)},r=function(e){a.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,r=function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(h,0,e)}:(i="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&h(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(i+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return s[u]=a,r(u),u++},d.clearImmediate=f}function f(e){delete s[e]}function h(e){if(l)setTimeout(h,0,e);else{var t=s[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{f(e),l=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,a=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(n=i.offset,a=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(n=i.startOffset,a=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;a=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var o=document.body.createTextRange();o.moveToElementText(a),o.setEndPoint("EndToStart",i),n=o.text.length}catch(e){return n}if(r)for(var u=!1;null!=a;)null===a.previousSibling&&null!==a.parentNode&&null!==a.parentNode.parentNode&&a.parentNode.parentNode.childNodes.length>1&&!u?(a=a.parentNode,u=!0):null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length,u&&(n+=1));else for(;null!=a;)null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function a(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,o=0;o<i.length&&t>=0;o+=1)t=a(i[o],t,r),n&&"DIV"===i[o].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var i=document.createRange();return a(e,t,(function(e,t){return i.setStart(e,t)})),a(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,o={},u=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},s=JSON.stringify(u);i(s)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,u=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(u)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var a=!1,i=r.performance;try{i&&i.now&&i.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var o=0;o<e.length;o+=1){try{if(a){t.perfNow=!0;var u=Math.floor(100*i.now())%10;(u<0||u>9)&&(u=0);for(var s=0;s<u;s+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[o]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";e.exports=r(25)()?globalThis:r(26)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),t.Math_atan=t.Math_tan=t.Math_cos=t.Math_sin=t.Math_exp=t.Math_log=t.Math_log10=t.Math_sqrt=void 0;var n=r(7);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const u=Math.exp;t.Math_exp=u;const s=Math.sin;t.Math_sin=s;const l=Math.cos;t.Math_cos=l;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),a=r(9);function i(e,t,r,n,a,i,o,u,s){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:u,rounding:s}}function o(e){return i(n.Dtr_Yr(e),n.Dtr_Mon(e),n.Dtr_DOM(e),n.Dtr_Hour(e),n.Dtr_Min(e),n.Dtr_Sec(e),n.Dtr_Wdy(e),n.Dtr_FracSec(e),n.Dtr_Rounding(e))}function u(e,t){n.Dtr_Write(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return n.Dtr_DaysPerMonth(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var i=t;return 0===n.Dtr_FromNum(e,i,0,r?1:0,a?1:0)&&o(0)},t.toNum=function(e,t,r){u(0,e);var i=n.Dtr_ToNum(0,t?1:0,r?1:0),o=n.Mathpack_TakeMathError();return o===a.MathErrorNum.None?i:a.mathError(o)},t.toNumWithDuration=function(e,t,r,i,o){u(0,e);var s=i,l=n.Dtr_ToNumWithDuration(0,t?1:0,r?1:0,s,o),c=n.Mathpack_TakeMathError();return c===a.MathErrorNum.None?l:a.mathError(c)},t.toDays=function(e,t,r){return u(0,e),0===n.Dtr_ToDays(0,t?1:0,r?1:0)&&n.Dtr_Days()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(t.TimeDivision||(t.TimeDivision={})),t.toTime=function(e,t,r){var i=t,o=r,u=n.Dtr_ToTime(e,i,o);return n.Mathpack_TakeMathError()===a.MathErrorNum.None&&u},t.utcToLocal=function(e,t,r,a){return u(0,e),null!=t.standardDate&&u(1,t.standardDate),null!=t.daylightDate&&u(2,t.daylightDate),0!==n.Dtr_UtcToLocal(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,a?1:0)&&o(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),a=r(11),i=r(8),o=r(6);function u(e,t){for(var r=e[0],n=e[1],a=t[0],i=t[1],o=[],u=r;u<=a;u++)for(var s=n;s<=i;s++)o.push([u,s,0]);return o}t.detect_errors=function(e,t,r,s){void 0===s&&(s=1/0),t=null!=t?t:a.Colorize.getFormattingDiscount(),r=null!=r?r:a.Colorize.getReportingThreshold(),o.watchdog.arm(s);for(var l={},c=0,d=e.worksheets.map((function(e){if(o.watchdog("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var s=e.usedRangeAddress;s=s.replace(/!(!+)/,"!");var l=new i.Timer("excelint"),c=a.Colorize.process_suspicious(s,e.formulas,e.values),d=(c[0],c[1],c[2],c[3]);o.watchdog("wd0x7919b4");var f=l.elapsedTime(),h=a.Colorize.adjust_proposed_fixes(d,e.styles,0,0),v=l.elapsedTime(),p=h.map((function(e){o.watchdog("wd0xfb8f16");var n=e[0],i=e[1],u=e[2],s=e[3],l=-n;return s||(l*=(100-t)/100),100*l>=r?a.tuple(l,i,u,s):null})).filter((function(e){return null!==e})),m=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},g=l.elapsedTime(),S=p.map((function(t){o.watchdog("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",a=[],i=[],u=[],s=[],l=[],c=[],d=[],f=[],h=[],v=t[3],p=[m.apply(void 0,t[1]),m.apply(void 0,t[2])],g=0;g<2;g++){var S=t[g+1][0],b=S[1]-1,y=S[0]-1,C=e.formulas[b][y],k=n.ExcelUtils.numeric_constants(C);l.push(k),c.push(c.reduce((function(e,t){return e+t}),0));var E=n.ExcelUtils.all_cell_dependencies(C,y+1,b+1,!1);d.push(E.length);var A=n.ExcelUtils.formulaToR1C1(C,y+1,b+1),R=n.ExcelUtils.column_index_to_name(y+1)+(b+1)+":",N=R+A;u.push(A),s.push(N),a.push(C),i.push(R+C),f.push((C.match(/\$/g)||[]).length),h.push(E)}var T=Math.abs(c[0]-c[1]),I=[];for(g=0;g<h.length;g++)if(h[g].length>0){if("vertical"===r&&0===h[g][0][0]&&-1===h[g][0][1]){I.push("recurrent-formula");break}if("horizontal"===r&&-1===h[g][0][0]&&0===h[g][0][1]){I.push("recurrent-formula");break}}d[0]!==d[1]&&I.push("different-referent-count"),l[0].length!==l[1].length&&(1===Math.abs(l[0].length-l[1].length)?I.push("one-extra-constant"):I.push("number-of-constants-mismatch")),l[0].length>0&&l[1].length>0&&(d[0]+d[1]===0?I.push("both-constants"):d[0]*d[1]==0&&I.push("one-is-all-constants")),u[0]!==u[1]&&JSON.stringify(h[0].sort())!==JSON.stringify(h[1].sort())&&I.push("r1c1-mismatch"),f[0]!==f[1]&&I.push("absolute-ref-mismatch");for(g=0;g<h.length;g++)if(h[g].length>0&&h[g][0][0]*h[g][0][1]!=0){I.push("off-axis-reference");break}return I===[]&&I.push("unclassified"),{bin:I,direction:r,sameFormat:v,rangeSizes:p,numbers:c,sameConstants:l[0]===l[1],numeric_difference:T,magnitude_numeric_difference:0===T?0:Math.log10(T),formulas:i,r1c1formulas:s,dependence_vectors:h}})),b=l.elapsedTime(),y=e.formulas.flat().filter((function(e){return e.length>0})).length,C=e.values.flat().filter((function(e){return e.length>0})).length,k=e.values[0].length,E=e.values.length,A=E*k,R=p.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),N=p.map((function(e){return o.watchdog("wd0xbcc23c"),e[0]>=r/100?u(e[1][0],e[1][1]).concat(u(e[2][0],e[2][1])):[]})),T=Array.from(new Set(N.flat(1).map((function(e){return JSON.stringify(e)}))));N=T.map((function(e){return JSON.parse(e)}));var I=l.elapsedTime(),F={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:p,exampleFixes:S,suspiciousRanges:p.length,weightedSuspiciousRanges:R,suspiciousCells:N.length,elapsedTimeSeconds:I/1e3,proposedFixesTimeSeconds:f/1e3,adjustProposedFixesTimeSeconds:(v-f)/1e3,adjustFormatProposedFixesTimeSeconds:(g-v)/1e3,exampleFixesTimeSeconds:(b-g)/1e3,numCountingTimeSeconds:(I-b)/1e3,columns:k,rows:E,totalCells:A,numFormulaCells:y,numValueCells:C};return{name:e.sheetName,out:F}})).filter((function(e){return null!==e.out}));c<d.length;c++){var f=d[c],h=f.name,v=f.out;l[h]=v}return{workbookName:e.workbookName,worksheets:l}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),l=s[0],c=s[1],d=(s[2],t[1]),f=d[0],h=d[1];d[2];return!(n-f>1||l-o>1||a-h>1||c-u>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),l=s[0],c=s[1],d=(s[2],t[1]),f=d[0],h=d[1];d[2];return[[Math.min(n,l),Math.min(a,c),0],[Math.max(o,f),Math.max(u,h),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1];a[2];return(i-r+1)*(o-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1],u=(a[2],i-r+1),s=o-n+1;return Math.sqrt(u*u+s*s)},e.overlap=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),l=s[0],c=s[1],d=(s[2],t[1]),f=d[0],h=d[1];d[2];return(o>f?f-n+1:o-l+1)*(u>h?h-a+1:u-c+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];r[i]=e.clone(t[i])}return r}return t}return null},e}();t.JSONclone=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(35),a=r(11),i=r(6);function o(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function u(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function s(e,t,r,i,o,s,l,c,d,f){var h,v,p,m=t[0],g=t[1],S=[],b=n.binsearch(d,t,(function(e,t){return e[0][0]-t[0][0]})),y=n.binsearch(f,t,(function(e,t){return e[0][1]-t[0][1]}));b>y?(h=i,p=b,v=0):(h=o,p=y,v=1),p>0&&(p-=1);for(var C=function(r){var i=h[r];if(i===e)return"continue";var o=c[i];if(0===v){if(g[0]+1<o[0][0])return"break"}else if(g[1]+1<o[0][1])return"break";if(g[0]+1<o[0][0]||g[1]+1<o[0][1]||o[1][0]+1<m[0]||o[1][1]+1<m[1]);else{var d=function(e,t,r,a){var i=e[0],o=e[1],s=t[0],l=t[1],c=[i-1,l,0],d=[s,o-1,0],f=[s+1,o,0],h=[i,l+1,0],v=[],p=-1;if(-1!==(p=n.strict_binsearch(a,c,u))&&r[p][1]===o){var m=[r[p],a[p]];v.push(m)}if(-1!==(p=n.strict_binsearch(a,d,u))&&r[p][0]===i){m=[r[p],a[p]];v.push(m)}if(-1!==(p=n.strict_binsearch(r,f,u))&&a[p][1]===l){m=[r[p],a[p]];v.push(m)}if(-1!==(p=n.strict_binsearch(r,h,u))&&a[p][0]===s){m=[r[p],a[p]];v.push(m)}return v}(m,g,s[i],l[i]);d.length>0&&(S=S.concat(d.map((function(r,n,o){return[a.Colorize.fix_metric(parseFloat(e),t,parseFloat(i),r),t,r]}))))}},k=p;k<h.length;k++){if("break"===C(k))break}return S}function l(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}t.find_all_proposed_fixes=function(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];i.watchdog("wd0xa287cd"),t[a]=e[a].sort(o).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},a={},c=0,d=Object.keys(e);c<d.length;c++){var f=d[c];i.watchdog("wd0xb02b87"),n[f]=r[f].map((function(e,t,r){var n=e[0];e[1];return n})),a[f]=r[f].map((function(e,t,r){e[0];return e[1]}))}var h=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var a=n[r],i=1e6,o=1e6,u=-1e6,s=-1e6,l=0;l<e[a].length;l++){var c=e[a][l][0][0],d=e[a][l][1][0],f=e[a][l][0][1],h=e[a][l][1][1];d>u&&(u=d),c<i&&(i=c),h>s&&(s=h),f<o&&(o=f)}t[a]=[[i,o,0],[u,s,0]]}return t}(e),v=Object.keys(e);l(v,(function(e,t){return h[e][0][0]-h[t][0][0]}));var p=v.map((function(e,t,r){return h[e]})),m=Object.keys(e);l(m,(function(e,t){return h[e][0][1]-h[t][0][1]}));for(var g,S=m.map((function(e,t,r){return h[e]})),b=0,y=Object.keys(e);b<y.length;b++){f=y[b];for(var C=0;C<r[f].length;C++){i.watchdog("wd0xe37031");var k=s(f,r[f][C],0,v,m,n,a,h,p,S);t=t.concat(k)}}return t=t.map((function(e,t,r){return u(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),g={},t=t.filter((function(e){return!(g[e]=e in g)}))}},function(e,t,r){"use strict";function n(e,t,r){for(var n=0,a=e.length;n<a;){var i=Math.floor((n+a)/2);r(e[i],t)<0?n=i+1:a=i}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.binsearch=function(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),n(e,t,r)},t.strict_binsearch=function(e,t,r){void 0===r&&(r=void 0);var a=n(e,t,r);return a===e.length||0!==r(e[a],t)?-1:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var a=e[n]/t;0!==a&&(r-=a*Math.log2(a))}return r/Math.log2(t)},e}();t.InfoGain=n;var a=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,a,i,o){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var u=i,s=0;s<t.length;s++){var l=t[s],c=l[0];u=o(u,r[n+l[1]][a+c])}return u},e.stencil_computation=function(t,r,n){e.initialize();for(var a=t.length,i=t[0].length,o=Array(a).fill(0).map((function(){return Array(i).fill(0)})),u=1;u<i-1;u++)for(var s=1;s<a-1;s++)o[s][u]=e.apply_stencil(e.stencil,t,u,s,n,r);for(s=1;s<i-1;s++)o[0][s]=e.apply_stencil(e.stencil_top,t,0,s,n,r),o[a-1][s]=e.apply_stencil(e.stencil_bottom,t,a-1,s,n,r);for(u=1;u<a-1;u++)o[u][0]=e.apply_stencil(e.stencil_left,t,u,0,n,r),o[u][i-1]=e.apply_stencil(e.stencil_right,t,u,i-1,n,r);return o[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),o[0][i-1]=e.apply_stencil(e.stencil_topright,t,0,i-1,n,r),o[a-1][0]=e.apply_stencil(e.stencil_bottomleft,t,a-1,0,n,r),o[a-1][i-1]=e.apply_stencil(e.stencil_bottomright,t,a-1,i-1,n,r),o},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=a},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"SyntaxError",(function(){return cp})),r.d(n,"TypeError",(function(){return dp})),r.d(n,"baseErrors",(function(){return hp})),r.d(n,"formatDiagnostic",(function(){return vp}));var a={};r.r(a),r.d(a,"MachineCallKind",(function(){return Kg})),r.d(a,"machineCall",(function(){return Zg})),r.d(a,"isMachineCall",(function(){return $g})),r.d(a,"ArrayMachine",(function(){return eS})),r.d(a,"TransitionKind",(function(){return pe})),r.d(a,"nextTransition",(function(){return Ce})),r.d(a,"callMachineTransition",(function(){return ke})),r.d(a,"nextOnSuccessReceiver",(function(){return Ae})),r.d(a,"MachineCycle",(function(){return Te})),r.d(a,"MachineRuntime",(function(){return Ie})),r.d(a,"AllMachine",(function(){return Fe}));var i={};r.r(i),r.d(i,"createPrefetchingCache",(function(){return tL})),r.d(i,"timelineQueueProcessorFactory",(function(){return rL})),r.d(i,"createFormulaBarScheduler",(function(){return nL})),r.d(i,"createExperimentFormulaBarScheduler",(function(){return aL})),r.d(i,"createDynamicPluginLoader",(function(){return iL})),r.d(i,"createRecalcSideGrid",(function(){return oL})),r.d(i,"dynamicPluginLoaderInsideInit",(function(){return G_})),r.d(i,"createIGridFromRecalcService",(function(){return uL}));var o={};r.r(o),r.d(o,"createPrefetchingCache",(function(){return tL})),r.d(o,"timelineQueueProcessorFactory",(function(){return rL})),r.d(o,"createFormulaBarScheduler",(function(){return nL})),r.d(o,"createExperimentFormulaBarScheduler",(function(){return aL})),r.d(o,"createDynamicPluginLoader",(function(){return iL})),r.d(o,"createRecalcSideGrid",(function(){return oL})),r.d(o,"dynamicPluginLoaderInsideInit",(function(){return G_})),r.d(o,"createIGridFromRecalcService",(function(){return uL}));function u(e,t){return{wrap:e,unwrap:t}}function s(){}function l(){}function c(){return function(e){return e}}var d=function(e){return e};function f(e){return e}function h(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function v(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function p(e,t){for(var r={},n=0,a=v(e);n<a.length;n++){var i=a[n];r[i]=t(i)}return r}function m(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()}function g(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];e.push(a)}return e}function S(e,t){var r=[];g(r,e);for(var n=0,a=t;n<a.length;n++){g(r,a[n])}return r}function b(e){return null!=e}function y(e){return null==e}function C(e,t){return[e,t]}function k(e,t){return e<t?e:t}function E(e,t){return e<t?t:e}function A(e){return e<0?-e:e}function R(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var N="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function T(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}var I=r(1);function F(e){return e}function O(e,t){if("string"==typeof t&&null!=M[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?_[r]:void 0;return void 0===n&&(n=w[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function D(e){try{return String(JSON.stringify(O(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: "+String(JSON.stringify(e))+">";var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error "+r+">":"<error "+t+": "+r+">"}}var M={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},w={boolean:F,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol "+String(e)+">"},undefined:F,null:F,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=O(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(O):"<unexpected>"}},_=Object.create(null);function L(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(z(t))}var P,x=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),B=/[0-9]/g,U=/d/g;function G(e){return e.toLowerCase().replace(U,"w").replace(B,"d").replace(x,"w")}function j(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function V(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function H(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t}function W(e,t){return Array(t+1).join(e)}function K(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e}var z=null!==(P=Math.log2)&&void 0!==P?P:function(e){return Math.log(e)*Math.LOG2E};function Y(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function q(e){if(null==e||"object"!=typeof e)return D(e);var t=e,r=String(t.name),n=String(t.message);if(null!=t.stack){var a=String(t.stack);return a.indexOf(n)>=0&&a.indexOf(r)>=0?a:r+": "+n+"\n"+a}return n.indexOf(r)>=0?n:r+": "+n}function J(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message=t+" "+String(r.message),r}function Q(e,t){return function(r,n,a,i){if(e(r,n,a,i),!a)throw new Error(t+" "+r+" "+n+" "+i)}}function X(e){return{shipAssertTag:Q(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:Q(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e)}}function Z(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var $=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var t=this.callBuffer;this.callBuffer=[];var r="calc.common.DefaultLogger.invokeBufferedCalls: "+t.length+" calls before initLogger";ee.ULS.traceTag(579736781,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,r);for(var n=0,a=t;n<a.length;n++){var i=a[n];(e=ee.noThrowLogger)[i.method].apply(e,i.args)}}},e}(),ee=new(function(){function e(){this.logger=new $,this.ULS=X(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=X(e),this.noThrowLogger=function(e){return{shipAssertTag:Z(e.shipAssertTag.bind(e)),assertTag:Z(e.assertTag.bind(e)),traceTag:Z(e.traceTag.bind(e)),debugTraceTag:Z(e.debugTraceTag.bind(e))}}(e),t instanceof $&&t.invokeBufferedCalls()},e}());function te(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+D(t);return ee.ULS.assertTag(595980872,I.LogCategory.msoulscat_ES_EWAJS,!1,r)}function re(e){return ee.ULS.assertTag(595980873,I.LogCategory.msoulscat_ES_EWAJS,!1,e)}function ne(e,t){t||re(e+": expected condition to be true")}function ae(e,t){j(t)||re(e+": expected integer; given "+D(t))}function ie(e,t){(!j(t)||t<0)&&re(e+": expected natural number; given "+D(t))}function oe(e,t){(!j(t)||t<=0)&&re(e+": expected positive integer; given "+D(t))}function ue(e,t,r){(!j(t)||t<0||t>=r)&&re(e+": expected natural number less than "+D(r)+"; given "+D(t))}function se(e,t,r){(!j(t)||t<=0||t>r)&&re(e+": expected positive integer at most "+D(r)+"; given "+D(t))}var le,ce=function(e,t){return(e<<t|e>>>32-t)>>>0},de=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-ce(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^ce(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}(),fe=r(0);function he(e){return{kind:le.Success,value:e}}!function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(le||(le={}));var ve,pe,me=he(void 0);function ge(e){return{kind:le.Failure,reason:e}}function Se(e){return e.kind===le.Success}function be(e){return{kind:ve.JavaScriptError,error:e}}function ye(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e.JavaScriptError="JavaScriptError"}(ve||(ve={})),function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(pe||(pe={}));var Ce=ye(pe.Next,void 0,void 0);function ke(e,t){return ye(pe.CallMachine,e,t)}var Ee={receiveResult:function(e){return Se(e)?Ce:e}};function Ae(){return Ee}var Re,Ne,Te=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(fe.c)(t,e),t}(Error),Ie=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(ke(e,{receiveResult:function(e){return e}})),this.transition=Ce}catch(e){this.transition=ge(be(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new Te(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case pe.Next:return void(this.transition=this.advanceTopFrame());case pe.CallMachine:return this.pushFrame(e),void(this.transition=this.advanceTopFrame());default:var t=this.stack.pop();return t?(t.machine.runStatus=e,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=ge(be(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=ge(be(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),Fe=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?ke(this.machines[this.values.length],this):he(this.values)},e.prototype.receiveResult=function(e){return Se(e)?(this.values.push(e.value),this.next()):e},e}(),Oe=function(){function e(t,r,n){this.transition=t,this.onFulfilled=r,this.onRejected=n,this.runStatus=!(t instanceof e||t.kind===pe.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e},e.prototype.next=function(){return this.transition instanceof e?this.transition=ke(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if(Se(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState(ge(be(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState(he(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new Fe(t.map(e.resolve)))},e.prototype.settle=function(){return new Ie(this).run()},e.settleOrThrow=function(e){var t=e.settle();if(Se(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e(he(t),void 0,void 0)},e.reject=function(t){return new e(ge(t),void 0,void 0)},e.undefined=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefined,void 0,void 0);return r.transition=ke(t,r),r},e.try=function(t){return e.undefined.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?ke(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return Se(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?he(this.accum):(this.accum=e,Ce)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}();(Ne=Re||(Re={})).fastMin=k,Ne.fastMax=E,Ne.fastAbs=A,Ne.identity=f,Ne.numEnumArray=v,Ne.numEnumMap=p,Ne.safePush=g,Ne.safeConcat=S,Ne.isDefined=b,Ne.isNone=y,Ne.makeStringMap=h,Ne.now=N,Ne.staticAssertExtends=s,Ne.staticAssertSame=l,Ne.staticAssertIs=c,Ne.staticAssertIsOptional=d,Ne.JSF32=de,Ne.Pledge=Oe,Ne.assertNever=te,Ne.assertNatural=ie,Ne.assertTrue=ne,Ne.assertFalse=re,Ne.assertPositiveLength=se,Ne.assertPositiveInteger=oe,Ne.assertIndex=ue,Ne.messageFromError=q,Ne.isInteger=j,Ne.stringStartsWith=V,Ne.stringEndsWith=H,Ne.arrayFill=K;var De,Me=r(4);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcStructuredReferences="CalcStructuredReferences",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunctions="CalcLambdaFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcAutocompleteExperiment="CalcAutocompleteExperiment",e["OfficeVSO:4969385_ParseResultStructRef"]="OfficeVSO:4969385_ParseResultStructRef",e["OfficeVSO:3852168_CalcDocQual"]="OfficeVSO:3852168_CalcDocQual",e["OfficeVSO:3852168_CalcNFLength"]="OfficeVSO:3852168_CalcNFLength",e["OfficeVSO:3852168_CalcNFLocaleData"]="OfficeVSO:3852168_CalcNFLocaleData"}(De||(De={}));var we=function(e){var t="calc.common.isFeatureEnabledCallback: called with "+e+" before initCalc";return ee.ULS.traceTag(587207117,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,t),!1},_e={};function Le(e){return void 0===_e[e]&&(_e[e]=we(e)),_e[e]}function Pe(){var e={};for(var t in De){var r=De[t];null!=r&&(e[r]=Le(r))}return e}var xe={"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.CalcTSDotOperator":!1};function Be(e){var t=xe[e];switch(typeof t){case"boolean":return Object(Me.a)(e,t);case"number":return Object(Me.c)(e,t);case"string":return Object(Me.d)(e,t);default:re("Wrong defaultValue type")}}function Ue(e,t){switch(t.kind){case kt.Literal:var r=t.oper,n=t.isClosed,a=t.label;return e.literalNode(r,n,a);case kt.Array:var i=t.nodes;n=t.isClosed,a=t.label;return e.arrayNode(i,n,a);case kt.App:var o=t.head,u=t.args;n=t.isClosed,a=t.label;return e.appNode(o,u,n,a);case kt.Let:o=t.head;var s=t.vars,l=t.body,c=t.badArgs;n=t.isClosed,a=t.label;return e.letNode(o,s,l,c,n,a);case kt.Lambda:o=t.head;var d=t.params;l=t.body,c=t.badArgs,n=t.isClosed,a=t.label;return e.lambdaNode(o,d,l,c,n,a);case kt.Paren:var f=t.node;n=t.isClosed,a=t.label;return e.parenNode(f,n,a);case kt.Name:var h=t.parts,v=t.qualifier;a=t.label;return e.nameNode(h,v,a);case kt.CellRef:var p=t.ref;v=t.qualifier,a=t.label;return e.cellRefNode(p,v,a);case kt.FieldRef:var m=t.lhs,g=t.rhs,S=t.shouldBeBracketed;a=t.label;return e.fieldRefNode(m,g,S,a);case kt.StructRef:m=t.lhs,g=t.rhs,a=t.label;return e.structRefNode(m,g,a);case kt.Bad:a=t.label;switch(t.type){case Nt.Sequence:case Nt.StructRef:case Nt.FieldRef:return e.badSequenceNode(t.type,t.contents,a);default:return e.badStringNode(t.type,t.contents,a)}default:return te("calc.lang.visitFormulaNode",t)}}function Ge(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function je(e,t){var r=t.id,n=t.whole,a=t.label;return e.wsfNode(r,n,a)}function Ve(e,t){switch(t.kind){case kt.Operator:return Ge(e,t);case kt.WSF:return je(e,t);default:return Ue(e,t)}}function He(e,t){switch(t.kind){case ht.Error:var r=t.label;return e.errorQualifier(r);case ht.Relative:r=t.label;return e.relativeQualifier(r);case ht.Document:var n=t.document,a=t.path,i=t.isQuoted;r=t.label;return e.documentQualifier(n,a,i,r);case ht.Sheet:var o=t.sheet,u=t.document;i=t.isQuoted,r=t.label;return e.sheetQualifier(o,u,i,r);case ht.Ident:var s=t.name;i=t.isQuoted,r=t.label;return e.identQualifier(s,i,r);case ht.SheetRange:var l=t.sheet1,c=t.sheet2,d=t.document;i=t.isQuoted,r=t.label;return e.sheetRangeQualifier(l,c,d,i,r);default:return te("calc.lang.visitQualifier",t)}}function We(e,t){switch(t.kind){case vt.Error:var r=t.label;return e.cellRefError(r);case vt.Single:var n=t.row,a=t.col,i=t.isBracketed;r=t.label;return e.cellRefSingle(n,a,i,r);case vt.Range:var o=t.ref1,u=t.ref2;r=t.label;return e.cellRefRange(o,u,r);case vt.Row:var s=t.row1,l=t.row2;i=t.isBracketed,r=t.label;return e.cellRefRow(s,l,i,r);case vt.Col:var c=t.col1,d=t.col2;i=t.isBracketed,r=t.label;return e.cellRefCol(c,d,i,r);default:return te("calc.lang.visitCellRef",t)}}function Ke(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}var ze=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return Qt(e,t,r)},e.prototype.arrayNode=function(e,t,r){return Xt(e,t,r)},e.prototype.appNode=function(e,t,r,n){return Zt(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,a,i){return ir(e,t,r,n,a,i)},e.prototype.lambdaNode=function(e,t,r,n,a,i){return sr(e,t,r,n,a,i)},e.prototype.parenNode=function(e,t,r){return dr(e,t,r)},e.prototype.nameNode=function(e,t,r){return fr(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return Sr(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return br(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return Cr(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return Or(e,t,r)},e.prototype.badStringNode=function(e,t,r){return Or(e,t,r)},e.prototype.operatorNode=function(e,t){return lr(e,t)},e.prototype.wsfNode=function(e,t,r){return cr(e,t,r)},e}(),Ye=Ke(new ze),qe=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,a,i){return this.value},e.prototype.lambdaNode=function(e,t,r,n,a,i){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r,n){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badStringNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function Je(e){return Ke(new qe(e))}var Qe=Je(void 0),Xe=function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,a,i){return this.visitor.letNode(e,t,r,n,a,i)},e.prototype.lambdaNode=function(e,t,r,n,a,i){return this.visitor.lambdaNode(e,t,r,n,a,i)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badStringNode=function(e,t,r){return this.visitor.badStringNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}(),Ze=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return Object(fe.c)(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return ne("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,n,a,i){return Object(fe.f)(t.map((function(e){return e.binder.arg})),void 0===r?[]:[r.arg],n.map((function(e){return e.arg}))).reduce(this.reducer,e)},t.prototype.lambdaNode=function(e,t,r,n,a,i){return Object(fe.f)(void 0===r?[]:[r.arg],n.map((function(e){return e.arg}))).reduce(this.reducer,e)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r,n){return e},t.prototype.badSequenceNode=function(e,t,r){return ne("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(Xe);function $e(e,t){return Ke(new Ze(e,t))}var et=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,a,i){return this.b(this.a.letNode(e,t,r,n,a,i))},e.prototype.lambdaNode=function(e,t,r,n,a,i){return this.b(this.a.lambdaNode(e,t,r,n,a,i))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badStringNode=function(e,t,r){return this.b(this.a.badStringNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function tt(e,t){return Ke(new et(e,t))}tt($e(Je(0),E),(function(e){return e+1}));var rt=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var a={},i=0,o=this.keys;i<o.length;i++){var u=o[i];a[u]=this.visitors[u].appNode(e,t,r,n)}return a},e.prototype.letNode=function(e,t,r,n,a,i){for(var o={},u=0,s=this.keys;u<s.length;u++){var l=s[u];o[l]=this.visitors[l].letNode(e,t,r,n,a,i)}return o},e.prototype.lambdaNode=function(e,t,r,n,a,i){for(var o={},u=0,s=this.keys;u<s.length;u++){var l=s[u];o[l]=this.visitors[l].lambdaNode(e,t,r,n,a,i)}return o},e.prototype.parenNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r,n){for(var a={},i=0,o=this.keys;i<o.length;i++){var u=o[i];a[u]=this.visitors[u].fieldRefNode(e,t,r,n)}return a},e.prototype.structRefNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].structRefNode(e,t,r)}return n},e.prototype.badSequenceNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].badSequenceNode(e,t,r)}return n},e.prototype.badStringNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].badStringNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,a=this.keys;n<a.length;n++){var i=a[n];r[i]=this.visitors[i].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].wsfNode(e,t,r)}return n},e}();function nt(e,t){var r=function(t){switch(t.kind){case kt.Literal:var n=t.oper,a=t.isClosed,i=t.label;return e.literalNode(n,a,i);case kt.Array:var o=t.nodes;a=t.isClosed,i=t.label;return e.arrayNode(o.map((function(e){return e.map(r)})),a,i);case kt.App:var u=t.head,s=t.args;a=t.isClosed,i=t.label;return e.appNode(function(t){switch(t.kind){case kt.Operator:return Ge(e,t);case kt.WSF:return je(e,t);default:return r(t)}}(u),s.map(r),a,i);case kt.Let:u=t.head;var l=t.vars,c=t.body,d=t.badArgs;a=t.isClosed,i=t.label;return e.letNode(je(e,u),l.map((function(e){var t=e.name,n=e.binder;return ar(t,nr(r(n.arg),n.index))})),void 0===c?void 0:nr(r(c.arg),c.index),d.map((function(e){return nr(r(e.arg),e.index)})),a,i);case kt.Lambda:u=t.head;var f=t.params;c=t.body,d=t.badArgs,a=t.isClosed,i=t.label;return e.lambdaNode(je(e,u),f,void 0===c?void 0:nr(r(c.arg),c.index),d.map((function(e){return nr(r(e.arg),e.index)})),a,i);case kt.Paren:var h=t.node;a=t.isClosed,i=t.label;return e.parenNode(r(h),a,i);case kt.Name:var v=t.parts,p=t.qualifier;i=t.label;return e.nameNode(v,p,i);case kt.CellRef:var m=t.ref;p=t.qualifier,i=t.label;return e.cellRefNode(m,p,i);case kt.FieldRef:var g=t.lhs,S=t.rhs,b=t.shouldBeBracketed;i=t.label;return e.fieldRefNode(r(g),S,b,i);case kt.StructRef:g=t.lhs,S=t.rhs,i=t.label;return e.structRefNode(g,S,i);case kt.Bad:i=t.label;switch(t.type){case Nt.Sequence:case Nt.StructRef:case Nt.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),i);default:return e.badStringNode(t.type,t.contents,i)}default:return te("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function at(e,t,r,n){var a=[],i=function(e){return a.push(e),o},o=function(){return a.length<t.length?r(e,t[a.length],i):n(a)};return o}function it(e,t,r){return at(e,t,ct,r)}function ot(e,t,r,n){return function(){return void 0!==t?r(e,t,n):n(void 0)}}function ut(e,t,r){var n=t.id,a=t.whole,i=t.label;return function(){return r(e.wsfNode(n,a,i))}}function st(e,t,r){var n=t.name,a=t.binder;return ct(e,a.arg,(function(e){return r(ar(n,nr(e,a.index)))}))}function lt(e,t,r){var n=t.arg,a=t.index;return ct(e,n,(function(e){return r(nr(e,a))}))}function ct(e,t,r){switch(t.kind){case kt.Literal:var n=t.oper,a=t.isClosed,i=t.label;return function(){return r(e.literalNode(n,a,i))};case kt.Array:var o=t.nodes,u=t.isClosed,s=t.label;return at(e,o,it,(function(t){return r(e.arrayNode(t,u,s))}));case kt.App:var l=t.head,c=t.args,d=t.isClosed,f=t.label;return function(){return function(e,t,r){switch(t.kind){case kt.Operator:var n=t.id,a=t.label;return function(){return r(e.operatorNode(n,a))};case kt.WSF:return ut(e,t,r);default:return ct(e,t,r)}}(e,l,(function(t){return it(e,c,(function(n){return r(e.appNode(t,n,d,f))}))}))};case kt.Let:var h=t.head,v=t.vars,p=t.body,m=t.badArgs,g=t.isClosed,S=t.label;return function(){return ut(e,h,(function(t){return at(e,v,st,(function(n){return ot(e,p,lt,(function(a){return at(e,m,lt,(function(i){return r(e.letNode(t,n,a,i,g,S))}))}))}))}))};case kt.Lambda:var b=t.head,y=t.params,C=t.body,k=t.badArgs,E=t.isClosed,A=t.label;return function(){return ut(e,b,(function(t){return function(){return ot(e,C,lt,(function(n){return at(e,k,lt,(function(a){return r(e.lambdaNode(t,y,n,a,E,A))}))}))}}))};case kt.Paren:var R=t.node,N=t.isClosed,T=t.label;return function(){return ct(e,R,(function(t){return function(){return r(e.parenNode(t,N,T))}}))};case kt.Name:var I=t.parts,F=t.qualifier,O=t.label;return function(){return r(e.nameNode(I,F,O))};case kt.CellRef:var D=t.ref,M=t.qualifier,w=t.label;return function(){return r(e.cellRefNode(D,M,w))};case kt.FieldRef:var _=t.lhs,L=t.rhs,P=t.shouldBeBracketed,x=t.label;return function(){return ct(e,_,(function(t){return function(){return r(e.fieldRefNode(t,L,P,x))}}))};case kt.StructRef:var B=t.lhs,U=t.rhs,G=t.label;return function(){return r(e.structRefNode(B,U,G))};case kt.Bad:var j=t.label;switch(t.type){case Nt.Sequence:case Nt.StructRef:case Nt.FieldRef:var V=t.type,H=t.contents;return it(e,H,(function(t){return r(e.badSequenceNode(V,t,j))}));default:var W=t.type,K=t.contents;return function(){return r(e.badStringNode(W,K,j))}}default:return te("calc.lang.reduceBottomUp_CPS",t)}}var dt=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return Ue(t,e)},this.lazyVisitFormulaNode=function(e){return Oe.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return Ve(t,e)},this.lazyVisitAppHeadNode=function(e){return Oe.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return je(t,e)},this.lazyVisitWSFNode=function(e){return Oe.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e.name,n=e.binder;return t.lazyVisitFormulaNode(n.arg).bind((function(e){return ar(r,nr(e,n.index))}))},this.lazyVisitIndexedArg=function(e){var r=e.arg,n=e.index;return t.lazyVisitFormulaNode(r).bind((function(e){return nr(e,n)}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return Oe.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return Oe.all(e.map((function(e){return Oe.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var a=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return Oe.all(t.map(a.lazyVisitFormulaNode)).bind((function(t){return a.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,a,i){var o=this;return this.lazyVisitWSFNode(e).bind((function(e){return Oe.all(t.map(o.lazyVisitVar)).bind((function(t){return(void 0===r?Oe.resolve(void 0):o.lazyVisitIndexedArg(r)).bind((function(r){return Oe.all(n.map(o.lazyVisitIndexedArg)).bind((function(n){return o.visitor.letNode(e,t,r,n,a,i)}))}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,a,i){var o=this;return this.lazyVisitWSFNode(e).bind((function(e){return(void 0===r?Oe.resolve(void 0):o.lazyVisitIndexedArg(r)).bind((function(r){return Oe.all(n.map(o.lazyVisitIndexedArg)).bind((function(n){return o.visitor.lambdaNode(e,t,r,n,a,i)}))}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return Oe.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return Oe.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r,n){var a=this;return this.lazyVisitFormulaNode(e).bind((function(e){return a.visitor.fieldRefNode(e,t,r,n)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return Oe.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return Oe.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badStringNode=function(e,t,r){var n=this;return Oe.try((function(){return n.visitor.badStringNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return Oe.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return Oe.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();var ft,ht,vt,pt,mt;function gt(e,t,r){return r<=50?nt(e,t):function(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(ct(e,t,(function(e){r=e}))),r}(e,t)}function St(e,t){return gt(e,t.node,t.depthUpperBound)}function bt(e,t){return Oe.settleOrThrow(Oe.resolve(Ue(e,t)))}function yt(e,t){return bt(e,t.node)}function Ct(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case kt.Array:for(var n=0,a=0,i=t.nodes;a<i.length;a++)for(var o=0,u=i[a];o<u.length;o++){n=E(n,e(u[o],r+1))}return n+1;case kt.Let:case kt.Lambda:case kt.App:n=e(t.head,r+1);for(var s=0,l=t.args;s<l.length;s++){n=E(n,e(l[s],r+1))}return n+1;case kt.Paren:return e(t.node,r+1)+1;case kt.FieldRef:return e(t.lhs,r+1)+1;case kt.Name:case kt.CellRef:case kt.StructRef:case kt.Literal:case kt.Operator:case kt.WSF:return 1;case kt.Bad:switch(t.type){case Nt.Sequence:case Nt.StructRef:case Nt.FieldRef:n=0;for(var c=0,d=t.contents;c<d.length;c++){n=E(n,e(d[c],r+1))}return n+1;default:return"string"==typeof t.contents?1:te("calc.lang.getDepthUpperBound",t.contents)}default:return te("calc.lang.getDepthUpperBound",t)}}(e,0)}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(ft||(ft={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(ht||(ht={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(vt||(vt={})),function(e){e.Abs="Abs",e.Rel="Rel"}(pt||(pt={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(mt||(mt={}));var kt,Et,At,Rt,Nt,Tt,It,Ft,Ot,Dt,Mt={kind:mt.AppHeadName},wt={kind:mt.FormulaRoot};function _t(e){return void 0===e&&(e=0),{kind:ht.Error,isQuoted:!1,label:e}}function Lt(e){return void 0===e&&(e=0),{kind:ht.Relative,isQuoted:!1,label:e}}function Pt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ht.Document,isQuoted:r,label:n,document:e,path:t}}function xt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ht.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function Bt(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:ht.Ident,isQuoted:t,label:r,name:e}}function Ut(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=0),{kind:ht.SheetRange,isQuoted:n,label:a,sheet1:e,sheet2:t,document:r}}function Gt(e,t){return{kind:e,index:t}}function jt(e){void 0===e&&(e=0);return{kind:vt.Error,label:e,isBracketed:!1}}function Vt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:vt.Single,label:n,row:e,col:t,isBracketed:r}}function Ht(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:vt.Range,label:r,ref1:e,ref2:t,isBracketed:n}}function Wt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:vt.Row,label:n,row1:e,row2:t,isBracketed:r}}function Kt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:vt.Col,label:n,col1:e,col2:t,isBracketed:r}}function zt(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:Ct(e)}}function Yt(e,t,r,n){return ie("calc.lang.formulaSpan",e),ae("calc.lang.formulaSpan",t),t<e&&re("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function qt(e,t,r){return{kind:mt.LocalNameUse,name:e,whole:t,label:r}}function Jt(e){return void 0===e&&(e=[]),{kind:mt.LocalNameDecl,uses:e}}function Qt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:kt.Literal,label:r,oper:e,isClosed:t}}function Xt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:kt.Array,label:r,nodes:e,isClosed:t}}function Zt(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:kt.App,label:n,head:e,args:t,isClosed:r}}function $t(e){return Array.isArray(e)}function er(e){return void 0!==e.kind}function tr(e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r],i=a.arg,o=a.index;ue("calc.lang.flattenNumberedArgs: idx",o,e.length),ne("calc.lang.flattenNumberedArgs: repetition",void 0===t[o]),t[o]=i}return t}function rr(e,t,r){return tr(S(Object(fe.f)(void 0===t?[]:[t],r),e.map((function(e){return[e.name,e.binder]}))))}function nr(e,t){return{arg:e,index:t}}function ar(e,t){return{name:e,binder:t}}function ir(e,t,r,n,a,i){void 0===n&&(n=[]),void 0===a&&(a=!0),void 0===i&&(i=0),ne("calc.lang.letNode",t.every((function(e){return void 0===($t(e)?e[0]:e.name.arg).qualifier})));var o=t.map((function(e,t){return $t(e)?ar(nr(e[0],2*t),nr(e[1],2*t+1)):e})).sort((function(e,t){return e.name.index-t.name.index})),u=void 0!==r&&er(r)?nr(r,2*t.length):r,s=rr(o,u,n);return{kind:kt.Let,label:i,head:e,args:s,isClosed:a,vars:o,body:u,badArgs:n}}function or(e,t,r){return void 0===r&&(r=[]),tr(Object(fe.f)(e.map((function(e){return e.name})),void 0===t?[]:[t],r))}function ur(e){return{name:e}}function sr(e,t,r,n,a,i){void 0===n&&(n=[]),void 0===a&&(a=!0),void 0===i&&(i=0),ne("calc.lang.lambdaNode",t.every((function(e){return void 0===(er(e)?e:e.name.arg).qualifier})));var o=t.map((function(e,t){return er(e)?ur(nr(e,t)):e})).sort((function(e,t){return e.name.index-t.name.index})),u=void 0!==r&&er(r)?nr(r,t.length):r,s=or(o,u,n);return{kind:kt.Lambda,label:i,head:e,args:s,isClosed:a,params:o,body:u,badArgs:n}}function lr(e,t){return void 0===t&&(t=0),{kind:kt.Operator,label:t,id:e}}function cr(e,t,r){return void 0===r&&(r=0),{kind:kt.WSF,label:r,id:e,whole:t}}function dr(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:kt.Paren,label:r,node:e,isClosed:t}}function fr(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,a="string"==typeof e?hr(e,!0):e;return{kind:kt.Name,label:r,whole:n,parts:a,qualifier:t}}function hr(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Et.IdentNamePart,label:r,asWhole:e,canDenoteNamedObject:t}}function vr(e,t,r){return void 0===r&&(r=0),{kind:Et.CellRefNamePart,label:r,asWhole:t,canDenoteNamedObject:!1,ref:e}}function pr(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:Et.FieldRefNamePart,label:n,asWhole:e.asWhole+"."+t,canDenoteNamedObject:r,lhs:e,rhs:t}}function mr(e){for(var t=[e],r=t[0];r.kind===Et.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}}function gr(e){for(var t=e;t.kind===Et.FieldRefNamePart;)t=t.lhs;return t}function Sr(e,t,r){return void 0===r&&(r=0),{kind:kt.CellRef,label:r,ref:e,qualifier:t}}function br(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:kt.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}}function yr(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{label:n,field:e,isBracketed:t,isClosed:r}}function Cr(e,t,r){return void 0===r&&(r=0),{kind:kt.StructRef,label:r,lhs:e,rhs:t}}function kr(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:Rt.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}}function Er(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:Rt.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}}function Ar(e,t,r){return void 0===r&&(r=0),{kind:Rt.RangeOpRef,label:r,lhs:e,rhs:t}}function Rr(e,t){var r;void 0===t&&(t=0);for(var n=((r={})[At.All]=!1,r[At.Data]=!1,r[At.Headers]=!1,r[At.Totals]=!1,r[At.ThisRow]=!1,r),a=[],i=0,o=e;i<o.length;i++){var u=o[i];switch(u.kind){case Rt.SpecialRef:n[u.id]=!0;break;case Rt.ColumnRef:case Rt.RangeOpRef:a.push(u)}}return{kind:Rt.CommaOpRef,label:t,refs:e,specialRefs:n,columnRefs:a}}function Nr(e,t){return void 0===t&&(t=0),{kind:Rt.ThisRowOpRef,label:t,ref:e}}function Tr(e){return void 0===e&&(e=0),{kind:Rt.MissingRef,label:e}}function Ir(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:Rt.BadRef,contents:e,isBracketed:t,isClosed:r,label:n}}function Fr(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{label:r,isClosed:t,innerRef:e}}function Or(e,t,r){return void 0===r&&(r=0),{kind:kt.Bad,label:r,type:e,contents:t}}function Dr(e,t,r,n,a,i,o){(ie("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&re("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&re("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:a,staticPrecs:i,flags:o}}function Mr(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[k(r,a),E(n,i)]}function wr(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[E(r,a),k(n,i)]}function _r(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return E(r,a)<k(n,i)}function Lr(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0}function Pr(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}function xr(e){return e.index===e.index2}function Br(e){return e.isWellFormed}function Ur(e){return 1===e.rows&&1===e.cols}function Gr(e){return xr(e.sheet)}function jr(e){return Ur(e.range)}function Vr(e,t){if(Ur(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,o=0;o<n;o+=1)for(var u=0;u<i;u+=1)if(!t(va(r+o,a+u),o,u))return!1;return!0}function Hr(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,l=t.cols,c=k(r,o),d=k(n,u);return fa(c,d,E(r+a,o+s)-c,E(n+i,u+l)-d)}function Wr(e,t){return e?t?Hr(e,t):e:t}function Kr(e){return 0===e.length&&re("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Hr)}function zr(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,l=t.cols,c=E(r,o),d=E(n,u),f=k(r+a,o+s)-c,h=k(n+i,u+l)-d;if(!(f<=0||h<=0))return fa(c,d,f,h)}function Yr(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,l=t.cols;return E(r,o)<k(r+a,o+s)&&E(n,u)<k(n+i,u+l)}function qr(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,o=t.rows,u=t.cols,s=a<=r&&r<a+o,l=i<=n&&n<i+u;return s&&l?va(r,n):s&&1===u?va(r,i):l&&1===o?va(a,n):1===u&&1===o?va(a,i):void 0}function Jr(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=r+a,l=o+t.rows,c=n+i,d=u+t.cols;return r===o&&s===l&&n===u&&c===d?0:r<=o&&s>=l&&n<=u&&c>=d?1:r>=o&&s<=l&&n>=u&&c<=d?-1:void 0}function Qr(e,t){var r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],a=[t.row,t.row+t.rows],i=[t.col,t.col+t.cols],o=Pr(r,a),u=Pr(n,i);if(void 0!==o&&o<=0){var s=Lr(n,i);if(void 0!==s)return ha(e.row,s[0],e.rows,s[1]-s[0])}if(void 0!==u&&u<=0){var l=Lr(r,a);if(void 0!==l)return ha(l[0],e.col,l[1]-l[0],e.cols)}}function Xr(e){return e.rows*e.cols}function Zr(e,t){return e===t||e.name===t.name&&e.path===t.path}function $r(e,t){return Zr(e.document,t.document)&&e.index===t.index}function en(e,t){return Zr(e.document,t.document)&&e.index===t.index}function tn(e,t){return e.row===t.row&&e.col===t.col}function rn(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function nn(e,t){return $r(e.sheet,t.sheet)&&tn(e.range,t.range)}function an(e,t){return $r(e.sheet,t.sheet)&&rn(e.range,t.range)}function on(e){return Ur(e)?e:fa(e.row,e.col,1,1)}function un(e){return jr(e)?e:ya(e.sheet,on(e.range))}function sn(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return fa(k(r,a),k(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function ln(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case kt.Array:for(var i=n.nodes,o=i.length-1;!a&&o>=0;o-=1)for(var u=i[o],s=u.length-1;!a&&s>=0;s-=1){r(c=u[s])&&(n=c,a=!0)}break;case kt.App:case kt.Let:case kt.Lambda:var l=n.args;for(s=l.length-1;!a&&s>=0;s-=1){r(c=l[s])&&(n=c,a=!0)}break;case kt.Paren:var c;r(c=n.node)&&(n=c,a=!0);break;case kt.Bad:case kt.Name:case kt.CellRef:case kt.StructRef:case kt.Literal:break;case kt.FieldRef:r(n.lhs)&&(n=n.lhs,a=!0);break;default:te("getSubExpressionFromPosition",n)}return n}!function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF"}(kt||(kt={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(Et||(Et={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(At||(At={})),function(e){e.SpecialRef="SpecialRef",e.ColumnRef="ColumnRef",e.RangeOpRef="RangeOpRef",e.CommaOpRef="CommaOpRef",e.ThisRowOpRef="ThisRowOpRef",e.MissingRef="MissingRef",e.BadRef="BadRef"}(Rt||(Rt={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Operator="Operator",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(Nt||(Nt={})),function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(Tt||(Tt={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(It||(It={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(Ft||(Ft={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(Ot||(Ot={}));var cn=[];function dn(e){return 0===function(e){return 1===e.args.length&&pn(e.args[0])?0:e.args.length}(e)?cn:e.args}function fn(e){return e.kind===kt.Operator}function hn(e){return e.kind===kt.WSF}function vn(e){return e.kind===kt.Name&&void 0===e.qualifier}function pn(e){return e.kind===kt.Literal&&Nn(e.oper)}function mn(e){return e.kind===kt.Literal&&yn(e.oper)}function gn(e,t,r){var n=e.headTypes,a=e.restTypes,i=e.tailTypes;if(oe("calc.runtime.getArgType: n",r),ue("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===a.length)return It.None;if(t<n.length+a.length)return a[t-n.length];var o=(r-n.length)%a.length;return o>i.length?It.None:t>=r-o?i[t-(r-o)]:a[(t-n.length)%a.length]}function Sn(e,t){var r=e.minArgs,n=e.headTypes,a=e.restTypes,i=e.tailTypes;return!(t<r)&&(t<=n.length+a.length||0!==a.length&&(t-n.length)%a.length<=i.length)}function bn(e,t){return t.length>0&&((r=e).kind===kt.Literal&&kn(r.oper)||e.kind===kt.Name||e.kind===kt.CellRef);var r}function yn(e){return e.kind===Tt.Number}function Cn(e){return e.kind===Tt.String}function kn(e){return e.kind===Tt.Boolean}function En(e){return e.kind===Tt.Error}function An(e){return e.kind===Tt.Range}function Rn(e){return e.kind===Tt.Array}function Nn(e){return e.kind===Tt.Missing}function Tn(e){return e.kind===Tt.Blank}function In(e){return e.kind===Tt.Rich}var Fn=Tt.Number|Tt.String|Tt.Boolean;function On(e){return 0!=(e.kind&Fn)}var Dn,Mn=Fn|Tt.Error|Tt.Array|Tt.Rich;function wn(e){return 0!=(e.kind&Mn)}function _n(e,t,r,n){if(r.kind!==t.kind)return!1;switch(r.kind){case Tt.Boolean:case Tt.String:return r.value===t.value;case Tt.Number:return 0===e.cond2(r,t);case Tt.Error:return r.type===t.type;case Tt.Rich:return n;case Tt.Array:var a=t;if(r.cols!==a.cols||r.rows!==a.rows)return!1;for(var i=0;i<r.rows;i+=1)for(var o=r.opers[i],u=a.opers[i],s=0;s<r.cols;s+=1)if(!_n(e,u[s],o[s],n))return!1;return!0;case Tt.Blank:return!0;default:return te("calc.lang.readOperEq",r)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(Dn||(Dn={}));var Ln=Object(fe.a)(Object(fe.a)({},ve),Dn);function Pn(e){return{kind:Ln.NotImplemented,features:e}}function xn(e){return 0===e.length&&re("calc.lang.unavailable: expected nonempty array"),{kind:Ln.Unavailable,objects:e}}function Bn(e){return{kind:Ln.Internal,message:e}}function Un(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t}var Gn="_xlfn.",jn="_xlws.";function Vn(e,t){var r=t;return r.length>Gn.length&&0===e.stringCompareCI(r.substring(0,Gn.length),Gn)&&(r=r.substring(Gn.length)).length>jn.length&&0===e.stringCompareCI(r.substring(0,jn.length),jn)&&(r=r.substring(jn.length)),e.getWorksheetFuncId(r)}var Hn="_xlpm.";function Wn(e,t){var r=t;return r.length>Hn.length&&0===e.stringCompareCI(r.substring(0,Hn.length),Hn)&&(r=r.substring(Hn.length)),r}function Kn(e){return e.kind!==Rt.SpecialRef&&e.kind!==Rt.BadRef||e.isBracketed}function zn(e){return e.kind===Rt.MissingRef||e.kind===Rt.BadRef}function Yn(e){return e.columnRefs.length<=1&&e.refs.every(Kn)&&(t=e.specialRefs,1===(r=Object.keys(t).reduce((function(e,r){return e+(t[Number(r)]?1:0)}),0))||2===r&&t[At.Data]&&(t[At.Headers]||t[At.Totals]));var t,r}function qn(e){return Qn(e.lhs)&&Qn(e.rhs)}function Jn(e){return!zn(e.lhs)&&!zn(e.rhs)}function Qn(e){switch(e.kind){case Rt.SpecialRef:case Rt.ColumnRef:return e.isClosed;case Rt.RangeOpRef:return Qn(e.lhs)&&Qn(e.rhs);case Rt.MissingRef:return!0;case Rt.BadRef:return e.isClosed}}var Xn,Zn,$n=((Dt={})[At.All]=1,Dt[At.Headers]=2,Dt[At.Data]=3,Dt[At.Totals]=4,Dt[At.ThisRow]=5,Dt),ea=function(e){return e.kind===Rt.MissingRef?7:e.kind!==Rt.SpecialRef?6:$n[e.id]};function ta(e,t){return ea(e)-ea(t)}function ra(e){return{kind:Xn.Cell,range:e}}function na(e){return{kind:Xn.Range,range:e}}function aa(e,t){switch(e){case Xn.Cell:return jr(t)?ra(t):re("calc.lang.lexicalSourceGrid: expected cell");case Xn.Range:return na(t)}}function ia(e){return{kind:Xn.NameManager,name:e}}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}(Xn||(Xn={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(Zn||(Zn={}));function oa(e,t){return{path:e,name:t}}function ua(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}}function sa(e,t,r){return{document:e,index:t,index2:r}}function la(e,t){return sa(e,t,t)}function ca(e){return{document:e,index:void 0,index2:void 0}}function da(e,t){return{sheets:e,position:t}}function fa(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function ha(e,t,r,n){return ue("calc.lang.gridRange",e,1<<20),ue("calc.lang.gridRange",t,16384),se("calc.lang.gridRange",r,(1<<20)-e),se("calc.lang.gridRange",n,16384-t),fa(e,t,r,n)}function va(e,t){return ue("calc.lang.gridCell",e,1<<20),ue("calc.lang.gridCell",t,16384),fa(e,t,1,1)}function pa(e,t){return{sheet:e,range:t}}var ma,ga,Sa=pa,ba=pa,ya=pa,Ca=pa;function ka(e){return{document:e,index:void 0}}function Ea(e,t){return void 0===t?ka(e):la(e,t)}function Aa(e,t){return{scope:e,name:t}}function Ra(e,t){return{document:e,id:t}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(ga||(ga={}));var Na;function Ta(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function Ia(e){return e?qa:Ja}function Fa(e){return{kind:Tt.String,value:e}}function Oa(e){var t=ja[e];return void 0!==t?t:Ga(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(Na||(Na={}));var Da=Ga(Na.NULL),Ma=Ga(Na.DIV0),wa=Ga(Na.VALUE),_a=Ga(Na.REF),La=Ga(Na.NAME),Pa=Ga(Na.NUM),xa=Ga(Na.NA),Ba=Ga(Na.GETTING_DATA),Ua=Ga(Na.FIELD);function Ga(e){return{kind:Tt.Error,type:e}}var ja=Y(((ma={})[Na.NULL]=Da,ma[Na.DIV0]=Ma,ma[Na.VALUE]=wa,ma[Na.REF]=_a,ma[Na.NAME]=La,ma[Na.NUM]=Pa,ma[Na.NA]=xa,ma[Na.GETTING_DATA]=Ba,ma[Na.FIELD]=Ua,ma));function Va(e,t,r){return ie("calc.lang.arrayOper",e),ie("calc.lang.arrayOper",t),r.length!==e?re("calc.lang.arrayOper: Inconsistent row number"):{kind:Tt.Array,rows:e,cols:t,opers:r}}function Ha(e,t){return oe("calc.lang.rangeSeqOper",t.length),{kind:Tt.Range,sheets:e,ranges:t}}function Wa(e,t){return{kind:Tt.Range,sheets:e,ranges:[t]}}var Ka,za={kind:Tt.Missing},Ya={kind:Tt.Blank},qa={kind:Tt.Boolean,value:!0},Ja={kind:Tt.Boolean,value:!1};!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLUMNS=638]="CHOOSECOLUMNS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOLUMN=650]="TOCOLUMN",e[e.TOROW=651]="TOROW",e[e.VECTORWRAP=652]="VECTORWRAP",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISMISSINGARG=658]="ISMISSINGARG",e[e.TESTFUNCTIONBEGIN=659]="TESTFUNCTIONBEGIN",e[e.IMAGE=660]="IMAGE",e[e.GRF=661]="GRF",e[e.UNIT=662]="UNIT",e[e.RICHERROR=663]="RICHERROR",e[e.COUNTER=664]="COUNTER",e[e.BROKENRECORD=665]="BROKENRECORD",e[e.FORMULABYTES=666]="FORMULABYTES",e[e.FORMULACODE=667]="FORMULACODE",e[e.FORMULAHTML=668]="FORMULAHTML",e[e.STREAM=669]="STREAM",e[e.GETRICHERRORS=670]="GETRICHERRORS",e[e.DBGSTAT=671]="DBGSTAT",e[e.RICHNUMBER=672]="RICHNUMBER",e[e.RICHERNUMBER=673]="RICHERNUMBER",e[e.DBGWRITE=674]="DBGWRITE",e[e.TEST=675]="TEST",e[e.AAC=676]="AAC",e[e.AWC=677]="AWC",e[e.LETREC=680]="LETREC",e[e.NESTEDRECORD=681]="NESTEDRECORD"}(Ka||(Ka={}));var Qa,Xa=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),Za=[],$a=[[1,Za,[57],Za,1,0,16],[1,[36,831,831],Za,Za,823,0,0],[1,[15],Za,Za,4,0,0],[1,[15],Za,Za,4,0,0],[1,Za,[305],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[0,[16],Za,Za,33,0,0],[0,[16],Za,Za,33,0,0],[0,Za,Za,Za,3,0,16],[2,[1],[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,[1,1],Za,Za,2,0,0],[1,[1,65,4],Za,Za,2,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[0,Za,Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[263,48,48],Za,Za,263,0,0],[2,[48,1,1,1],Za,Za,311,0,0],[2,[2,1],Za,Za,2,0,0],[3,[2,1,1],Za,Za,2,0,0],[1,[2],Za,Za,1,0,0],[1,[7],Za,Za,1,0,0],[0,Za,Za,Za,4,0,16],[0,Za,Za,Za,4,0,16],[1,Za,[52],Za,4,0,16],[1,Za,[52],Za,4,0,16],[1,[4],Za,Za,4,0,16],[2,[1,1],Za,Za,1,0,0],[3,[16,83,18],Za,Za,1,0,0],[3,[16,19,18],Za,Za,1,0,0],[3,[16,19,18],Za,Za,1,0,0],[3,[16,19,18],Za,Za,1,0,0],[3,[16,19,18],Za,Za,1,0,0],[3,[16,19,18],Za,Za,1,0,0],[1,Za,[49],Za,1,0,16],[3,[16,19,18],Za,Za,1,0,0],[2,[263,2],Za,Za,2,0,0],[1,[48,112,84,84],Za,Za,32,0,0],[1,[48,112,112,84],Za,Za,32,0,0],[1,[48,112,84,84],Za,Za,32,0,0],[1,[48,112,112,84],Za,Za,32,0,0],[1,[16],Za,Za,512,0,2],[0,[4],Za,Za,512,0,2],[0,[575],Za,Za,512,0,2],[3,[1,1,1,1,1],Za,Za,1,0,0],[3,[1,1,1,1,1],Za,Za,1,0,0],[3,[1,1,1,1,1],Za,Za,1,0,0],[3,[1,1,1,1,1],Za,Za,1,0,0],[3,[1,1,1,1,1,1],Za,Za,1,0,0],[3,[48,1,1],Za,Za,1,0,16],[1,[48,1],Za,Za,1,0,0],[0,Za,Za,Za,1,16383,0],[2,[263,305,17],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[0,Za,Za,Za,1,16383,0],[1,[16],Za,Za,1,0,0],[1,[48],Za,Za,1,0,0],[1,[48],Za,Za,1,0,0],[3,[16,65,65,65,65],Za,Za,16,16383,0],[2,[2,16],Za,Za,16,0,2],[2,[16,16],Za,Za,2,0,2],[0,[66,81,16],Za,Za,4,0,2],[2,[2,2,1],Za,Za,1,0,0],[1,[39],Za,Za,32,0,0],[0,[1,24],Za,Za,4,0,2],[0,Za,Za,Za,4,0,2],[1,[303],Za,Za,1,0,0],[0,[4],Za,Za,4,0,2],[1,[2,63],Za,Za,4,0,2],[0,Za,Za,Za,50,0,2],[1,[16],Za,Za,47,0,2],[0,[65,66],Za,Za,32,0,2],[4,[87,117,117,1,117],Za,Za,4,0,0],[0,[1,66],Za,Za,32,0,2],[0,Za,Za,Za,16,0,2],[0,Za,Za,Za,16,0,2],[0,[1],Za,Za,4,0,2],[2,[1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[2,[33],[831],Za,823,0,0],[3,[263,49,49,4],Za,Za,295,0,0],[3,[263,49,49,4],Za,Za,295,0,0],[0,[66,65],Za,Za,32,0,2],[1,[2,65,66,67,65,65,2],Za,Za,575,0,2],[1,[63],Za,Za,4,0,0],[1,[18],Za,Za,2,0,2],[1,[2,4],Za,Za,6,0,2],[2,[16,47],Za,Za,4,0,2],[1,[1,1],Za,Za,1,0,0],[1,[2,1,4,4],Za,Za,7,0,2],[1,[1],Za,Za,2,0,0],[1,[2],Za,Za,2,0,0],[1,[2],Za,Za,2,0,0],[1,[2],Za,Za,2,0,0],[1,[2,9],Za,Za,2,0,0],[1,[2,9],Za,Za,2,0,0],[2,[258,258],Za,Za,4,0,0],[1,[2],Za,Za,2,0,0],[4,[2,1,1,2],Za,Za,2,0,0],[3,[2,2,2,2],Za,Za,2,0,0],[1,[2],Za,Za,1,0,0],[0,[66,65,66],Za,Za,32,0,2],[0,[2],Za,Za,2,0,2],[2,[2,2,1],Za,Za,1,0,0],[1,[2,16],Za,Za,303,16383,0],[1,[15],Za,Za,4,0,0],[1,[143],Za,Za,4,0,0],[1,[143],Za,Za,4,0,0],[1,[143],Za,Za,4,0,0],[1,[23],Za,Za,2,0,0],[1,[23],Za,Za,1,0,0],[1,[2,1],Za,Za,1,0,2],[1,[1],Za,Za,1,0,2],[1,[1],Za,Za,1,0,2],[1,[1],Za,Za,2,0,2],[2,[1,1],Za,Za,2,0,2],[2,[1,2],Za,Za,1,0,2],[2,[1,2],Za,Za,1,0,2],[1,[1,1],Za,Za,1,0,2],[1,[3],Za,Za,1,0,0],[1,[3],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[4,[1,1,1,1],Za,Za,1,0,0],[4,[1,1,1,1,1],Za,Za,1,0,0],[1,[2,66,65],Za,Za,2,0,2],[1,[16,4],Za,Za,2,0,2],[1,[2,4],Za,Za,16,0,2],[1,[2,4],Za,Za,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],Za,3,0,2],[1,[3],[127],Za,575,0,2],[0,[3],Za,Za,1,0,2],[2,[3,115,83,3],Za,Za,1,0,2],[3,[3,83,115,83,3],Za,Za,1,0,2],[4,[3,3,3,4,3],Za,Za,4,0,2],[4,[3,3,3,4,3],Za,Za,4,0,2],[4,[3,3,3,3,3],Za,Za,4,0,2],[0,[3],Za,Za,4,0,2],[2,[3,3,3],Za,Za,4,0,2],[3,[3,3,3,3],Za,Za,4,0,2],[1,[1,67,66],Za,Za,1,0,2],[1,[52],Za,Za,36,0,2],[1,[2],Za,Za,2,0,0],[1,[32],Za,Za,1,0,0],[1,[32],Za,Za,32,0,0],[2,[32,32],Za,Za,32,0,0],[0,[2,2],Za,Za,32,0,2],[4,[1,1,1,1,1,1],Za,Za,1,0,0],[4,[1,1,1,1,1,1],Za,Za,1,0,0],[1,Za,[121],Za,1,0,16],[0,[1,16],Za,Za,4,0,2],[3,[2,1,1,1],Za,Za,512,0,2],[1,[4],Za,Za,512,0,2],[0,Za,Za,Za,512,0,2],[0,Za,Za,Za,512,0,2],[2,[2,2],Za,Za,1,0,2],[2,[1,2],Za,Za,32,0,2],[3,[1,18,18],Za,Za,4,0,2],[2,[1,2],Za,Za,4,0,2],[1,[1],Za,Za,4,0,2],[0,[1],Za,Za,512,0,2],[0,[2],Za,Za,4,0,2],[0,[3,3,3,3],Za,Za,3,0,2],[1,Za,[113],Za,1,0,16],[1,[1],Za,Za,1,0,0],[1,[1,16],Za,Za,47,0,2],[1,[1],Za,Za,47,0,2],[1,[1,2],Za,Za,47,0,2],[1,[1,2],Za,Za,63,0,2],[3,[16,19,18],Za,Za,1,0,0],[1,[143],Za,Za,4,0,0],[0,[82,65,65],Za,Za,2,0,2],[0,[66,82,17,17],Za,Za,1,0,2],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[3,[16,19,18],Za,Za,1,0,0],[3,[16,19,18],Za,Za,1,0,0],[1,[1,1],Za,Za,1,0,0],[1,[143],Za,Za,4,0,0],[3,[16,83,18],Za,Za,1,0,0],[1,[3],Za,Za,4,0,2],[1,[3],Za,Za,4,0,2],void 0,void 0,[1,[1,1],Za,Za,2,0,0],[2,[2,2,1],Za,Za,1,0,0],[2,[2,2,1],Za,Za,1,0,0],[4,[2,1,1,2],Za,Za,2,0,0],[1,[2,9],Za,Za,2,0,0],[1,[2,9],Za,Za,2,0,0],[3,[2,1,1],Za,Za,2,0,0],[1,[2],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[1,[2],Za,Za,2,0,0],[1,[2],Za,Za,2,0,0],[2,[1,16,4],Za,Za,1,0,16],void 0,void 0,[2,[1,65,65,68,66],Za,Za,2,0,0],[2,[1,1,4],Za,Za,1,0,0],[0,Za,Za,Za,1,16383,0],[5,[1,1,1,1,1,1,4],Za,Za,1,0,0],[0,Za,Za,Za,512,0,2],[1,[12],Za,Za,512,0,2],[0,Za,Za,Za,512,0,2],[1,[2,82,84],Za,Za,512,0,2],[1,Za,[49],Za,1,0,16],[1,Za,[32],Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,[16,19,18],Za,Za,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],Za,Za,2,0,2],[0,[4],Za,Za,4,0,2],[0,Za,Za,Za,16,0,2],[0,[2,2],Za,Za,4,0,2],[0,[2,2,2],Za,Za,4,0,2],[2,[2,23,23,23,23],Za,Za,2,0,2],[2,[2,1,1,2],Za,Za,1,0,2],[1,[2,66,65,65],Za,Za,1,0,2],[1,[2],Za,Za,3,16383,0],[0,Za,Za,Za,2,0,2],[1,[1,2,1,1,1],Za,Za,47,0,2],[4,[1,1,1,1,1],Za,Za,1,0,0],[0,[4],Za,Za,512,0,2],void 0,void 0,[0,[1],Za,Za,512,0,2],[2,[48,48],Za,Za,32,0,16],[0,[66,96],Za,Za,2,0,2],[1,[2],Za,Za,4,0,2],[1,[17],[127],Za,575,0,0],[1,[3],Za,Za,4,0,2],[1,[2],Za,Za,63,0,2],[1,[1,3],Za,Za,47,0,2],[1,[1,3,1],Za,Za,47,0,2],[1,[2,66,4],Za,Za,4,0,2],[1,[15],Za,Za,1,0,0],[0,[2],Za,Za,4,0,2],[0,[2],Za,Za,4,0,2],[0,[99,66],Za,Za,4,0,2],[3,[3,1,4],Za,Za,4,0,2],[3,[3,1,4],Za,Za,4,0,2],[2,[2,3,66],Za,Za,1,0,2],[1,[1,2],Za,Za,35,0,2],[1,Za,[49],Za,1,0,16],[3,[1,1,1,65,65],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,[1,1,1,65,65],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,[1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[4,[1,1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[3,[1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[3,[1,32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[4,[32,32,1,1],Za,Za,1,0,0],[3,[32,32,1,65],Za,Za,1,0,0],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[2,[49,1,1],Za,Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[49,1,65],Za,Za,1,0,16],[1,Za,[32],Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[1,1],Za,Za,1,0,0],void 0,[3,[2,1,1,1],Za,Za,1,0,2],[2,[2,1,1],Za,Za,1,0,2],[1,Za,[2],Za,2,0,0],[2,[1,1],Za,Za,1,0,0],[2,[66,2,66,65,65,65,66,66,66],Za,Za,2,0,2],[1,[1,2],Za,Za,35,0,2],[1,[1,66,2],Za,Za,35,0,2],[1,[1,66,66,2],Za,Za,7,0,2],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[2,[1],[16],Za,1,0,0],[2,[16,15,16],Za,Za,1,0,0],[2,[16,15],Za,Za,1,0,0],[1,[16],Za,Za,1,0,0],[1,[1,2],Za,Za,19,0,2],[1,[33],Za,Za,33,0,2],[4,[1,1,1,1],Za,Za,1,0,0],[3,[1,1,2],Za,Za,1,0,0],[1,[1],Za,Za,2,0,0],[2,[1,1],Za,Za,2,0,0],[1,[1,5],Za,Za,2,0,0],[0,[66,66,66,65],Za,Za,6,0,2],[0,[66,66,66,66,65],Za,Za,6,0,2],[1,[1,2],Za,Za,19,0,2],[2,[18,18],[2,79],Za,15,0,0],[1,[2,39],Za,Za,39,0,0],[1,[16],Za,Za,2,0,0],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,[1],Za,Za,2,0,0],[1,[1],Za,Za,2,0,0],[1,[3],Za,Za,2,0,0],[1,[1],Za,Za,2,0,0],[1,[1],Za,Za,2,0,0],[1,[1],Za,Za,2,0,0],[1,[2],Za,Za,1,0,0],[1,[2],Za,Za,4,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,Za,[2],Za,2,0,0],[1,[2],[50],Za,15,0,0],[2,[2,50,2],Za,Za,10,0,0],[3,[2,2,2],Za,Za,15,0,0],[3,[2,2,1,2],Za,Za,10,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[2,[95,95,95],Za,Za,9,0,0],[1,Za,[127],Za,9,0,0],[1,Za,[127],Za,9,0,0],[4,[95,95,95,127],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[1,[95,95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[127,127,95],Za,Za,9,0,0],[3,[95,127,127],Za,Za,9,0,0],[5,[95,95,95,95,95,95],Za,Za,9,0,0],[5,[95,95,95,95,95,95],Za,Za,9,0,0],[4,[95,95,95,95,95],Za,Za,9,0,0],[4,[95,95,95,95,95],Za,Za,9,0,0],[4,[95,95,95,95,95],Za,Za,9,0,0],[4,[95,95,95,95,95],Za,Za,9,0,0],[4,[95,95,95,95,95],Za,Za,9,0,0],[3,[95,95,95],Za,Za,9,0,0],[3,[95,95,95],Za,Za,9,0,0],[3,[95,95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,0,0],[2,[95,95,95],Za,Za,9,0,0],[3,[95,95,95,95],Za,Za,9,0,0],[3,[95,95,95,95],Za,Za,9,0,0],[3,[95,95,95,95],Za,Za,9,0,0],[3,[95,95,95,95],Za,Za,9,0,0],[3,[95,95,95,95],Za,Za,9,0,0],[3,[95,95,95,95],Za,Za,9,0,0],[5,[95,95,95,95,95,95],Za,Za,9,0,0],[5,[95,95,95,95,95,95],Za,Za,9,0,0],[7,[95,95,95,95,95,95,95,95],Za,Za,9,0,0],[7,[95,95,95,95,95,95,95,95],Za,Za,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Za,Za,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Za,Za,9,0,0],[2,[95,95],Za,Za,9,16383,0],[1,[95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95,95],Za,Za,9,0,0],[3,[95,95,95],Za,Za,9,0,0],[6,[95,95,95,95,95,95,95,95],Za,Za,9,0,0],[4,[95,95,95,95,95],Za,Za,9,0,0],[2,[95,95,127],Za,Za,9,0,0],[2,[95,95,127],Za,Za,9,0,0],[1,Za,[127],Za,9,0,0],[1,Za,[127],Za,9,0,0],[1,Za,[127],Za,9,0,0],[2,[95,127],Za,Za,9,0,0],[3,[2,2,1,2],Za,Za,10,0,0],[2,[2,50,2,1,2],Za,Za,10,0,0],[1,[2],Za,Za,9,0,0],[2,[47,575],Za,Za,303,0,0],[2,Za,[16,15],Za,1,0,0],[3,[16],[16,15],Za,1,0,0],[2,[16,15,16],Za,Za,1,0,0],[3,[16],[16,15],Za,1,0,0],[3,[1,1,48,17],[16],Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[2,[32,32],Za,Za,1,0,0],[3,[1,1,4],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,Za,[32],Za,32,0,16],[1,Za,[32],Za,1,0,16],[4,[1,1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[2,[49,1],Za,Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[49,1,65],Za,Za,1,0,16],[2,[49,1,65],Za,Za,1,0,16],[3,[1,1,4],Za,Za,1,0,0],[2,[49,1],Za,Za,1,0,16],[2,[49,1],Za,Za,1,0,16],[2,[1,16,4],Za,Za,1,0,16],[2,[1,16,4],Za,Za,1,0,16],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[3,[1,1,4],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[1,Za,[49],Za,1,0,16],[1,Za,[49],Za,1,0,16],[4,[1,1,1,4],Za,Za,1,0,0],[2,[95,95,75,127],Za,Za,9,0,0],[2,[95,95,75,127],Za,Za,9,0,0],[2,[1,1],Za,Za,1,0,0],[1,[1,65],Za,Za,1,0,0],void 0,[4,[1,1,1,4,65,65],Za,Za,1,0,0],[3,[1,1,1,65,65],Za,Za,1,0,0],[3,[1,1,4],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[5,[1,1,1,1,4],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[4,[1,1,1,4],Za,Za,1,0,0],[2,[1,4],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[4,[32,32,1,1],Za,Za,1,0,0],[2,[49,1,1],Za,Za,1,0,16],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[1],Za,Za,1,0,0],[1,[1,65],Za,Za,1,0,0],[1,[1,65],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[2,[1,1],Za,Za,1,0,0],[1,Za,[52],Za,4,0,16],[3,[1,1,1],Za,Za,1,0,0],[2,[1,1,65],Za,Za,2,0,0],[2,[2,1],Za,Za,1,0,0],[2,[3,3],Za,Za,1,0,0],[3,[1,1,1,65],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,Za,[49],Za,1,0,16],[1,[1],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[3,[1,1,1],Za,Za,1,0,0],[1,[1],Za,Za,2,0,0],[1,[2],Za,Za,1,0,0],[1,[1],Za,Za,32,0,0],[1,[2],Za,Za,1,0,0],[1,[1],Za,Za,1,0,0],[1,[2,66,66],Za,Za,1,0,0],[0,[50],Za,Za,1,16383,16],[0,[48],Za,Za,1,16383,16],[1,[16],Za,Za,2,16383,0],[1,[16],Za,Za,4,0,0],[2,[47,575],Za,Za,303,0,0],[1,[1,65,65],Za,Za,1,0,0],[1,[1,65,65],Za,Za,1,0,0],[1,[95],Za,Za,9,0,0],[1,[95],Za,Za,9,0,0],[2,[2,2],Za,Za,47,0,0],[1,[2],Za,Za,10,0,0],[1,[2],Za,Za,10,0,0],[3,[1,48,48,65,65,65],Za,Za,1,0,0],[3,[1,48,48,65,65,65,65],Za,Za,1,0,0],[2,[48,48,65,65],Za,Za,1,0,0],[3,[1,32,32],Za,Za,1,0,0],[3,[48,48,1,65,65,65],Za,Za,1,0,0],[3,[16],[16,15],Za,1,0,0],[3,[16],[16,15],Za,1,0,0],[3,[114,68],[114],Za,2,0,16],[1,Za,[114],Za,2,0,16],[2,Za,[44,575],Za,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1527],Za,Za,1503,0,21],[2,Za,[113,113],Za,1,0,17],[1,[16],Za,Za,48,0,21],[2,[271,2,4],Za,Za,303,0,21],[2,[271,2],Za,Za,303,0,17],[2,[48,48,111],Za,Za,303,0,1],[1,[160,96,96,4],Za,Za,32,0,1],[1,[160,4,4],Za,Za,32,0,1],[2,[2,256],Za,Za,1,0,8],[3,[2,49,1],Za,Za,1,0,25],[3,[2,49,1],Za,Za,1,0,25],[2,[2],[49],Za,1,0,25],[2,[2,2,65,68,68],Za,Za,1,0,1],[1,[2,65,65],Za,Za,2,0,1],[2,[2,2,65,68],Za,Za,2,0,1],[2,[2,2,65,68],Za,Za,2,0,1],[2,[2,98,98,68],Za,Za,32,0,1],[1,[32,96,96,4],Za,Za,32,0,9],[2,[4,16],Za,Za,32,0,25],[2,[391,48,65,65],Za,Za,1,0,1],[3,[391,48,48,511,65,65],Za,Za,319,0,1],[2,[160],[160,65],Za,32,0,1],[0,[65,65,65,65,68],Za,Za,32,16383,1],[1,[65,65,65,65],Za,Za,32,0,1],[2,[258,1,65,65,65],[65],Za,32,0,17],[1,[48,65,65,65,65],Za,Za,48,0,1],[1,[48],[48],Za,32,0,1],[1,[48],[48],Za,32,0,1],[1,[48,33],[33],Za,32,0,1],[1,[48,33],[33],Za,32,0,1],[3,Za,[319,319],[319],319,0,1],[1,Za,[319],Za,319,0,1],[3,[65,65,319],Za,Za,32,0,1],[1,Za,[319],Za,319,0,1],[1,[319],Za,Za,4,0,1],[1,[319],Za,Za,9,0,1],[0,Za,Za,Za,319,0,1],[3,[15],[2,47],Za,303,0,17],[1,[399,1],Za,Za,2,0,1],[1,[32,1],Za,Za,2,0,1],[2,[15,2],Za,Za,256,0,17],[1,[32,65,68],Za,Za,32,0,1],[1,[32,65,68],Za,Za,32,0,1],[2,[32,1,463],Za,Za,32,0,1],[2,[48],[303],Za,32,0,1],[3,[511,48,271],Za,Za,319,0,1],[3,[511,48,271],Za,Za,32,0,1],[1,[48,271],Za,Za,32,0,1],[1,[48,271],Za,Za,32,0,1],[1,[1535],Za,Za,4,0,1],[0,Za,Za,Za,1,0,1],[1,[2],Za,Za,258,0,1],[1,[287,2],Za,Za,288,0,17],[2,[15,2],Za,Za,271,0,17],[1,[1,1],Za,Za,10,0,17],[0,Za,Za,Za,1,0,1],[3,[47],[2,47],Za,47,0,17],[1,[16],Za,Za,2,16383,1],[1,[16],Za,Za,2,16383,1],[1,[16],Za,Za,2,16383,1],[0,[1],Za,Za,1,0,1],[0,[1],Za,Za,32,0,1],[1,[2,1],Za,Za,47,0,1],[1,[1],Za,Za,264,0,17],[1,[1],Za,Za,264,0,17],[2,[2,47],Za,Za,47,0,1],[1,[2],[1151],Za,1087,0,16],[1,[1],[1151],Za,1087,0,0],[1,[1],[1151],Za,1087,0,0],void 0,void 0,[3,Za,[319,319],[319],319,0,1],[3,[15],[2,303],Za,303,0,17]].map((function(e){return void 0===e?void 0:Dr.apply(void 0,e)})),ei=Dr(0,[],[It.All],[],It.All,Ft.All,Ot.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(Qa||(Qa={}));var ti=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"],ri=Tt.Number|Tt.String|Tt.Boolean|Tt.Blank,ni=Tt.Number|Tt.String|Tt.Boolean|Tt.Blank,ai=Dr(2,[Tt.Number,Tt.Number],[],[],Tt.Number,Ft.None,Ot.None),ii=Dr(1,[Tt.Number],[],[],Tt.Number,Ft.None,Ot.None),oi=Dr(1,[ri],[],[],ri,Ft.None,Ot.None),ui=Dr(2,[Tt.String,Tt.String],[],[],Tt.String,Ft.None,Ot.None),si=Dr(2,[ni,ni],[],[],Tt.Boolean,Ft.None,Ot.None),li=Dr(2,[Tt.Range,Tt.Range],[],[],Tt.Range,Ft.AllCells,Ot.None),ci=Dr(2,[Tt.Range,Tt.Range],[],[],Tt.Range,Ft.None,Ot.None),di=Dr(2,[Tt.Boolean,Tt.Boolean],[],[],Tt.Boolean,Ft.None,Ot.None),fi=[];function hi(e){var t=fi[e];return null!=t?t:ei}function vi(e){var t=$a[e];return null!=t?t:ei}function pi(e,t){var r=$a[e];null!=r&&(r.staticPrecs=t)}fi[Qa.Add]=ai,fi[Qa.Sub]=ai,fi[Qa.Mul]=ai,fi[Qa.Div]=ai,fi[Qa.Pow]=ai,fi[Qa.Percent]=ii,fi[Qa.Neg]=ii,fi[Qa.At]=$a[Ka.SINGLE],fi[Qa.Pound]=$a[Ka.ANCHORARRAY],fi[Qa.Pos]=oi,fi[Qa.Concat]=ui,fi[Qa.Eq]=si,fi[Qa.Ne]=si,fi[Qa.Lt]=si,fi[Qa.Le]=si,fi[Qa.Gt]=si,fi[Qa.Ge]=si,fi[Qa.Range]=li,fi[Qa.Isect]=ci,fi[Qa.Union]=ci,fi[Qa.And]=di,fi[Qa.Or]=di,fi[Qa.Xor]=di,fi[Qa.Min]=ai,fi[Qa.Max]=ai,pi(Ka.ROW,Ft.OwnRow),pi(Ka.COLUMN,Ft.OwnCol),pi(Ka.SHEET,Ft.OwnDocSheets),pi(Ka.SHEETS,Ft.OwnDocSheets),pi(Ka.OFFSET,Ft.AllCells),pi(Ka.INDIRECT,Ft.AllCells),pi(Ka.SUMIF,Ft.AllCells),pi(Ka.AVERAGEIF,Ft.AllCells),pi(Ka.LOOKUP,Ft.AllCells),pi(Ka.ADDRESS,Ft.RefStyle),pi(Ka.FORMULATEXT,Ft.RefStyle),pi(Ka.NOW,Ft.Time),pi(Ka.TODAY,Ft.Time),pi(Ka.RAND,Ft.Calc),pi(Ka.RANDBETWEEN,Ft.Calc),pi(Ka.RANDARRAY,Ft.Calc),pi(Ka.SUBTOTAL,Ft.CellProps),pi(Ka.CELL,Ft.CellProps|Ft.AllCells),pi(Ka.INFO,Ft.None);var mi,gi,Si,bi,yi;function Ci(e){return 55296==(64512&e)}function ki(e){return 56320==(64512&e)}function Ei(e){return 55296==(63488&e)}function Ai(e,t){if(Ci(e)&&ki(t))return 65536+((1023&e)<<10|1023&t)}function Ri(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}function Ni(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;Ci(e.charCodeAt(n))&&n+1<e.length&&ki(e.charCodeAt(n+1))?n+=2:n+=1}return n}function Ti(e,t,r){for(var n=0,a=t;a<r;n+=1){Ci(e.charCodeAt(a))&&a+1<r&&ki(e.charCodeAt(a+1))?a+=2:a+=1}return n}function Ii(e,t){var r=e.charCodeAt(t);if(!Ei(r))return r;if(t+1>=e.length)return 65533;var n=Ai(r,e.charCodeAt(t+1));return null!=n?n:65533}function Fi(e){return e>=65536?2:1}function Oi(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var a=Ii(e,n);r.push(a),n+=Fi(a)}return r}!function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(mi||(mi={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(gi||(gi={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.Unknown="Unknown",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(Si||(Si={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench"}(bi||(bi={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(yi||(yi={}));function Di(e){return 32===e||10===e}function Mi(e,t,r,n){ue("calc.parse.parseUint",t,16);for(var a=0,i=n,o=r.length;i<o;){var u=Ii(r,i);if(!e.isNumeral(u))break;var s=e.getOrdinal(u);0===a&&0!==s&&(o=k(o,i+t)),a=10*a+s,i+=Fi(u)}return i===o&&i<r.length&&e.isNumeral(Ii(r,i))?[0,n]:[a,i]}function wi(e,t,r,n){var a=n,i=Mi(e,5,r,a),o=i[0],u=i[1];if(u===a)return!1;if(o>32767)return!1;if(!((a=u)<r.length&&47===r.charCodeAt(a)))return!1;var s=Mi(e,5,r,a+=1),l=s[0],c=s[1];if(c===a)return!1;if(l>32767)return!1;if(a=c,0===l)return[!1,0,a];var d=t.div(t.fromNumber(o),t.fromNumber(l));return ne("calc.lang.tryTokenizeFrac",yn(d)),[d,l,a]}function _i(e,t,r,n,a,i,o){var u,s,l,c=n,d=0,f="",h=!1,v=!1,p=Si.ASCII;if(V(r,e.decimalSeparator,n)||n<r.length&&e.isNumeral(Ii(r,n))){for(var m=function(){if((i||a&&r.indexOf("%",c)>=0)&&(d-=2,void 0!==u)){var n=t.div(u,t.fromNumber(100));ne("calc.lang.parseNumberLiteral",yn(n)),u=n,l=yi.Pct}if(A(d)>=309)return{value:void 0,i:c,consumedThousands:h,consumedDecimal:v,numShape:p,format:l};var o=t.parse(e,!0,d,f);if(void 0!==u){var s=t.add(o,u);ne("calc.lang.parseNumberLiteral",yn(s)),o=s}return{value:o,i:c,consumedThousands:h,consumedDecimal:v,numShape:p,format:l}};c<r.length;){var g=Ii(r,c);if(!e.isNumeral(g))break;if(0!==e.getOrdinal(g))break;(s=e.getNumberShape(g))!==Si.ASCII&&(p=s),c+=Fi(g)}if(o)if(!1!==(C=wi(e,t,r,c))){var S=C[0],b=C[1],y=C[2];return c=y,!1===S?{value:void 0,i:c,consumedThousands:h,consumedDecimal:v,numShape:p,format:l}:(l=b>=10?yi.FractBond:yi.Fract,u=S,m())}for(var C,k=c;c<r.length;){g=Ii(r,c);if(e.isNumeral(g))d+=1,(s=e.getNumberShape(g))!==Si.ASCII&&(p=s),c+=Fi(g);else{if(!(a&&d>0&&V(r,e.thousandsSeparator,c)))break;h=!0,c+=e.thousandsSeparator.length}}if(f+=r.substring(k,c),h){var E=function(e,t,r){for(var n=r,a="",i=0;i<t.length;){var o=Ii(t,i);if(e.isNumeral(o)){var u=Fi(o);a+=t.substring(i,i+u),i+=u,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;i+=e.thousandsSeparator.length}}return a}(e,f,d);if(void 0===E)return;f=E}if(n<c&&c<r.length&&Di(r.charCodeAt(c)))if(!1!==(C=wi(e,t,r,c+1))){S=C[0],b=C[1],y=C[2];return c=y,!1===S?{value:void 0,i:c,consumedThousands:h,consumedDecimal:v,numShape:p,format:l}:(l=b>=10?yi.FractBond:yi.Fract,u=S,m())}var R=!1;if(V(r,e.decimalSeparator,c)&&(R=c===n,v=!0,c+=e.decimalSeparator.length),0===d)for(;c<r.length;){g=Ii(r,c);if(!e.isNumeral(g))break;if(0!==e.getOrdinal(g))break;d-=1,(s=e.getNumberShape(g))!==Si.ASCII&&(p=s),c+=Fi(g)}for(k=c;c<r.length;){g=Ii(r,c);if(!e.isNumeral(g))break;(s=e.getNumberShape(g))!==Si.ASCII&&(p=s),c+=Fi(g)}if(f+=r.substring(k,c),!(R&&c<=n+e.decimalSeparator.length)){var N=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!V(t,"**",n))return[0,r];n+=2}var a=!1;if(n<t.length){var i=Ii(t,n);((a=45===i)||43===i)&&(n+=Fi(i))}if(n>=t.length||!e.isNumeral(Ii(t,n)))return!1;var o=Mi(e,10,t,n),u=o[0],s=o[1];return s!==n&&(!(u>2147483647)&&[a?-u:u,s])}(e,r,c);if(!1!==N){var T=N[0];y=N[1];d+=T,y!==c&&(l=yi.Exp),c=y}return!1===N?{value:void 0,i:c,consumedThousands:h,consumedDecimal:v,numShape:p,format:l}:m()}}}var Li=1<<20,Pi=Li.toString(10).length,xi=16384,Bi=xi.toString(26).length,Ui=xi.toString(10).length;function Gi(e){return e>=97&&e<=122||e>=65&&e<=90}function ji(e){return 1+(e>=97?e-97:e-65)}function Vi(e,t,r){return function(n,a,i,o){var u=function(e,t){return V(e,"$",t)?[pt.Abs,t+1]:[pt.Rel,t]}(i,o),s=u[0],l=u[1],c=e(n,r,i,l),d=c[0],f=c[1];if(f>l){if(d<1||d>t)return;return[Gt(s,(s===pt.Rel?d-a:d)-1),!1,f]}return[void 0,!1,o]}}function Hi(e,t,r){return io(e,t,r)-e}function Wi(e,t,r,n){return function(a,i,o,u){var s=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(u>=o.length||0!==a.stringCompareCI(s,o[u]))return[void 0,!1,u];var l=u+s.length,c=Mi(a,n,o,l),d=c[0],f=c[1];if(f>l){if(d<1||d>r)return;return[Gt(pt.Abs,d-1),!1,f]}if(V(o,a.leftBracket,l)){if(l+=a.leftBracket.length,V(o,a.rightBracket,l))return[Gt(pt.Rel,Hi(i,0,r)),!0,l+a.rightBracket.length];var h=1,v=o.charCodeAt(l);43===v?l+=1:45===v&&(h=-1,l+=1);var p=Mi(a,n,o,l),m=p[0],g=p[1];if(g>l&&m<r&&V(o,a.rightBracket,g))return[Gt(pt.Rel,Hi(i,m*h,r)),!0,g+a.rightBracket.length]}return[!1,!1,f]}}function Ki(e,t,r,n,a,i,o){var u=n(e,t,i,o);if(null==u)return[void 0,void 0,o];var s=u[0],l=u[1],c=u[2];if(c>o){var d=a(e,r,i,c);if(null==d)return l?[s,void 0,c]:[void 0,void 0,o];var f=d[0],h=d[2];return h>c?[s,f,h]:[s,void 0,c]}var v=a(e,r,i,o);if(null==v)return[void 0,void 0,o];var p=v[0],m=v[2];return m>o?[void 0,p,m]:[void 0,void 0,o]}var zi=Vi(Mi,Li,Pi),Yi=Vi((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,i=k(t.length,r+e);a<i;a+=1){var o=t.charCodeAt(a);if(!Gi(o))break;n=26*n+ji(o)}return a===i&&a<t.length&&Gi(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),xi,Bi),qi=Wi(!1,!0,Li,Pi),Ji=Wi(!1,!1,xi,Ui),Qi=Wi(!0,!0,Li,Pi),Xi=Wi(!0,!1,xi,Ui);function Zi(e,t){return"object"!=typeof e&&"object"!=typeof t}function $i(e,t,r,n,a){var i,o=r.col,u=r.row;if(t===ft.A1){var s=Ki(e,o,u,Yi,zi,n,a),l=s[0],c=s[1],d=s[2];if((null!=c&&null!=l||null!=c&&c.kind===pt.Abs||null!=l&&l.kind===pt.Abs||(null!=c||null!=l)&&(a-1>=0&&58===n.charCodeAt(a-1)||d<n.length&&58===n.charCodeAt(d)))&&(d>=n.length||!e.isIdentContinue(Ii(n,d))))return{refStyle:ft.A1,row:c,col:l,i:d}}var f=!1,h=Ki(e,u,o,qi,Ji,n,a),v=h[0],p=h[1],m=h[2];if(null!=v||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(f=!0,v=(i=Ki(e,u,o,Qi,Xi,n,a))[0],p=i[1],m=i[2]),(null!=v||null!=p)&&(m>=n.length||!Zi(v,p)||!e.isIdentContinue(Ii(n,m))))return{refStyle:ft.R1C1,row:v,col:p,i:m,enLocale:f}}function eo(e,t){var r=Ki(e,0,0,Yi,zi,t,0),n=r[0],a=r[1],i=r[2];return void 0!==n&&void 0!==a&&i===t.length?va(a.index,n.index):void 0}function to(e,t){var r=Ki(e,0,0,Yi,zi,t,0),n=r[0],a=r[1],i=r[2];if(void 0!==n&&void 0!==a){if(i===t.length)return va(a.index,n.index);if(58===t.charCodeAt(i)){var o=Ki(e,0,0,Yi,zi,t,i+1),u=o[0],s=o[1],l=o[2];if(void 0!==u&&void 0!==s&&l===t.length){var c=k(a.index,s.index),d=k(n.index,u.index);return ha(c,d,E(a.index,s.index)+1-c,E(n.index,u.index)+1-d)}}}}var ro=Gt(pt.Abs,0),no=Gt(pt.Abs,1048575);function ao(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function io(e,t,r){return e+t&r-1}function oo(e,t){return e===ft.R1C1&&t.kind===pt.Rel&&0!==t.index}function uo(e,t,r,n){if(t.kind===pt.Abs)return t.index;if(n)return io(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function so(e,t,r,n,a,i){var o=uo(r,n,a,i);if(void 0!==o){if(n.kind===pt.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function lo(e,t,r,n,a){return t===ft.A1?function(e,t,r){var n=uo(e,t,1<<20,r);if(void 0!==n){var a=(n+1).toFixed();return t.kind===pt.Abs?"$"+a:a}}(r,n,a):so(e,e.rowLetter,r,n,1<<20,a)}function co(e,t,r,n,a){return t===ft.A1?function(e,t,r){var n=uo(e,t,16384,r);if(void 0!==n){var a=ao(n);return t.kind===pt.Abs?"$"+a:a}}(r,n,a):so(e,e.columnLetter,r,n,16384,a)}function fo(e,t,r,n){if(r.kind===pt.Abs)return r;var a=uo(t,r,e,n);if(void 0!==a){var i=a-t;return i===r.index?r:Gt(pt.Rel,i)}}fo.bind(void 0,1<<20),fo.bind(void 0,16384);function ho(e,t,r,n,a){var i=uo(e,t,n,a),o=uo(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function vo(e,t,r,n,a,i,o,u,s){var l=ho(i,o,u,r,s);if(void 0!==l){var c=l[0],d=l[1],f=l[2],h=l[3];if(void 0!==t&&0===f&&h===r-1&&o.kind===u.kind)return t(n,a,s);var v=e(n,a,i,c,s);if(void 0!==v){if(a===ft.R1C1&&c.kind===d.kind&&c.index===d.index)return v;var p=e(n,a,i,d,s);if(void 0!==p)return v+":"+p}}}var po=vo.bind(void 0,lo,void 0,1<<20),mo=vo.bind(void 0,co,(function(e,t,r){return po(e,t,0,ro,no,r)}),16384);function go(e,t,r,n,a,i){var o=ho(r,n,a,t,i);if(void 0!==o){var u=o[0],s=o[1],l=o[2],c=o[3];if(void 0!==e&&0===l&&c===t-1&&n.kind===a.kind)return e;var d=fo(t,r,u,i),f=fo(t,r,s,i);if(void 0!==d&&void 0!==f)return[!1,d,f]}}go.bind(void 0,void 0,1<<20),go.bind(void 0,[!0,ro,no],16384);function So(e,t,r,n,a,i){var o=lo(e,t,r.row,n,i),u=co(e,t,r.col,a,i);if(void 0!==o&&void 0!==u)return t===ft.A1?u+o:o+u}function bo(e,t,r,n,a,i,o,u){var s=ho(r.row,n,i,1<<20,u),l=ho(r.col,a,o,16384,u);if(void 0!==s&&void 0!==l){var c=s[0],d=s[1],f=s[2],h=s[3],v=l[0],p=l[1],m=l[2],g=l[3];if(0===m&&16383===g&&a.kind===o.kind)return po(e,t,r.row,c,d,u);if(0===f&&1048575===h&&n.kind===i.kind)return mo(e,t,r.col,v,p,u);var S=So(e,t,r,c,v,u),b=So(e,t,r,d,p,u);if(void 0!==S&&void 0!==b)return S+":"+b}}function yo(e,t){return 46===t||e.isIdentContinue(t)}var Co=/'/g;function ko(e,t){if(0===t.length)return!1;var r=0,n=Ii(t,r);if(!e.isIdentStart(n))return!1;for(var a=0,i=Oi(t,r+=Fi(n));a<i.length;a++){if(!yo(e,i[a]))return!1}return!0}var Eo=va(0,0);function Ao(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=$i(e,t,Eo,r,0);if(void 0!==n)if(n.refStyle===ft.A1){var a=n.i;if(a>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,a)))return!0}else if(!Zi(n.row,n.col))return!0;return!ko(e,r)&&(!function(e,t){var r=0;if(!V(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=Ii(t,r);if(!yo(e,n))return!1;for(r+=Fi(n);;){if(V(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var a=Ii(t,r);if(!yo(e,a))return!1;r+=Fi(a)}var i=t.indexOf(":",r);return i<0?ko(e,t.substring(r)):ko(e,t.substring(r,i))&&ko(e,t.substring(i+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&ko(e,t.substring(r,t.length-n))))}(e,r))}function Ro(e,t,r){return Ao(e,t,r)?No(r):r}function No(e){return"'"+e.replace(Co,"''")+"'"}function To(e,t,r){var n=1===t.cols&&1===t.rows?So(e,ft.A1,va(0,0),Gt(pt.Rel,t.row),Gt(pt.Rel,t.col),!1):bo(e,ft.A1,va(0,0),Gt(pt.Rel,t.row),Gt(pt.Rel,t.col),Gt(pt.Rel,t.row+t.rows-1),Gt(pt.Rel,t.col+t.cols-1),!1);return ne("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:Ro(e,ft.A1,r)+"!"+n}var Io,Fo=r(3),Oo={ULS:new I.NulLogger},Do=Object(I.initStopwatchFactory)((function(e){return Oo.ULS.traceTag(595948114,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,e)}));function Mo(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(Io||(Io={}));var wo=function(e,t,r){var n;function a(e){n[e]|=Io.IdentStartClass}function i(e){n[e]|=Io.IdentContinueClass}function o(e,t){n[e]|=Io.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var s=E(e[e.length-1],E(t[t.length-1],r[r.length-1]));n=new Uint8Array(s),Mo(e,a),Mo(t,i),Mo(r,o);for(var l=4969;l<4978;l+=1)o(l,4968)}var c=n[u];return void 0!==c?c:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2248,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,40957,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42955,42997,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2248,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6849,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,40957,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42955,42997,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]),_o={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};function Lo(e,t){return{key:e,value:t}}var Po=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return Lo(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var a=e[0],i=e[1];return r.push([a,i,t+n])})),r.sort((function(e,r){var n=e[0],a=e[2],i=r[0],o=r[2],u=t.keyCompare(n,i);return 0!==u?u:a-o}));for(var a=[],i=void 0,o=0;o<r.length;o+=1){var u=r[o],s=u[0],l=u[1];void 0===i||0!==this.keyCompare(s,i)?(a.push([s,l]),i=s):a[a.length-1]=[s,l]}return this.ofSequence(a)},e.prototype.getKeyIndex=function(e){for(var t=xo;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=Bo(t):r>0&&(t=Uo(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],a=t[0];return r.keyCompare(n,a)}));for(var a=new Array(n.length),i=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var i=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+i,e(Bo(t),r,n,i),e(Uo(t),r,n+i+1,a-i-1)}(xo,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var s=n[o[u]],l=s[0],c=s[1];a[u]=l,i[u]=c}return new e(this.keyCompare,a,i)},e}(),xo=0;function Bo(e){return 2*e+1}function Uo(e){return 2*e+2}var Go,jo=r(2),Vo=function(e,t,r,n,a){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}},Ho=Vo(0,void 0,0,void 0,0),Wo=jo.dtr.Rounding,Ko=jo.dtr.dtr,zo=jo.dtr.TimeDivision;!function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(Go||(Go={}));var Yo={fromNum:function(e,t,r){return jo.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=jo.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):Pa},toNumWithDuration:function(e,t,r,n){var a=jo.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof a?e.mathpack.fromNumber(a):Pa},daysPerMonth:jo.dtr.daysPerMonth,toDays:function(e,t){return jo.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return jo.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return jo.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}};function qo(e){return{kind:Tt.Number,_valueXL:e}}var Jo=qo(jo.mathpack.zero()),Qo=qo(jo.mathpack.one()),Xo=qo(jo.mathpack.pi());function Zo(e){return 0!=(e.num&jo.mathpack.MathErrorNum.DivBy0)?Ma:Pa}function $o(e){return function(t){return re("calc.lang."+e+": error "+JSON.stringify(t))}}function eu(e,t,r){return function(n){var a=e(n._valueXL);return"number"==typeof a?t(a):r(a)}}function tu(e,t,r){return function(n,a){var i=e(n._valueXL,a._valueXL);return"number"==typeof i?t(i):r(i)}}var ru=tu((function(e,t){return jo.mathpack.equal(t,2)?jo.mathpack.mul(e,e):jo.mathpack.power(e,t)}),qo,Zo),nu=eu((function(e){return jo.mathpack.div(e,100)}),qo,$o("xlPercent"));var au=eu(jo.mathpack.ceil,qo,$o("xlCeil")),iu=eu(jo.mathpack.floor,qo,$o("xlFloor")),ou=eu(jo.mathpack.cond,f,$o("xlCond, isSupported = "+Object(jo.isSupported)())),uu=tu(jo.mathpack.cond2,f,$o("xlCond2"));var su=eu(jo.mathpack.sfix,f,$o("xlSfix")),lu=eu(jo.mathpack.viewRound,qo,$o("xlViewRound"));var cu,du,fu,hu,vu,pu,mu={zero:Jo,one:Qo,pi:Xo,add:tu(jo.mathpack.add,qo,Zo),sub:tu(jo.mathpack.sub,qo,Zo),mul:tu(jo.mathpack.mul,qo,Zo),div:tu(jo.mathpack.div,qo,Zo),power:ru,percent:nu,neg:function(e){return 0!==ou(e)?qo(jo.mathpack.neg(e._valueXL)):e},compare:function(e,t){return jo.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var n=t._valueXL,a=jo.mathpack.formatGeneral(e,n,r);return"string"!=typeof a?re("calc.lang.xlFormatGeneral: error "+JSON.stringify(a)):a},formatFixed:function(e,t,r){var n=e._valueXL,a=jo.mathpack.formatFixed(n,t,r);return"object"!=typeof a?re("calc.lang.xlFormatFixed: error "+JSON.stringify(a)):a},formatScientific:function(e,t,r){var n=e._valueXL,a=jo.mathpack.formatScientific(n,t,r);return"object"!=typeof a?re("calc.lang.xlFormatScientific: error "+JSON.stringify(a)):a},parse:function(e,t,r,n){var a=jo.mathpack.pack(e,t,r,n);return"number"!=typeof a?re("calc.lang.xlParse: error "+JSON.stringify(a)):qo(a)},trunc:function(e){return qo(jo.mathpack.trunc(e._valueXL))},ceil:au,floor:iu,abs:function(e){return qo(jo.mathpack.abs(e._valueXL))},cond:ou,cond2:uu,fromNumber:function(e){return ne("calc.lang.xlFromNumber",isFinite(e)),qo(e)},toNumber:function(e){var t=e._valueXL;return ne("calc.lang.xlToNumber",isFinite(t)),t},sqrt:eu(jo.mathpack.sqrt,qo,Zo),exp:eu(jo.mathpack.exp,qo,Zo),ln:eu(jo.mathpack.ln,qo,Zo),log:eu(jo.mathpack.log,qo,Zo),sin:eu(jo.mathpack.sin,qo,Zo),cos:eu(jo.mathpack.cos,qo,Zo),tan:eu(jo.mathpack.tan,qo,Zo),asin:eu(jo.mathpack.asin,qo,Zo),acos:eu(jo.mathpack.acos,qo,Zo),atan:eu(jo.mathpack.atan,qo,Zo),atan2:tu(jo.mathpack.atan2,qo,Zo),round:tu(jo.mathpack.round,qo,Zo),roundUp:tu(jo.mathpack.roundUp,qo,Zo),roundDown:tu(jo.mathpack.roundDown,qo,Zo),tenTo:function(e){ae("calc.lang.xlTenTo",e);var t=jo.mathpack.tenTo(e);return"number"==typeof t?qo(t):Zo(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,n=t._valueXL;return jo.mathpack.exp32(r)-jo.mathpack.exp32(n)>=52428800?Jo:t},fix:function(e){return jo.mathpack.fix(e._valueXL)},lfix:function(e){return jo.mathpack.lfix(e._valueXL)},sfix:su,viewRound:lu};function gu(e,t,r,n,a,i,o){return void 0===t&&(t=ft.A1),void 0===r&&(r=mu),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===i&&(i=Ho),void 0===o&&(o=Yo),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}}var Su,bu,yu,Cu,ku,Eu,Au=!1,Ru=void 0,Nu=/^(https)|(http)|(file):\/\//;function Tu(e,t,r){Iu(e,t,r,void 0)}function Iu(e,t,r,n){if(Au){ee.ULS.traceTag(595910878,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var a;if(ee.setLogger(e),function(e){Oo.ULS=e}(e),"function"==typeof(a=t)&&(we=a),null!=r&&!Nu.test(r)){var i="calc.config.initCalc: calcAbsUrl is not absolute: "+r;ee.ULS.traceTag(595910879,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,i)}Fo.setConfig(null!=n?n:{onWorkerError:function(e){var t={error:q(e),innerError:e.info.error?q(e.info.error):void 0},r="calc.onWorkerError: "+JSON.stringify(t);ee.ULS.traceTag(593335298,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: "+JSON.stringify(e);ee.ULS.traceTag(593335299,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,t)}}),Ru=r,Au=!0;ee.ULS.traceTag(594642132,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"calc.config.initCalc: Calc version 28.11.0 (production) initialized")}}function Fu(){return Au}function Ou(){return Ru}function Du(){if(null==Ru)throw new Error("initCalc was not passed calcAbsUrl");return Ru}function Mu(e,t,r,n){return Object(fe.b)(this,void 0,void 0,(function(){var a;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return[4,Fo.Endpoint.createOutside(e)];case 1:return a=i.sent(),Iu((o=a.post,u=function(e){return"["+(new Date).toISOString()+"] "+e},{shipAssertTag:function(e,t,r,n){o.shipAssertTag(e,t,r,u(n))},assertTag:function(e,t,r,n){o.assertTag(e,t,r,u(n))},traceTag:function(e,t,r,n){o.traceTag(e,t,r,u(n))},debugTraceTag:function(e,t,r,n){o.debugTraceTag(e,t,r,u(n))}}),(function(e){return!0===t[e]}),r,n),[2]}var o,u}))}))}function wu(e){return Object(fe.b)(this,void 0,void 0,(function(){var t,r,n,a,i;return Object(fe.d)(this,(function(o){switch(o.label){case 0:t=Du(),r=new MessageChannel,n={port:r.port1,options:{id:"WorkerThreadLogger"}},a={port:r.port2,options:{id:"WorkerThreadLogger"}},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Promise.all([Fo.Endpoint.createInside(n,(function(){return ee.noThrowLogger})),e.call.initCalcThreadInside.transfer([a.port],a,Pe(),t)])];case 2:return[2,o.sent()[0]];case 3:throw i=o.sent(),n.port.close(),i;case 4:return[2]}}))}))}function _u(e,t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,y,C){return Lu(r,n,Pu,xu,Bu,(function(e){return e>0&&e%3==0}),Uu,Gu,s,l,Vu,c,d,f,h,v,p,m,g,S,b,y,C,",",bu.USA,Su.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,mi.Paren,!0,!1,"$",2,gi.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],Hu,Wu,Ku,zu,Yu,qu)}function Lu(e,t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,y,C,k,E,A,R,N,T,I,F,O,D,M,w,_,L,P,x,B,U,G,j,V,H,W,K,z,Y,q,J,Q,X,Z,$,ee,te,re,ne,ae,ie,oe,ue,se,le,ce){return{getWorksheetFuncId:function(t){return e(t.toLocaleUpperCase())},getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:a,isThousandsPosition:i,isIdentStart:o,isIdentContinue:u,stringCompareCI:s,errorNames:l,specialRefNames:c,trueName:d,falseName:f,rowLetter:h,columnLetter:v,leftBrace:p,rightBrace:m,leftBracket:g,rightBracket:S,decimalSeparator:b,listSeparator:y,columnSeparator:C,rowSeparator:k,thousandsSeparator:E,lcid:A,country:R,isThai:N,isEastAsia:T,isKorea:I,isJapan:F,isChinaT:O,isChinaS:D,isComplexScript:M,numberDecimals:w,isExpSepBySpace:_,fractionSeparator:L,isPercentSepBySpace:P,currencyFormat:x,isCurrencySymbolLead:B,isCurrencySepBySpace:U,currencySymbol:G,currencyDecimals:j,dateOrder:V,dateSeparator:H,dateAltSeparator:W,year4Digits:K,month2Digits:z,day2Digits:Y,longDateFormat:q,timeSeparator:J,timeAltSeparator:Q,hour2Digits:X,clock24Hour:Z,isAMPMSepBySpace:$,ampmSymbols:ee,dayNameShort:te,dayNameLong:re,monthNameShort:ne,monthNameLong:ae,pictureSpecial:ie,pictureSingle:oe,pictureColor:ue,pictureDbnum:se,sysDateFormat:le,sysTimeFormat:ce}}function Pu(e){return 0!=(wo(e)&Io.DigitClass)}function xu(e){var t=wo(e);return 0==(t&Io.DigitClass)?re("calc.config.getOrdinal: expected numeral; given "+D(e)):t&Io.Ordinal}function Bu(e){switch(ne("calc.config.getNumberShape",Pu(e)),2147483392&e){case 0:return Si.ASCII;case 1536:return e<1648?Si.ArabicIndic:Si.ExtendedArabicIndic;case 1792:return Si.Unknown;case 2304:return e<2416?Si.Devanagari:Si.Bengali;case 2560:return e<2672?Si.Gurmukhi:Si.Gujarati;case 2816:return e<2928?Si.Oriya:Si.Tamil;case 3072:return e<3184?Si.Telugu:Si.Kannada;case 3328:return e<3440?Si.Malayalam:Si.Unknown;case 3584:return e<3680?Si.Thai:Si.Lao;case 3840:return Si.Tibetan;case 4096:return e<4176?Si.Myanmar:Si.Unknown;case 4864:return Si.Ethiopic;case 5888:return Si.Khmer;case 6144:return Si.Mongolian;default:return Si.Unknown}}function Uu(e){return 0!=(wo(e)&Io.IdentStartClass)}function Gu(e){return 0!=(wo(e)&Io.IdentContinueClass)}!function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(Su||(Su={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(bu||(bu={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(yu||(yu={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(Cu||(Cu={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(ku||(ku={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(Eu||(Eu={}));var ju=Y(((cu={})[Na.NULL]="#NULL!",cu[Na.DIV0]="#DIV/0!",cu[Na.VALUE]="#VALUE!",cu[Na.REF]="#REF!",cu[Na.NAME]="#NAME?",cu[Na.NUM]="#NUM!",cu[Na.NA]="#N/A",cu[Na.GETTING_DATA]="#GETTING_DATA",cu[Na.FIELD]="#FIELD!",cu)),Vu=Y(((du={})[At.All]="#All",du[At.Data]="#Data",du[At.Headers]="#Headers",du[At.Totals]="#Totals",du[At.ThisRow]="#This Row",du)),Hu=Y(((fu={})[yu.AP1]="AM/PM",fu[yu.AP2]="A/P",fu[yu.AP3]="/",fu[yu.General]="General",fu[yu.Currency]="$",fu)),Wu=Y(((hu={})[Cu.Sep]=";",hu[Cu.Hash]="#",hu[Cu.Zero]="0",hu[Cu.Decimal]=".",hu[Cu.Percent]="%",hu[Cu.Comma]=",",hu[Cu.Colon]=":",hu[Cu.DateSep]="/",hu[Cu.Slash]="/",hu[Cu.Space]=" ",hu[Cu.Minus]="-",hu[Cu.Plus]="+",hu[Cu.OpenParen]="(",hu[Cu.CloseParen]=")",hu[Cu.Backslash]="\\",hu[Cu.Star]="*",hu[Cu.Year]="y",hu[Cu.Month]="m",hu[Cu.Day]="d",hu[Cu.Hour]="h",hu[Cu.Minute]="m",hu[Cu.Second]="s",hu[Cu.E]="E",hu[Cu.APDelim]="/",hu[Cu.Quote]='"',hu[Cu.ColorStart]="[",hu[Cu.ColorEnd]="]",hu[Cu.Text]="@",hu[Cu.Question]="?",hu[Cu.Underscore]="_",hu[Cu.Reign]="r",hu[Cu.LocDay]="a",hu[Cu.Era]="g",hu[Cu.EraYear]="e",hu[Cu.BidiDate]="B",hu[Cu.BidiNum]="N",hu[Cu.DayTh]="",hu[Cu.MonthTh]="",hu[Cu.YearTh]="",hu[Cu.EngYearTh]="b",hu[Cu.ThYear]="",hu[Cu.HourTh]="",hu[Cu.MinuteTh]="",hu[Cu.SecondTh]="",hu[Cu.ZeroTh]="",hu)),Ku=Y(((vu={})[ku.Black]="Black",vu[ku.White]="White",vu[ku.Red]="Red",vu[ku.Green]="Green",vu[ku.Blue]="Blue",vu[ku.Yellow]="Yellow",vu[ku.Magenta]="Magenta",vu[ku.Cyan]="Cyan",vu[ku.Color]="Color",vu)),zu=Y(((pu={})[Eu.DBNUM1]="DBNum1",pu[Eu.DBNUM2]="DBNum2",pu[Eu.DBNUM3]="DBNum3",pu[Eu.DBNUM4]="DBNum4",pu)),Yu="dddd, mmmm dd, yyyy",qu="h:mm:ss AM/PM",Ju=void 0;function Qu(e){var t=ts()[e];return void 0===t?"wsf:"+e:t}function Xu(e){var t=ju[e];return void 0===t?"error.type:"+e:t}function Zu(e){if(e===Qa.Isect)return" ";if(e===Qa.Union)return",";var t=ti[e];return void 0===t?"op:"+e:t}function $u(e,t,r){return t===Qa.Isect?r:t===Qa.Union?e.listSeparator:ti[t]}var es=/_/g;function ts(){if(null==Ju){Ju=[];for(var e=0,t=v(Ka);e<t.length;e++){var r=t[e],n=Xa[r],a=null!=n?n:Ka[r].replace(es,".");Ju[r]=a}}return Ju}function rs(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),Po.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?re("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var ns,as,is=void 0;function os(){var e,t,r,n,a;return null==is&&(e=ts(),t=R("en-US"),r=rs(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,is=Lu(n,a,Pu,xu,Bu,(function(e){return e>0&&e%3==0}),Uu,Gu,t,ju,Vu,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",",",bu.USA,Su.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,mi.Paren,!0,!1,"$",2,gi.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],Hu,Wu,Ku,zu,Yu,qu)),is}function us(e){return{originGridCell:he(e.range),originSheet:he(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}function ss(e){return{kind:ns.NoOriginSheet,origin:e}}function ls(e){return{kind:ns.InvalidStructRef,reason:e}}!function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(ns||(ns={})),function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(as||(as={}));var cs,ds={kind:ns.EmptyIntersection};!function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(cs||(cs={}));var fs=function(e,t){return{kind:cs.ResolvedName,node:e,resolution:t}},hs=function(e,t){return{kind:cs.ResolvedCellRef,node:e,resolution:t}},vs=function(e,t,r){return{kind:cs.ResolvedUserDefinedFunc,node:e,resolution:t,name:r}},ps=function(e,t){return{kind:cs.ResolvedLocalName,node:e,resolution:t}},ms=function(e,t,r){return{kind:cs.ResolvedStructRef,node:e,table:t,resolution:r}},gs=function(e){return{kind:cs.ResolvedNever,node:e,resolution:me}},Ss=function(e,t){return{kind:cs.ResolvedDottedName,resolved:e,fields:t}};function bs(e){return Se(e)&&y(e.value)?me:e}function ys(e){return!Se(e)||void 0===e.value}function Cs(e,t,r){var n=uo(e.row,t.row,1<<20,r),a=uo(e.col,t.col,16384,r);return void 0!==n&&void 0!==a?va(n,a):void 0}function ks(e,t){if(t.kind===vt.Error)return me;var r=e.originGridCell;if(!Se(r))return r;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case vt.Single:return he(Cs(n,t,a));case vt.Range:var i=Cs(n,t.ref1,a),o=Cs(n,t.ref2,a);return void 0!==i&&void 0!==o?he(sn(i,o)):me;case vt.Row:var u=uo(n.row,t.row1,1<<20,a),s=uo(n.row,t.row2,1<<20,a);return void 0!==u&&void 0!==s?he(sn(va(u,0),va(s,16383))):me;case vt.Col:var l=uo(n.col,t.col1,16384,a),c=uo(n.col,t.col2,16384,a);return void 0!==l&&void 0!==c?he(sn(va(0,l),va(1048575,c))):me;default:return te("calc.runtime.resolverService.resolveGridRef",t)}}function Es(e){function t(t,r){if(void 0===r){var n=t.originSheet;return Se(n)?[r,he(n.value.document)]:[r,n]}var a=e.getDocumentLoc(r.path,r.document);if(!Se(a))return[r,a];var i=null==r.path?void 0:y(a.value)?r.path:a.value.path;return[Pt(y(a.value)?r.document:a.value.name,i,r.isQuoted,r.label),b(a.value)?he(a.value):me]}function r(t,r){if(ys(r))return[t,r];var n=bs(e.getSheetIndex(r.value,t));if(ys(n))return[t,n];var a=e.getSheetName(r.value,n.value);return Se(a)?[a.value,he(la(r.value,n.value))]:[t,a]}function n(e,n){var a=t(e,n.document),i=a[0],o=a[1],u=r(n.sheet,o),s=u[0],l=u[1];return[xt(s,i,n.isQuoted,n.label),l]}function a(a,i){switch(i.kind){case ht.Error:return[i,me];case ht.Sheet:return n(a,i);case ht.SheetRange:return function(n,a){var i,o=t(n,a.document),u=o[0],s=o[1],l=r(a.sheet1,s),c=l[0],d=l[1],f=r(a.sheet2,s),h=f[0],v=f[1],p=c,m=h;if(ys(s))i=s;else if(ys(d))i=d;else if(ys(v))i=v;else{if($r(d.value,v.value))return[xt(p,u,a.isQuoted,a.label),he(la(s.value,d.value.index))];var g=e.getSheetRangeIndexes(d.value),S=e.getSheetRangeIndexes(v.value);Se(g)?Se(S)?S.value.position<g.value.position&&(p=h,m=c):i=S:i=g,i=he(sa(s.value,d.value.index,v.value.index))}return[Ut(p,m,u,a.isQuoted,a.label),i]}(a,i);default:return te("calc.runtime.resolverService.resolveCellRefQualifier",i)}}function i(e,t){var r,n,i,o,u=t.qualifier,s=t.ref,l=ks(e,s);if(void 0===u||u.kind===ht.Relative){n=u;var c=e.originSheet;if(Se(c)){var d=c.value;i=void 0===d.index?ge(ss(d)):he(d)}else i=c}else n=(r=a(e,u))[0],i=r[1];return o=ys(l)?l:ys(i)?i:he(Sa(i.value,l.value)),hs(Sr(s,n,t.label),o)}function o(r,a,i){var o,u,s,l=a.qualifier,c=a.parts;if(void 0===l||l.kind===ht.Relative){var d=r.originSheet;if(!Se(d))return fs(a,d);var f=d.value;if(void 0===f.index)return fs(a,ge(ss(f)));var h=bs(e.getNameLoc(f,c.asWhole,i));if(!Se(h))return fs(a,h);if(h.value)return fs(fr(hr(h.value.name,c.canDenoteNamedObject,c.label),l,a.label),h);u=l,s=he(ka(f.document))}else u=(o=function(e,r){switch(r.kind){case ht.Document:var a=t(e,r);return[l=a[0],ys(c=a[1])?c:he(ka(c.value))];case ht.Sheet:return n(e,r);case ht.Ident:var i=n(e,xt(r.name,void 0)),o=i[0],u=i[1];if(!Se(u))return[r,u];if(u.value)return[Bt(o.sheet,r.isQuoted,r.label),u];var s=t(e,Pt(r.name)),l=s[0],c=s[1];return[Bt(l.document,r.isQuoted,r.label),ys(c)?c:he(ka(c.value))];default:return te("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,l))[0],s=o[1];var v,p=c;return ys(s)?v=s:ys(v=bs(e.getNameLoc(s.value,c.asWhole,i)))||(p=hr(v.value.name,c.canDenoteNamedObject,c.label)),fs(fr(p,u,a.label),v)}function u(t,r,n){void 0===n&&(n=!1);var a=e.getStructRefColumn(t,r.name);if(!Se(a))return{kind:Rt.ColumnRef,innerRef:r,resolution:a};var i=a.value;if(y(i))return{kind:Rt.ColumnRef,innerRef:r,resolution:ge(ls(as.UndefinedColumnName))};var o=i.range.range;return n&&(o=ha(o.row-(i.hasHeadersRow?1:0),o.col,o.rows+(i.hasHeadersRow?1:0)+(i.hasTotalsRow?1:0),o.cols)),{kind:Rt.ColumnRef,innerRef:Er(i.name,r.isBracketed,r.isClosed,r.label),resolution:he(ba(i.range.sheet,o))}}function s(t,r,n){if(n===At.ThisRow){if(!Se(t.originGridCell))return t.originGridCell;var a=s(t,r,At.Data);if(ys(a))return a;var i=a.value.range,o=t.originGridCell.value.row;return o<i.row||o>=i.row+i.rows?ge(ds):he(ba(a.value.sheet,ha(o,i.col,1,i.cols)))}return bs(e.getStructRefSpecialRef(r,n))}function l(e,t,r){switch(t.kind){case Rt.ColumnRef:return u(e,t,r);case Rt.MissingRef:return{kind:Rt.MissingRef,innerRef:t,resolution:me}}}function c(e,t,r){var n;void 0===r&&(r=!1);var a,i,o=l(e,t.lhs,r),u=o.innerRef,s=o.resolution,c=l(e,t.rhs,r),d=c.innerRef,f=c.resolution,h=Ar(u,d,t.label);if(!Se(s)&&s.reason.kind!==ns.InvalidStructRef)return{kind:Rt.RangeOpRef,innerRef:h,resolution:s};if(!Se(f)&&f.reason.kind!==ns.InvalidStructRef)return{kind:Rt.RangeOpRef,innerRef:h,resolution:f};if(!Se(s))return{kind:Rt.RangeOpRef,innerRef:h,resolution:s};if(!Se(f))return{kind:Rt.RangeOpRef,innerRef:h,resolution:f};if(void 0!==s.value)a=s.value.sheet,i=Wr(s.value.range,null===(n=f.value)||void 0===n?void 0:n.range);else{if(void 0===f.value)return{kind:Rt.RangeOpRef,innerRef:h,resolution:ge(ls(as.InvalidOp))};a=f.value.sheet,i=f.value.range}return{kind:Rt.RangeOpRef,innerRef:h,resolution:he(ba(a,i))}}function d(r,n){var a,i,o,u,s,l,c=n.qualifier,d=n.parts,f=null!==(o=null===(i=r.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo;if(void 0===c){var h=r.originSheet;if(!Se(h))return vs(n,h,d.asWhole);u=c,s=he(h.value.document)}else u=(a=function(e,r){switch(r.kind){case ht.Document:return t(e,r);case ht.Ident:var n=t(e,Pt(r.name)),a=n[0],i=n[1];return[Bt(a.document,r.isQuoted,r.label),i];default:return te("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,c))[0],s=a[1];var v=d.asWhole;if(ys(s))l=s;else{var p=function(e,t,r,n){var a=n;return a.length>"_xludf.".length&&0===t.stringCompareCI(a.substring(0,"_xludf.".length),"_xludf.")&&(a=a.substring("_xludf.".length)),[e.getUserDefinedFuncLoc(r,a),a]}(e,f,s.value,d.asWhole),m=p[0],g=p[1];v=g,Se(m)?0!==m.value.length?(l=m,v=g):(l=me,v=g):l=m}return vs(fr(hr(d.asWhole,d.canDenoteNamedObject,d.label),u,n.label),l,v)}return{resolveName:o,resolveGridRef:ks,resolveCellRef:i,resolveUserDefinedFunc:d,resolveDottedName:function(e,t,r){var n,a=t.qualifier,u=t.parts,s=[],l=r[t.label],c=(null==l?void 0:l.kind)===mt.AppHeadName;if(!a){var f=gr(u);if(f.kind===Et.IdentNamePart){var h=mr(u).parts.slice(1),v=function(e,t){var r=t[e.label];return(null==r?void 0:r.kind)===mt.LocalNameUse?ps(fr(hr(r.whole,e.canDenoteNamedObject,e.label),void 0,-1),he(r)):ps(fr(hr(e.asWhole,e.canDenoteNamedObject,e.label),void 0,-1),me)}(f,r);if(n=Ss(v,h.map((function(e){return e.rhs}))),!Se(v.resolution)||v.resolution.value)return n}}for(;;){if(u.canDenoteNamedObject){var p=fr(hr(u.asWhole,u.canDenoteNamedObject,u.label),a,-1),m=o(e,p,c?Zn.AppHead:Zn.Plain);if(n=Ss(m,Object(fe.f)(s).reverse()),!Se(m.resolution)||m.resolution.value)return n;if(c&&(void 0===a||a.kind===ht.Document||a.kind===ht.Ident)){var g=d(e,p);if(n=Ss(g,Object(fe.f)(s).reverse()),!Se(g.resolution)||g.resolution.value)return n}}if(u.kind===Et.CellRefNamePart&&(null==a&&e.allowUnqualifiedCell||null!=a&&a.kind!==ht.Document)){var S=i(e,Sr(u.ref,null!=a&&a.kind===ht.Ident?xt(a.name):a,u.label));return Ss(S,s.reverse())}if(u.kind!==Et.FieldRefNamePart)return void 0!==n?n:Ss(gs(fr(hr(u.asWhole,u.canDenoteNamedObject,u.label),a,-1)),Object(fe.f)(s).reverse());s.push(u.rhs),u=u.lhs,c=!1}},resolveStructRef:function(t,r){var n,a=r.lhs,i=r.rhs,l=a;if(void 0!==a){var d=o(t,a,Zn.StructRef),f=d.node;if(!Se(h=d.resolution))return ms(r,void 0,h);if(y(h.value))return ms(r,void 0,ge(ls(as.UndefinedTableName)));l=f,n=h.value}else{var h,v=t.originGridCell,p=t.originSheet;if(!Se(v))return ms(r,void 0,v);if(!Se(p))return ms(r,void 0,p);if(void 0===p.value.index)return ms(r,void 0,ge(ls(as.InvalidOriginSheet)));if(!Se(h=e.getContainingTable(ya(p.value,v.value))))return ms(r,void 0,h);if(y(h.value))return ms(r,void 0,ge(ls(as.MissingTableName)));n=h.value}var m=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case Rt.ColumnRef:var a=u(t,r.innerRef),i=a.innerRef,o=a.resolution;return{structRef:Fr(i,r.isClosed,r.label),resolution:o};case Rt.RangeOpRef:var l=c(t,r.innerRef);i=l.innerRef,o=l.resolution;return{structRef:Fr(i,r.isClosed,r.label),resolution:o};case void 0:o=s(e,t,At.Data);return{structRef:r,resolution:o};case Rt.SpecialRef:o=s(e,t,r.innerRef.id);return{structRef:r,resolution:o};case Rt.CommaOpRef:var d=function(e,t,r){for(var n,a,i=r.refs.map((function(r){return function(e,t,r){switch(r.kind){case Rt.ColumnRef:return u(t,r,!0);case Rt.SpecialRef:return{kind:Rt.SpecialRef,innerRef:r,resolution:s(e,t,r.id)};case Rt.RangeOpRef:return c(t,r,!0);case Rt.MissingRef:return{kind:Rt.MissingRef,innerRef:r,resolution:me};case Rt.BadRef:return{kind:Rt.BadRef,innerRef:r,resolution:ge(ls(as.InvalidOp))}}}(e,t,r)})),o=Rr(i.map((function(e){return e.innerRef})),r.label),l=0,d=i;l<d.length;l++){var f=d[l].resolution;if(!Se(f)&&f.reason.kind!==ns.InvalidStructRef)return{commaOpRef:o,resolution:f}}for(var h,v,p=[],m=0,g=i;m<g.length;m++){if(!Se((k=g[m]).resolution)||k.kind===Rt.BadRef)return{commaOpRef:o,resolution:k.resolution};p.push((k.kind===Rt.SpecialRef||(k.kind,Rt.MissingRef),{kind:k.kind,resolution:k.resolution}))}if(!Yn(r))return{commaOpRef:o,resolution:ge(ls(as.InvalidOp))};for(var S=0,b=p;S<b.length;S++){(k=b[S]).kind===Rt.SpecialRef&&(h=Wr(h,null===(n=k.resolution.value)||void 0===n?void 0:n.range),void 0===v&&(v=null===(a=k.resolution.value)||void 0===a?void 0:a.sheet))}if(void 0===h||void 0===v)return{commaOpRef:o,resolution:me};for(var y=0,C=p;y<C.length;y++){var k;if((k=C[y]).kind!==Rt.SpecialRef&&(k.kind!==Rt.MissingRef&&void 0===(h=zr(h,k.resolution.value.range))))return{commaOpRef:o,resolution:ge(ls(as.InvalidOp))}}return{commaOpRef:o,resolution:he(ba(v,h))}}(e,t,r.innerRef);i=d.commaOpRef,o=d.resolution;return{structRef:Fr(i,r.isClosed,r.label),resolution:o};case Rt.ThisRowOpRef:var f=s(e,t,At.ThisRow);if(ys(f)||void 0===r.innerRef.ref)return{structRef:r,resolution:f};var h=r.innerRef.ref.kind===Rt.ColumnRef?u(t,r.innerRef.ref):c(t,r.innerRef.ref),v=(i=h.innerRef,h.resolution),p=Nr(i,i.label);if(ys(v))return{structRef:Fr(p,r.isClosed,r.label),resolution:v};var m=zr(f.value.range,v.value.range);return m?{structRef:Fr(p,r.isClosed,r.label),resolution:he(ba(f.value.sheet,m))}:{structRef:r,resolution:ge(ls(as.InvalidOp))};case Rt.BadRef:return{structRef:r,resolution:ge(ls(as.InvalidOp))}}}(t,n,i),g=m.structRef,S=m.resolution;return ms(S.kind===le.Failure&&S.reason.kind!==ns.EmptyIntersection?r:Cr(l,g,r.label),n,S)}}}var As=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return he(oa(e,t))},e.prototype.getSheetIndex=function(e,t){return he(t)},e.prototype.getSheetName=function(e,t){return he(t)},e.prototype.getNameLoc=function(e,t){return he(t.indexOf(".")>=0?void 0:Aa(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return he([Ra(e,t)])},e.prototype.getSheetRangeIndexes=function(e){return he(da([e.index],0))},e.prototype.getContainingTable=function(e){return me},e.prototype.getStructRefColumn=function(e,t){return me},e.prototype.getStructRefSpecialRef=function(e,t){return me},e.prototype.getNamedRanges=function(e){return he([])},e}();function Rs(e){return new As(e)}function Ns(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:he(t.range),originSheet:he(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}function Ts(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:he(t.range),originSheet:he(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}var Is,Fs=/"/g,Os=ya(la(oa(void 0,"Book1"),0),va(0,0));function Ds(e){if(!Se(e)&&e.reason.kind!==ns.NoOriginSheet&&e.reason.kind!==ns.InvalidStructRef&&e.reason.kind!==ns.EmptyIntersection)throw new xs(e.reason)}function Ms(e){for(var t=[],r=[],n=0,a=e;n<a.length;n++){var i=a[n];i.length>0&&Fi(Ii(i,0))===i.length?t[Ii(i,0)]=!0:r.push(i)}return function(e,n){var a=Ii(e,n);if(!0===t[a])return!0;for(var i=0,o=r;i<o.length;i++){if(V(e,o[i],n))return!0}return!1}}function ws(e,t){for(var r="",n=0;n<e.length;){t(e,n)&&(r+="'");var a=Ii(e,n);r+=Ri(a),n+=Fi(a)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(Is||(Is={}));var _s={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,a,i){return i},lambdaNode:function(e,t,r,n,a,i){return i},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r,n){return n},structRefNode:function(e,t,r){return r},badSequenceNode:function(e,t,r){return r},badStringNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},Ls=Object(fe.a)(Object(fe.a)({},Je(void 0)),{operatorNode:function(e){return e}}),Ps=function(){function e(e,t,r,n){var a,i,o,u,s=this;this.root=r,this.anonymize=n,this.anon=function(e){return s.anonymize?G(e):e},this.locals=t,this.localeInfo=null!==(i=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==i?i:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(u=null===(o=t.config)||void 0===o?void 0:o.refStyle)&&void 0!==u?u:e.config.refStyle,this.resolver=Es(e),this.spans=r.spans,this.annotations=r.annotations;var l=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],c=Object(fe.f)(l,["\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"]);this.isStructRefEscapable=Ms(l),this.isStructRefBracketedThisRef=Ms(c),this.isFieldRefEscapable=Ms(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var e=new rt({str:this,label:_s,op:Ls});return"="+this.pre(this.root.node.label,"")+St(e,this.root).str},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t},e.prototype.printRef=function(e,t){var r="";switch(e.kind){case Rt.SpecialRef:(t===Is.Original&&e.isBracketed||t===Is.Bracketed)&&(r+=this.localeInfo.leftBracket);var n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new xs(Bn("No locale data for specialRefName"));r+=n,(t===Is.Original&&e.isBracketed&&e.isClosed||t===Is.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case Rt.ColumnRef:var a=0===e.name.length||V(e.name," ")||H(e.name," ");(t===Is.Original&&e.isBracketed||t===Is.Bracketed||t===Is.Unbracketed&&a)&&(r+=this.localeInfo.leftBracket);var i=ws(e.name,this.isStructRefEscapable);r+=this.anon(i),(t===Is.Original&&e.isBracketed&&e.isClosed||t===Is.Bracketed||t===Is.Unbracketed&&a)&&(r+=this.localeInfo.rightBracket);break;case Rt.RangeOpRef:r+=this.printRef(e.lhs,t===Is.Original?t:Is.Bracketed)+":"+this.printRef(e.rhs,t===Is.Original?t:Is.Bracketed);break;case Rt.MissingRef:break;case Rt.BadRef:e.isBracketed&&(r+=this.localeInfo.leftBracket),r+=e.contents,e.isBracketed&&e.isClosed&&(r+=this.localeInfo.rightBracket)}return r},e.prototype.printThisRowOpRef=function(e){var t="@";return e&&(e.kind===Rt.ColumnRef?t+=this.printRef(e,e.isClosed?function(e,t){for(var r=0;r<e.length;){if(t(e,r))return!0;r+=Fi(Ii(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?Is.Bracketed:Is.Unbracketed:Is.Original):t+=this.printRef(e,qn(e)&&Jn(e)?Is.Bracketed:Is.Original)),t},e.prototype.printApplication=function(e,t,r){var n=this,a=t.map((function(e,t){return n.pre(e.label,0===t||""===e.str?"":" ")+e.str}));return e.str+"("+a.join(this.localeInfo.listSeparator)+(0===t.length?"":this.post(t[t.length-1].label,""))+(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?He(this,r)+"!":"")+We(this,t)},e.prototype.printName=function(e){var t=e.whole,r=e.qualifier;return(void 0!==r?He(this,r)+"!":"")+this.anon(t)},e.prototype.printUnanonymisedDocQual=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e.prototype.literalNode=function(e,t,r){switch(e.kind){case Tt.String:return'"'+this.anon(e.value).replace(Fs,'""')+'"';case Tt.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case Tt.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21));case Tt.Missing:return"";case Tt.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new xs(Bn("No locale data for error oper"));return n;default:return te("calc.lang.printFormula",e)}},e.prototype.arrayNode=function(e,t,r){var n=this;return this.localeInfo.leftBrace+e.map((function(e){return e.map((function(e){return e.str})).join(n.localeInfo.columnSeparator)})).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var a=t[0];switch(e.op){case Qa.Percent:return a.str+this.pre(e.label,"")+e.str;case Qa.Pound:return a.str+e.str;default:return e.str+this.post(e.label,"")+a.str}}if(2===t.length){var i=t[0],o=t[1];return i.str+this.pre(e.label," ")+e.str+this.post(e.label,e.op===Qa.Isect?"":" ")+o.str}return re("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)},e.prototype.letNode=function(e,t,r,n,a,i){var o=this,u=t.map((function(e){var t=e.name,r=e.binder;return ar(nr({str:o.anon(Wn(o.localeInfo,t.arg.whole)),label:t.arg.label,op:void 0},t.index),r)}));return this.printApplication(e,rr(u,r,n),a)},e.prototype.lambdaNode=function(e,t,r,n,a,i){var o=this,u=t.map((function(e){var t=e.name;return ur(nr({str:o.anon(Wn(o.localeInfo,t.arg.whole)),label:t.arg.label,op:void 0},t.index))}));return this.printApplication(e,or(u,r,n),a)},e.prototype.parenNode=function(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,fr(e,t,r),this.annotations),a=n.resolved,i=n.fields;return Ds(a.resolution),a.kind===cs.ResolvedCellRef?Object(fe.f)([this.printCellRef(a.node)],i.map(this.anon)).join("."):a.kind===cs.ResolvedLocalName&&void 0!==a.resolution.value?Object(fe.f)([this.anon(a.resolution.value.name)],i.map(this.anon)).join("."):a.kind===cs.ResolvedUserDefinedFunc?Object(fe.f)([this.anon(a.name)],i.map(this.anon)).join("."):Object(fe.f)([this.printName(a.node)],i.map(this.anon)).join(".")},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,Sr(e,t,r)),a=n.node;return Ds(n.resolution),this.printCellRef(a)},e.prototype.fieldRefNode=function(e,t,r,n){var a=e.str,i=r,o=t.isBracketed||i?this.localeInfo.leftBracket:"",u=t.isBracketed&&t.isClosed||i?this.localeInfo.rightBracket:"",s=ws(t.field,this.isFieldRefEscapable);return a+="."+o+this.anon(s)+u+this.post(t.label,"")},e.prototype.structRefNode=function(e,t,r){var n,a=this,i=this.resolver.resolveStructRef(this.locals,Cr(e,t,r)),o=i.node,u=i.table;Ds(i.resolution);var s=o.rhs.innerRef,l=o.lhs;void 0!==l||void 0===u||!o.rhs.isClosed||(null==s?void 0:s.kind)===Rt.ColumnRef||(null==s?void 0:s.kind)===Rt.ThisRowOpRef&&(null===(n=s.ref)||void 0===n?void 0:n.kind)===Rt.ColumnRef||(l=fr(hr(u.name)));var c=void 0!==l?this.printName(l):"";if(void 0===s&&o.rhs.isClosed&&void 0!==l)return c;switch(c+=this.localeInfo.leftBracket,null==s?void 0:s.kind){case Rt.ColumnRef:case Rt.SpecialRef:if(s.kind===Rt.SpecialRef&&s.id===At.ThisRow&&s.isClosed){c+=this.printThisRowOpRef(void 0);break}c+=this.printRef(s,s.isClosed?Is.Unbracketed:Is.Original);break;case Rt.RangeOpRef:var d=(f=qn(s)&&Jn(s))?Is.Bracketed:Is.Original;c+=this.printRef(s,d);break;case Rt.CommaOpRef:var f;if((f=Yn(s)&&s.refs.every(Qn)&&function(e){return!e.refs.some(zn)}(s))&&s.specialRefs[At.ThisRow]){c+=this.printThisRowOpRef(0===s.columnRefs.length?void 0:s.columnRefs[0]);break}var h=f?function(e){for(var t={},r=[],n=0,a=e.refs;n<a.length;n++){var i=a[n];i.kind!==Rt.SpecialRef?r.push(i):void 0===t[i.id]&&(t[i.id]=!0,r.push(i))}return r.sort(ta),r}(s):s.refs,v=f?1===h.length?Is.Unbracketed:Is.Bracketed:Is.Original;c+=h.map((function(e){return a.printRef(e,v)})).join(this.localeInfo.listSeparator);break;case Rt.ThisRowOpRef:c+=this.printThisRowOpRef(s.ref);break;case Rt.BadRef:c+=this.printRef(s,Is.Original)}return o.rhs.isClosed&&(c+=this.localeInfo.rightBracket),c},e.prototype.badSequenceNode=function(e,t,r){var n=this;return t.map((function(e){return n.pre(e.label,"")+e.str+n.post(e.label,"")})).join("")},e.prototype.badStringNode=function(e,t,r){return this.anon(t)},e.prototype.operatorNode=function(e,t){var r=$u(this.localeInfo,e,"");if(void 0===r)throw new xs(Bn("Invalid operator"));return r},e.prototype.wsfNode=function(e,t,r){return this.localeInfo.getWorksheetFuncName(e)},e.prototype.cellRefError=function(){var e=this.localeInfo.errorNames[Na.REF];if(null==e)throw new xs(Bn("No locale data for #REF"));return e},e.prototype.cellRefSingle=function(e,t,r){var n=So(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefRange=function(e,t){var r=bo(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()},e.prototype.cellRefRow=function(e,t,r){var n=po(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefCol=function(e,t,r){var n=mo(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.errorQualifier=function(){var e=this.localeInfo.errorNames[Na.REF];if(null==e)throw new xs(Bn("No locale data for #REF"));return e.replace("!","")},e.prototype.relativeQualifier=function(){return""},e.prototype.documentQualifier=function(e,t,r){return No(this.anon(this.printUnanonymisedDocQual(Pt(e,t))))},e.prototype.sheetQualifier=function(e,t,r){return Ro(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(t)+e))},e.prototype.identQualifier=function(e,t){return Ro(this.localeInfo,this.refStyle,this.anon(e))},e.prototype.sheetRangeQualifier=function(e,t,r,n){var a=this.anon(this.printUnanonymisedDocQual(r)+e),i=this.anon(t),o=a+":"+i;return Ao(this.localeInfo,this.refStyle,a)||Ao(this.localeInfo,this.refStyle,i)?No(o):o},e}(),xs=Un("PrintFormulaError"),Bs=Un("PrintRangeError");function Us(e,t,r,n){void 0===n&&(n=!1);try{return he(new Ps(e,t,r,n).print())}catch(e){return ge(e instanceof xs?e.reason:be(e))}}function Gs(e,t,r){try{var n=r.kind===Xn.Cell||r.kind===Xn.Range?Ns(r,un(r.range)):r.kind===Xn.NameManager?Ts(r,Os):te("calc.lang.anonymizeFormula",r),a=Us(Rs(gu(os(),ft.A1,e.mathpack)),n,t,!0);if(a.kind===le.Success)return a.value;if(a.reason.kind===ve.JavaScriptError)throw a.reason.error}catch(e){var i="calc.lang.anonymizeFormula: Format failed: "+q(e);ee.ULS.traceTag(556863706,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,i)}return D(t)}function js(e,t){return Vt(Gt(pt.Rel,t.row-e.row),Gt(pt.Rel,t.col-e.col))}function Vs(e,t,r){var n,a=t.originSheet.value,i=function(e,t){var r=js(e,on(t));return Ur(t)?r:Ht(r,js(e,va(t.row+t.rows-1,t.col+t.cols-1)))}(t.originGridCell.value,r.range);if(void 0===a.index||!$r(a,r.sheet)){var o=e.getSheetName(r.sheet.document,r.sheet.index);if(!Se(o))throw new Bs(o.reason);n=xt(o.value)}return Sr(i,n)}function Hs(e){return Se(e)?(ne("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),he(e.value)):e.reason.kind===ns.InvalidStructRef?re("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):ge(e.reason)}function Ws(e,t,r,n){var a,i;void 0===n&&(n=_o);try{if(!Zr(t.originSheet.value.document,r.sheet.document))throw new Bs(Pn(["printRange cross-document"]));return he(null!==(i=null!==(a=function(e,t,r,n){var a=t.originSheet.value,i=e.getNamedRanges(r);if(!Se(i))throw new Bs(i.reason);if(0!==i.value.length){var o=function(e){return void 0!==e.index&&(void 0===a.index||!$r(e,a))},u=i.value.filter((function(e){var t=e.scope;return void 0===t.index?Zr(t.document,r.sheet.document):$r(t,r.sheet)})).filter((function(t){var r=t.scope,n=t.name;if(void 0!==r.index||void 0===a.index)return!0;var i=a,o=e.getNameLoc(i,n,Zn.Plain);if(!Se(o))throw new Bs(o.reason);return null==o.value})).filter((function(e){var t=e.scope,r=e.name;return o(t)||!n.contains(r)}));if(0!==u.length){var s,l=1===u.length?u[0]:Object(fe.f)(u).sort((function(t,r){return e.config.localeInfo.stringCompareCI(t.name,r.name)}))[0];if(o(l.scope)){var c=e.getSheetName(l.scope.document,l.scope.index);if(!Se(c))throw new Bs(c.reason);s=xt(c.value)}return fr(hr(l.name),s)}}}(e,t,r,n))&&void 0!==a?a:function(e,t,r){var n=r.sheet,a=r.range,i=e.getContainingTable(ya(n,on(a)));if(!Se(i))throw new Bs(i.reason);if(null!=i.value){var o=i.value,u=Hs(e.getStructRefSpecialRef(o,At.All));if(!Se(u))throw new Bs(u.reason);var s=u.value.range,l=u.value.sheet,c=Jr(s,a);if(!(void 0===c||c<0)){var d=Hs(e.getStructRefSpecialRef(o,At.Data));if(!Se(d))throw new Bs(d.reason);var f=d.value.range,h=t.originGridCell.value,v=t.originSheet.value,p=void 0!==v.index&&$r(v,l)&&Yr(s,h)?void 0:fr(hr(o.name)),m=null!=p?p:fr(hr(o.name)),g=f.cols>1&&a.col===f.col&&a.cols===f.cols,S=function(){var t=Hs(e.getStructRefColumn(o,a.col));if(!Se(t))throw new Bs(t.reason);if(1===a.cols)return Er(t.value.name);var r=Hs(e.getStructRefColumn(o,a.col+a.cols-1));if(!Se(r))throw new Bs(r.reason);return Ar(Er(t.value.name),Er(r.value.name))};if(a.row===s.row&&a.rows===s.rows)return Cr(m,Fr(g?kr(At.All):Rr([kr(At.All,!0),S()])));if(1===a.rows&&a.row===h.row&&a.row>=f.row&&a.row<f.row+f.rows)return Cr(1===a.cols?p:m,Fr(Nr(g?void 0:S())));if(a.row===f.row&&a.rows===f.rows)return g?Cr(m,Fr(void 0)):Cr(1===a.cols?p:m,Fr(S()));var b=a.row===s.row&&a.row+a.rows===f.row,y=a.row===f.row+f.rows&&a.row+a.rows===s.row+s.rows;if(b||y){var C=kr(b?At.Headers:At.Totals,!g);return Cr(m,Fr(g?C:Rr([C,S()])))}var k=a.row===s.row&&s.row<f.row&&a.row+a.rows===f.row+f.rows,E=a.row===f.row&&s.row+s.rows>f.row+f.rows&&a.row+a.rows===s.row+s.rows;if(k||E){var A=kr(k?At.Headers:At.Data,!0),R=kr(k?At.Data:At.Totals,!0);return Cr(m,Fr(Rr(g?[A,R]:[A,R,S()])))}}}}(e,t,r))&&void 0!==i?i:Vs(e,t,r))}catch(e){return ge(e instanceof Bs?e.reason:be(e))}}var Ks={getNamedRanges:function(){return re("calc.lang.prettyPrinter: default getNamedRanges")}};function zs(e){var t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:Ks.getNamedRanges}}(e);return{printFormula:function(t,r){return Us(e,t,r)},printRange:function(e,r,n){return Ws(t,e,r,n)}}}var Ys=function(e,t,r){return{sign:e,mantissa:t,exponent:r}};function qs(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}function Js(e){return{kind:Tt.Number,_valueIEEE:e}}var Qs=Js(0),Xs=Js(1),Zs=Js(Math.PI);function $s(e){return isFinite(e)?Js(e):Pa}function el(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function tl(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),a=!V(r,"-"),i=r.substring(a?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(48!==e.charCodeAt(t))return!1;return!0}(i)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:i,exponent:o}}var rl=["0","1","2","3","4","5","6","7","8","9"];function nl(e){var t=e._valueIEEE;return Js(t<0?Math.ceil(t):Math.floor(t))}function al(e){var t=e._valueIEEE;return Js(Math.floor(t))}function il(e){return e.substring(0,1)+"."+e.substring(1)}var ol,ul,sl={zero:Qs,one:Xs,pi:Zs,add:function(e,t){return $s(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return $s(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return $s(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,n=t._valueIEEE;return 0===n?Ma:$s(r/n)},power:function(e,t){var r=e._valueIEEE,n=t._valueIEEE,a=Math.pow(r,n);return isFinite(a)?Js(a):isNaN(a)?Ma:Pa},percent:function(e){return Js(e._valueIEEE/100)},neg:function(e){return Js(-e._valueIEEE)},compare:el,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=t._valueIEEE,i=String(a).replace("e","E");return"."!==n&&(i=i.replace(".",n)),i},formatFixed:function(e,t,r){var n,a=e._valueIEEE,i=tl(a),o=i.sign,u=i.mantissa,s=i.exponent,l=r+(s+t);if(0===l){var c=parseFloat("5e"+String(s-1));if(Math.abs(a)>=c)return Ys(o,"1",s+t+1)}if(l<1)return Ys(!0,"",0);l<=21&&(o=(n=tl(a,l-1)).sign,u=n.mantissa,l=r+((s=n.exponent)+t));var d=u.substring(0,l);return Ys(o,d,0===d.length?0:s+t)},formatScientific:function(e,t,r){var n,a=e._valueIEEE,i=tl(a),o=i.sign,u=i.mantissa,s=i.exponent,l=qs(s,t),c=l+r;if(ne("calc.lang.ieeeFormatScientific",c>0),0===c){var d=parseFloat("5e"+String(s-1));if(Math.abs(a)>=d)return Ys(o,"",s+1)}if(c<1)return Ys(!0,"",0);c<=21&&(o=(n=tl(a,c-1)).sign,u=n.mantissa,c=(l=qs(s=n.exponent,t))+r);var f=u.substring(0,c);return Ys(o,f,0===f.length?0:s)},parse:function(e,t,r,n){return Js(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0,i=Oi(t);a<i.length;a++){var o=i[a];n+=rl[r(o)]}return n}(e,n)+"E"+String(r)))},trunc:nl,ceil:function(e){var t=e._valueIEEE;return Js(Math.ceil(t))},floor:al,abs:function(e){return Js(Math.abs(e._valueIEEE))},cond:function(e){return el(e,Qs)},cond2:el,fromNumber:Js,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return $s(Math.sqrt(e._valueIEEE))},exp:function(e){return $s(Math.exp(e._valueIEEE))},ln:function(e){return $s(Math.log(e._valueIEEE))},log:function(e){return $s(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return Js(Math.sin(e._valueIEEE))},cos:function(e){return Js(Math.cos(e._valueIEEE))},tan:function(e){return Js(Math.tan(e._valueIEEE))},asin:function(e){return $s(Math.asin(e._valueIEEE))},acos:function(e){return $s(Math.acos(e._valueIEEE))},atan:function(e){return $s(Math.atan(e._valueIEEE))},atan2:function(e,t){return Js(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return Qs;var n=tl(r).exponent,a=nl(t)._valueIEEE+n;if(0===a){var i=parseFloat("5e"+String(n-1));if(Math.abs(r)>=i)return $s((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?Qs:a>21?e:$s(parseFloat(r.toExponential(a-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return Qs;var n=tl(r),a=n.sign,i=n.mantissa,o=n.exponent,u=nl(t)._valueIEEE+o;return u<1?$s(parseFloat((a?"":"-")+"10e"+String(o-1-u))):u>21?e:$s(parseFloat((a?"":"-")+function(e,t){if(e.length<=t)return il(e);for(var r=e.substring(0,t),n=0,a=r.length-1;a>=0&&r.charCodeAt(a)-48==9;a-=1)n+=1;return n===r.length?"10":il(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(i,u)+"e"+String(o-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return Qs;var n=tl(r),a=n.sign,i=n.mantissa,o=n.exponent,u=nl(t)._valueIEEE+o;if(u<1)return Qs;if(u>21)return e;var s=i.substring(0,u);return $s(parseFloat((a?"":"-")+il(s)+"e"+String(o-1)))},tenTo:function(e){return ae("calc.lang.ieeeTenTo",e),$s(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=nl(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=al(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:f};!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(ol||(ol={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(ul||(ul={}));var ll=ol.Red,cl=ol.Black,dl=ul.DoubleBlack,fl={c:cl,l:void 0,r:void 0},hl={c:dl,l:void 0,r:void 0};function vl(e){return void 0===e.l}function pl(e){return e.c===ll}function ml(e){return e.c===cl&&void 0!==e.l}function gl(e){return e.c===cl&&void 0===e.l}var Sl=fl;function bl(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function yl(e,t){return bl(e,t.l,t.key,t.value,t.r)}function Cl(e){return vl(e)?fl:yl(cl,e)}function kl(e,t,r){if(!vl(r)){var n=e.keyCompare(t,r.key);return n<0?kl(e,t,r.l):n>0?kl(e,t,r.r):r}}function El(e,t){return!!vl(t)||!!El(e,t.l)&&(!!e(t.key,t.value)&&El(e,t.r))}function Al(e,t,r,n,a){if(e===cl){if(pl(t)&&pl(t.l))return bl(ll,yl(cl,t.l),t.key,t.value,bl(cl,t.r,r,n,a));if(pl(a)&&pl(a.r))return bl(ll,bl(cl,t,r,n,a.l),a.key,a.value,yl(cl,a.r));if(pl(t)&&pl(t.r))return bl(ll,bl(cl,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,bl(cl,t.r.r,r,n,a));if(pl(a)&&pl(a.l))return bl(ll,bl(cl,t,r,n,a.l.l),a.l.key,a.l.value,bl(cl,a.l.r,a.key,a.value,a.r))}if(e===dl){if(pl(a)&&pl(a.l))return bl(cl,bl(cl,t,r,n,a.l.l),a.l.key,a.l.value,bl(cl,a.l.r,a.key,a.value,a.r));if(pl(t)&&pl(t.r))return bl(cl,bl(cl,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,bl(cl,t.r.r,r,n,a))}return bl(e,t,r,n,a)}function Rl(e,t,r,n,a){return e===ll&&t.c===dl&&ml(a)?Al(cl,bl(ll,Cl(t),r,n,a.l),a.key,a.value,a.r):e===ll&&ml(t)&&a.c===dl?Al(cl,t.l,t.key,t.value,bl(ll,t.r,r,n,Cl(a))):e===cl&&t.c===dl&&ml(a)?Al(dl,bl(ll,Cl(t),r,n,a.l),a.key,a.value,a.r):e===cl&&ml(t)&&a.c===dl?Al(dl,t.l,t.key,t.value,bl(ll,t.r,r,n,Cl(a))):e===cl&&t.c===dl&&pl(a)&&ml(a.l)?bl(cl,Al(cl,bl(ll,Cl(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===cl&&pl(t)&&ml(t.r)&&a.c===dl?bl(cl,t.l,t.key,t.value,Al(cl,t.r.l,t.r.key,t.r.value,bl(ll,t.r.r,r,n,Cl(a)))):(ne("calc.common.rbTree.rotate: expected R|B",t.c!==dl&&a.c!==dl),bl(e,t,r,n,a))}function Nl(e,t,r,n){return function(e){return!pl(e)||e.l.c!==ll&&e.r.c!==ll?e:yl(cl,e)}(function e(t,r,n,a){if(vl(a))return bl(ll,fl,r,n,fl);var i=t.keyCompare(r,a.key);return i<0?Al(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?Al(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):bl(a.c,a.l,r,n,a.r)}(e,t,r,n))}function Tl(e,t,r){if(vl(r))return r;if(r.c===ll&&gl(r.l)&&gl(r.r))return 0===e.keyCompare(t,r.key)?fl:r;if(r.c===cl&&gl(r.l)&&gl(r.r))return 0===e.keyCompare(t,r.key)?hl:r;if(r.c===cl&&pl(r.l)&&gl(r.l.l)&&gl(r.l.r)&&gl(r.r)){var n=e.keyCompare(t,r.key);return n<0?bl(cl,Tl(e,t,r.l),r.key,r.value,fl):n>0?r:bl(cl,fl,r.l.key,r.l.value,fl)}var a=e.keyCompare(t,r.key);if(a<0)return Rl(r.c,Tl(e,t,r.l),r.key,r.value,r.r);if(a>0)return Rl(r.c,r.l,r.key,r.value,Tl(e,t,r.r));ne("calc.common.rbTree.rem: expected node",!vl(r.r));var i=function e(t){if(t.c===ll&&gl(t.l)&&gl(t.r))return[t.key,t.value,fl];if(t.c===cl&&gl(t.l)&&gl(t.r))return[t.key,t.value,hl];if(t.c===cl&&gl(t.l)&&pl(t.r))return[t.key,t.value,yl(cl,t.r)];ne("calc.common.rbTree.remMin: expected node",!vl(t.l));var r=e(t.l),n=r[0],a=r[1],i=r[2];return[n,a,Rl(t.c,i,t.key,t.value,t.r)]}(r.r),o=i[0],u=i[1],s=i[2];return Rl(r.c,r.l,o,u,s)}function Il(e,t,r){var n=Tl(e,t,function(e){return ml(e)&&e.l.c===cl&&e.r.c===cl?yl(ll,e):e}(r));return ne("calc.common.rbTree.remove: expected R|B",n.c===ll||n.c===cl),n}var Fl,Ol,Dl,Ml,wl,_l,Ll,Pl,xl,Bl,Ul,Gl,jl,Vl,Hl,Wl,Kl,zl=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(Sl,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=kl(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return kl(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return El(e,this.root)},e.prototype.setValue=function(t,r){return new e(Nl(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(Il(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var a=r();return[new e(Nl(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,n=Sl,a=0;return this.forEach((function(e,i){return t(e,i)&&(n=Nl(r,e,i,n),a+=1),!1})),new e(n,a,this.keyCompare)},e}(),Yl=function(e){function t(t,r,n){var a=e.call(this,Qe)||this;return a.localeInfo=t,a.annotations=r,a.names=n,a}return Object(fe.c)(t,e),t.prototype.appNode=function(t,r,n,a){var i=this;return Oe.try((function(){return t.kind===kt.Name&&(i.annotations[t.label]=Mt),e.prototype.appNode.call(i,t,r,n,a)}))},t.prototype.letNode=function(e,r,n,a){var i=this,o=e.id===Ka.LETREC||e.id!==Ka.LET&&re("calc.lang.buildAnnotations"),u=[this.names];r.reduce((function(e,t){var r=t.name,n=e.setValue(Wn(i.localeInfo,r.arg.whole),r.arg);return u.push(n),i.annotations[r.arg.label]=Jt(),n}),this.names);var s=new t(this.localeInfo,this.annotations,u[r.length]);return this.lazyVisitAppHeadNode(e).bind((function(e){return o?Oe.all(r.map((function(e){var t=e.binder;return Oe.try((function(){return Ue(s,t.arg)}))}))):Oe.all(r.map((function(e,r){var n=e.binder,a=new t(i.localeInfo,i.annotations,u[r]);return Oe.try((function(){return Ue(a,n.arg)}))})))})).bind((function(e){return void 0===n?void 0:Ue(s,n.arg)})).bind((function(e){return Oe.all(a.map((function(e){return Oe.try((function(){return Ue(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.lambdaNode=function(e,r,n,a){var i=this,o=r.reduce((function(e,t){var r=t.name,n=e.setValue(Wn(i.localeInfo,r.arg.whole),r.arg);return i.annotations[r.arg.label]=Jt(),n}),this.names),u=new t(this.localeInfo,this.annotations,o);return this.lazyVisitAppHeadNode(e).bind((function(e){return void 0===n?void 0:Ue(u,n.arg)})).bind((function(e){return Oe.all(a.map((function(e){return Oe.try((function(){return Ue(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.nameNode=function(t,r,n){var a=this;return Oe.try((function(){if(void 0===r){var i=gr(t),o=a.names.getEntry(Wn(a.localeInfo,i.asWhole));if(void 0!==o)a.annotations[i.label]=qt(o.key,o.value.whole,o.value.label),a.annotations[o.value.label].uses.push({label:i.label})}return e.prototype.nameNode.call(a,t,r,n)}))},t}(dt);function ql(e,t){var r=[];return bt(new Yl(e,r,zl.create(e.stringCompareCI)),t),r[t.label]=wt,r}function Jl(e){return{config:e}}function Ql(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:he(t)}}(Ol=Fl||(Fl={})).LexicalKind=Xn,Ol.NameSource=Zn,Ol.sheetRows=1<<20,Ol.sheetCols=16384,Ol.lexicalSourceCell=ra,Ol.lexicalSourceRange=na,Ol.lexicalSourceGrid=aa,Ol.lexicalSourceName=ia,Ol.documentLoc=oa,Ol.structRefColumnLoc=ua,Ol.sheetIndex=la,Ol.sheetRange=sa,Ol.gridCell=va,Ol.gridRange=ha,Ol.allSheetsRange=ca,Ol.sheetRangeIndexes=da,Ol.sheetGridCell=ya,Ol.sheetGridRange=ba,Ol.sheetGridCube=Sa,Ol.originCell=Ca,Ol.documentScope=ka,Ol.nameLoc=Aa,Ol.nameScope=Ea,Ol.userDefinedFuncLoc=Ra,(Ml=Dl||(Dl={})).SpecialPrecs=Ft,Ml.PrecsBound=ga,Ml.OperKind=Tt,Ml.trueOper=qa,Ml.falseOper=Ja,Ml.ErrorType=Na,Ml.precedents=Ta,Ml.stringOper=Fa,Ml.booleanOper=Ia,Ml.errorOper=Oa,Ml.nullErrorOper=Da,Ml.div0ErrorOper=Ma,Ml.valueErrorOper=wa,Ml.refErrorOper=_a,Ml.nameErrorOper=La,Ml.numErrorOper=Pa,Ml.naErrorOper=xa,Ml.gettingDataErrorOper=Ba,Ml.fieldErrorOper=Ua,Ml.arrayOper=Va,Ml.rangeSeqOper=Ha,Ml.range3DOper=Wa,Ml.missingOper=za,Ml.blankOper=Ya,(_l=wl||(wl={})).RefStyle=ft,_l.QualifierKind=ht,_l.CellRefKind=vt,_l.PosKind=pt,_l.NodeKind=kt,_l.NamePartKind=Et,_l.SpecialRefId=At,_l.StructRefKind=Rt,_l.BadType=Nt,_l.errorQualifier=_t,_l.relativeQualifier=Lt,_l.documentQualifier=Pt,_l.sheetQualifier=xt,_l.identQualifier=Bt,_l.sheetRangeQualifier=Ut,_l.pos=Gt,_l.cellRefError=jt,_l.cellRefSingle=Vt,_l.cellRefRange=Ht,_l.cellRefRow=Wt,_l.cellRefCol=Kt,_l.formula=zt,_l.formulaSpan=Yt,_l.literalNode=Qt,_l.arrayNode=Xt,_l.appNode=Zt,_l.indexedArg=nr,_l.flattenLetArgs=rr,_l.letVar=ar,_l.letNode=ir,_l.flattenLambdaArgs=or,_l.lambdaParam=ur,_l.lambdaNode=sr,_l.operatorNode=lr,_l.wsfNode=cr,_l.parenNode=dr,_l.nameNode=fr,_l.identNamePart=hr,_l.cellRefNamePart=vr,_l.fieldRefNamePart=pr,_l.cellRefNode=Sr,_l.fieldRefNode=br,_l.fieldRef=yr,_l.structRefNode=Cr,_l.structRef=Fr,_l.specialRef=kr,_l.columnRef=Er,_l.rangeOpRef=Ar,_l.commaOpRef=Rr,_l.thisRowOpRef=Nr,_l.missingRef=Tr,_l.badRef=Ir,_l.badNode=Or,_l.AnnotationKind=mt,_l.appHeadNameAnnotation=Mt,_l.formulaRootAnnotation=wt,_l.localNameUseAnnotation=qt,_l.localNameDeclAnnotation=Jt,(Pl=Ll||(Ll={})).SignatureType=It,Pl.FunctionFlags=Ot,Pl.OperatorId=Qa,Pl.WorksheetFuncId=Ka,Pl.SpecialPrecs=Ft,Pl.functionType=Dr,Pl.unknownFunctionType=ei,Pl.getOperatorType=hi,Pl.getWorksheetFuncType=vi,(Bl=xl||(xl={})).isSheetIndex=xr,Bl.isSheetGridRange=Gr,Bl.isGridCell=Ur,Bl.isSheetGridCell=jr,Bl.forEachCellInRange=Vr,Bl.gridRangeJoin=Hr,Bl.gridRangeJoinOpt=Wr,Bl.gridRangesJoin=Kr,Bl.gridRangeIsect=zr,Bl.gridRangeIsects=Yr,Bl.gridCellImplicitIsect=qr,Bl.gridRangeCompare=Jr,Bl.gridRangeExcept=Qr,Bl.gridRangeSize=Xr,Bl.isDocumentLocEqual=Zr,Bl.isSheetIndexEqual=$r,Bl.isNameScopeEqual=en,Bl.isGridCellEqual=tn,Bl.isGridRangeEqual=rn,Bl.isSheetGridCellEqual=nn,Bl.isSheetGridRangeEqual=an,Bl.isWellFormed=Br,Bl.isUnqualifiedNameNode=vn,Bl.isOperatorNode=fn,Bl.isWSFNode=hn,Bl.gridRangeAnchor=on,Bl.sheetGridRangeAnchor=un,Bl.gridCellRange=sn,Bl.getArguments=dn,Bl.getArgType=gn,Bl.isValidArgsLength=Sn,Bl.isNumberOper=yn,Bl.isStringOper=Cn,Bl.isBooleanOper=kn,Bl.isErrorOper=En,Bl.isRangeOper=An,Bl.isArrayOper=Rn,Bl.isMissingOper=Nn,Bl.isBlankOper=Tn,Bl.isRichOper=In,Bl.isPrimitiveOper=On,Bl.isWriteOper=wn,Bl.isReadOperEqual=_n,Bl.ResultKind=le,Bl.success=he,Bl.failure=ge,Bl.successUndefined=me,Bl.isSuccess=Se,Bl.ReasonKind=Ln,Bl.notImplemented=Pn,Bl.unavailable=xn,Bl.internal=Bn,Bl.javaScriptError=be,Bl.createFailureErrorClass=Un,Bl.columnName=ao,Bl.formatRow=lo,Bl.formatCol=co,Bl.formatRowRange=po,Bl.formatColRange=mo,Bl.formatCellPos=So,Bl.formatGridRangeA1=To,Bl.parseGridCellA1=eo,Bl.parseGridRangeA1=to,Bl.getSubExpressionFromPosition=ln,Bl.resolveLocalsGrid=us,Bl.ResolveReasonKind=ns,Bl.noOriginSheet=ss,Bl.invalidStructRef=ls,Bl.InvalidStructRefReason=as,Bl.emptyIntersection=ds,Bl.ResolvedKind=cs,Bl.resolvedName=fs,Bl.resolvedCellRef=hs,Bl.resolvedUserDefinedFunc=vs,Bl.resolvedLocalName=ps,Bl.resolvedStructRef=ms,Bl.resolvedNever=gs,Bl.resolvedDottedName=Ss,Bl.createResolver=Es,Bl.visitFormulaNode=Ue,Bl.visitOperatorNode=Ge,Bl.visitWSFNode=je,Bl.visitAppHeadNode=Ve,Bl.visitQualifier=He,Bl.visitCellRef=We,Bl.IdentityVisitor=ze,Bl.identityVisitor=Ye,Bl.ConstVisitor=qe,Bl.constVisitor=Je,Bl.voidVisitor=Qe,Bl.DelegatingVisitor=Xe,Bl.BinaryVisitor=Ze,Bl.binaryVisitor=$e,Bl.ComposeVisitor=et,Bl.composeVisitor=tt,Bl.reduceBottomUp=St,Bl.reducePledge=yt,Bl.buildAnnotations=ql,Bl.createSimplePrintGlobals=Rs,Bl.printLocalsGrid=Ns,Bl.printLocalsName=Ts,Bl.createPrinter=zs,(Gl=Ul||(Ul={})).LogCategory=I.LogCategory,Gl.TraceLevel=I.TraceLevel,Gl.NulLogger=I.NulLogger,Gl.ulsLogger=ee,Gl.localeInfo=_u,Gl.localeInfo2=Lu,Gl.LCID=bu,Gl.Country=Su,Gl.PictureSpecial=yu,Gl.PictureSingle=Cu,Gl.PictureColor=ku,Gl.PictureDbnum=Eu,Gl.calcConfig=gu,Gl.initCalc=Tu,Gl.getEnglishLocaleInfo=os,Gl.englishWorksheetFuncIdToName=Qu,Gl.englishErrorTypeToName=Xu,Gl.englishOperatorIdToName=Zu,Gl.operatorIdToName=$u,Gl.createWorksheetFuncNameCallbacks=rs,Gl.isCalcInit=Fu,Gl.getCalcAbsUrl=Ou,Gl.FeatureName=De,(Vl=jl||(jl={})).numberComponents=Ys,Vl.ieeeMathpack=sl,Vl.xlMathpack=mu,Vl.formatScientificLeft=qs,(Wl=Hl||(Hl={})).TimeDivision=zo,Wl.Rounding=Wo,Wl.tzData=Vo,Wl.tzUTC=Ho,Wl.dateTime=Ko,Wl.TimeGranularity=Go,Wl.xlDatepack=Yo,function(e){e.NotFormulaString="NotFormulaString"}(Kl||(Kl={}));var Xl=Object(fe.a)(Object(fe.a)({},Ln),Kl),Zl=Ns,$l=Ts;function ec(e){return{kind:Xl.NotFormulaString,message:e}}var tc,rc,nc,ac;function ic(e){return e.kind===ac.BadNumber||e.kind===Tt.Number}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape"}(tc||(tc={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(rc||(rc={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot"}(nc||(nc={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(ac||(ac={}));var oc={kind:ac.BadNumber};var uc={kind:ac.BadError};function sc(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}var lc=function(e){return sc(tc.End,e,"",!1)},cc=function(e,t){return sc(tc.Spaces,e,t,!1)},dc=function(e,t){return sc(tc.Unexpected,e,t,!1)},fc=function(e,t){return sc(tc.Escape,e,t,!1)},hc=function(e,t){return sc(tc.Ident,e,t,!0)};function vc(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}var pc=function(e,t){return vc(tc.Left,e,t,rc.Bracket)},mc=function(e,t){return vc(tc.Left,e,t,rc.Brace)},gc=function(e){return vc(tc.Right,e,")",rc.Paren)},Sc=function(e,t){return vc(tc.Right,e,t,rc.Bracket)},bc=function(e,t){return vc(tc.Right,e,t,rc.Brace)},yc=function(e){return vc(tc.Right,e,"'",rc.SQuote)},Cc=function(e,t){return vc(tc.Sep,e,t,nc.List)},kc=function(e,t){return vc(tc.Sep,e,t,nc.Col)},Ec=function(e,t){return vc(tc.Sep,e,t,nc.Row)},Ac=function(e){return vc(tc.Sep,e,"!",nc.Qual)};function Rc(e,t,r,n,a,i,o){return{kind:tc.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:a,refStyle:i,isBadLocale:o}}function Nc(e,t,r,n){void 0===n&&(n=!0);var a=r.kind===Tt.Boolean||ic(r)&&function(e){for(var t=0,r=Oi(e);t<r.length;t++){var n=r[t];if(43===n||45===n||42===n||32===n||47===n)return!1}return!0}(t);return{kind:tc.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:n}}function Tc(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?Nc(t,r,Ja):0===e.stringCompareCI(e.trueName,r)?Nc(t,r,qa):hc(t,r)}function Ic(e,t,r){return{kind:tc.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function Fc(e){var t=ti[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return Ic(r,t,e)}}var Oc=Fc(Qa.Add),Dc=Fc(Qa.Sub),Mc=Fc(Qa.Mul),wc=Fc(Qa.Div),_c=Fc(Qa.Pow),Lc=Fc(Qa.Percent),Pc=Fc(Qa.Concat),xc=Fc(Qa.Eq),Bc=Fc(Qa.Lt),Uc=Fc(Qa.Gt),Gc=Fc(Qa.Ne),jc=Fc(Qa.Le),Vc=Fc(Qa.Ge),Hc=Fc(Qa.Range),Wc=Fc(Qa.At),Kc=Fc(Qa.Pound);function zc(e,t,r){return r.push(t),t.start+e}function Yc(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return ee.ULS.assertTag(595980821,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function qc(e,t,r){for(var n=t;n<e.length&&r(e,n);)n+=Fi(Ii(e,n));return[e.substring(t,n),n]}function Jc(e,t,r,n,a){return r(e,t)?1:V(e,n,t)&&t+n.length<e.length&&a(e,t+n.length)?2:0}function Qc(e,t,r,n,a){for(var i=[],o=t,u=t;u<e.length;){var s=Jc(e,u,r,n,a);if(0===s)break;2===s&&(o!==u&&i.push(e.substring(o,u)),o=u+n.length,u+=n.length),u+=Fi(Ii(e,u))}return o!==u&&i.push(e.substring(o,u)),[i.join(""),u]}var Xc;function Zc(e){if(!Xc){Xc=h();for(var t=0,r=Object.getOwnPropertyNames($c);t<r.length;t++){var n=r[t];Xc[n.charCodeAt(0)]=!0}for(var a=0,i=Object.getOwnPropertyNames(ed);a<i.length;a++){var o=i[a];Xc[o.charCodeAt(0)]=!0}}return!0===Xc[e]}var $c={"+":Oc,"-":Dc,"*":Mc,"/":wc,"^":_c,"%":Lc,"&":Pc,"=":xc,"<":Bc,">":Uc,":":Hc,".":function(e){return vc(tc.Sep,e,".",nc.Dot)},"@":Wc,"#":Kc},ed={"<>":Gc,"<=":jc,">=":Vc};function td(e,t,r){if(t<e.length-1){var n=ed[e.substring(t,t+2)];if(null!=n)return zc(2,n(t),r)}var a=$c[e.charAt(t)];if(null!=a)return zc(1,a(t),r);return ee.ULS.assertTag(595980822,I.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function rd(e,t,r,n,a){var i=_i(e,t,r,n,!1,!1,!1);if(void 0!==i){var o=i.value,u=i.i;return zc(u-n,Nc(n,r.substring(n,u),null!=o?o:oc,!0),a),u}}var nd=function(e,t){return 34!==e.charCodeAt(t)},ad=function(e,t){return 34===e.charCodeAt(t)};function id(e,t,r){var n=Qc(e,t+1,nd,'"',ad),a=n[0],i=n[1],o=e.substring(t,i+1);return i<e.length?zc(i+1-t,Nc(t,o,Fa(a),!0),r):zc(i-t,Nc(t,o,Fa(a),!1),r)}function od(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var i=e.errorNames[a];if(null!=i){var o=t.substring(r,r+i.length);if(0===e.stringCompareCI(i,o))return zc(i.length,Nc(r,o,Oa(a)),n)}}for(var u=r+1,s=!1;u<t.length;){var l=Ii(t,u);if(u!==r+1||161!==l&&191!==l)if(u>r+1&&47===l&&!s)s=!0,u+=1;else{if(u>r+1&&48===l){(u+=1)<t.length&&33===t.charCodeAt(u)&&(u+=1);break}if(33===l||63===l){u!==r+1&&(u+=1);break}if(!e.isIdentStart(l)&&46!==l)break;u+=Fi(l)}else u+=1}if(u>r+1)return zc(u-r,Nc(r,o=t.substring(r,u),uc),n)}function ud(e,t,r,n){for(var a=1;a<e.specialRefNames.length;a+=1){var i=e.specialRefNames[a];if(null!=i){var o=t.substring(r,r+i.length);if(0===e.stringCompareCI(i,o))return zc(i.length,(u=r,s=o,l=a,vc(tc.SpecialRef,u,s,l)),n)}}var u,s,l}function sd(e,t,r){var n=t.charCodeAt(r);return!(Di(n)||39===n||35===n||58===n||64===n||V(t,e.listSeparator,r)||V(t,e.leftBracket,r)||V(t,e.rightBracket,r))}var ld=function(e,t){return Di(Ii(e,t))};function cd(e,t,r,n){for(var a=r,i=0,o=function(t,r){return sd(e,t,r)},u=function(t,r){return!sd(e,t,r)},s=Yc("calc.parse.tokenizeBracketedRef",a);a<t.length;){s(a);var l=Ii(t,a);if(n.length>0&&n[n.length-1].kind===tc.Escape&&u(t,a))a=zc(Fi(l),hc(a,Ri(l)),n);else if(64!==l){if(35===l)if(null!=(f=ud(e,t,a,n))){a=f;continue}if(39!==l)if(V(t,e.rightBracket,a)){if(a=zc(e.rightBracket.length,Sc(a,e.rightBracket),n),0===(i-=1))return a}else if(o(t,a)){var c=qc(t,a,o),d=c[0];a=zc((f=c[1])-a,hc(a,d),n)}else if(Di(l)){var f,h=qc(t,a,ld);d=h[0];a=zc((f=h[1])-a,cc(a,d),n)}else 58!==l?V(t,e.listSeparator,a)?a=zc(e.listSeparator.length,Cc(a,e.listSeparator),n):V(t,e.leftBracket,a)&&i<2?(a=zc(e.leftBracket.length,pc(a,e.leftBracket),n),i+=1):a=zc(Fi(l),dc(a,Ri(l)),n):a=zc(1,Hc(a),n);else a=zc(1,fc(a,"'"),n)}else a=zc(1,Wc(a),n)}return a}function dd(e,t,r,n){for(var a,i=zc(1,(a=r,vc(tc.Left,a,"'",rc.SQuote)),n),o=function(t,r){return function(e,t,r){var n=t.charCodeAt(r);return 39!==n&&58!==n&&42!==n&&63!==n&&!V(t,e.leftBracket,r)&&!V(t,e.rightBracket,r)}(e,t,r)},u=function(e,t){return 39===e.charCodeAt(t)},s=Yc("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){s(i);var l=Ii(t,i);if(39===l&&!(i+1<t.length&&39===t.charCodeAt(i+1)))return zc(1,yc(i),n);if(58!==l)if(V(t,e.leftBracket,i))i=zc(e.leftBracket.length,pc(i,e.leftBracket),n);else if(V(t,e.rightBracket,i))i=zc(e.rightBracket.length,Sc(i,e.rightBracket),n);else if(Jc(t,i,o,"'",u)>0){var c=Qc(t,i,o,"'",u),d=c[0];i=zc(c[1]-i,hc(i,d),n)}else i=zc(Fi(l),dc(i,Ri(l)),n);else i=zc(1,Hc(i),n)}return i}function fd(e,t,r,n,a,i){var o,u,s,l,c=$i(e,t,r,n,a);if(null!=c){var d=c.i,f=n.substring(d,a);return zc(d-a,c.refStyle===ft.A1?(o=a,u=f,s=c.row,l=c.col,Rc(o,u,!(null!=s&&s.kind!==pt.Rel||null!=l&&l.kind!==pt.Rel),s,l,ft.A1,!1)):function(e,t,r,n,a){return void 0===a&&(a=!1),Rc(e,t,!(!1!==r&&null!=r&&r.kind!==pt.Abs||!1!==n&&null!=n&&n.kind!==pt.Abs),r,n,ft.R1C1,a)}(a,f,c.row,c.col,c.enLocale),i)}}function hd(e,t,r,n){var a=n[n.length-1];return null==a||(a.kind!==tc.Sep||a.value!==nc.Dot)&&(V(t,e.decimalSeparator,r)?a.kind===tc.Spaces&&null==(a=n[n.length-2])||a.kind!==tc.Ident&&a.kind!==tc.CellRef&&a.kind!==tc.Right&&(a.kind!==tc.Literal||ic(a.oper)):e.isNumeral(Ii(t,r)))}function vd(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function pd(e,t,r,n,a,i){for(var o=function(e,t,r,n,a,i){for(var o,u=[],s=[],l=i,c=Yc("calc.parse.tokenize",l);l<a.length;){c(l);var d=fd(e,r,n,a,l,u);if(null==d){var f=Ii(a,l);if(hd(e,a,l,u)){var h=rd(e,t,a,l,u);if(null!=h){l=h;continue}}if(34!==f)if(e.isIdentContinue(f)){var v=qc(a,l,(function(t,r){return e.isIdentContinue(Ii(t,r))})),p=v[0];l=zc(v[1]-l,Tc(e,l,p),u)}else if(35!==f)if(Zc(f))l=td(a,l,u);else if(Di(f)){var m=qc(a,l,ld);p=m[0];l=zc(m[1]-l,cc(l,p),u)}else if(40!==f)if(41!==f)if(V(a,e.leftBrace,l))s.push(rc.Brace),l=zc(e.leftBrace.length,mc(l,e.leftBrace),u);else if(V(a,e.rightBrace,l))s.length>0&&s[s.length-1]===rc.Brace&&s.pop(),l=zc(e.rightBrace.length,bc(l,e.rightBrace),u);else if(V(a,e.leftBracket,l))l=cd(e,a,l,u);else if(V(a,e.rightBracket,l))l=zc(e.rightBracket.length,Sc(l,e.rightBracket),u);else{if(s.length>0&&s[s.length-1]===rc.Brace){if(V(a,e.columnSeparator,l)){l=zc(e.columnSeparator.length,kc(l,e.columnSeparator),u);continue}if(V(a,e.rowSeparator,l)){l=zc(e.rowSeparator.length,Ec(l,e.rowSeparator),u);continue}}l=V(a,e.listSeparator,l)?zc(e.listSeparator.length,Cc(l,e.listSeparator),u):33!==f?39!==f?zc(Fi(f),dc(l,Ri(f)),u):dd(e,a,l,u):zc(1,Ac(l),u)}else s.length>0&&s[s.length-1]===rc.Paren&&s.pop(),l=zc(1,gc(l),u);else s.push(rc.Paren),l=zc(1,(o=l,vc(tc.Left,o,"(",rc.Paren)),u);else{var g=od(e,a,l,u);if(null!=g){l=g;continue}l=td(a,l,u)}else l=id(a,l,u)}else l=d}return u}(e,t,r,n,a,i),u=[],s=0;s<o.length;){var l=o[s];if(l.kind!==tc.Unexpected)u.push(l),s+=1;else{var c=vd(o,s,tc.Unexpected,(function(e,t){var r=e,n=t;return dc(r.start,r.chars+n.chars)})),d=c[0],f=c[1];u.push(d),s=f}}return u.push(lc(a.length)),u}function md(e,t,r,n){var a;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){a=he({output:e,index:t})}),(function(){a=ge(void 0)}))),null==a){var i="calc.parse.runParser: internal error: parser did not call resolve or reject on "+D(t);return ee.ULS.assertTag(595980827,I.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function gd(e){var t;return function(r,n,a,i,o){var u=null!=t?t:t=e();return function(){return u(r,n,a,i,o)}}}function Sd(e){return function(t,r,n,a,i){return a(e,r)}}var bd,yd=function(e,t,r,n,a){return a};function Cd(){return yd}function kd(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function Ed(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function Ad(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function Rd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?Cd():e.reduce(Ad)}function Nd(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function Td(e){return function(t,r,n,a,i){return e(t,r,n,(function(){return a(!0,r)}),i)}}function Id(e){return function(t,r,n,a,i){return e(t,r,n,i,(function(){return a(!0,r)}))}}function Fd(e,t){return function(r,n,a,i,o){var u=r[n];if(null==u)return o;var s=e(a,u);return null==s?o:i(s,n+t)}}function Od(e){return Fd(e,1)}function Dd(e){return Fd(e,0)}function Md(e){return function(t,r,n,a,i){var o=t[r],u=t[r+1];if(null==o||null==u)return i;var s=e(n,o,u);return null==s?i:a(s,r+1)}}function wd(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){var n=t(a,e);return null==n?o:i(n,r)}),o)}}function _d(e,t){return r=e,n=function(e,t,r){return r.push(t),r},a=t,function(e,t,i,o,u){var s=a,l=t;function c(){return r(e,l,i,d,f)}function d(t,r){if(r<=l){var a=D(e),o="calc.parse.reduce: internal error: no progress made at index "+l+" on "+a;return ee.ULS.assertTag(595980829,I.LogCategory.msoulscat_ES_EWAJS,!1,o)}return s=n(i,t,s),l=r,c}function f(){return o(s,l)}return c};var r,n,a}function Ld(e){return function(t,r,n,a,i){return _d(e,[])(t,r,n,a,i)}}function Pd(e,t){return void 0===t&&(t=e),kd(e,(function(e,r){return _d(t,[r])}))}function xd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return Sd([]);if(1===e.length)return Ed(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,a,i,o){var u=n,s=[];function l(){return e[s.length](t,u,a,c,o)}function c(e,t){return u=t,s.push(e),s.length<r?l:i(s,u)}return l}}function Bd(e,t){return Ed(xd(e,t),(function(e,t){return t[0]}))}function Ud(e,t){return Ed(xd(e,t),(function(e,t){return t[1]}))}function Gd(e){return Ed(e,(function(e,t){return S([],t)}))}function jd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Gd(xd.apply(void 0,e))}function Vd(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+D(t);return ee.ULS.assertTag(595980824,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function Hd(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=Yt(t,r,n,a),i}function Wd(e,t,r){return function(n,a,i,o,u){var s=e(i);return r(n,a,i,(function(e,r){return t(i,s),o(e,r)}),(function(){return t(i,s),u}))}}function Kd(e,t){return Wd((function(t){var r=t.delim;return t.delim=e,r}),(function(e,t){return e.delim=t}),t)}function zd(e){return Wd((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}function Yd(e){return e.kind===tc.Sep&&e.value===nc.Dot}function qd(e){return e.kind===tc.Operator&&e.value===Qa.Range}function Jd(e){return e.kind===tc.Literal&&e.oper.kind===Tt.Error&&e.oper.type===Na.REF}function Qd(e){return e.kind===tc.Left&&e.value===rc.Bracket}function Xd(e){return(e.kind===tc.Left||e.kind===tc.Right)&&e.value===rc.Bracket}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(bd||(bd={}));var Zd=Nd(Od((function(e,t){return t.kind===tc.Spaces?t.chars:void 0})),""),$d=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+D(e);return ee.ULS.assertTag(589825166,I.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(i.start,t)};function ef(e){return Od((function(t,r){return r.kind===tc.Sep&&r.value===e?r:void 0}))}function tf(e){return Od((function(t,r){return r.kind===tc.Left&&r.value===e?r:void 0}))}function rf(e){return Od((function(t,r){return r.kind===tc.Right&&r.value===e?r:void 0}))}var nf,af,of=ef(nc.List),uf=ef(nc.Row),sf=ef(nc.Col),lf=ef(nc.Qual),cf=ef(nc.Dot),df=tf(rc.Paren),ff=rf(rc.Paren),hf=tf(rc.Brace),vf=rf(rc.Brace),pf=tf(rc.SQuote),mf=rf(rc.SQuote),gf=tf(rc.Bracket),Sf=rf(rc.Bracket),bf=Md((function(e,t,r){return Yd(t)&&!Qd(r)?t:void 0})),yf=Od((function(e,t){return qd(t)?t:void 0})),Cf=Od((function(e,t){return function(e){return e.kind===tc.Operator&&e.value===Qa.At}(t)?t:void 0})),kf=Od((function(e,t){return t.kind===tc.Escape?t:void 0})),Ef=Od((function(e,t){return t.kind===tc.End?t:void 0})),Af=Ed(Pd(Od((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:hc(r.start,t.map((function(e){return e.chars})).join(""))})),Rf=wd(Af,(function(e,t){return e.localeInfo.isIdentStart(Ii(t.chars,0))?t:void 0})),Nf=Od((function(e,t){return Xd(t)||t.kind===tc.End?void 0:t})),Tf=gd((function(){return Gd(Ld(Rd(Pd(Nf),jd(xd(gf),Tf,Nd(xd(Sf),[])))))})),If=Ed(xd(gf,Tf,$d,Nd(Sf,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],a=t[3];return r.push(lc(n)),[r,void 0!==a]}));function Ff(e,t){return{kind:af.MaybeWSFTerm,node:e,whole:t}}function Of(e){return e.kind!==tc.Operator&&e.kind!==tc.Sep&&e.kind!==tc.End&&e.kind!==tc.Spaces&&!(e.kind in af)}function Df(e,t){return Of(t=t.kind===af.MaybeWSFTerm?t.node:t)?Vd(e,t).start:t.start}!function(e){e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(af||(af={}));var Mf=Nd(Od((function(e,t){return t.kind===tc.Spaces?t.chars:void 0})),""),wf=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+D(e);return ee.ULS.assertTag(589825160,I.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(Df(r,i),t)};function _f(e){return Ed(xd(Mf,wf,Od(e),wf,Mf),(function(e,t){var r=t[0],n=t[1];return lr(t[2],Hd(e,n,t[3],r,t[4]))}))}function Lf(e){return Ed(xd(Mf,wf,Od(e),wf),(function(e,t){var r=t[0],n=t[1];return lr(t[2],Hd(e,n,t[3],r,""))}))}function Pf(e){return Ed(xd(wf,Od(e),wf,Mf),(function(e,t){var r=t[0];return lr(t[1],Hd(e,r,t[2],"",t[3]))}))}var xf=_f((function(e,t){return t.kind!==tc.Operator||t.value!==Qa.Add&&t.value!==Qa.Sub?void 0:t.value})),Bf=Pf((function(e,t){if(t.kind===tc.Operator){if(t.value===Qa.Add)return Qa.Pos;if(t.value===Qa.Sub)return Qa.Neg}})),Uf=Pf((function(e,t){return t.kind===tc.Operator&&t.value===Qa.At?t.value:void 0})),Gf=Lf((function(e,t){return t.kind===tc.Operator&&t.value===Qa.Pound?t.value:void 0})),jf=Od((function(e,t){return t.kind===af.StructRefTerm?t:void 0})),Vf=_f((function(e,t){return t.kind!==tc.Operator||t.value!==Qa.Mul&&t.value!==Qa.Div?void 0:t.value})),Hf=_f((function(e,t){return t.kind===tc.Operator&&t.value===Qa.Pow?t.value:void 0})),Wf=Lf((function(e,t){return t.kind===tc.Operator&&t.value===Qa.Percent?t.value:void 0})),Kf=_f((function(e,t){return t.kind===tc.Operator&&t.value===Qa.Concat?t.value:void 0})),zf=_f((function(e,t){return t.kind===tc.Operator&&t.value>=Qa.Eq&&t.value<=Qa.Ge?t.value:void 0})),Yf=_f((function(e,t){return t.kind===tc.Operator&&t.value===Qa.Range?t.value:void 0})),qf=_f((function(e,t){return t.kind===tc.Operator&&t.value===Qa.Union?t.value:void 0})),Jf=Md((function(e,t,r){if(t.kind===tc.Spaces&&r.kind!==tc.End&&(r.kind!==tc.Operator||r.value===Qa.At)&&!Yd(r)){var n=Hd(e,t.start,Df(e,r),t.chars,"");return lr(Qa.Isect,n)}})),Qf=Od((function(e,t){return Yd(t)?t:void 0})),Xf=Od((function(e,t){return t.kind===af.ArgsTerm?t:void 0})),Zf=Od((function(e,t){return t.kind===af.ArgsTerm||t.kind===af.FieldRefTerm?t:void 0})),$f=((nf={})[Ka.LET]=De.CalcLetFunction,nf[Ka.LETREC]=De.CalcLetRecFunction,nf[Ka.LAMBDA]=De.CalcLambdaFunctions,nf);var eh=Ed(xd(Od((function(e,t){if(t.kind===af.MaybeWSFTerm&&void 0!==t.whole){var r=Vn(e.localeInfo,t.whole);if(void 0===r)return;ne("calc.parse.parseWSFName: unexpected UDF",r!==Ka._UDF);var n=$f[r];if(void 0!==n&&!Le(n))return;return cr(r,t.whole,t.node.label)}})),Xf),(function(e,t){var r,n,a=t[0],i=t[1],o=Vd(e,a).start,u=i.nodes;switch(a.id){case Ka.LET:case Ka.LETREC:a.id;for(var s=[],l=[],c=void 0,d=0;d<u.length;d+=1){var f=u[d];d!==u.length-1?!(d+1<u.length&&vn(f))||d+3<u.length&&(r=e.refStyle,!(vn(n=u[d+2])||r===ft.A1&&n.kind===kt.CellRef&&void 0===n.qualifier&&n.ref.kind===vt.Single&&n.ref.col.kind===pt.Rel&&n.ref.row.kind===pt.Rel))&&vn(u[d+1])?l.push(nr(f,d)):(s.push(ar(nr(f,d),nr(u[d+1],d+1))),d+=1):c=nr(f,d)}var h=Hd(e,o,i.end,"","");return ir(a,s,c,l,i.isClosed,h);case Ka.LAMBDA:a.id;var v=[];for(l=[],d=0;d<u.length-1;d+=1){vn(f=u[d])?v.push(ur(nr(f,d))):l.push(nr(f,d))}c=nr(u[u.length-1],u.length-1),h=Hd(e,o,i.end,"","");return sr(a,v,c,l,i.isClosed,h)}return ah(e,a,u,i.isClosed,o,i.end)}));function th(e,t,r){return Ed(xd(Ld(e),t),(function(e,t){var n=t[0],a=t[1];return n.reduceRight(r(e),a)}))}function rh(e,t,r){return Ed(xd(e,Ld(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function nh(e){return function(t,r){var n=r[0],a=r[1],i=Vd(e,t).start,o=Vd(e,a).end;return Zt(n,[t,a],!0,Hd(e,i,o,"",""))}}function ah(e,t,r,n,a,i){return Zt(t,r,n,Hd(e,a,i,"",""))}function ih(e){return function(t,r){var n=Vd(e,t).start;switch(r.kind){case af.ArgsTerm:return ah(e,t,r.nodes,r.isClosed,n,r.end);case af.FieldRefTerm:var a=Hd(e,n,r.end,"",""),i=Vd(e,r.rhs),o=i.start,u=i.end,s=i.pre,l=i.post,c=!r.rhs.isBracketed&&bn(t,s);if(mn(t)){var d=Hd(e,o,o,"",""),f=Qt(za,!0,d),h=Hd(e,o,u,s,l);return Or(Nt.FieldRef,[t,br(f,r.rhs,c,h)],a)}return br(t,r.rhs,c,a);case af.StructRefTerm:a=Hd(e,n,r.end,"","");return t.kind===kt.Name||pn(t)?Cr(t.kind===kt.Name?t:void 0,r.rhs,a):Or(Nt.StructRef,[t,Cr(void 0,r.rhs,Hd(e,r.start,r.end,"",""))],a);case kt.Operator:return ah(e,r,[t],!0,n,Vd(e,r).end)}}}function oh(e){var t=!0;return function(r,n){var a=Vd(e,n).start,i=Vd(e,r).end,o=Hd(e,a,i,"","");if((n.id===Qa.Pos||n.id===Qa.Neg)&&t&&(t=!1,mn(r)&&""===Vd(e,n).post))return Qt(n.id===Qa.Pos?r.oper:e.mathpack.neg(r.oper),!0,o);return Zt(n,[r],!0,o)}}var uh=Od((function(e,t){return t.kind===af.MaybeWSFTerm?t.node:Of(t)?t:void 0})),sh=Ed(xd(Mf,Qf,wf,Mf),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Or(Nt.Operator,n.chars,Hd(e,n.start,a,r,i))})),lh=Ed(Uf,(function(e,t){return Or(Nt.Operator,function(e,t){var r;return null!==(r=$u(e.localeInfo,t,""))&&void 0!==r?r:"op:"+t}(e,t.id),t.label)})),ch=Ed(xd(wf,Ld(Rd(uh,sh,lh)),wf),(function(e,t){var r=t[0],n=t[1],a=t[2];if(1===n.length)return n[0];var i=Hd(e,r,a,"","");return 0===n.length?Qt(za,!0,i):Or(Nt.Sequence,n,i)})),dh=rh(gd((function(){return Rd(eh,Ud(Td(Uf),ph),Ud(Td(Bf),gh),ch)})),Rd(Gf,jf),ih),fh=rh(dh,xd(Yf,dh),nh),hh=rh(fh,xd(Jf,fh),nh),vh=rh(hh,Zf,ih),ph=th(Uf,vh,oh),mh=rh(ph,xd(qf,ph),nh),gh=th(Bf,mh,oh),Sh=rh(gh,Wf,ih),bh=rh(Sh,xd(Hf,Sh),nh),yh=rh(bh,xd(Vf,bh),nh),Ch=rh(yh,xd(xf,yh),nh),kh=rh(Ch,xd(Kf,Ch),nh),Eh=rh(kh,xd(zf,kh),nh);var Ah=Od((function(e,t){return t.isIdentContinue&&!function(e){return e.kind===tc.Literal&&e.oper.kind===Tt.Boolean}(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),Rh=Od((function(e,t){return t.isIdentContinue||Yd(t)?t.chars:void 0})),Nh=Ed(Pd(Ah,Rh),(function(e,t){return t.join("")})),Th=Od((function(e,t){return t.kind===tc.Ident?t.chars:void 0})),Ih=function(e,t){var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function Fh(e,t,r,n,a,i){var o,u;if(null==t)null==n?(o=Bt(r,a,i),u=r):(o=Ut(r,n,void 0,a,i),u=r+":"+n);else{var s=Ih(e.localeInfo,t);null==n?(o=xt(r,t,a,i),u=""+s+r):(o=Ut(r,n,t,a,i),u=""+s+r+":"+n)}return[o,a?No(u):u]}var Oh=Od((function(e,t){return t.kind===tc.Ident||qd(t)?t.chars:void 0})),Dh=Ed(xd($d,Ld(Oh),gf,Pd(Oh),Sf,$d),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),i=(t[4],t[5]),o=n.join("");return Pt(a.join(""),""!==o?o:void 0,!0,Hd(e,r,i,"",""))})),Mh=Ed(xd($d,gf,Pd(Rh),Sf,$d),(function(e,t){var r=t[0],n=(t[1],t[2]),a=(t[3],t[4]);return Pt(n.join(""),void 0,!1,Hd(e,r,a,"",""))})),wh=gd((function(){return Le(De["OfficeVSO:3852168_CalcDocQual"])?Mh:Cd()})),_h=gd((function(){return Le(De["OfficeVSO:3852168_CalcDocQual"])?Dh:Cd()})),Lh=Ed(xd($d,Nd(wh,void 0),Nh,Nd(Ud(yf,Nh),void 0),$d),(function(e,t){var r=t[0];return Fh(e,t[1],t[2],t[3],!1,Hd(e,r,t[4],"",""))})),Ph=Ed(xd(pf,Nd(_h,void 0),Th,Nd(Ud(yf,Th),void 0),mf,$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=(t[4],t[5]);return Fh(e,n,a,i,!0,Hd(e,r.start,o,"",""))})),xh=Ed(Mh,(function(e,t){return[t,Ih(e.localeInfo,t)]})),Bh=gd((function(){return Le(De["OfficeVSO:3852168_CalcDocQual"])?xh:Cd()})),Uh=Ed(xd(pf,Dh,mf),(function(e,t){t[0];var r=t[1];t[2];return[r,No(Ih(e.localeInfo,r))]})),Gh=gd((function(){return Le(De["OfficeVSO:3852168_CalcDocQual"])?Uh:Cd()})),jh=Ed(xd(pf,Ld(Od((function(e,t){return t.kind===tc.End||t.kind===tc.Right&&t.value===rc.SQuote?void 0:t.chars}))),Nd(xd(mf,Nd(Bd(lf,Zd),void 0)),[void 0,void 0]),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=a[0],o=a[1],u=t[3],s="'"+n.join("")+(void 0!==i?"'":"")+(void 0!==o?"!":""),l=Hd(e,r.start,u,"","");return[Or(Nt.Qualifier,s,l),s]})),Vh=Md((function(e,t,r){if(Jd(t))return[_t(Hd(e,t.start,r.start,"","")),t.chars]})),Hh=Ed(xd(Rd(Lh,Ph,Bh,Gh,Dd((function(e,t){return[Lt(Hd(e,t.start,t.start,"","")),""]}))),lf,Zd),(function(e,t){var r=t[0];return[r[0],r[1]+"!"]})),Wh=Rd(Vh,Hh,jh);function Kh(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale}function zh(e){return e.refStyle===ft.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function Yh(e,t){return t.kind===tc.CellRef&&Kh(e,t)&&zh(t)}var qh=Gt(pt.Rel,0);function Jh(e){return!1===e?qh:e}function Qh(e,t){var r=e.refStyle===ft.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return Vt(Jh(e.row),Jh(e.col),r,t);if(null!=e.row){var n=Jh(e.row);return Wt(n,n,r,t)}if(null!=e.col){var a=Jh(e.col);return Kt(a,a,r,t)}var i="calc.parse.cellRefToken2cellRef: bad token "+D(e);return ee.ULS.assertTag(589825159,I.LogCategory.msoulscat_ES_EWAJS,!1,i)}function Xh(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart(Ii(t.chars,0))}var Zh,$h=Od((function(e,t){return Yh(e,t)&&!Xh(e,t)||Jd(t)?t:void 0})),ev=Od((function(e,t){return Yh(e,t)&&Xh(e,t)?t:void 0})),tv=Ed(xd(Rd($h,(Zh=function(e){return e.cellRefMustBeCellRefNode?ev:Bd(ev,Id(Rd(Af,bf)))},function(e,t,r,n,a){return Zh(r)(e,t,r,n,a)})),$d),(function(e,t){var r=t[0],n=t[1],a=r.kind===tc.CellRef?Qh(r,Hd(e,r.start,n,"","")):jt(Hd(e,r.start,n,"","")),i=r.kind===tc.CellRef?r.chars:void 0;return Ff(Sr(a,void 0,Hd(e,r.start,n,"","")),i)}));var rv=Md((function(e,t,r){return t.kind!==tc.CellRef||!Kh(e,t)||function(e,t,r){return r.kind===tc.Left&&r.value===rc.Paren&&t.isIdentContinue&&null!=Vn(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]})),nv=Rd(kd(xd(rv,Zd,yf,Zd,rv),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],s=u[0],l=u[1],c=Hd(e,n.start,a,"",i),d=Hd(e,s.start,l,o,""),f=Qh(n,c),h=Qh(s,d),v=void 0;if(f.kind===vt.Single&&h.kind===vt.Single)v=Ht(f,h,m=Hd(e,n.start,l,"",""));else if(0===i.length&&0===o.length)if(f.kind===vt.Row&&h.kind===vt.Row){var p=f.isBracketed||h.isBracketed,m=Hd(e,n.start,l,"","");v=Wt(f.row1,h.row1,p,m)}else if(f.kind===vt.Col&&h.kind===vt.Col){p=f.isBracketed||h.isBracketed,m=Hd(e,n.start,l,"","");v=Kt(f.col1,h.col1,p,m)}if(null==v)return Cd();var g=Ff(Sr(v,void 0,Hd(e,n.start,l,"","")),void 0);return n.isIdentContinue&&s.isIdentContinue?Dd((function(e,t){return t.kind===tc.Sep&&t.value===nc.Qual?void 0:g})):Sd(g)})),tv);var av=Rd(Od((function(e,t){return t.kind===tc.Ident&&e.localeInfo.isIdentStart(Ii(t.chars,0))||t.kind===tc.CellRef&&Xh(e,t)?t:void 0})),Bd(Od((function(e,t){return t.kind===tc.Literal&&t.oper.kind===Tt.Boolean?t:void 0})),Td(bf))),iv=Dd((function(e,t){return Qd(t)})),ov=Ed(xd(Pd(av,Af),Ld(Rd(Af,bf)),iv,$d),(function(e,t){var r,n,a,i,o,u,s,l,c,d,f=t[0],h=t[1],v=t[2],p=t[3],m=f[0],g=1===f.length&&(null===(r=h[0])||void 0===r?void 0:r.kind)===tc.Sep,S=m.kind!==tc.CellRef||(d=m).refStyle===ft.A1&&null==d.row&&"object"==typeof d.col&&d.col.kind===pt.Rel||function(e,t){return t.refStyle===ft.A1&&e.refStyle===ft.A1&&t.isIdentContinue||t.refStyle===ft.R1C1&&Zi(t.row,t.col)}(e,m)&&g;if(v||!Be("Microsoft.Office.Excel.CalcTSDotOperator")||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===tc.Literal||r.length%2!=0||r.some((function(t,r){return r%2==0?t.kind!==tc.Sep:t.kind===tc.Sep||!e.localeInfo.isIdentStart(Ii(t.chars,0))}))}(e,f,h)){var b=fr(hr(Object(fe.f)(f,h).map((function(e){return e.chars})).join(""),S,Hd(e,m.start,p,"","")),void 0,Hd(e,m.start,p,"",""));return Ff(b,b.whole)}var y,C=S,k=0;if(1===f.length&&m.kind===tc.CellRef){var E=Hd(e,m.start,null!==(a=null===(n=h[k])||void 0===n?void 0:n.start)&&void 0!==a?a:p,"","");if(Kh(e,m))if(zh(m)){y=vr(Qh(m,Hd(e,m.start,null!==(o=null===(i=h[k])||void 0===i?void 0:i.start)&&void 0!==o?o:p,"","")),m.chars,E)}else y=hr(m.chars,C,E);else C=!1,y=hr(m.chars,C,E)}else{var A=f.map((function(e){return e.chars})).join("");0===e.localeInfo.stringCompareCI(A,"_xlpm")&&k+1<h.length&&(A+="."+h[k+1].chars,k+=2),y=hr(A,C,E=Hd(e,m.start,null!==(s=null===(u=h[k])||void 0===u?void 0:u.start)&&void 0!==s?s:p,"",""))}for(var R=y;k+1<h.length;k+=2){var N=h[k+1],T=null!==(c=null===(l=h[k+2])||void 0===l?void 0:l.start)&&void 0!==c?c:p;R=pr(R,N.chars,k+2>=h.length?S:C,Hd(e,m.start,T,"",""))}R.kind===Et.CellRefNamePart&&re("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var I=fr(R,void 0,Hd(e,m.start,p,"",""));return Ff(I,I.whole)})),uv=Nd(Rd(nv,ov),{node:void 0}),sv=kd(Wh,(function(e,t){var r=t[0],n=t[1];return Ed(r.kind===ht.SheetRange?zd(r.isQuoted?uv:nv):r.kind===ht.Error?zd(uv):uv,(function(e,t){var a=t.node;if(null==a)return r.kind===ht.Error?Qt(_a,!0,r.label):r.kind===kt.Bad?r:Or(Nt.Qualifier,n,r.label);var i=Vd(e,r).start,o=Vd(e,a).end;if(a.kind===kt.Name){var u=Hd(e,i,o,"","");if(r.kind===kt.Bad||r.kind===ht.Error||r.kind===ht.SheetRange){var s=r.kind===kt.Bad?r:Or(Nt.Qualifier,n,r.label);return Or(Nt.Sequence,[s,a],u)}return fr(a.parts,r,u)}var l=Hd(e,i,o,"","");if(r.kind===kt.Bad||r.kind===ht.Document){s=r.kind===kt.Bad?r:Or(Nt.Qualifier,n,r.label);return Or(Nt.Sequence,[s,a],l)}return r.kind===ht.Ident&&(r=xt(r.name,void 0,r.isQuoted,r.label)),Sr(a.ref,r,l)}))})),lv=Ed(Rd(nv,ov),(function(e,t){return t.node.kind===kt.CellRef&&t.node.ref.kind===vt.Error?Qt(_a,!0,t.node.label):t})),cv=Rd(sv,lv);var dv=Ed(xd(Rd(Od((function(e,t){return t.kind===tc.Literal&&t.oper.kind!==Tt.Boolean?t:t.kind===tc.CellRef&&function(e){return e.refStyle===ft.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===pt.Rel}(t)?Nc(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),Bd(Od((function(e,t){return t.kind===tc.Literal&&t.oper.kind===Tt.Boolean?t:void 0})),Id(bf))),$d),(function(e,t){var r=t[0],n=t[1],a=Hd(e,r.start,n,"","");if(r.oper.kind===ac.BadNumber)return Or(Nt.NumberLiteral,r.chars,a);if(function(e){return e.kind===ac.BadError}(r.oper))return Or(Nt.ErrorLiteral,r.chars,a);if(Cn(r.oper)&&r.oper.value.length>32767)return Or(Nt.StringLiteral,r.chars,a);var i=Qt(r.oper,r.hasRight,a);return kn(r.oper)?Ff(i,r.chars):i})),fv=Ed(xd(Ld(Rd(Od((function(e,t){return Xd(t)||t.kind===tc.Unexpected||t.kind===tc.Escape||t.kind===tc.End?void 0:t.chars})),Ud(kf,Od((function(e,t){return t.kind!==tc.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars}))))),Ef),(function(e,t){var r=t[0];t[1];return r.join("")})),hv=wd(If,(function(e,t){var r=t[0],n=t[1],a=md(fv,r,0,e);return Se(a)?[a.value.output,!0,n]:void 0})),vv=Ed(Rf,(function(e,t){return[t.chars,!1,!0]})),pv=Ed(xd($d,Zd,cf,Rd(vv,hv),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=i[0],u=i[1],s=i[2],l=t[4],c=yr(o,u,s,Hd(e,a.start,l,n,""));return function(e,t,r,n){return{kind:af.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}(n.length>0,c,r,l)})),mv=gd((function(){return Be("Microsoft.Office.Excel.CalcTSDotOperator")?pv:Cd()})),gv=Od((function(e,t){return t.isIdentContinue||t.kind===tc.Spaces?t:void 0})),Sv=Ed(Pd(gv),(function(e,t){var r=t[0];return 1===t.length?r:hc(r.start,t.map((function(e){return e.kind===tc.Escape?"":e.chars})).join(""))})),bv=Od((function(e,t){return t.isIdentContinue||t.kind===tc.Spaces||t.kind===tc.Escape||function(e){return e.kind===tc.Sep&&e.value===nc.List}(t)||qd(t)?t:void 0})),yv=Ed(Pd(bv),(function(e,t){var r=t[0];return 1===t.length?r:hc(r.start,t.map((function(e){return e.kind===tc.Escape?"":e.chars})).join(""))})),Cv=Od((function(e,t){return t.kind===tc.SpecialRef?t:void 0})),kv=Rd(Ed(xd($d,Cv,$d),(function(e,t){var r=t[0],n=t[1],a=t[2];return kr(n.value,!1,!0,Hd(e,r,a,"",""))})),Ed(xd($d,gf,Cv,Nd(Sf,void 0),$d),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4];return kr(n.value,!0,void 0!==a,Hd(e,r,i,"",""))}))),Ev=Ed(xd($d,Sv,$d),(function(e,t){var r=t[0],n=t[1],a=t[2];return Er(n.chars,!1,!0,Hd(e,r,a,"",""))})),Av=Ed(xd($d,gf,Nd(yv,void 0),Nd(Sf,void 0),$d),(function(e,t){var r,n=t[0],a=(t[1],t[2]),i=t[3],o=t[4];return Er(null!==(r=null==a?void 0:a.chars)&&void 0!==r?r:"",!0,void 0!==i,Hd(e,n,o,"",""))})),Rv=Ed(xd($d,yv,$d),(function(e,t){var r=t[0],n=t[1],a=t[2];return Er(n.chars,!1,!0,Hd(e,r,a,"",""))})),Nv=Rd(Ev,Av),Tv=Ed($d,(function(e,t){return Tr(Hd(e,t,t,"",""))})),Iv=Rd(Nv,Tv),Fv=Od((function(e,t){return"#"===t.chars?t:void 0})),Ov=Ed(Pd(Fv,gv),(function(e,t){return dc(t[0].start,t.map((function(e){return e.chars})).join(""))})),Dv=Ed(Pd(Fv,bv),(function(e,t){return dc(t[0].start,t.map((function(e){return e.chars})).join(""))})),Mv=Rd(Ed(xd($d,Ov,$d),(function(e,t){var r=t[0],n=t[1],a=t[2];return Ir(n.chars,!1,!0,Hd(e,r,a,"",""))})),Ed(xd($d,gf,Dv,Nd(Sf,void 0),$d),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4];return Ir(n.chars,!0,void 0!==a,Hd(e,r,i,"",""))}))),wv=Ed(xd($d,Iv,yf,Iv,$d),(function(e,t){var r=t[0],n=t[1];t[2];return Ar(n,t[3],Hd(e,r,t[4],"",""))})),_v=Rd(wv,Nv),Lv=Rd(kv,Mv,wv,Nv,Tv),Pv=Ed(xd($d,Lv,Pd(xd(of,Lv)),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Rr(Object(fe.f)([n],a.map((function(e){e[0];return e[1]}))),Hd(e,r,i,"",""))})),xv=Ed(xd($d,Cf,Nd(_v,void 0),$d),(function(e,t){var r=t[0];t[1];return Nr(t[2],Hd(e,r,t[3],"",""))})),Bv=Rd(Bd(Ed(Zd,(function(){})),Ef),Bd(Rv,Ef),Bd(Pv,Ef),Bd(xv,Ef),Bd(wv,Ef),Bd(kv,Ef),Bd(Mv,Ef),Bd(Av,Ef)),Uv=wd(xd($d,If,$d),(function(e,t){var r=t[0],n=t[1],a=n[0],i=n[1],o=t[2],u=md(Bv,a,0,e);return Se(u)?function(e,t,r){return{kind:af.StructRefTerm,rhs:e,start:t,end:r}}(Fr(u.value.output,i,Hd(e,r,o,"","")),r,o):void 0})),Gv=gd((function(){return Le(De.CalcStructuredReferences)?Uv:Cd()})),jv=Ed(xd(Zd,gd((function(){return $v})),Zd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=Vd(e,n);return i.pre=r,i.post=a,n})),Vv=Ed(xd(df,Kd({delimId:rc.Paren,listSep:bd.Union},jv),Nd(ff,void 0),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return dr(n,void 0!==a,Hd(e,r.start,i,"",""))})),Hv=Pd(jv,Ud(sf,jv)),Wv=Pd(Hv,Ud(uf,Hv));function Kv(e){return Md((function(t,r,n){return e(r)?Or(Nt.Unexpected,r.chars,Hd(t,r.start,n.start,"","")):void 0}))}var zv=Rd(cv,dv,Vv,Ed(xd(hf,Kd({delimId:rc.Brace,listSep:bd.Union},Wv),Nd(vf,void 0),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Xt(n,void 0!==a,Hd(e,r.start,i,"",""))})),mv,Gv,Ed(xd($d,Kv(Qd),Kd({delimId:rc.Bracket,listSep:bd.Union},jv),Nd(Kv((function(e){return e.kind===tc.Right&&e.value===rc.Bracket})),void 0),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],u=[n,a];return null!=i&&u.push(i),Or(Nt.Sequence,u,Hd(e,r,o,"",""))})),Md((function(e,t,r){switch(t.kind){case tc.End:case tc.Operator:case tc.Spaces:return;case tc.Sep:if(t.value===nc.Dot||t.value!==nc.Qual&&(e.delim.delimId===rc.Brace||t.value!==nc.Col&&t.value!==nc.Row))return;break;case tc.Right:if(t.value===e.delim.delimId)return}return Or(t.kind===tc.CellRef?Nt.CellRef:Nt.Unexpected,t.chars,Hd(e,t.start,r.start,"",""))}))),Yv=Ed(xd(df,Kd({delimId:rc.Paren,listSep:bd.Arg},Pd(jv,Ud(of,jv))),Nd(ff,void 0),$d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return function(e,t,r,n){return{kind:af.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}}(n,void 0!==a,r.start,i)})),qv=Od((function(e,t){return t.kind!==tc.Operator||t.value!==Qa.Percent&&t.value!==Qa.Pound?void 0:t}));var Jv=Od((function(e,t){return t.kind===tc.Operator||Yd(t)?t:function(e,t){return t.kind===tc.Sep&&t.value===nc.List&&e.delim.listSep===bd.Union?Ic(t.start,e.localeInfo.listSeparator,Qa.Union):void 0}(e,t)})),Qv=Od((function(e,t){return t.kind===tc.Spaces?t:void 0})),Xv=Rd(Pd(Rd(zv,qv),Rd(Yv,mv,Gv)),xd(Jv)),Zv=Gd(Pd(Xv,jd(Nd(xd(Qv),[]),Xv))),$v=Ed(xd(Nd(Zv,void 0),$d),(function(e,t){var r=t[0],n=t[1];if(null==r){var a=Hd(e,n,n,"","");return Qt(za,!0,a)}var i=r;return i.push(lc(n)),function(e,t){var r=t.length-1;if(1===r&&Of(t[0]))return t[0];if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return ee.ULS.assertTag(589825161,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[0].kind===tc.Spaces){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces in "+D(t);return ee.ULS.assertTag(589825162,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&t[r-1].kind===tc.Spaces){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces in "+D(t);return ee.ULS.assertTag(589825163,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[r].kind!==tc.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in "+D(t);return ee.ULS.assertTag(589825164,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}for(;;){var a=md(Eh,t,0,e);if(Se(a)&&a.value.index>=r)return a.value.output;if(!Se(a)||0===a.value.index||1===a.value.index&&Of(t[0])){n="calc.parse.runTermParser: internal error: consumed "+(Se(a)?a.value.index:0)+" out of "+r+" in "+D(t);return ee.ULS.assertTag(589825165,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=(t=Object(fe.f)([a.value.output],t.slice(a.value.index))).length-1}}(e,i)}));function ep(e,t,r,n,a,i){var o=i.length-1;if(o<0){var u="calc.parse.runTokenParser: internal error: expected at least 1 token";return ee.ULS.assertTag(589825167,I.LogCategory.msoulscat_ES_EWAJS,!1,u)}if(i[o].kind!==tc.End){u="calc.parse.runTokenParser: internal error: array[n] !== End in "+D(i);return ee.ULS.assertTag(589825168,I.LogCategory.msoulscat_ES_EWAJS,!1,u)}var s=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,delim:{delimId:void 0,listSep:bd.Union},cellRefMustBeCellRefNode:!1,label:1,spans:[]}}(e,t,r,n,a),l=md(jv,i,0,s);if(!Se(l)||l.value.index<o){u="calc.parse.runTokenParser: internal error: consumed "+(Se(l)?l.value.index:0)+" out of "+o+" in "+D(i);return ee.ULS.assertTag(589825169,I.LogCategory.msoulscat_ES_EWAJS,!1,u)}var c=l.value.output;return zt(c,s.spans,ql(e,c))}var tp={getDocumentLoc:function(){return re("calc.lang.printFormula: default  getDocumentLoc")},getSheetIndex:function(){return re("calc.lang.printFormula: default  getSheetIndex")},getSheetName:function(){return re("calc.lang.printFormula: default  getSheetName")},getNameLoc:function(){return re("calc.lang.printFormula: default  getNameLoc")},getUserDefinedFuncLoc:function(){return re("calc.lang.printFormula: default  getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return re("calc.lang.printFormula: default  getSheetRangeIndexes")},getContainingTable:function(){return re("calc.lang.printFormula: default  getContainingTable")},getStructRefColumn:function(){return re("calc.lang.printFormula: default  getStructRefColumn")},getStructRefSpecialRef:function(){return re("calc.lang.printFormula: default  getStructRefSpecialRef")},getNamedRanges:function(){return re("calc.lang.printFormula: default  getNamedRanges")}};var rp={"=":1,"+":0,"-":0,"@":-1};function np(e,t,r){var n,a,i,o;try{var u=r[0],s=null!=u?rp[u]:void 0;if(null==s)return ge(ec("first character is not '=', '+', '-' or '@'"));if(s<0)return ge(Pn(["Lotus 1-2-3 syntax"]));var l=null!==(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==a?a:e.config.localeInfo,c=null!==(o=null===(i=t.config)||void 0===i?void 0:i.refStyle)&&void 0!==o?o:e.config.refStyle,d=e.config.mathpack,f=pd(l,d,c,t.originGridCell.value,r,s);return he(ep(l,d,c,t.lexicalKind,t.originGridCell.value,f))}catch(e){return ge(be(e))}}function ap(e){return{parseFormula:function(t,r,n,a){if("number"==typeof t){if(null==r){return ee.ULS.assertTag(595980825,I.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var i=t,o=r;return np(e,Ql(n,on(function(e){return void 0===e.range}(o)?o:o.range),{refStyle:i}),a)}return np(e,t,r)},formatFormula:function(t,r){try{return zs(function(e){var t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:tp.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:tp.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:tp.getSheetName,getNameLoc:null!==(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e))&&void 0!==s?s:tp.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(l=e.getUserDefinedFuncLoc)||void 0===l?void 0:l.bind(e))&&void 0!==c?c:tp.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:tp.getSheetRangeIndexes,getContainingTable:null!==(v=null===(h=e.getContainingTable)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:tp.getContainingTable,getStructRefColumn:null!==(m=null===(p=e.getStructRefColumn)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:tp.getStructRefColumn,getStructRefSpecialRef:null!==(S=null===(g=e.getStructRefSpecialRef)||void 0===g?void 0:g.bind(e))&&void 0!==S?S:tp.getStructRefSpecialRef,getNamedRanges:null!==(y=null===(b=e.getNamedRanges)||void 0===b?void 0:b.bind(e))&&void 0!==y?y:tp.getNamedRanges}}(e)).printFormula(t,r)}catch(e){return ge(be(e))}}}}function ip(e,t){var r=e[t];return null==r?re("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function op(e,t,r,n,a,i,o){return void 0===a&&(a=!1),!!Se(e)&&(function(e,t,r,n,a,i,o){if(null==e||null==n)return;var u={};null!=r?r.forEach((function(e){u[e]=!0})):u["*"]=!0;var s=0,l=[];l.push({formulaNode:e.node,letNamesSet:zl.create(t.stringCompareCI)});var c=function(){var t=l.pop();if(null==t)return"continue";var r=t.formulaNode,u=t.letNamesSet;switch(r.kind){case kt.Literal:f("literal")&&n("literal",{label:r.label,value:r});break;case kt.Array:r.nodes.map((function(e){return e.map((function(e){l.push({formulaNode:e,letNamesSet:u})}))}));break;case kt.App:case kt.Let:case kt.Lambda:var c=r.head;switch(c.kind){case kt.Operator:r.args.forEach((function(e){l.push({formulaNode:e,letNamesSet:u})})),f("operator")&&n("operator",{label:r.label,value:c.id});break;case kt.WSF:case kt.Name:if(a&&hn(r.head)&&r.head.id===Ka.LET){for(var d=u,v=u,p=0;p<r.args.length;p+=1){var m=r.args[p];p%2==0?(d=v,m.kind!==kt.Name||m.qualifier?m.kind===kt.Bad&&m.type===Nt.CellRef&&(v=v.setValue(m.contents,s)):v=v.setValue(m.whole,s),l.push({formulaNode:m,letNamesSet:v})):l.push({formulaNode:m,letNamesSet:d})}s+=1}else r.args.forEach((function(e){l.push({formulaNode:e,letNamesSet:u})}));f("function")&&n("function",{label:r.label,name:c.whole,isClosed:r.isClosed,args:r.args});break;default:l.push({formulaNode:c,letNamesSet:u}),r.args.forEach((function(e){l.push({formulaNode:e,letNamesSet:u})}))}break;case kt.Paren:l.push({formulaNode:r.node,letNamesSet:u});break;case kt.Name:if(a&&u.contains(r.whole)&&!r.qualifier&&f("letName"))n("letName",{label:r.label,name:r.whole.toLocaleLowerCase(),number:u.getValue(r.whole),qualifier:void 0});else if(f("namedRange")){var g=r.whole.split(".");n("namedRange",{label:r.label,name:g[0],names:g.slice(1),qualifier:h(r)})}break;case kt.CellRef:f("range")&&function(t){if(null==e||null==n)return;switch(t.ref.kind){case vt.Error:break;case vt.Col:var r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:ip(e.spans,r.label),qualifier:h(t)});break;case vt.Row:var a=t.ref;n("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:ip(e.spans,a.label),qualifier:h(t)});break;case vt.Single:var i=t.ref;n("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:ip(e.spans,i.label),qualifier:h(t)});break;case vt.Range:var o=t.ref;n("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:ip(e.spans,o.ref1.label),bottomRightSpan:ip(e.spans,o.ref2.label),qualifier:h(t)})}}(r);break;case kt.FieldRef:l.push({formulaNode:r.lhs,letNamesSet:u});break;case kt.StructRef:if(!Le(De["OfficeVSO:4969385_ParseResultStructRef"]))break;if(f("structRefRange")){if(null==o||null==i)break;var S=o.resolveStructRef(i,r).resolution;if(!Se(S)||void 0===S.value)break;var b=S.value;n("structRefRange",{label:r.label,type:"range",top:Gt(pt.Rel,b.range.row),left:Gt(pt.Rel,b.range.col),bottom:Gt(pt.Rel,b.range.row+b.range.rows-1),right:Gt(pt.Rel,b.range.col+b.range.cols-1),span:ip(e.spans,r.label),qualifier:void 0!==r.lhs?h(r.lhs):void 0,name:void 0!==r.lhs?r.lhs.whole:void 0})}break;case kt.Bad:r.type===Nt.CellRef&&u.contains(r.contents)&&f("letName")&&n("letName",{label:r.label,name:r.contents.toLocaleLowerCase(),number:u.getValue(r.contents),qualifier:void 0});break;default:return{value:te("calc.parse.traverseFormula",r)}}};for(;l.length>0;){var d=c();if("object"==typeof d)return d.value}function f(e){return u[e]||u["*"]}function h(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case ht.Sheet:var r=e.qualifier;t.type=ht.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case ht.SheetRange:var n=e.qualifier;t.type=ht.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case ht.Ident:var a=e.qualifier;t.type=ht.Ident,t.name=a.name;break;case ht.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}}(e.value,null!=n?n:os(),t,r,a,i,o),!0)}var up,sp,lp,cp,dp,fp={isSuccess:Se,traverse:op,extractReferences:function(e,t,r,n,a){if(void 0===r&&(r=!1),Se(e)){var i=[];return op(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:ip(e.value.spans,r.label)};i.push(n)}),t,r,n,a),i.sort((function(e,t){return e.span.start-t.span.start})),i}},extractLetVariables:function(e,t){if(Se(e)){var r=e.value;if(void 0!==r){for(var n=[],a=r.node;void 0!==a&&(a.kind===kt.App||a.kind===kt.Let||a.kind===kt.Lambda);){for(var i=hn(a.head)&&a.head.id===Ka.LET,o=void 0,u=a.args,s=0;s<u.length;s+=1){var l=u[s],c=ip(e.value.spans,l.label);if(i&&s%2==0&&s>=2&&u[s-2].kind===kt.Name&&n.push(u[s-2].whole),c.start<=t&&c.end>=t){o=l;break}}a=o}return n}}}};(sp=up||(up={})).createParseGlobals=Jl,sp.ReasonKind=Xl,sp.parseLocals=Ql,sp.formatLocalsGrid=Zl,sp.formatLocalsName=$l,sp.notFormulaString=ec,sp.createParser=ap,sp.parseResultHelper=fp,function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_argument_for_operator",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Invalid_body="Invalid_body",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Unexpected_dot_possible_literal="Unexpected_dot_possible_literal",e.Unexpected_dot_possible_field="Unexpected_dot_possible_field",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part"}(cp||(cp={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_arguments_for_operator",e.Excess_function_arguments="Excess_arguments_for_function",e.Insufficient_function_arguments="Insufficient_arguments_for_function"}(dp||(dp={}));var hp=((lp={})[cp.Unclosed_application]={kind:cp.Unclosed_application},lp[cp.Unclosed_paren]={kind:cp.Unclosed_paren},lp[cp.Unclosed_bracket]={kind:cp.Unclosed_bracket},lp[cp.Unclosed_array]={kind:cp.Unclosed_array},lp[cp.Unclosed_literal]={kind:cp.Unclosed_literal},lp[cp.Invalid_number_literal]={kind:cp.Invalid_number_literal},lp[cp.Invalid_string_literal]={kind:cp.Invalid_string_literal},lp[cp.Invalid_error_literal]={kind:cp.Invalid_error_literal},lp[cp.Invalid_name]={kind:cp.Invalid_name},lp[cp.Illegal_array_literal_element]={kind:cp.Illegal_array_literal_element},lp[cp.Empty_array_literal]={kind:cp.Empty_array_literal},lp[cp.Irregular_array_shape]={kind:cp.Irregular_array_shape},lp[cp.Empty_parenthesis]={kind:cp.Empty_parenthesis},lp[cp.Bad_node]={kind:cp.Bad_node},lp[cp.Invalid_qualifier]={kind:cp.Invalid_qualifier},lp[cp.Invalid_cell_ref]={kind:cp.Invalid_cell_ref},lp[cp.Invalid_binder]={kind:cp.Invalid_binder},lp[cp.Invalid_body]={kind:cp.Invalid_body},lp[cp.Empty_formula]={kind:cp.Empty_formula},lp[cp.Invalid_rel_sheet_qualifier_in_cell]={kind:cp.Invalid_rel_sheet_qualifier_in_cell},lp[cp.Invalid_rel_sheet_qualifier_in_name]={kind:cp.Invalid_rel_sheet_qualifier_in_name},lp[cp.Invalid_unqualified_cell]={kind:cp.Invalid_unqualified_cell},lp[cp.Unexpected_closing_paren]={kind:cp.Unexpected_closing_paren},lp[cp.Unexpected_closing_brace]={kind:cp.Unexpected_closing_brace},lp[cp.Unexpected_closing_bracket]={kind:cp.Unexpected_closing_bracket},lp[cp.Unexpected_field_ref]={kind:cp.Unexpected_field_ref},lp[cp.Unexpected_dot]={kind:cp.Unexpected_dot},lp[cp.Unexpected_dot_possible_literal]={kind:cp.Unexpected_dot_possible_literal},lp[cp.Unexpected_dot_possible_field]={kind:cp.Unexpected_dot_possible_field},lp[cp.Invalid_struct_ref_table_name]={kind:cp.Invalid_struct_ref_table_name},lp[cp.Invalid_struct_ref_comma_parts]={kind:cp.Invalid_struct_ref_comma_parts},lp[cp.Invalid_struct_ref_missing_part]={kind:cp.Invalid_struct_ref_missing_part},lp[cp.Invalid_struct_ref_bad_part]={kind:cp.Invalid_struct_ref_bad_part},lp[dp.Types_not_related]={kind:dp.Types_not_related},lp[dp.Unexpected_application_head]={kind:dp.Unexpected_application_head},lp[dp.Unexpected_application_head_with_fix]={kind:dp.Unexpected_application_head_with_fix},lp);function vp(e){switch(e.kind){case dp.Insufficient_function_arguments:case dp.Excess_function_arguments:return e.kind+": "+Qu(e.funcId);case cp.Missing_operation_argument:case dp.Incorrect_number_of_operator_arguments:return e.kind+": "+Zu(e.opId);case cp.Unexpected_character:return e.kind+": "+G(e.text);default:return e.kind}}function pp(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=vp(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t}}function mp(e,t){return{config:e,getSheetName:t}}function gp(e,t,r,n){return void 0===n&&(n=!1),{config:null!=r?r:void 0,lexicalKind:e,originGridCell:he(t.range),originSheet:he(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}}function Sp(e,t,r){return void 0===r&&(r=!1),{config:null!=t?t:void 0,lexicalKind:Xn.NameManager,originGridCell:he(e.range),originSheet:he(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}var bp={};function yp(e,t){return{context:e,result:t}}function Cp(e){return function(t){return t.kind===kt.Literal&&e(t.oper)}}var kp=Cp(Nn),Ep=Cp(yn),Ap=Tt.String|Tt.Boolean|Tt.Error,Rp=Cp((function(e){return 0!=(e.kind&Ap)}));function Np(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function Tp(e,t){return t!==Tt.Range||0!=(e&Tt.Range)}function Ip(e,t){if(t.kind===kt.Literal)switch(Np(e,t,hp.Unclosed_literal,t.isClosed),t.oper.kind){case Tt.Number:case Tt.Boolean:case Tt.String:case Tt.Error:return;default:return void Np(e,t,hp.Illegal_array_literal_element)}Np(e,t,hp.Illegal_array_literal_element)}function Fp(e,t,r){return Oe.try((function(){Np(e,t,hp.Types_not_related,Tp(Tt.Array,r)),Np(e,t,hp.Unclosed_array,t.isClosed);var n=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&pn(t.nodes[0][0]));if(Np(e,t,hp.Empty_array_literal,n),!n)return yp(e,r);for(var a=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],u=o.length;Np(e,t,hp.Irregular_array_shape,u===a);for(var s=0;s<u;s+=1)Ip(e,o[s])}return yp(e,r)}))}function Op(e,t,r){return Oe.try((function(){if(e.earlyExit&&!e.isOk())throw bp;switch(t.kind){case kt.Array:return Fp(e,t,r);case kt.Paren:return Np(e,t,hp.Unclosed_paren,t.isClosed),Np(e,t,hp.Empty_parenthesis,!kp(t.node)),Op(e,t.node,r);case kt.Bad:case kt.Name:case kt.CellRef:case kt.FieldRef:case kt.StructRef:case kt.App:case kt.Let:case kt.Lambda:case kt.Literal:return Lp(e,t).bind((function(n){return Np(e,t,hp.Types_not_related,Tp(n.result,r)),n.result=r,n}));default:return te("calc.analyze.checker.check: unhandled formula case",t)}}))}function Dp(e,t,r){if(vn(r)&&r.parts.kind===Et.IdentNamePart){var n=Wn(e.localeInfo,r.whole);return Np(e,r,hp.Invalid_binder,(n.indexOf(".")<0||!Be("Microsoft.Office.Excel.CalcTSDotOperator"))&&!t.contains(n)),t.setValue(n,!0)}return Np(e,r,hp.Invalid_binder),t}var Mp=function(e){return 0===e.args.length?e:e.args[e.args.length-1]};function wp(e,t,r){return Oe.try((function(){var n=vi(t),a=n.minArgs,i=n.headTypes,o=n.restTypes,u=n.tailTypes,s=n.flags,l=r.args,c=l.length,d=dn(r),f=d.length;if(Np(e,r.head,hp.Invalid_name,0==(s&Ot.OnlyParsedDuringLoad)||e.locals.workbookLoad),f<a)switch(t){case Ka.IF:case Ka.LET:case Ka.LETREC:case Ka.LAMBDA:break;default:var h=l[c-1];Np(e,void 0===h?r:h,{kind:dp.Insufficient_function_arguments,funcId:t,numArgsGiven:f,numArgsExpected:a})}if(0===o.length&&f>i.length){var v=l[c-1];Np(e,void 0===v?r:v,{kind:dp.Excess_function_arguments,funcId:t,numArgsGiven:f,numArgsExpected:i.length})}if(o.length>1&&f>i.length+o.length){var p=(f-i.length)%o.length;p>u.length&&Np(e,Mp(r),{kind:dp.Insufficient_function_arguments,funcId:t,numArgsGiven:f,numArgsExpected:f+(o.length-p)})}return Oe.all(d.map((function(t,r){return Op(e,t,gn(n,r,f))}))).bind((function(a){return e.specialDependencies|=n.staticPrecs,function(e,t,r){var n=dn(r).length;switch(t){case Ka.IF:var a=e.locals.lexicalKind===Xn.NameManager?1:2;return void(n<a&&Np(e,Mp(r),{kind:dp.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:a}));case Ka._UDF:return Np(e,r,hp.Unexpected_application_head);case Ka.LET:case Ka.LETREC:ne("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===kt.Let);for(var i=zl.create(e.localeInfo.stringCompareCI),o=0,u=r.vars;o<u.length;o++){i=Dp(e,i,u[o].name.arg)}for(var s=0,l=r.badArgs;s<l.length;s++){Np(e,l[s].arg,hp.Invalid_binder)}Np(e,Mp(r),{kind:dp.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:E(3,n+1+n%2)},n>=3&&void 0!==r.body);break;case Ka.LAMBDA:ne("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===kt.Lambda);i=zl.create(e.localeInfo.stringCompareCI);for(var c=0,d=r.params;c<d.length;c++){i=Dp(e,i,d[c].name.arg)}for(var f=0,h=r.badArgs;f<h.length;f++){Np(e,h[f].arg,hp.Invalid_binder)}Np(e,Mp(r),{kind:dp.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:n+1},n>=1&&void 0!==r.body),void 0!==r.body&&Np(e,r.body.arg,hp.Invalid_body,0===n||!pn(r.body.arg))}}(e,t,r),yp(e,n.returnType)}))}))}function _p(e,t){return Oe.try((function(){Np(e,t,hp.Unclosed_application,t.isClosed);var r=t.args;if(fn(t.head))return function(e,t,r){return Oe.try((function(){var n=hi(t.id),a=r.length,i=a===n.minArgs;return Np(e,t,{kind:dp.Incorrect_number_of_operator_arguments,opId:t.id},i),Oe.all(r.map((function(r,o){return Oe.try((function(){return kp(r)&&(i=!1,Np(e,r,{kind:cp.Missing_operation_argument,opId:t.id})),Op(e,r,gn(n,o,a))}))}))).bind((function(t){return i?(e.specialDependencies|=n.staticPrecs,yp(e,n.returnType)):yp(e,It.All)}))}))}(e,t.head,r);if(hn(t.head))return wp(e,t.head.id,t);var n=t.head;return Oe.all(r.map((function(t){return Op(e,t,It.All)}))).bind((function(t){return Lp(e,n).bind((function(t){return Tp(t.result,Tt.Range)||0!=(t.result&(Tt.Array|Tt.Rich))||Np(e,n,Rp(n)||n.kind===kt.Array?hp.Unexpected_application_head:hp.Unexpected_application_head_with_fix),yp(e,It.All)}))}))}))}function Lp(e,t){return Oe.try((function(){var r,n,a,i;if(e.earlyExit&&!e.isOk())throw bp;switch(t.kind){case kt.App:case kt.Let:case kt.Lambda:return _p(e,t);case kt.Array:return Fp(e,t,Tt.Array);case kt.Bad:return function e(t,r,n){return void 0===n&&(n=!1),Oe.try((function(){switch(r.type){case Nt.Sequence:return Np(t,r,hp.Bad_node,r.contents.some((function(e){return e.kind===kt.Bad}))),Oe.all(r.contents.map((function(n,a){return a===r.contents.length-1&&n.kind===kt.Bad&&n.type===Nt.Operator&&"."===n.contents?Np(t,n,hp.Unexpected_dot_possible_field):n.kind===kt.Bad?e(t,n,!0):Lp(t,n)})));case Nt.StructRef:return Np(t,r,hp.Invalid_struct_ref_table_name);case Nt.FieldRef:return Np(t,r,hp.Unexpected_field_ref);case Nt.Unexpected:switch(r.contents){case")":return Np(t,r,hp.Unexpected_closing_paren);case t.localeInfo.rightBrace:return Np(t,r,hp.Unexpected_closing_brace);case t.localeInfo.rightBracket:return Np(t,r,hp.Unexpected_closing_bracket);default:return Np(t,r,{kind:cp.Unexpected_character,text:r.contents})}case Nt.NumberLiteral:return Np(t,r,hp.Invalid_number_literal);case Nt.StringLiteral:return Np(t,r,hp.Invalid_string_literal);case Nt.ErrorLiteral:return Np(t,r,hp.Invalid_error_literal);case Nt.CellRef:return Np(t,r,hp.Invalid_cell_ref);case Nt.Qualifier:return Np(t,r,hp.Invalid_qualifier);case Nt.Operator:switch(r.contents){case".":return Np(t,r,n?hp.Unexpected_dot:hp.Unexpected_dot_possible_literal)}return Np(t,r,hp.Bad_node);default:te("calc.analyze.diagnoseBadNode",r)}}))}(e,t).bind((function(){return yp(e,It.All)}));case kt.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==ht.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?yp(e,Tt.Range):(Np(e,t,hp.Invalid_unqualified_cell),yp(e,It.All)):(Np(e,t,hp.Invalid_rel_sheet_qualifier_in_cell),yp(e,It.All));case kt.Literal:return Np(e,t,hp.Unclosed_literal,t.isClosed),yp(e,t.oper.kind|(En(t.oper)&&t.oper.type===Na.REF?Tt.Range:0));case kt.Name:if(!e.locals.allowRelativeQualifier&&void 0!==t.qualifier&&t.qualifier.kind===ht.Relative)return Np(e,t,hp.Invalid_rel_sheet_qualifier_in_name),yp(e,It.All);if(!e.locals.workbookLoad&&(null===(r=t.qualifier)||void 0===r?void 0:r.kind)===ht.Document&&!t.qualifier.isQuoted)return Np(e,t,hp.Invalid_qualifier),yp(e,It.All);var o=mr(t.parts).parts;return Np(e,t,hp.Invalid_name,(null===(n=e.annotations[o[0].label])||void 0===n?void 0:n.kind)===mt.LocalNameUse||(null===(a=e.annotations[t.label])||void 0===a?void 0:a.kind)===mt.LocalNameDecl||o.some((function(e){return e.canDenoteNamedObject}))),yp(e,It.All);case kt.Paren:return Np(e,t,hp.Unclosed_paren,t.isClosed),Np(e,t,hp.Empty_parenthesis,!kp(t.node)),Lp(e,t.node);case kt.FieldRef:return Np(e,t,hp.Unclosed_bracket,t.rhs.isClosed),Np(e,t,hp.Unexpected_field_ref,!kp(t.lhs)&&!Ep(t.lhs)),Lp(e,t.lhs).bind((function(t){return yp(e,It.All)}));case kt.StructRef:if(Np(e,t,hp.Invalid_struct_ref_table_name,void 0===t.lhs&&e.locals.allowImplicitTable||(null===(i=t.lhs)||void 0===i?void 0:i.kind)===kt.Name&&t.lhs.parts.kind===Et.IdentNamePart&&t.lhs.parts.canDenoteNamedObject),void 0===t.rhs.innerRef);else{Np(e,t.rhs.innerRef,hp.Invalid_struct_ref_comma_parts,t.rhs.innerRef.kind!==Rt.CommaOpRef||Yn(t.rhs.innerRef));var u=function(t){switch(null==t?void 0:t.kind){case void 0:break;case Rt.RangeOpRef:u(t.lhs),u(t.rhs);break;case Rt.CommaOpRef:t.refs.forEach(u);break;case Rt.SpecialRef:case Rt.ColumnRef:Np(e,t,hp.Unclosed_bracket,t.isClosed);break;case Rt.ThisRowOpRef:u(t.ref);break;case Rt.MissingRef:Np(e,t,hp.Invalid_struct_ref_missing_part);break;case Rt.BadRef:Np(e,t,hp.Unclosed_bracket,t.isClosed),Np(e,t,hp.Invalid_struct_ref_bad_part)}};u(t.rhs.innerRef)}return Np(e,t,hp.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?Oe.resolve(void 0):Lp(e,t.lhs)).bind((function(t){return yp(e,It.All)}));default:return te("calc.analyze.checker.infer: unhandled formula case",t)}}))}var Pp={ok:!0,isOk:f,collect:function(e,t,r){return!1}};function xp(e,t,r,n,a){var i,o,u=r.annotations;void 0===a&&(a=!0);var s={globals:e,locals:t,localeInfo:null!==(o=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo,annotations:u,reportError:n.collect,isOk:function(){return n.isOk(s.errorData)},earlyExit:a,specialDependencies:Ft.None,errorData:n.ok};return s}function Bp(e,t){try{return Np(e,t.node,hp.Empty_formula,!kp(t.node)),Oe.settleOrThrow(Op(e,t.node,It.All))}catch(t){if(t===bp)return yp(e,It.All);throw t}}function Up(e,t,r){try{return he(function(e,t,r){var n=Bp(xp(e,t,r,Pp),r).context.errorData;return Object(fe.a)(Object(fe.a)({},r),{isWellFormed:n})}(e,t,r))}catch(e){return ge(be(e))}}var Gp={getDocumentLoc:function(){return re("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return re("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return re("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return re("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return re("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return re("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return re("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return re("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return re("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};var jp,Vp,Hp,Wp=Un("AutocorrectError"),Kp=Object(fe.a)(Object(fe.a)({},$e(Je(!1),(function(e,t){return e||t}))),{badSequenceNode:function(e,t,r){return!0},badStringNode:function(e,t,r){return!0}}),zp=function(e){function t(t,r,n){var a=e.call(this)||this;return a.f=n,a.seenUnclosed=!1,a.seenParen=!1,a.seenMissingOperand=!1,a.globals=function(e){var t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:Gp.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:Gp.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:Gp.getSheetName,getNameLoc:null!==(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e))&&void 0!==s?s:Gp.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(l=e.getUserDefinedFuncLoc)||void 0===l?void 0:l.bind(e))&&void 0!==c?c:Gp.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:Gp.getSheetRangeIndexes,getContainingTable:null!==(v=null===(h=e.getContainingTable)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:Gp.getContainingTable,getStructRefColumn:null!==(m=null===(p=e.getStructRefColumn)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:Gp.getStructRefColumn,getStructRefSpecialRef:null!==(S=null===(g=e.getStructRefSpecialRef)||void 0===g?void 0:g.bind(e))&&void 0!==S?S:Gp.getStructRefSpecialRef}}(t),a.locals=r,a.resolver=Es(a.globals),a}return Object(fe.c)(t,e),t.prototype.autocorrect=function(){return St(Kp,this.f)?this.f.node:St(this,this.f)},t.prototype.literalNode=function(e,t,r){return t||(this.seenUnclosed=!0),Qt(e,t,r)},t.prototype.nameNode=function(e,t,r){var n=fr(e,t,r),a=mr(e);if(a.kind===Et.CellRefNamePart){var i=this.resolver.resolveDottedName(this.locals,n,this.f.annotations).resolved;if(i.kind===cs.ResolvedCellRef){var o=i.node,u=o.ref,s=o.qualifier,l=o.label,c=this.cellRefNode(u,s,l).ref;ne("calc.analyze.autocorrectFormula",a.kind===Et.CellRefNamePart);var d=a.parts,f=d[0],h=d[1],v=function(e,t){return pr(e,t.rhs,t.canDenoteNamedObject,t.label)};return fr(d.slice(2).reduce(v,v(vr(c,f.asWhole,f.label),h)),t,l)}if(i.resolution.kind!==le.Success&&i.resolution.reason.kind!==ns.NoOriginSheet)throw new Wp(i.resolution.reason)}return n},t.prototype.arrayNode=function(e,t,r){return t||(this.seenUnclosed=!0),Xt(e,t,r)},t.prototype.appNode=function(e,t,r,n){var a=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),fn(e)||(this.seenParen=!0),fn(e)&&t.some(pn)&&(this.seenMissingOperand=!0),Zt(e,t,a,n)},t.prototype.letNode=function(e,t,r,n,a,i){var o=this.appNodeBase(e,a,i);return a||(this.seenUnclosed=!0),this.seenParen=!0,ir(e,t,r,n,o,i)},t.prototype.lambdaNode=function(e,t,r,n,a,i){var o=this.appNodeBase(e,a,i);return a||(this.seenUnclosed=!0),this.seenParen=!0,sr(e,t,r,n,o,i)},t.prototype.parenNode=function(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,dr(e,t,r)},t.prototype.cellRefNode=function(e,t,r){var n=this.globals.config.localeInfo;return e.isBracketed&&"("===n.leftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?Sr(e,t,r):Sr(e,this.qualifyCellRef(),r)},t.prototype.fieldRefNode=function(e,t,r,n){return t.isClosed||(this.seenUnclosed=!0),br(e,t,r,n)},t.prototype.structRefNode=function(e,t,r){return t.isClosed||(this.seenUnclosed=!0),Cr(e,t,r)},t.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!Se(e))throw new Wp(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!Se(t))throw new Wp(t.reason);return xt(t.value,void 0)}},t.prototype.appNodeBase=function(e,t,r){return t||!fn(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},t.prototype.isFormulaRoot=function(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===mt.FormulaRoot},t}(ze);function Yp(e){return{checkFormula:function(t,r){return Up(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return function(e,t,r){try{var n=Bp(xp(e,t,r,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(null!==(n=a[e.label])&&void 0!==n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;return he([Object(fe.a)(Object(fe.a)({},r),{isWellFormed:void 0===n}),n])}catch(e){return ge(be(e))}}(e,t,r)},autocorrectFormula:function(t,r){return function(e,t,r){try{var n=r.spans,a=r.annotations,i=r.depthUpperBound;return he(zt(new zp(e,t,r).autocorrect(),n,a,i))}catch(e){return ge(e instanceof Wp?e.reason:be(e))}}(e,t,r)},findStaticPrecedents:function(e,t){return he(Ta([],[],Ft.All,ga.Upper))}}}(Vp=jp||(jp={})).analyzeLocalsGrid=gp,Vp.analyzeLocalsName=Sp,Vp.diagnostics=n,Vp.summarizeFormulaDiagnostics=pp,Vp.createAnalyzeGlobals=mp,Vp.createAnalyzer=Yp,function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.PreviousFormatFailure="PreviousFormatFailure"}(Hp||(Hp={}));var qp=Object(fe.a)(Object(fe.a)({},Dn),Hp);function Jp(e){return{kind:qp.NotValueString,message:e}}function Qp(e){return{kind:qp.NotFormatString,message:e}}var Xp={kind:qp.NoFormatPart};function Zp(e){return{kind:qp.TooWide,clip:e}}var $p,em,tm,rm,nm,am,im,om,um={kind:qp.DateOverflow},sm={kind:qp.FractionOverflow};function lm(){return{kind:qp.PreviousFormatFailure}}function cm(e){return e===tm.SysDate||e===tm.SysTime}function dm(e,t,r,n,a){return{kind:om.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:a}}function fm(e){return{kind:om.String,str:e}}function hm(e){return{kind:om.Blank,str:e}}function vm(e){return{kind:om.Flexible,str:e}}function pm(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function mm(e,t){return pm(e,t,nm.Center,im.All)}!function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}($p||($p={})),function(e){e.English="English",e.Lunar="Lunar"}(em||(em={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(tm||(tm={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(rm||(rm={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(nm||(nm={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(am||(am={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(im||(im={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(om||(om={}));var gm=pm,Sm=pm;function bm(e){return!Array.isArray(e.units)}function ym(e,t){return{renderWidth:e,getTextWidth:t}}function Cm(e){var t=h();return ym(e.renderWidth,(function(r){if(null!=t[r])return t[r];var n=e.getTextWidth(r);return t[r]=n,n}))}var km,Em,Am,Rm,Nm={renderWidth:1/0,getTextWidth:function(e){return e.length}};function Tm(e){for(var t="",r=0,n=e.units;r<n.length;r++){var a=n[r];switch(a.kind){case om.String:t+=a.str;break;case om.Blank:for(var i=0;i<a.str.length;i+=1)t+=" "}}return t}function Im(e){return{kind:km.Formula,fmla:e}}function Fm(e,t){return{kind:km.String,value:e,tick:t}}function Om(e,t){return{kind:km.Number,value:e,format:t}}function Dm(e){return{kind:km.Other,value:e}}function Mm(e,t){return{config:e,getTime:t}}function wm(e,t){var r=un(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:he(r.range),originSheet:he(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}!function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(km||(km={})),function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(Em||(Em={}));var _m,Lm=((Am={})[Si.ArabicIndic]={zero:1632,one:1633},Am[Si.ExtendedArabicIndic]={zero:1776,one:1777},Am[Si.Devanagari]={zero:2406,one:2407},Am[Si.Bengali]={zero:2534,one:2535},Am[Si.Gurmukhi]={zero:2662,one:2663},Am[Si.Gujarati]={zero:2790,one:2791},Am[Si.Oriya]={zero:2918,one:2919},Am[Si.Tamil]={zero:48,one:3047},Am[Si.Telugu]={zero:3174,one:3175},Am[Si.Kannada]={zero:3302,one:3303},Am[Si.Malayalam]={zero:3430,one:3431},Am[Si.Thai]={zero:3664,one:3665},Am[Si.Lao]={zero:3792,one:3793},Am[Si.Tibetan]={zero:3872,one:3873},Am[Si.Myanmar]={zero:4160,one:4161},Am[Si.Ethiopic]={zero:48,one:4969},Am[Si.Khmer]={zero:6112,one:6113},Am[Si.Mongolian]={zero:6160,one:6161},Am),Pm=((Rm={})[Si.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},Rm[Si.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},Rm[Si.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},Rm[Si.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},Rm[Si.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},Rm[Si.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},Rm[Si.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},Rm[Si.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},Rm[Si.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},Rm[Si.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},Rm[Si.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},Rm[Si.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},Rm[Si.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},Rm);function xm(e,t){if(t===Si.ASCII)return e;switch(t){case Si.ArabicIndic:case Si.ExtendedArabicIndic:case Si.Devanagari:case Si.Bengali:case Si.Gurmukhi:case Si.Gujarati:case Si.Oriya:case Si.Tamil:case Si.Telugu:case Si.Kannada:case Si.Malayalam:case Si.Thai:case Si.Lao:case Si.Tibetan:case Si.Myanmar:case Si.Ethiopic:case Si.Khmer:case Si.Mongolian:for(var r="",n=Lm[t],a=0;a<e.length;a+=1){ne("calc.numfmt.convertDigitsShape",48<=(i=e.charCodeAt(a))&&i<=57),r+=Ri(48===i?n.zero:n.one+(i-49))}return r;case Si.Unknown:return e;case Si.ChineseTrad1:case Si.ChineseTrad2:case Si.ChineseTrad3:case Si.ChineseSimp1:case Si.ChineseSimp2:case Si.ChineseSimp3:case Si.Japanese1:case Si.Japanese2:case Si.Japanese3:case Si.Korean1:case Si.Korean2:case Si.Korean3:case Si.Korean4:for(r="",n=Pm[t],a=0;a<e.length;a+=1){var i;ne("calc.numfmt.convertDigitsShape",48<=(i=e.charCodeAt(a))&&i<=57),r+=Ri(n.digits[i-48])}return r}}function Bm(e,t,r){var n=e.decimalSeparator;if(r===Si.ASCII)return he(t);switch(r){case Si.ArabicIndic:case Si.ExtendedArabicIndic:case Si.Devanagari:case Si.Bengali:case Si.Gurmukhi:case Si.Gujarati:case Si.Oriya:case Si.Tamil:case Si.Telugu:case Si.Kannada:case Si.Malayalam:case Si.Thai:case Si.Lao:case Si.Tibetan:case Si.Myanmar:case Si.Ethiopic:case Si.Khmer:case Si.Mongolian:var a=t.indexOf(n);return he(xm(t.substring(0,a<0?void 0:a),r)+(a<0?"":n)+(a<0?"":xm(t.substring(a+n.length),r)));case Si.Unknown:return he(t);case Si.ChineseTrad1:case Si.ChineseTrad2:case Si.ChineseTrad3:case Si.ChineseSimp1:case Si.ChineseSimp2:case Si.ChineseSimp3:case Si.Japanese1:case Si.Japanese2:case Si.Japanese3:case Si.Korean1:case Si.Korean2:case Si.Korean3:case Si.Korean4:return ge(Pn(["convertNumberShape: ideographic"]))}}function Um(e,t,r){if(""===t)return"";for(var n=Ti(t,0,t.length),a="",i=0,o=0;i<t.length;){var u=Fi(Ii(t,i));a+=t.substring(i,i+u),i+=u,o+=1,e.isThousandsPosition(r+(n-o))&&(a+=e.thousandsSeparator)}return a}function Gm(e,t){var r,n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:Hu[t];return ne("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function jm(e,t){var r,n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:Wu[t];return ne("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function Vm(e,t,r,n){var a="";if(r>1){var i=W(jm(e,Cu.Hash),r-1);a+=t?Um({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:jm(e,Cu.Comma)},i,1):i}return a+="0",n>0&&(a+=jm(e,Cu.Decimal),a+=W("0",n)),a}function Hm(e,t){var r="";return r+="0",t>0&&(r+=jm(e,Cu.Decimal),r+=W("0",t)),e.isPercentSepBySpace&&(r+=jm(e,Cu.Space)),r+=jm(e,Cu.Percent)}function Wm(e,t,r,n){var a="";return a+=Vm(e,!1,t,r),e.isExpSepBySpace&&(a+=jm(e,Cu.Space)),a+=jm(e,Cu.E),a+="+",a+=W("0",n)}function Km(e,t){var r=jm(e,Cu.Quote);return r+t+r}function zm(e,t){var r="";r+=jm(e,Cu.Hash);var n=e.fractionSeparator;return r+=" "===n?jm(e,Cu.Space):Km(e,n),r+=W(jm(e,Cu.Question),t),r+=jm(e,Cu.Slash),r+=W(jm(e,Cu.Question),t)}function Ym(e,t,r,n,a,i,o){void 0===o&&(o=!1);for(var u=e.isCurrencySymbolLead,s=e.currencyFormat,l=e.isCurrencySepBySpace,c=o?0:a?3:1,d=Vm(e,!0,4,r),f="",h=function(o){0!==o&&(f+=jm(e,Cu.Sep)),1===o&&t&&(f+=jm(e,Cu.ColorStart)+function(e,t){var r,n=null!==(r=e.pictureColor[t])&&void 0!==r?r:Ku[t];return ne("calc.numfmt.knownFormat: getColor",void 0!==n),n}(e,ku.Red)+jm(e,Cu.ColorEnd));var c=function(){return 2===o?function(e,t){var r="";return r+=Km(e,"-"),t>0&&(r+=W(jm(e,Cu.Question),t)),r}(e,r):3===o?jm(e,Cu.Text):d},h=function(){return 3!==o?qm(e,Cu.Star,Cu.Space):""},v=function(){return 1===o?jm(e,Cu.OpenParen):""},p=function(){return 3!==o||u?1===o?jm(e,Cu.CloseParen):qm(e,Cu.Underscore,Cu.CloseParen):""},m=function(){var t="";if(1!==o)switch(s){case mi.Intern:u||3===o||(t+=qm(e,Cu.Underscore,Cu.Minus));break;case mi.Lead:case mi.Trail:if(s===mi.Lead&&!a)break;t+=qm(e,Cu.Underscore,Cu.Minus)}else t+=jm(e,Cu.Minus);return a&&!u&&s===mi.Lead&&(t+=h()),t},g=function(){var t="";return n&&!u&&l&&(t+=jm(e,Cu.Space)),n&&(t+=null!=i?i:Gm(e,yu.Currency)),u&&l&&(t+=jm(e,Cu.Space)),t},S=function(){var e="";return 3!==o&&(u?(n&&(e+=g()),a&&(e+=h())):e+=g()),e};if(a&&(f+=function(){var t="";if(u)switch(s){case mi.Paren:t+=qm(e,Cu.Underscore,Cu.OpenParen);break;case mi.Trail:t+=qm(e,Cu.Underscore,Cu.Minus);break;case mi.Intern:t+=qm(e,Cu.Underscore,Cu.Space)}else{switch(s){case mi.Trail:t+=qm(e,Cu.Underscore,Cu.Minus);break;case mi.Paren:case mi.Intern:t+=qm(e,Cu.Underscore,Cu.Space)}s!==mi.Lead&&(t+=h())}return t}()),u)switch(s){case mi.Paren:a||(f+=v()),f+=S(),a&&(f+=v()),f+=c(),f+=p();break;case mi.Lead:f+=m(),f+=S(),f+=c();break;case mi.Intern:f+=S(),f+=m(),f+=c();break;case mi.Trail:f+=S(),f+=c(),f+=m()}else switch(s){case mi.Paren:f+=v(),f+=c(),a&&(f+=p()),f+=S(),a||(f+=p());break;case mi.Lead:f+=m(),f+=c(),f+=S();break;case mi.Intern:f+=c(),f+=m(),f+=S();break;case mi.Trail:f+=c(),f+=S(),f+=m()}a&&(f+=function(){if(u)switch(s){case mi.Lead:return qm(e,Cu.Underscore,Cu.Minus);case mi.Intern:return qm(e,Cu.Underscore,Cu.Space)}else switch(s){case mi.Lead:return qm(e,Cu.Underscore,Cu.Minus);case mi.Paren:case mi.Intern:return qm(e,Cu.Underscore,Cu.Space)}return""}())},v=0;v<=c;v+=1)h(v);return f}function qm(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:jm(e,t)})).join("")}var Jm=((_m={})[gi.MDY]=[1,0,2],_m[gi.DMY]=[0,1,2],_m[gi.YMD]=[2,1,0],_m[gi.MYD]=[1,2,0],_m[gi.DYM]=[0,2,1],_m[gi.YDM]=[2,0,1],_m);function Qm(e,t){return qm(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?Cu.Hour:"",Cu.Hour,Cu.Colon,Cu.Minute,Cu.Minute)}function Xm(e,t){return Qm(e,t)+qm(e,Cu.Colon,Cu.Second,Cu.Second)}function Zm(e){var t="";return e.isAMPMSepBySpace&&(t+=jm(e,Cu.Space)),t+=Gm(e,yu.AP1)}function $m(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,a=t||e.year4Digits,i=qm(e,a?Cu.Year:"",a?Cu.Year:"",Cu.Year,Cu.Year),o=qm(e,r?Cu.Month:"",Cu.Month),u=[qm(e,n?Cu.Day:"",Cu.Day),o,i],s=Jm[e.dateOrder],l="",c=0;c<3;c+=1)l+=u[s[c]],c<2&&(l+=jm(e,Cu.DateSep));return l}function eg(e,t,r){var n=e.day2Digits,a=e.country===Su.GER,i="/"===e.dateSeparator&&" "!==e.dateAltSeparator,o="";return t&&(o+=qm(e,n?Cu.Day:"",Cu.Day),i?o+=e.dateAltSeparator:(o+=jm(e,Cu.DateSep),a&&(o+=jm(e,Cu.Space)))),o+=qm(e,Cu.Month,Cu.Month,Cu.Month),r&&(o+=i?e.dateAltSeparator:jm(e,a?Cu.Space:Cu.DateSep),o+=qm(e,Cu.Year,Cu.Year)),o}function tg(e,t){switch(t){case yi.General:return Gm(e,yu.General);case yi.NoComFixed0:return Vm(e,!1,1,0);case yi.NoComFixed:return Vm(e,!1,1,2);case yi.Fixed0:return Vm(e,!0,4,0);case yi.Fixed:return Vm(e,!0,4,2);case yi.Currency:return Ym(e,!1,0,!0,!1);case yi.CoCurrency:return Ym(e,!0,0,!0,!1);case yi.CurrencyDec:return Ym(e,!1,2,!0,!1);case yi.CoCurrencyDec:return Ym(e,!0,2,!0,!1);case yi.Pct0:return Hm(e,0);case yi.Pct:return Hm(e,2);case yi.Exp:return Wm(e,1,2,2);case yi.Fract:return zm(e,1);case yi.FractBond:return zm(e,2);case yi.MMDDYY:return $m(e);case yi.DDMMMYY:return eg(e,!0,!0);case yi.DDMMM:return eg(e,!0,!1);case yi.MMMYY:return eg(e,!1,!0);case yi.HHMMAP:return Qm(e,!0)+Zm(e);case yi.HHMMSSAP:return Xm(e,!0)+Zm(e);case yi.HHMM:return Qm(e,!1);case yi.HHMMSS:return Xm(e,!1);case yi.MDYHMS:return qm(e,$m(e),Cu.Space,Qm(e,!1));case yi.USCoCurrency:case yi.USCoCurrencyDec:return Ym(Object(fe.a)(Object(fe.a)({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:mi.Paren}),!0,t===yi.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?Km(e,"US$"):"$");case yi.Currency2:return Ym(e,!1,0,!1,!1);case yi.CoCurrency2:return Ym(e,!0,0,!1,!1);case yi.CurrencyDec2:return Ym(e,!1,2,!1,!1);case yi.CoCurrencyDec2:return Ym(e,!0,2,!1,!1);case yi.Acct:return Ym(e,!1,0,!1,!0);case yi.AcctDec:return Ym(e,!1,2,!1,!0);case yi.AcctCur:return Ym(e,!1,0,!0,!0);case yi.AcctDecCur:return Ym(e,!1,2,!0,!0);case yi.MMSS:return qm(e,Cu.Minute,Cu.Minute,Cu.Colon,Cu.Second,Cu.Second);case yi.AbsHMMSS:return qm(e,Cu.ColorStart,Cu.Hour,Cu.ColorEnd,Cu.Colon,Cu.Minute,Cu.Minute,Cu.Colon,Cu.Second,Cu.Second);case yi.SS0:return qm(e,Cu.Minute,Cu.Minute,Cu.Colon,Cu.Second,Cu.Second,Cu.Decimal,"0");case yi.Eng:return Wm(e,3,1,1);case yi.Text:return jm(e,Cu.Text)}}function rg(e,t){switch(e){case yi.USCoCurrency:case yi.USCoCurrencyDec:return t.isEastAsia;default:return!0}}var ng,ag={0:yi.General,1:yi.NoComFixed0,2:yi.NoComFixed,3:yi.Fixed0,4:yi.Fixed,5:yi.Currency,6:yi.CoCurrency,7:yi.CurrencyDec,8:yi.CoCurrencyDec,9:yi.Pct0,10:yi.Pct,11:yi.Exp,12:yi.Fract,13:yi.FractBond,14:yi.MMDDYY,15:yi.DDMMMYY,16:yi.DDMMM,17:yi.MMMYY,18:yi.HHMMAP,19:yi.HHMMSSAP,20:yi.HHMM,21:yi.HHMMSS,22:yi.MDYHMS,37:yi.Currency2,38:yi.CoCurrency2,39:yi.CurrencyDec2,40:yi.CoCurrencyDec2,41:yi.Acct,42:yi.AcctCur,43:yi.AcctDec,44:yi.AcctDecCur,45:yi.MMSS,46:yi.AbsHMMSS,47:yi.SS0,48:yi.Eng,49:yi.Text};function ig(e,t){return qm(e,Cu.ColorStart,"$-",t,Cu.ColorEnd)}function og(e,t,r){var n,a,i=(null!==(a=null===(n=null==r?void 0:r.culture)||void 0===n?void 0:n.calendar)&&void 0!==a?a:bi.Gregorian)===bi.Gregorian;switch(t){case ng.GalleryGeneral:case ng.KeyboardGeneral:return tg(e,yi.General);case ng.GalleryNumber:return Vm(e,!1,1,e.currencyDecimals);case ng.KeyboardNumber:return Vm(e,!0,4,e.currencyDecimals);case ng.GalleryCurrency:return Ym(Object(fe.a)(Object(fe.a)({},e),{currencyFormat:e.currencyFormat===mi.Paren?mi.Lead:e.currencyFormat}),!1,e.currencyDecimals,!0,!1,void 0,!0);case ng.KeyboardCurrency:return Ym(e,!0,e.currencyDecimals,!0,!1);case ng.GalleryAccounting:case ng.ButtonAccounting:return Ym(e,!1,e.currencyDecimals,!0,!0);case ng.GalleryShortDate:return i?tg(e,yi.MMDDYY):qm(e,Cu.Month,Cu.DateSep,Cu.Day,Cu.Sep,Cu.Text);case ng.GalleryLongDate:return i?ig(e,"x-sysdate")+qm(e,Cu.Day,Cu.Day,Cu.Day,Cu.Day,", ",Cu.Month,Cu.Month,Cu.Month,Cu.Month," ",Cu.Day,Cu.Day,", ",Cu.Year,Cu.Year,Cu.Year,Cu.Year):qm(e,Cu.Month,Cu.DateSep,Cu.Day,Cu.DateSep,Cu.Year,Cu.Year,Cu.Sep,Cu.Text);case ng.GalleryTime:return ig(e,"x-systime")+qm(e,Cu.Hour,Cu.Colon,Cu.Minute,Cu.Minute,Cu.Colon,Cu.Second,Cu.Second," ")+Gm(e,yu.AP1);case ng.KeyboardDate:return ig(e,"en-US")+qm(e,Cu.Day,"-",Cu.Month,Cu.Month,Cu.Month,"-",Cu.Year,Cu.Year,Cu.Sep,Cu.Text);case ng.KeyboardTime:return ig(e,"en-US")+qm(e,Cu.Hour,Cu.Colon,Cu.Minute,Cu.Minute," ",Gm(e,yu.AP1),Cu.Sep,Cu.Text);case ng.GalleryPercentage:return Hm(e,e.currencyDecimals);case ng.ButtonPercentage:case ng.KeyboardPercentage:return tg(e,yi.Pct0);case ng.GalleryFraction:return tg(e,yi.Fract);case ng.GalleryScientific:case ng.KeyboardScientific:return Wm(e,1,e.currencyDecimals,2);case ng.GalleryText:return tg(e,yi.Text);case ng.ButtonComma:return Ym(e,!1,e.currencyDecimals,!1,!0)}}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(ng||(ng={}));var ug;function sg(e,t,r,n){if(" "!==t&&""!==t){var a="$"===t;if(e.isEastAsia){if(n<r.length&&36===r.charCodeAt(n)&&!a)return{currency:1,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?1:2,i:n+3};if((""===t&&e.isJapan||""===t&&e.isKorea)&&n<r.length&&92===r.charCodeAt(n))return{currency:0,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:2,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:0,i:n+t.length}:void 0}}function lg(e,t,r,n,a,i){var o,u=0,s=!1,l=!1,c=!1,d=e.isCurrencySymbolLead,f=e.currencySymbol;0!==a&&(d=1===a,f="");for(var h=0;h<r.length;){if(void 0===o&&d)if(void 0!==(g=sg(e,f,r,h))){o=g.currency,h=g.i;continue}switch(S=r.charCodeAt(h)){case 37:h+=1,u+=1;continue;case 32:h+=1;continue;case 40:case 45:case 43:if(h+=1,l)return he(void 0);l=!0,40===S&&(s=!0),c=43!==S;continue}break}var v=_i(e,t,r,h,!0,u>0||n,i);if(void 0===v||void 0===v.value)return he(void 0);h=v.i;for(var p,m=c?t.neg(v.value):v.value;h<r.length;){var g,S;if(void 0===o&&!d)if(void 0!==(g=sg(e,f,r,h))){o=g.currency,h=g.i;continue}switch(S=r.charCodeAt(h)){case 37:h+=1,u+=1;continue;case 32:h+=1;continue;case 41:if(h+=1,!s)return he(void 0);s=!1;continue}break}if(h!==r.length||s||u>1||void 0!==o&&u>0)return he(void 0);if(void 0!==v.format)p=v.format;else if(1===o)p=v.consumedDecimal?yi.USCoCurrencyDec:yi.USCoCurrency;else if(2===o){p=e.isChinaT?v.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':v.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(v.numShape!==Si.ASCII)return ge(Pn(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==o)switch(a){case 0:p=v.consumedDecimal?yi.CoCurrencyDec:yi.CoCurrency;break;case 1:p=Ym(Object(fe.a)(Object(fe.a)({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,v.consumedDecimal?2:0,!0,!1,"[$-x-euro2]");break;case 2:p=Ym(Object(fe.a)(Object(fe.a)({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,v.consumedDecimal?2:0,!0,!1,"[$-x-euro1]")}else p=u>0?v.consumedDecimal?yi.Pct:yi.Pct0:v.consumedThousands?v.consumedDecimal?yi.Fixed:yi.Fixed0:yi.General}return he({value:m,format:p})}function cg(e,t,r,n,a,i){if(!a)return lg(e,t,r,n,0,i);for(var o=0;o<=2;o+=1){var u=lg(e,t,r,n,o,i);if(!Se(u))return u;if(void 0!==u.value)return u;if(0===o&&r.indexOf("")<0)break}return he(void 0)}var dg={getTime:function(){return re("calc.numfmt.parseDateInternal: default getTime")}};function fg(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:dg.getTime}}function hg(e,t){return ne("calc.numfmt.monthToken",Og(e,1,12)),{kind:0,value:e,bidiDate:t}}var vg=Object(fe.f)(new Array(12)).map((function(e,t){return hg(t+1)})),pg=function(e){return vg[e]},mg=function(e){return hg(e+1,em.English)},gg=function(e){return hg(e+1,em.Lunar)},Sg=[!0,!1].map((function(e){return{kind:1,am:e}})),bg=Sg[0],yg=Sg[1],Cg=function(e){return 0===e?bg:yg};function kg(e,t,r){return ne("calc.numfmt.numberToken",j(e)&&Og(e,-9999,9999)&&Og(t,1,4)),{kind:2,value:e,digits:t,numShape:r}}var Eg=function(e){return 3===e||4===e},Ag=function(e,t){return e.lcid===bu.Hungarian&&2===t},Rg=function(e){return e<=1},Ng=function(e){return e<=2},Tg=["",""],Ig=((ug={})[Su.FRN]=[["Jun",hg(6)],["Jul",hg(7)]],ug[Su.DUT]=[["Mrt",hg(3)]],ug[Su.GER]=[["Mrz",hg(3)]],ug),Fg=["",""," "," "," "," ","","","",""," "," "];function Og(e,t,r){return e>=t&&e<=r}function Dg(e,t){var r=e.getTime(Go.Year,t);if(!Se(r))return r;var n=e.config,a=n.datepack.fromNum(n,r.value,Wo.RoundSec);return ne("calc.numfmt.parseDateInternal: current year fromNum",!1!==a),he(a.yr)}function Mg(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function wg(e,t,r,n,a,i){for(var o=t.indexOf(" ",r),u=0;u<n.length;u+=1){var s=n[u],l=k(a,s.length);if(o>=0&&s.indexOf(" ")<0&&o-r>=l&&o-r<=s.length)if(Mg(e,f=s.substring(0,o-r),t,r))return[i(u),r+f.length];for(var c=void 0,d=l;d<=s.length;d+=1){var f;if(!Mg(e,f=s.substring(0,d),t,r))break;c=r+f.length}if(void 0!==c)return[i(u),c]}}function _g(e,t,r,n,a){for(var i=0;i<n.length;i+=1){var o=n[i];if(Mg(e,o,t,r))return[a(i),r+o.length]}}function Lg(e,t,r){var n,a=Ig[e.country];if(void 0!==a)for(var i=0,o=a;i<o.length;i++){var u=o[i],s=u[0],l=u[1];if(Mg(e,s,t,r))return[l,r+s.length]}if(e.isEastAsia){if(void 0!==(n=wg(e,t,r,os().monthNameLong,3,pg)))return n}else if(e.isComplexScript){if(void 0!==(n=_g(e,t,r,e.monthNameLong,pg)))return n;if(void 0!==(n=_g(e,t,r,e.monthNameShort,pg)))return n;if(void 0!==(n=_g(e,t,r,os().monthNameLong,mg)))return n;if(void 0!==(n=_g(e,t,r,os().monthNameShort,mg)))return n}else if(void 0!==(n=wg(e,t,r,e.monthNameLong,3,pg)))return n;return(e.lcid&bu.LANG)==(bu.Arabic&bu.LANG)&&void 0!==(n=_g(e,t,r,Fg,gg))||void 0!==(n=wg(e,t,r,e.ampmSymbols,1,Cg))||void 0!==(n=wg(e,t,r,os().ampmSymbols,1,Cg))||(e.isChinaS||e.isChinaT)&&void 0!==(n=wg(e,t,r,Tg,1,Cg))?n:[void 0,r]}function Pg(e,t,r,n){var a,i,o,u,s,l=r,c=45===t.charCodeAt(l);if(c&&(l+=1),5===n){if(o=(a=Mi(e,4,l+4<t.length?t.substring(0,l+4):t,l))[0],ne("calc.numfmt.parseDateInternal: 0 < digits <= 4",Og(s=(u=a[1])-l,1,4)),4===s){for(var d=void 0;u<t.length&&e.isNumeral(d=Ii(t,u));)u+=Fi(d);o=Math.round(o/10),s=3}}else if(o=(i=Mi(e,4,t,l))[0],(s=(u=i[1])-l)>4||s>2&&o<100)return[void 0,r];if(0===s)return[void 0,r];var f=function(e,t){for(var r=Si.ASCII,n=0,a=Oi(t);n<a.length;n++){var i=a[n],o=e.getNumberShape(i);o!==Si.ASCII&&(r=o)}return r}(e,t.substring(l,u));return l=u,[kg(c?-o:o,s,f),l]}function xg(e,t,r,n){var a=0,i=r;if(32===t.charCodeAt(i))for(a=1;32===t.charCodeAt(i);)i+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&3===n&&V(t,e.timeAltSeparator,i)?(a=4,i+=e.timeAltSeparator.length):V(t,e.dateSeparator,i)?(a=2,i+=e.dateSeparator.length):V(t,e.timeSeparator,i)?(a=3,i+=e.timeSeparator.length):V(t,e.decimalSeparator,i)&&3===n?(a=5,i+=e.decimalSeparator.length):47===t.charCodeAt(i)||45===t.charCodeAt(i)?(a=2,i+=1):58===t.charCodeAt(i)?(a=3,i+=1):V(t,", ",i)&&(a=6,i+=2),1===a&&(" "===e.dateSeparator?a=2:" "===e.timeSeparator?a=3:" "===e.decimalSeparator&&3===n&&(a=5)),[a,i]}function Bg(e,t,r,n){var a=e.config,i=a.localeInfo;if(!i.isEastAsia&&!function(e,t){for(var r=0,n=Oi(t);r<n.length;r++){var a=n[r];if(e.isNumeral(a))return!0}return!1}(i,t))return he(void 0);if(i.isEastAsia)return ge(Pn(["parse East Asia date"]));if(i.isThai){var o=t.indexOf("b");if(o<0&&(o=t.indexOf("B")),o>=0&&o+1<t.length&&i.isNumeral(Ii(t,o+1)))return ge(Pn(["parse Thai Buddhist date"]))}var u=function(e,t,r){for(var n,a=e.localeInfo,i=e.dateCompatibility,o=[],u=null==r?void 0:r.bidiDate,s=Si.ASCII,l=null==r?void 0:r.culture,c=!1,d=!1,f=0;f<t.length;){if(o.length>=9)return he(void 0);var h=void 0;if(a.isNumeral(Ii(t,f))||!i&&f+1<t.length&&45===t.charCodeAt(f)&&a.isNumeral(Ii(t,f+1))){var v=Pg(a,t,f,n),p=v[0],m=v[1];if(void 0===p)return he(void 0);f=m,p.numShape!==Si.ASCII&&(s=p.numShape),h=p}else{if(32===t.charCodeAt(f))return ge(Pn(["absurd date/time string with leading space"]));var g=Lg(a,t,f),S=g[0],b=g[1];if(void 0===S)return he(void 0);if(f=b,0===S.kind){if(c)return he(void 0);c=!0,void 0!==S.bidiDate&&(u=S.bidiDate)}if(1===S.kind){if(d)return he(void 0);if(d=!0,0===o.length||1!==o[o.length-1].sep)return he(void 0);n=o[o.length-1].sep=3}h=S}var y=xg(a,t,f,n),C=y[0];for(f=y[1];f<t.length&&32===t.charCodeAt(f);)f+=1;o.push({tok:h,sep:C}),n=C}return ne("calc.numfmt.parseDateInternal: > 0 tokens",0!==o.length),he({tokens:o,bidiDate:u,numShape:s,culture:l})}(a,t,r);if(!Se(u)||void 0===u.value)return u;var s=u.value,l=s.tokens,c=s.bidiDate,d=s.numShape,f=s.culture;if(c===em.Lunar)return ge(Pn(["Lunar calendar"]));if(void 0!==f&&(f.localCalendarInput||f.tag===tm.Gannen))return ge(Pn(["parse date: possible local calendar"]));var h=function(e,t){for(var r,n,a,i,o,u,s,l=e.localeInfo,c=0;c<t.length;c+=1)if(Eg(t[c].sep)){r={start:c,end:c+1};break}if(void 0!==r){if(0!==r.start&&1!==t[r.start-1].sep&&!Ag(l,t[r.start-1].sep))return he(void 0);for(;r.end<t.length&&Eg(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&5===t[r.end-1].sep){r.end+=1;var d=t[r.end-1];if(2!==d.tok.kind)return he(void 0);d.tok;if(u=d,r.end<t.length&&Eg(t[r.end-1].sep)){if(r.end+=1,1!==(f=t[r.end-1]).tok.kind)return ge(Pn(["non-AM/PM after FracSec"]));f.tok;s=f}}else{var f;if(1===(f=t[r.end-1]).tok.kind){f.tok;s=f}}var h=r.end-r.start-(void 0!==u?1:0)-(void 0!==s?1:0);for(c=0;c<h;c+=1)if(2!==t[r.start+c].tok.kind)return ge(Pn(["non-number in H/M/S component"]));switch(h){case 0:return re("calc.numfmt.parseDateInternal: 0 time");case 1:ne("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===u),a=t[r.start];break;case 2:void 0===u?(a=t[r.start],i=t[r.start+1]):(i=t[r.start],o=t[r.start+1]);break;case 3:a=t[r.start],i=t[r.start+1],o=t[r.start+2];break;default:return he(void 0)}for(c=r.end;c<t.length;c+=1)if(Eg(t[c].sep))return he(void 0);if(r.end===t.length){var v=t[r.end-1].sep;if(!(Rg(v)||void 0!==s&&5===v))return ge(Pn(["trailing sep after time"]))}else{var p=t[r.end-1].sep;if(!Rg(p)&&6!==p)return ge(Pn(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return ge(Pn(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return he({time:r,date:n,hour:a,min:i,sec:o,fracSec:u,ampm:s})}(a,l);if(!Se(h)||void 0===h.value)return h;var v=h.value,p=v.time,m=v.date,g=v.hour,S=v.min,b=v.sec,y=v.fracSec,C=v.ampm,k=function(e,t,r,n){var a,i,o,u=e.config,s=u.localeInfo,l=u.dateCompatibility,c=u.datepack,d=!1;if(void 0!==n){var f=n.end-n.start;if(f<2||f>3)return he(void 0);var h=r[n.start],v=h.tok,p=h.sep,m=r[n.start+1],g=m.tok,S=m.sep,b=r[n.end-1],y=b.tok,C=b.sep;if(ne("calc.numfmt.parseDateInternal: all not AM/PM",1!==v.kind&&1!==g.kind&&1!==y.kind),!Rg(C)&&!Ag(s,C))return he(void 0);var k=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(0===e[r].tok.kind)return r}(r,n);if(d=k,k)if(Ng(p)&&Ng(S))if(0===v.kind){if(f>2)return he(void 0);i=v,ne("calc.numfmt.parseDateInternal: yr not Month",0!==y.kind),a=y}else{if(0!==g.kind)return he(void 0);o=v,i=g,3===f&&(ne("calc.numfmt.parseDateInternal: yr not Month",0!==y.kind),a=y)}else{if(3!==f)return he(void 0);if(Rg(S))return he(void 0);var E=s.longDateFormat?v:g,A=s.longDateFormat?g:v;if(0!==E.kind)return he(void 0);ne("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",0!==A.kind&&0!==y.kind),o=A,i=E,a=y}else if(ne("calc.numfmt.parseDateInternal: all not Month",0!==v.kind&&0!==g.kind&&0!==y.kind),2===f&&2===p)switch(d=!0,s.dateOrder){case gi.MDY:i=v,a=y;break;case gi.YMD:Og(v.value,1,12)?(i=v,o=y):(a=v,i=y);break;case gi.DMY:Og(y.value,1,12)?(o=v,i=y):(i=v,a=y);break;default:return ge(Pn(["date parse date order"]))}else{if(f<3||2!==p||2!==S)return he(void 0);switch(v.value>999||!l&&v.value>99?gi.YMD:s.dateOrder){case gi.MDY:i=v,o=g,a=y;break;case gi.YMD:a=v,i=g,o=y;break;case gi.DMY:o=v,i=g,a=y;break;default:return ge(Pn(["date parse date order"]))}}}var R=!1;if(s.dateOrder!==gi.DMY&&void 0===o&&void 0!==i&&Og(i.value,1,12)&&void 0!==a&&Og(a.value,1,31)){var N=Dg(e,t);if(!Se(N))return N;a.value<=c.daysPerMonth(i.value,N.value,l)&&(o=a,a=kg(N.value,4,Si.ASCII),R=!0)}return he({yr:a,mon:i,dom:o,useMonthName:d,usingCurrentYear:R})}(e,n,l,m);if(!Se(k)||void 0===k.value)return k;var E=k.value,A=E.yr,R=E.mon,N=E.dom,T=E.useMonthName,I=E.usingCurrentYear,F=function(e,t,r,n,a,i,o,u,s,l){var c,d,f,h,v=e.config,p=v.mathpack,m=v.datepack,g=v.dateCompatibility;if(void 0!==n||void 0!==a||void 0!==r){if(ne("calc.numfmt.parseDateInternal: dom || yr",void 0!==a||void 0!==r),ne("calc.numfmt.parseDateInternal: mon",void 0!==n),!Og(f=n.value,1,12))return he(void 0);if(void 0===r){var S=Dg(e,t);if(!Se(S))return S;d=S.value}else d=Og(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!Og(d,1900,9999))return he(void 0);if(!Og(h=null!==(c=null==a?void 0:a.value)&&void 0!==c?c:1,1,m.daysPerMonth(f,d,g)))return he(void 0)}else{var b=m.fromNum(v,p.zero,Wo.RoundSec);ne("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==b),d=b.yr,f=b.mon,h=b.dom}var y,C=0,k=0,E=0,A=0,R=Wo.RoundSec,N=0;if(void 0!==i){if(i.value<0)return ge(Pn(["negative hour"]));if(i.value>23){if(void 0!==y)return he(void 0);N=i.value,y=zo.Hour}else C=i.value}if(void 0!==o){if(o.value<0)return ge(Pn(["negative minute"]));if(o.value>59){if(void 0!==y)return he(void 0);N=o.value,y=zo.Minute}else k=o.value}if(void 0!==u){if(u.value<0)return ge(Pn(["negative second"]));if(u.value>59){if(void 0!==y)return he(void 0);N=u.value,y=zo.Second}else E=u.value}if(void 0!==s){if(s.value<0)return ge(Pn(["negative fractional second"]));ne("calc.numfmt.parseDateInternal: fracSec.digits",s.digits>=1&&s.digits<=3),R=s.digits,ne("calc.numfmt.parseDateInternal: fracSec.value",s.value<(3===R?1001:2===R?100:10)),A=s.value}if(void 0!==l){if(void 0!==y||C>12)return he(void 0);l.am?12===C&&(C=0):C<12&&(C+=12)}var T=Ko(d,f,h,C,k,E,1,A,R),I=void 0!==y?m.toNumWithDuration(v,T,y,N):m.toNum(v,T);return En(I)?he(void 0):he({value:I,duration:y})}(e,n,A,R,N,null==g?void 0:g.tok,null==S?void 0:S.tok,null==b?void 0:b.tok,null==y?void 0:y.tok,null==C?void 0:C.tok);if(!Se(F)||void 0===F.value)return F;var O=F.value,D=O.value,M=function(e,t,r,n,a,i,o,u,s,l,c,d){if(e!==Si.ASCII)return ge(Pn(["parseDateInternal ifmt for non-ASCII"]));if(o)return 4===(null==u?void 0:u.sep)?ge(Pn(["parseDateInternal ifmt for alternate time separator"])):void 0!==l?he(yi.SS0):void 0!==d?d!==zo.Hour||void 0!==c||t?he(yi.General):he(yi.AbsHMMSS):he(t?yi.MDYHMS:void 0!==c?void 0!==s?yi.HHMMSSAP:yi.HHMMAP:void 0!==s?yi.HHMMSS:yi.HHMM);if(ne("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!a)return he(yi.MMDDYY);var f=void 0!==r&&!i;return he(void 0===n?yi.MMMYY:f?yi.DDMMMYY:yi.DDMMM)}(d,void 0!==m,A,N,T,I,void 0!==p,S,b,y,C,O.duration);return Se(M)?he({value:D,format:M.value}):M}function Ug(e){var t=V(e,"'"),r=t?e.substring(1):e;return r.length>32767?ge(Jp("cell text too long")):he(Fm(Fa(r),t))}function Gg(e,t,r){return Bg(fg(e),t,r,am.ValueCell)}function jg(e,t,r){var n=e.config,a=n.localeInfo,i=n.mathpack,o=a.isEastAsia&&r.valueType===$p.Percentage&&!0,u=!1;switch(r.valueType){case $p.Number:case $p.Currency:case $p.Percentage:case $p.Fraction:case $p.Scientific:case $p.Accounting:u=!0}return cg(a,i,t,o,!0,u)}function Vg(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return qa;if(0===e.stringCompareCI(t,e.falseName))return Ja;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return Oa(r)}}(e.config.localeInfo,t);if(void 0!==n)return he(Dm(n));for(var a=0,i=r.valueType===$p.Date||r.valueType===$p.Time?[Gg,jg]:[jg,Gg];a<i.length;a++){var o=(0,i[a])(e,t,r);if(!Se(o))return o;if(void 0!==o.value){var u=o.value;return he(Om(u.value,u.format))}}return he(void 0)}function Hg(e,t){return e!==t&&(t.source===Em.Builtin&&(t.valueType===$p.General||function(e,t){return(null==e?void 0:e.valueType)!==$p.Number&&t.valueType!==$p.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t)))}var Wg=function(){function e(e,t,r){ie("calc.common.StrictArray2D",e),ie("calc.common.StrictArray2D",t);var n=r.length;n<e&&re("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var i=r[a].length;i<t&&re("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+i)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return ue("calc.common.StrictArray2D.get",e,this.rows),ue("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Yg(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var Kg,zg=function(){function e(e,t,r,n,a,i){ie("calc.common.StrictSparseArray2D",e),ie("calc.common.StrictSparseArray2D",t),ue("calc.common.StrictSparseArray2D",r,e+1),ue("calc.common.StrictSparseArray2D",n,t+1);var o=a.length;o<r&&re("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var s=a[u].length;s<n&&re("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+s)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=a,this.sparseElement=i}return e.prototype.get=function(e,t){return ue("calc.common.StrictSparseArray2D.get",e,this.rows),ue("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new qg(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),Yg=function(){function e(e,t,r){ie("calc.common.NonstrictArray2D",e),ie("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return ue("calc.common.NonstrictArray2D.get",e,this.rows),ue("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=Jg(this.rows,this.cols,this.func);return new Wg(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),qg=function(){function e(e,t,r,n,a,i){ie("calc.common.NonstrictSparseArray2D",e),ie("calc.common.NonstrictSparseArray2D",t),ue("calc.common.NonstrictSparseArray2D",r,e+1),ue("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=a,this.sparseFunc=i}return e.prototype.get=function(e,t){return ue("calc.common.NonstrictSparseArray2D.get",e,this.rows),ue("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=Jg(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new zg(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function Jg(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function Qg(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function Xg(e,t,r){return new Yg(e,t,(function(e,t){return r}))}function Zg(e){return{kind:Kg.MachineCall,machine:e}}function $g(e){return e.kind===Kg.MachineCall}!function(e){e.MachineCall="MachineCall"}(Kg||(Kg={}));var eS=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(oS(this.context,this.toDeref,!0),nS);ne("calc.runtime.ArrayMachine.next",!Nn(t)&&!An(t)),Rn(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return he(Va(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return $g(r)?ke(r.machine,this):(this.toDeref=r,Ce)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:ge(be(t))}},e.prototype.receiveResult=function(e){return Se(e)?(this.toDeref=e.value,this.next()):e},e}(),tS=Tt.Number|Tt.String|Tt.Boolean|Tt.Error|Tt.Rich|Tt.Array,rS=Tt.Number|Tt.String|Tt.Boolean|Tt.Error|Tt.Blank|Tt.Rich,nS=rS|Tt.Array;function aS(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;ee.ULS.traceTag(596120270,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Verbose,n)}function iS(e,t,r){return Va(e,t,Rn(r)?function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return Qg(r,n,void 0===a[0]?i:a[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var s=0;s<r;s+=1){u.push([]);for(var l=0;l<n;l+=1)u[s][l]=o(s,l)}return u}(r.rows,r.cols,e,t,r.opers,xa):Qg(e,t,r))}function oS(e,t,r){if(!An(t))return t;if(!xr(t.sheets))return wa;if(!r)return 1===t.ranges.length&&Ur(t.ranges[0])?e.dereferenceOper(t,It.All&~Tt.Range):e.dereferenceOper(t,Tt.Array);var n=e.dereferenceOper(t,It.All&~(Tt.Range|Tt.Array));return Rn(n)?xa:n}function uS(e){var t=function(e){return e&~(Tt.Array|Tt.Range)};return Dr(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function sS(e,t,r,n,a){switch(n.kind){case Tt.Missing:case Tt.Blank:return Xg(t,r,e.zero);case Tt.Array:return 0!=(a&Tt.Array)?Xg(t,r,n):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?Xg(e,t,r.get(0,0)):1===r.rows?new Yg(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new Yg(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new Yg(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(t,r,new Wg(n.rows,n.cols,n.opers),xa);case Tt.Range:default:return Xg(t,r,n)}}function lS(e,t,r,n){for(var a=0,i=0,o=0;o<n.length;o+=1){var u=n[o];Rn(u)&&0==(gn(t,o,n.length)&Tt.Array)?(a=E(a,u.rows),i=E(i,u.cols)):(a=E(a,1),i=E(i,1))}var s=n.map((function(r,n,o){return sS(e.mathpack,a,i,r,gn(t,n,o.length))}));return Zg(new eS(e,a,i,(function(e,t){return r(s.map((function(r){return r.get(e,t)})))})))}function cS(e){return function(t,r){return e(t)(r[0])}}function dS(e){return function(t,r){return e(t)(r[0],r[1])}}var fS=function(e){return yn(e)?e:re("calc.funcs.assertNumber")},hS=function(e){return Cn(e)?e:re("calc.funcs.assertString")},vS=Fa("");function pS(e){return Cn(e)&&""===e.value}function mS(e,t){var r=oS(e,t,!1),n=In(r)?r.getFallback():r;switch(n.kind){case Tt.Number:return n;case Tt.Boolean:return wa;case Tt.String:var a=e.coerceOper(n,Tt.Number);return yn(a)?a:wa;case Tt.Error:return n;case Tt.Array:return wa;case Tt.Missing:return xa;case Tt.Blank:return e.mathpack.zero;default:return te("calc.funcs.chkNumOper",n)}}function gS(e,t){var r=mS(e,t);if(En(r))return r;var n=e.mathpack;return n.cond(r)<0?Pa:SS(e,r=n.floor(r))?(e.config.date1904&&!Cn(t)&&(r=n.add(n.fromNumber(1462),r)),r):Pa}function SS(e,t){var r,n,a=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),a>=r&&a<=n}function bS(e,t,r){var n=e.div(t,r);if(En(n))return n;var a=e.mul(e.trunc(n),r);if(En(a))return a;var i=e.sub(t,a);return!En(i)&&e.cond(t)<0?e.abs(i):i}function yS(e,t){switch(e){case Qa.Eq:return 0===t;case Qa.Ne:return 0!==t;case Qa.Lt:return t<0;case Qa.Gt:return t>0;case Qa.Le:return t<=0;case Qa.Ge:return t>=0}}function CS(e,t,r){return yS(e,t.value-r.value)}function kS(e,t,r,n){return yS(t,e.stringCompareCI(r.value,n.value))}function ES(e,t,r,n){return yS(t,e.compare(r,n))}function AS(e,t,r){if(xr(t.sheets))if(xr(r.sheets))if(Zr(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return la(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+D(t)+", range2 = "+D(r);aS(e,Na.VALUE,n)}else{var n="different document, range1 = "+D(t)+", range2 = "+D(r);aS(e,Na.VALUE,n)}else aS(e,Na.VALUE,"3D reference, range2 = "+D(r));else aS(e,Na.VALUE,"3D reference, range1 = "+D(t))}function RS(e,t,r,n){void 0===n&&(n=!1);var a,i,o,u=e.config.mathpack;if(1===r.length){var s=r[0];switch(t){case Qa.Percent:return u.percent(s);case Qa.Neg:return u.neg(s);case Qa.Pos:return s;default:var l="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return ee.ULS.assertTag(593372496,I.LogCategory.msoulscat_ES_EWAJS,!1,l)}}if(2===r.length){s=r[0];var c=r[1];switch(t){case Qa.Add:var d=u.add(s,c);return n&&yn(d)?u.checkAlmostCancellation(s,d):d;case Qa.Sub:d=u.sub(s,c);return n&&yn(d)?u.checkAlmostCancellation(s,d):d;case Qa.Mul:return u.mul(s,c);case Qa.Div:return u.div(s,c);case Qa.Pow:return u.power(s,c);case Qa.Concat:return Fa((s.value+c.value).substring(0,32767));case Qa.Eq:case Qa.Ne:case Qa.Lt:case Qa.Le:case Qa.Gt:case Qa.Ge:return Ia(function(e,t,r,n){var a=e.config,i=a.localeInfo,o=a.mathpack;if(r.kind!==n.kind){if(Tn(r))switch(n.kind){case Tt.Number:return ES(o,t,o.zero,n);case Tt.String:return kS(i,t,vS,n);case Tt.Boolean:return CS(t,Ja,n)}if(Tn(n))switch(r.kind){case Tt.Number:return ES(o,t,r,o.zero);case Tt.String:return kS(i,t,r,vS);case Tt.Boolean:return CS(t,r,Ja)}return yS(t,r.kind-n.kind)}switch(r.kind){case Tt.Number:return ES(o,t,r,n);case Tt.String:return kS(i,t,r,n);case Tt.Boolean:return CS(t,r,n);case Tt.Blank:return yS(t,0);default:return!1}}(e,t,s,c));case Qa.Range:return null==(o=AS("calc.runtime.applyRangeOp",a=s,i=c))?wa:Ha(o,[Hr(Kr(a.ranges),Kr(i.ranges))]);case Qa.Isect:return function(e,t){var r=AS("calc.runtime.applyIsectOp",e,t);if(null==r)return wa;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var i=0;i<t.ranges.length;i+=1){var o=zr(e.ranges[a],t.ranges[i]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+D(e)+", range2 = "+D(t);return aS("calc.runtime.applyIsectOp",Na.NULL,u),Da}return Ha(r,n)}(s,c);case Qa.Union:return function(e,t){var r=AS("calc.runtime.applyUnionOp",e,t);return null==r?wa:Ha(r,e.ranges.concat(t.ranges))}(s,c);case Qa.And:return Ia(s.value&&c.value);case Qa.Or:return Ia(s.value||c.value);case Qa.Xor:return Ia(s.value!==c.value);case Qa.Min:return u.cond2(s,c)<=0?s:c;case Qa.Max:return u.cond2(s,c)>=0?s:c;default:var f="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return ee.ULS.assertTag(593372497,I.LogCategory.msoulscat_ES_EWAJS,!1,f)}}var h="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return ee.ULS.assertTag(593372498,I.LogCategory.msoulscat_ES_EWAJS,!1,h)}var NS=function(e){return e.kind!==om.General},TS=function(e){return e.kind!==om.Flexible};function IS(e,t,r){return 0!=(t&im.MaxChars)&&r.length>255?im.MaxChars:0!=(t&im.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?im.CellWidth:void 0}function FS(e,t,r,n,a,i){var o=E(0,255-r.length-n.length),u=0===a.length?o:Math.floor(o/a.length);if(e.renderWidth!==1/0){var s=e.getTextWidth(a);s>0&&(u=k(u,E(Math.floor((e.renderWidth-e.getTextWidth(r+n))/s),0)))}var l,c=i(u);if(!1===c||void 0===(l=IS(e,t,r+c+n))){for(var d=c,f=u+1;f<u+50;f+=1){if(!1!==(v=i(f))){if(v===d)break;if(void 0!==(p=IS(e,t,r+v+n))){!1===d&&(d=p);break}d=v}}return ne("calc.numfmt.renderValue: false after upwards search",!1!==d),d}var h=l;for(f=u-1;f>=0;f-=1){var v,p;if(!1===(v=i(f)))break;if(void 0===(p=IS(e,t,r+v+n)))return v;h=p}return h}var OS,DS=Un("RenderHashesError"),MS=Un("RenderError");function wS(e,t,r){var n=e.fromNumber(t.num),a=t.includeSign&&e.cond(n)<0?"-":"",i=a+e.formatGeneral(t,e.abs(n),r-a.length);if("-0"===i&&(i="0"),i.length>r)return he(!1);var o=i.indexOf("E");if(o>=0){var u=Bm(t,i.substring(0,o),t.expNumberShape);if(!Se(u))return u;var s=i.substring(o,o+2),l=xm(i.substring(o+2),t.expNumberShape);return ne("calc.numfmt.render: formatGeneral ePart","E-"===s||"E+"===s),he(u.value+s+l)}var c=Bm(t,i,t.numberShape);return Se(c)?he(c.value):c}function _S(e,t,r){try{return bm(t)?he(mm(t.units,t.color)):he(function(e,t,r){var n,a,i=t.units,o=t.color,u=t.alignment,s=t.clip,l=Cm(r);if(i.every(NS))n=i;else if(l.renderWidth===1/0)n=i.map((function(t){if(t.kind!==om.General)return t;var r=wS(e,t,11);if(!Se(r))throw new MS(r.reason);return ne("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),fm(r.value)}));else{for(var c="",d="",f=void 0,h=void 0,v=0;v<i.length;v+=1){var p=i[v];switch(p.kind){case om.String:case om.Blank:void 0!==f?d+=p.str:c+=p.str;break;case om.General:ne("calc.numfmt.renderValue: expected a single General unit",void 0===f),f=v,h=p;break;case om.Flexible:}}ne("calc.numfmt.renderValue: genUnit",void 0!==f&&void 0!==h);var m=h,g=FS(l,s,c,d,"0",(function(t){var r=wS(e,m,k(t,11));if(!Se(r))throw new MS(r.reason);return r.value}));if("number"==typeof g)throw new DS(Zp(g));n=i.map((function(e){return e.kind===om.General?fm(g):e}))}if(n.every(TS))a=n;else if(l.renderWidth===1/0)a=n.filter(TS);else{c="",d="";var S,b=void 0;for(v=0;v<n.length;v+=1){var y=n[v];switch(y.kind){case om.String:case om.Blank:void 0!==S?d+=y.str:c+=y.str;break;case om.Flexible:S=v,b=y}}ne("calc.numfmt.renderValue: lastFlexUnit",void 0!==S&&void 0!==b);var C=b,A=FS(l,im.All,c,d,b.str,(function(e){return W(C.str,e)}));if("number"==typeof A){if(0!=(A&s))throw new DS(Zp(A));A=""}var R=A.length/C.str.length;R=E(R-1,0);var N=W(C.str,R);a=n.map((function(e,t){return e.kind!==om.Flexible?e:fm(t===S?N:"")}))}if(s!==im.None){var T="";for(v=0;v<a.length;v+=1)T+=a[v].str;var I=IS(l,s,T);if(void 0!==I)throw new DS(Zp(I))}return Sm(a,o,u,s)}(e,t,r))}catch(e){return e instanceof DS?he(mm(e.reason,t.color)):ge(e instanceof MS?e.reason:be(e))}}var LS,PS={ar:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","s."],["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],["a. m.","p. m."],"z"],fr:[["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["sijeanj","veljaa","oujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","et","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","etvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sn","mn","tis","ons","tor","fre","lr"],["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","luned","marted","mercoled","gioved","venerd","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sm."],["duminic","luni","mari","miercuri","joi","vineri","smbt"],["a.m.","p.m."],"z"],ru:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","et","pet","sub"],["nedelja","ponedeljak","utorak","sreda","etvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","'",""],"en","z"],bg:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","nor","bezen","duben","kvten","erven","ervenec","srpen","z","jen","listopad","prosinec"],["ne","po","t","st","t","p","so"],["nedle","pondl","ter","steda","tvrtek","ptek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["s","ma","ti","on","to","fr","l"],["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],"sv","z"],el:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],et:[["jaan","veebr","mrts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","mrts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["phapev","esmaspev","teisipev","kolmapev","neljapev","reede","laupev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kes","hein","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],hu:[["jan.","febr.","mrc.","pr.","mj.","jn.","jl.","aug.","szept.","okt.","nov.","dec."],["janur","februr","mrcius","prilis","mjus","jnius","jlius","augusztus","szeptember","oktber","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasrnap","htf","kedd","szerda","cstrtk","pntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"j"],ko:["ja",["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","bir.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegu","birelis","liepa","rugpjtis","rugsjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","t"],["sekmadienis","pirmadienis","antradienis","treiadienis","ketvirtadienis","penktadienis","etadienis"],["priepiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jn.","jl.","aug.","sept.","okt.","nov.","dec."],["janvris","februris","marts","aprlis","maijs","jnijs","jlijs","augusts","septembris","oktobris","novembris","decembris"],["svtd.","pirmd.","otrd.","tred.","ceturtd.","piektd.","sestd."],["svtdiena","pirmdiena","otrdiena","trediena","ceturtdiena","piektdiena","sestdiena"],["priekp.","pcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["sn","man","tir","ons","tor","fre","lr"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],["niedz.","pon.","wt.","r.","czw.","pt.","sob."],["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sb"],["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"],"en","z"],sk:["ja",["janur","februr","marec","aprl","mj","jn","jl","august","september","oktber","november","december"],["ne","po","ut","st","t","pi","so"],["nedea","pondelok","utorok","streda","tvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","et.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","etrtek","petek","sobota"],["dop.","pop."],"z"],th:[["..","..","..","..","..","..","..","..","..","..","..",".."],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],"en","z"],tr:[["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],["Paz","Pzt","Sal","ar","Per","Cum","Cmt"],["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],["","S"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Thang Ging","Thang Hai","Thang Ba","Thang T","Thang Nm","Thang Sau","Thang Bay","Thang Tam","Thang Chin","Thang Mi","Thang Mi Mt","Thang Mi Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chu Nht","Th Hai","Th Ba","Th T","Th Nm","Th Sau","Th Bay"],["SA","CH"],"z"],ta:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],syr:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],[".","."],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],dv:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],hi:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],["",""],"z"],"ar-SA":"ar","ar-IQ":[["","","","","","","","","","","",""],["","","","","","","","","","","",""],"ar","ar","ar","z"],"ar-DZ":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mi.","jue.","vie.","sb."],"es",["a.m.","p.m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mi","jue","vie","sb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fv.","mar.","avr.","mai","jui.","juil.","aot","sept.","oct.","nov.","dc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["","","","","","",""],"zh","zh","s"],"zh-SG":[["","","","","","","","","","","",""],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jn","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jnner","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","S"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[[".",".","",".","","","",".",".",".",".","."],["","","","","","","","","","","",""],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","et.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["","","","","","","","","","","",""],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["","","","","","","","","","","",""],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi"};function xS(e){var t=e.culture,r=e.tag;if("number"!=typeof t){var n=t;return void 0!==r&&(""!==t&&(n+="-"),n+="x-"+String(r)),void 0===LS&&(LS=function(){for(var e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],r=0,n=Object.keys(PS);r<n.length;r++){var a=n[r],i=PS[a];if("string"!=typeof i){var o=i.slice(0,5).map((function(r,n){if("string"==typeof r){var a=e[r];return ne("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==a),a[t[n]]}return r})),u=o[0],s=o[1],l=o[2],c=o[3],d=o[4],f=i[5],h="k"===f,v="j"===f,p="t"===f,m="s"===f,g=h||v||p||m;e[a]={monthNameShort:u,monthNameLong:s,dayNameShort:l,dayNameLong:c,ampmSymbols:d,isEastAsia:g,isKorea:h,isJapan:v,isChinaT:p,isChinaS:m}}else{var S=e[i];ne("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==S),e[a]=S}}return e}()),LS[n]}}var BS,US,GS,jS,VS,HS,WS,KS,zS,YS,qS=((OS={})[bu.USA]="en-US",OS[bu.Greek]="el-GR",OS[bu.Hungarian]="hu-HU",OS[bu.Turkish]="tr-TR",OS[bu.Thailand]="th-TH",OS[bu.Vietnam]="vi-VN",OS[bu.Arabic]="ar-SA",OS[bu.Hebrew]="he-IL",OS[bu.Tamil]="ta-IN",OS[bu.Syriac]="syr-SY",OS[bu.Iraq]="ar-IQ",OS[bu.Algerian]="ar-DZ",OS[bu.Basque]="eu-ES",OS[bu.PortBrazil]="pt-BR",OS[bu.Croatian]="hr-HR",OS[bu.Czech]="cs-CZ",OS[bu.Danish]="da-DK",OS[bu.Dutch]="nl-NL",OS[bu.Australian]="en-AU",OS[bu.CanadianEnglish]="en-CA",OS[bu.British]="en-GB",OS[bu.Finnish]="fi-FI",OS[bu.French]="fr-FR",OS[bu.FrenchCanadian]="fr-CA",OS[bu.Italian]="it-IT",OS[bu.NorskBokmal]="nb-NO",OS[bu.NorskNynorsk]="nn-NO",OS[bu.Polish]="pl-PL",OS[bu.PortIberian]="pt-PT",OS[bu.Romanian]="ro-RO",OS[bu.Russian]="ru-RU",OS[bu.Ukrainian]="uk-UA",OS[bu.Belarusian]="be-BY",OS[bu.SerbianCyrillic]="sr-Cyrl-CS",OS[bu.SerbianLatin]="sr-Latn-CS",OS[bu.Slovak]="sk-SK",OS[bu.Slovenian]="sl-SI",OS[bu.SpanishModern]="es-ES",OS[bu.Swedish]="sv-SE",OS[bu.HongKong]="zh-HK",OS[bu.ChinaT]="zh-TW",OS[bu.Korea]="ko-KR",OS[bu.Japan]="ja-JP",OS[bu.China]="zh-CN",OS[bu.Devihi]="dv-MV",OS[bu.Hindi]="hi-IN",OS[bu.German]="de-DE",OS[bu.Swiss]="fr-CH",OS);var JS={decimalSeparator:"NOTUSED"};function QS(e,t,r,n){var a=e.formatFixed(t,0,0),i=a.mantissa,o=a.exponent;ne("calc.numfmt.dtrInteger: mantissa len <= exponent",i.length<=o),ne("calc.numfmt.dtrInteger: mantissa || !exponent",0!==i.length||0===o);var u=xm(o<r?W("0",r-o):"",n),s=Bm(JS,i+W("0",o-i.length),n);if(!Se(s))throw new wb(s.reason);return u+s.value}function XS(e,t,r,n,a){var i=e.formatFixed(t,0,0),o=i.mantissa,u=i.exponent;return ne("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=u),ne("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===u),xm(((u<r?W("0",r-u):"")+o+W("0",u-o.length)).substring(0,n),a)}function ZS(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,a=r.exponent;return ne("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=a),ne("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===a),""===n?"0":n.length<a?n+W("0",a-n.length):n}function $S(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];switch(n.kind){case om.Blank:case om.String:for(var a=n.str;r+1<e.length;){var i=e[r+1];if(i.kind!==n.kind)break;a+=i.str,r+=1}t.push({kind:n.kind,str:a});break;case om.Flexible:case om.General:t.push(n)}}return t}var eb,tb=function(e){return e.kind===om.Flexible},rb=((BS={})[1]=Si.ChineseTrad1,BS[2]=Si.ChineseTrad2,BS[3]=Si.ChineseTrad3,BS),nb=((US={})[1]=Si.ChineseSimp1,US[2]=Si.ChineseSimp2,US[3]=Si.ChineseSimp3,US),ab=((GS={})[1]=Si.Japanese1,GS[2]=Si.Japanese2,GS[3]=Si.Japanese3,GS),ib=((jS={})[1]=Si.Korean1,jS[2]=Si.Korean2,jS[3]=Si.Korean3,jS[4]=Si.Korean4,jS);function ob(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(eb||(eb={}));var ub,sb=Y(((VS={})[eb.Ne]="<>",VS[eb.Le]="<=",VS[eb.Ge]=">=",VS[eb.Eq]="=",VS[eb.Lt]="<",VS[eb.Gt]=">",VS)),lb=((HS={})[eb.Ne]=Qa.Ne,HS[eb.Le]=Qa.Le,HS[eb.Ge]=Qa.Ge,HS[eb.Eq]=Qa.Eq,HS[eb.Lt]=Qa.Lt,HS[eb.Gt]=Qa.Gt,HS),cb=((WS={})[Qa.Ne]=eb.Ne,WS[Qa.Le]=eb.Le,WS[Qa.Ge]=eb.Ge,WS[Qa.Eq]=eb.Eq,WS[Qa.Lt]=eb.Lt,WS[Qa.Gt]=eb.Gt,WS);function db(e,t,r,n){for(var a in t){var i=t[a];if(null!=i&&!(n+i.length>r.length)){var o=r.substring(n,n+i.length);if(0===e.stringCompareCI(i,o))return Number(a)}}}function fb(e,t,r,n){for(var a in t){var i=t[a];if(null!=i&&V(r,i,n))return Number(a)}return db(e,t,r,n)}function hb(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}function vb(e,t){var r=t.indexOf(hb(e.pictureSingle,Cu.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(ub||(ub={}));var pb=/^[0-9A-F]{1,8}$/i,mb=/^(?:([a-z]{2,}(?:-[A-Z0-9]{2,}(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,gb=Y(((KS={})[1]=Si.ASCII,KS[2]=Si.ArabicIndic,KS[3]=Si.ExtendedArabicIndic,KS[4]=Si.Devanagari,KS[5]=Si.Bengali,KS[6]=Si.Gurmukhi,KS[7]=Si.Gujarati,KS[8]=Si.Oriya,KS[9]=Si.Tamil,KS[10]=Si.Telugu,KS[11]=Si.Kannada,KS[12]=Si.Malayalam,KS[13]=Si.Thai,KS[14]=Si.Lao,KS[15]=Si.Tibetan,KS[16]=Si.Myanmar,KS[17]=Si.Ethiopic,KS[18]=Si.Khmer,KS[19]=Si.Mongolian,KS[27]=Si.Japanese1,KS[28]=Si.Japanese2,KS[29]=Si.Japanese3,KS[30]=Si.ChineseSimp1,KS[31]=Si.ChineseSimp2,KS[32]=Si.ChineseSimp3,KS[33]=Si.ChineseTrad1,KS[34]=Si.ChineseTrad2,KS[35]=Si.ChineseTrad3,KS[36]=Si.Korean1,KS[37]=Si.Korean2,KS[38]=Si.Korean3,KS[39]=Si.Korean4,KS)),Sb=Y(((zS={})[1]=bi.Gregorian,zS[2]=bi.GregorianUS,zS[3]=bi.Japan,zS[4]=bi.Taiwan,zS[5]=bi.Korea,zS[6]=bi.Hijri,zS[7]=bi.Thai,zS[8]=bi.Hebrew,zS[9]=bi.GregorianMEFrench,zS[10]=bi.GregorianArabic,zS[11]=bi.GregorianXlitEnglish,zS[12]=bi.GregorianXlitFrench,zS)),bb=Object.keys(tm).reduce((function(e,t){var r=tm[t];return e[String(r)]=r,e}),Object.create(null));function yb(e){return e.toString(16).toUpperCase()}function Cb(e){return Number("0x"+e)}var kb=((YS={})[Cu.Hour]=zo.Hour,YS[Cu.HourTh]=zo.Hour,YS[Cu.Minute]=zo.Minute,YS[Cu.MinuteTh]=zo.Minute,YS[Cu.Second]=zo.Second,YS[Cu.SecondTh]=zo.Second,YS);function Eb(e){return 400===e.kind?e.formattedStr:void 0}var Ab={kind:ub.General};function Rb(e){return 1===e.length&&e[0].kind===ub.General}var Nb={code:[Ab],color:void 0,dbnum:void 0,dtrRounding:Wo.RoundSec};function Tb(e){return void 0===e.color&&void 0===e.dbnum&&Rb(e.code)}function Ib(e){return void 0===e.color&&void 0===e.dbnum&&(1===(t=e.code).length&&t[0].kind===Cu.Text);var t}var Fb,Ob,Db={},Mb=Un("ApplyHashesError"),wb=Un("ApplyError"),_b=Un("InitError"),Lb=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],void 0===t.old?(this.logFormatString=G(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=Em.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!0,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return he(this.applyImpl(e,t,r,n))}catch(e){return ge(e instanceof wb?e.reason:be(J(e,"(while applying format "+this.logFormatString+")")))}},e.prototype.applyImpl=function(e,t,r,n){var a,i=this.config,o=i.mathpack,u=i.localeInfo;if(this.formatString===hb(u.pictureSpecial,yu.General)){var s=void 0;if(Cn(e))return gm([fm(e.value)],s,t,r);if(!n&&0===o.cond(e))return gm([],s,t,r);var l=dm(o.toNumber(e),u.decimalSeparator,!0,Si.ASCII,Si.ASCII);return gm([l],s,t,r)}for(var c=!1;;){var d=void 0;try{var f=void 0,h=!1,v=[];if(Cn(e))f=3;else{var p=o.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(f=(a=this.getPart(e)).partKind,h=a.forceNeg):f=p<0?1:p>0?0:2,p<0&&(this.onlyOneNumberPart||h)&&v.push(fm("-"))}s=(d=this.parts[f]).color;var m=d.dbnum,g=d.code,S=d.dtrRounding;if(!n&&2===f&&d===this.parts[0]&&!c)return gm([],s,t,r);var b=this.getNumShape(m);this.applyPart({dtrRounding:S,dbnum:m,forceNeg:h,units:v,numShape:b},g,e,void 0);var y=r|(3!==f||Tb(d)||Ib(d)?im.None:im.MaxChars),C=v.some(tb)?nm.Left:t;return gm($S(v),s,C,y)}catch(t){if(t===Db){ne("calc.numfmt.NumberFormatImpl: applyImpl restart",!Cn(e)&&0!==o.cond(e)),e=o.zero,c=!0;continue}if(t instanceof Mb)return mm(t.reason,null==d?void 0:d.color);throw t}}},e.prototype.applyPart=function(e,t,r,n){for(var a,i,o,u,s=this,l=this.config,c=l.mathpack,d=l.datepack,f=l.localeInfo,h=function(){var t,n;if(void 0!==u)return u;ne("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!Cn(r));var a=s.config,i=a.date1904,o=a.dateCompatibility;if(!o&&c.cond(r)<0)throw new Mb(um);if(o&&!i&&c.cond(r)<0)throw new Mb(um);var l=d.fromNum(s.config,c.abs(r),e.dtrRounding);if(!1===l)throw new Mb(um);var f=null!==(n=null===(t=s.applyCurrCode)||void 0===t?void 0:t.calendar)&&void 0!==n?n:bi.Gregorian;if(f!==bi.Gregorian)throw new wb(Pn(["calendar: "+f]));return ne("calc.numfmt.NumberFormatImpl: components within range",l.yr>=0&&l.mon>=1&&l.mon<=12&&l.dom>=0&&l.dom<=31&&l.hour>=0&&l.hour<=23&&l.min>=0&&l.min<=59&&l.sec>=0&&l.sec<=59&&l.fracSec>=0&&l.wdy>=1&&l.wdy<=7),u=l},v=function(){if(void 0!==u)throw new wb(Pn(["use of value after date component"]));return r},p=!1,m=e.numShape,g=e.units,S=0;S<t.length;S+=1){var b=t[S];switch(b.kind){case ub.General:p=!0;var y=v();if(Cn(y))g.push(fm(y.value));else{var C=c.abs(y);if(c.cond(y)<0&&"0"===c.formatGeneral(f,C,1))throw new wb(Pn(["potential LRestart in interval (-0.5,0)"]));var E=dm(c.toNumber(C),f.decimalSeparator,!1,m,this.getNumShape(void 0));if(void 0!==e.dbnum){var A=wS(c,E,255);if(!Se(A))throw new wb(A.reason);ne("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==A.value),g.push(fm(A.value));break}g.push(E)}break;case Cu.Text:var R=v();ne("calc.numfmt.NumberFormatImpl: applyPart Text value",Cn(R)),g.push(fm(R.value));break;case ub.Exp:case Cu.Slash:case 400:g.push(fm(b.formattedStr));break;case Cu.Star:g.push(vm(b.escaped));break;case Cu.Underscore:g.push(hm(b.escaped));break;case ub.StrLit:g.push(fm(b.escaped));break;case Cu.Percent:case ub.Numeral:g.push(fm(b.formattedStr));break;case ub.Currency:g.push(fm(f.currencySymbol));break;case ub.CurrCode:var N=b.currencySymbol,T=b.currCode;ne("calc.numfmt.NumberFormatImpl: applyPart system tag",!cm(null==T?void 0:T.tag)),void 0!==N&&g.push(fm(N));break;case 405:g.push(fm(f.dateSeparator));break;case 406:b.printAsTimeSep?g.push(fm(f.timeSeparator)):g.push(fm(b.formattedStr));break;case 403:var I=v();ne("calc.numfmt.NumberFormatImpl: applyPart Num value",!Cn(I)),ne("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);var F=b.numDigLeft,O=b.numDigDec,D=2*(K=b.numPercent)-3*(z=b.numThousands),M=c.formatFixed(I,D,O),w=M.mantissa,_=M.exponent;if(ne("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==w.length||0===_),ne("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",w.length<=_+O),c.cond(I)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===w.length)throw Db;this.applyPart(e,b.codeBefore,c.zero,void 0),this.applyPart(e,b.code,c.zero,{comma:b.comma,fractionDenom:!1,decimal:!1,digits:w,digitsExp:_,numDigLeft:F});break;case 402:var L=v();ne("calc.numfmt.NumberFormatImpl: applyPart Exp value",!Cn(L)),ne("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);var P=b.numMantDigLeft,x=b.numMantDigDec,B=0===P&&0===x,U=c.formatScientific(L,P,x);w=U.mantissa,_=U.exponent;ne("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==w.length||0===_||B);var G=qs(_,P);ne("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",w.length<=G+x),this.applyPart(e,b.codeMant,c.zero,{comma:b.commaMant,fractionDenom:!1,decimal:!1,digits:w,digitsExp:G,numDigLeft:b.numMantDigLeft}),this.applyPart(e,b.codeBetween,c.zero,void 0);var j=""!==w||B?_-G:0;j<0?g.push(fm("-")):b.isNeg||g.push(fm("+"));var V=ZS(c,c.fromNumber(j));this.applyPart(e,b.codeExp,c.zero,{comma:b.commaMant,fractionDenom:!1,decimal:!1,digits:V,digitsExp:V.length,numDigLeft:b.numExpDigLeft});break;case 401:var H=v();ne("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!Cn(H)),ne("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);var K=b.numPercent,z=b.numThousands,Y=b.numIntDigLeft,q=b.numNumerDig,J=b.numDenomDig,Q=b.commaInt,X=b.denomValue,Z=(D=2*K-3*z,c.tenTo(D)),$=En(Z)?Z:c.mul(c.abs(H),Z);if(En($))throw new wb(Pn(["overflow on fraction exp adjust"]));var ee=function(e){for(var t=e;t<g.length;t+=1){var r=g[t];r.kind===om.String&&(g[t]=hm(r.str))}},re=b.anyZeroNumer,ae=void 0,ie=void 0,oe=void 0;if(void 0!==b.codeInt){var ue=c.trunc($),se=c.sub($,ue);if(ne("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",yn(se)),ae=(a=this.formFraction(se,X,J)).numer,ie=a.denom,ne("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",c.cond2(ae,ie)<=0),0===c.cond2(ae,ie)){ae=c.zero;var le=c.add(ue,c.one);ne("calc.numfmt.NumberFormatImpl: applyPart bumped error",yn(le)),ue=le}0!==c.cond(ae)&&(re=!0);var ce=ZS(c,ue),de={comma:Q,fractionDenom:!1,decimal:!1,digits:ce,digitsExp:ce.length,numDigLeft:Y},fe=g.length;this.applyPart(e,b.codeInt,c.zero,de),oe=g.length,ne("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==b.lastDigInt),0!==c.cond(ue)||!re||b.lastDigInt===Cu.Zero?this.applyPart(e,b.codeBetween1,c.zero,void 0):(b.lastDigInt!==Cu.Question&&(g.length=fe),this.applyPart(e,b.codeBetween1,c.zero,void 0),ee(fe),b.firstDigNumer!==Cu.Question&&(g.length=fe))}else{if(ae=(i=this.formFraction($,X,J)).numer,ie=i.denom,c.cond(H)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===c.cond(ae))throw Db;re=!0,oe=g.length}var he=ZS(c,ae),ve={comma:!1,fractionDenom:!1,decimal:!1,digits:he,digitsExp:he.length,numDigLeft:q};this.applyPart(e,b.codeNumer,c.zero,ve),this.applyPart(e,b.codeBetween2,c.zero,void 0);var pe=ZS(c,ie),me={comma:!1,fractionDenom:!0,decimal:ve.decimal,digits:pe,digitsExp:pe.length,numDigLeft:J};this.applyPart(e,b.codeDenom,c.zero,me),re||(b.anyQuestionNumer||b.firstDigDenom===Cu.Question?ee(oe):g.length=oe);break;case Cu.Decimal:ne("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,g.push(fm(f.decimalSeparator));break;case Cu.Hash:case Cu.Zero:case Cu.Question:ne("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);var ge=b.count;if(n.decimal||n.fractionDenom&&b.kind===Cu.Question){if(n.fractionDenom&&S!==t.length-1)throw new wb(Pn(["left-align bug in denominator"]));if(n.digitsExp<0){var be=xm(W("0",Ce=k(ge,-n.digitsExp)),m);g.push(fm(be)),n.digitsExp+=Ce,ge-=Ce}var ye=k(ge,n.digits.length);be=xm(n.digits.substring(0,ye),m);if(g.push(fm(be)),n.digits=n.digits.substring(ye),ge-=ye,b.kind!==Cu.Hash&&ge>0){be=xm(W("0",ge),m);g.push(b.kind===Cu.Question?hm(be):fm(be))}break}if(n.numDigLeft>n.digitsExp){var Ce=k(ge,n.numDigLeft-n.digitsExp);if(b.kind!==Cu.Hash){be=xm(W("0",Ce),m);n.comma&&(be=Um(f,be,n.numDigLeft-Ce)),g.push(b.kind===Cu.Question?hm(be):fm(be))}ge-=Ce,n.numDigLeft-=Ce}else ge+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,ge);break;case ub.PrefixDigTh:f.isThai&&(m=e.numShape=Si.Thai);break;case ub.LatinDate:throw new wb(Pn(["TokenKind.LatinDate"]));case ub.BidiDate:throw new wb(Pn(["TokenKind.BidiDate"]));case Cu.HourTh:throw new wb(Pn(["PictureSingle.HourTh"]));case Cu.MinuteTh:throw new wb(Pn(["PictureSingle.MinuteTh"]));case Cu.SecondTh:throw new wb(Pn(["PictureSingle.SecondTh"]));case Cu.Hour:case Cu.Minute:case Cu.Second:if(b.isAbs){var ke=v();ne("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!Cn(ke));var Ee=d.toTime(this.config,c.abs(ke),kb[b.kind],e.dtrRounding);if(!1===Ee)throw new wb(Pn(["absolute time overflow"]));g.push(fm(QS(c,c.fromNumber(Ee),b.count,m)))}else{var Ae=h(),Re=void 0;b.kind===Cu.Minute?Re=Ae.min:b.kind===Cu.Second?Re=Ae.sec:(Re=Ae.hour,b.isAMPM&&(Re>12&&(Re-=12),0===Re&&(Re=12))),g.push(fm(QS(c,c.fromNumber(Re),b.count,m)))}break;case ub.AMPM:case ub.AMPMFE:var Ne=void 0;if(Ne=!!Cn(r)||h().hour<12,(void 0===(null===(o=this.applyCurrCode)||void 0===o?void 0:o.culture)||b.kind===ub.AMPMFE)&&(b.kind===ub.AMPMFE||f.isEastAsia||b.pictureKind===yu.AP2)){var Te=vb(f,b.tokenStr);g.push(fm(Te[Ne?0:1]));break}var Ie=this.getBundledLocaleInfo("localised AM/PM string",this.applyCurrCode);g.push(fm(Ie.ampmSymbols[Ne?0:1]));break;case 404:var Fe=h();ne("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",Fe.rounding>=b.rounding);var Oe=XS(c,c.fromNumber(Fe.fracSec),Fe.rounding,b.rounding,m);g.push(fm(f.decimalSeparator+Oe));break;case Cu.Era:throw new wb(Pn(["PictureSingle.Era"]));case Cu.EraYear:throw new wb(Pn(["PictureSingle.EraYear"]));case Cu.YearTh:throw new wb(Pn(["PictureSingle.YearTh"]));case Cu.EngYearTh:throw new wb(Pn(["PictureSingle.EngYearTh"]));case Cu.ThYear:throw new wb(Pn(["PictureSingle.ThYear"]));case Cu.MonthTh:throw new wb(Pn(["PictureSingle.MonthTh"]));case Cu.DayTh:throw new wb(Pn(["PictureSingle.DayTh"]));case Cu.Year:var De=h().yr;Re=b.count>2?De:De%100;g.push(fm(QS(c,c.fromNumber(Re),b.count,m)));break;case Cu.Month:var Me=h().mon;switch(b.count){case 1:case 2:g.push(fm(QS(c,c.fromNumber(Me),b.count,m)));break;case 3:case 4:case 5:Ie=this.getBundledLocaleInfo("localised month string",this.applyCurrCode);if(3===b.count)g.push(fm(Ie.monthNameShort[Me-1]));else if(4===b.count)g.push(fm(Ie.monthNameLong[Me-1]));else{var we=Ie.monthNameLong[Me-1];g.push(fm(we.substring(0,Fi(Ii(we,0)))))}}break;case Cu.Day:case Cu.LocDay:if(b.count<3){var _e=h().dom;g.push(fm(QS(c,c.fromNumber(_e),b.count,m)))}else{var Le=h().wdy,Pe=void 0;Pe=f.isEastAsia&&b.kind===Cu.Day?os():this.getBundledLocaleInfo("localised day string",this.applyCurrCode);be=3===b.count?Pe.dayNameShort[Le-1]:Pe.dayNameLong[Le-1];g.push(fm(be))}break;case 407:ne("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===n),this.applyPart(e,b.codeSysFormat,r,n);break;default:return te("calc.numfmt.NumberFormatImpl: applyPart code",b)}}p&&v()},e.prototype.dumpDigLeft=function(e,t,r){var n=this.config.localeInfo,a=e.units,i=e.numShape,o=r,u=k(o,t.digits.length),s=xm(t.digits.substring(0,u),i);if(t.comma&&(s=Um(n,s,t.numDigLeft-u)),a.push(fm(s)),t.digits=t.digits.substring(u),o-=u,t.digitsExp-=u,t.numDigLeft-=u,o>0){s=xm(W("0",o),i);t.comma&&(s=Um(n,s,t.numDigLeft-o)),a.push(fm(s)),t.digitsExp-=o,t.numDigLeft-=o}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=0;r<2;r+=1){var n=r,a=void 0;if(0===r){if(void 0===(a=this.condPos)&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[0])throw new Mb(Xp);if(0===this.parts[0].code.length)throw new wb(Pn(['emulation of ";[COND]foo" bug']));if(void 0===(a=this.condNeg)){if(this.parts[2]===this.parts[0])return ne("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===Qa.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0!==a){var i=a.operator,o=a.operand;if(En(t.sub(e,o)))throw new wb(Pn(["overflow in condition check"]));if(yS(i,t.cond2(e,o)))switch(i){case Qa.Eq:return{partKind:n,forceNeg:!1};case Qa.Ne:case Qa.Gt:case Qa.Ge:return{partKind:n,forceNeg:!0};case Qa.Lt:return{partKind:n,forceNeg:t.cond(o)>0};case Qa.Le:return{partKind:n,forceNeg:t.cond(o)>=0}}}}if(this.parts[2]===this.parts[0])throw new Mb(Xp);return{partKind:2,forceNeg:!0}},e.prototype.getNumShape=function(e){var t=this.applyCurrCode,r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return Si.ASCII;var n=this.getBundledLocaleInfo("localised DBNUM culture",t);return n.isEastAsia&&(n.isKorea?r=ib[e]:n.isJapan?r=ab[e]:n.isChinaT?r=rb[e]:n.isChinaS&&(r=nb[e])),null!=r?r:Si.ASCII},e.prototype.formFraction=function(e,t,r){var n,a,i,o=this.config.mathpack;if(void 0!==t){var u=o.fromNumber(137438953472);if(En(o.sub(e,u)))throw new wb(Pn(["overflow in fraction threshold check"]));if(o.cond2(e,u)<0){var s=o.mul(e,o.fromNumber(1.0000000000000002));ne("calc.numfmt.NumberFormatImpl: formFraction nudged error",yn(s)),e=s}var l=t,c=o.toNumber(l)<<1,d=o.mul(e,o.fromNumber(c));if(!yn(d))throw new wb(Pn(["overflow in fraction denom mul"]));var f=o.lfix(d);if(f<0||f>=65535)throw new Mb(sm);return{numer:o.fromNumber(f+1>>1),denom:l}}switch(r){case 1:i=10;break;case 2:i=100;break;case 3:i=1e3;break;case 4:i=1e4;break;case 5:i=1e5;break;case 6:i=1e6;break;default:i=1e7}var h=o.fix(e);if(h>=2147483647)throw new Mb(sm);for(var v=e,p=1,m=1,g=0,S=0;;){var b=p*h;S+=b;var y=g*h;if(m+=y,b>2147483647||y>2147483647||m>=i){1===g&&2===h&&0===o.cond2(v,o.trunc(v))&&(p+=1);break}p=(n=[S,p])[0],S=n[1],g=(a=[m,g])[0],m=a[1];var C=o.sub(v,o.trunc(v));if(ne("calc.numfmt.NumberFormatImpl: formFraction frac sub",yn(C)),0===o.cond(C))break;var k=o.div(o.one,C);if(En(k))throw new wb(Pn(["overflow in fraction inversion"]));if(v=k,(h=o.fix(v))>2147483647)break}return 0===g&&(g=p=1),{numer:o.fromNumber(p),denom:o.fromNumber(g)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=E(0,k(t,127)),a=[],i=function(e){var t=o.parts[e];if((1===e||2===e)&&t===o.parts[0])return a.push(a[0]),"continue";if(3===e)return a.push(t===o.parts[0]?a[0]:t),"continue";var i=t.code,u=t.color,s=t.dbnum,l=t.dtrRounding,c={code:i.map((function(t){if(403===t.kind){var a=t.numDigLeft,i=t.numPercent,o=t.numThousands,u=t.comma,s=t.codeBefore;return{kind:403,numDigLeft:a,numDigDec:n,numPercent:i,numThousands:o,comma:u,code:r.adjustDecimals(e,t.numDigDec,t.code,n),codeBefore:s}}if(402===t.kind){var l=t.isNeg,c=t.numMantDigLeft,d=t.numExpDigLeft,f=t.commaMant,h=t.codeBetween,v=t.codeExp;return{kind:402,isNeg:l,numMantDigLeft:c,numMantDigDec:n,numExpDigLeft:d,commaMant:f,codeMant:r.adjustDecimals(e,t.numMantDigDec,t.codeMant,n),codeBetween:h,codeExp:v}}return t})),color:u,dbnum:s,dtrRounding:l};a.push(c)},o=this,u=0;u<=3;u+=1)i(u);try{var s=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec="+n+" on "+this.logFormatString+")",synth:a});if(Le(De["OfficeVSO:3852168_CalcNFLength"])&&s.formatString.length>255)throw new _b(this.notFormatString("format string too long: max length"));return s}catch(e){if(e instanceof _b)return this;throw e}},e.prototype.adjustDecimals=function(e,t,r,n){var a;if(n===t)return r;for(var i=!1,o=void 0,u=void 0,s=void 0,l=0;l<r.length;l+=1){switch((b=r[l]).kind){case Cu.Decimal:void 0===s&&(s=l);break;case Cu.Hash:case Cu.Question:case Cu.Zero:void 0!==s?u=l:(o=l,b.kind===Cu.Question&&(i=!0))}}var c=function(e){return e===Cu.Percent||e===ub.Currency||e===ub.CurrCode||e===Cu.Star};if(0===n){if(void 0===s)return r;var d=0,f=0;void 0===o?void 0!==u&&(d=s+1,f=u+1):(d=s,f=(null!=u?u:s)+1);var h=r.slice(0,d);for(l=d;l<f;l+=1)c(r[l].kind)&&h.push(r[l]);return g(h,r.slice(f)),h}if(t>n){ne("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==s);var v=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(v||(v={}));var p=v.AfterDigs,m=[],S=t-n;for(l=r.length-1;l>=0;l-=1){l<=s&&(p=v.Keeping);var b=r[l];if(p===v.AfterDigs&&(b.kind!==Cu.Hash&&b.kind!==Cu.Question&&b.kind!==Cu.Zero||(p=v.Dropping)),p===v.Keeping||p===v.AfterDigs||c(b.kind))m.push(b);else if(b.kind===Cu.Hash||b.kind===Cu.Question||b.kind===Cu.Zero){var y=k(S,b.count);y<b.count&&m.push({kind:b.kind,count:b.count-y}),0===(S-=y)&&(p=v.Keeping)}}return m.reverse(),m}if(2===e&&i&&void 0===u)return r;var C=n-t;if(void 0!==u){var E=r.slice();b=E[u];return E[u]={kind:b.kind,count:b.count+C},E}var A=r.slice(),R=null!==(a=null!=s?s:o)&&void 0!==a?a:A.length-1,N=[];return void 0===s&&N.push({kind:Cu.Decimal}),N.push({kind:Cu.Zero,count:C}),A.splice.apply(A,Object(fe.f)([R+1,0],N)),A},e.prototype.parseString=function(e){if(Le(De["OfficeVSO:3852168_CalcNFLength"])){if(this.source!==Em.CustomBytecode&&e.length>255)throw new _b(this.notFormatString("format string too long: max length"))}else if(e.length>80)throw new _b(Pn(["long format string"]));for(var t,r,n=!1,a=!1,i=0,o=!1,u=0;u<=3&&!o;u+=1){var s=this.tokenize(e.substring(i)),l=s.cond,c=s.currencySymbol,d=this.convertTokToSun(s),f=d.currCode,h=d.hasPercent,v=d.hasDate,p=d.hasTime,m=this.classifySunPartKind(d,3===u?3:0),g=this.convertSunToCode(d),S=g.part,b=g.applyCurrCode;if(i+=s.consumed,o=s.eos,h&&(this.hasPercent=!0),v&&(this.hasDate=!0),p&&(this.hasTime=!0),void 0!==f){if(0!==u&&(void 0===this.thisCurrCode||(t=this.thisCurrCode,r=f,t.culture!==r.culture||t.numberShape!==r.numberShape||t.nationalNumberInput!==r.nationalNumberInput||t.calendar!==r.calendar||t.localCalendarInput!==r.localCalendarInput||t.tag!==r.tag)))throw new _b(Pn(["inconsistent CurrCode in number parts"]));void 0===this.thisCurrCode&&(this.thisCurrCode=f)}if(void 0!==b&&void 0===this.applyCurrCode&&(this.applyCurrCode=b),void 0!==c&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=c),this.source===Em.System&&(ne("calc.numfmt.NumberFormatImpl.parseString: system ipart",0===u),!o||3===m))throw new _b(this.notFormatString("system format with more than one part"));if((3===m||0===u&&1===m)&&(n=!0,this.parts[3]=S,3===m)){if(void 0!==l)throw new _b(this.notFormatString("condition in text part"));if(void 0!==f)throw new _b(Pn(["CurrCode in text part"]));break}if(a=!0,this.parts[u]=S,this.onlyOneNumberPart=0===u,0===u)this.parts[1]=S,this.parts[2]=S,this.condPos=l;else if(1===u)this.condNeg=l;else if(void 0!==l)throw new _b(this.notFormatString("condition in zero part"))}if(!o)throw new _b(this.notFormatString("too many parts"));a||(this.parts[0]=Nb,this.parts[1]=Nb,this.parts[2]=Nb,this.posBeforeText=!1),n||(this.parts[3]=Nb),a&&!n&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Rb(this.parts[0].code)&&(this.parts[1]=Nb,this.onlyOneNumberPart=!1),ne("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((function(e){return void 0!==e}))),this.checkBytecode()},e.prototype.tokenize=function(e){for(var t,r,n=this.config.localeInfo,a={color:void 0,dbnum:void 0,cond:void 0,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};a.consumed<e.length&&a.eos;){var i=this.readToken(a,e,a.consumed),o=t;switch(t=i,a.consumed+=i.tokenStr.length,i.kind){case Cu.Sep:a.eos=!1;continue;case ub.Color:if(void 0!==a.color)throw new _b(this.notFormatString("more than one color"));if(0!==a.tokens.length)throw new _b(Pn(["colour in middle of format"]));a.color=i.color;continue;case ub.Dbnum:if(void 0!==a.dbnum)throw new _b(this.notFormatString("more than one DBNUM"));if(0!==a.tokens.length)throw new _b(Pn(["DBNUM in middle of format"]));a.dbnum=i.dbnum;continue;case ub.Cond:if(void 0!==a.cond)throw new _b(this.notFormatString("more than one condition"));if(0!==a.tokens.length)throw new _b(Pn(["condition in middle of format"]));a.cond=i.cond;continue;case ub.CurrCode:if(void 0!==r)throw new _b(this.notFormatString("more than one currency code in section"));r=i;break;case ub.AMPM:case ub.AMPMFE:case Cu.Colon:case Cu.DateSep:case ub.LatinDate:case ub.BidiDate:case Cu.Year:case Cu.Month:case Cu.Day:case Cu.Hour:case Cu.Minute:case Cu.Second:case Cu.Reign:case Cu.LocDay:case Cu.Era:case Cu.EraYear:case Cu.EngYearTh:case Cu.DayTh:case Cu.MonthTh:case Cu.YearTh:case Cu.ThYear:case Cu.HourTh:case Cu.MinuteTh:case Cu.SecondTh:if((null==o?void 0:o.kind)===i.kind){o.count+=i.count;continue}}a.tokens.push(i)}return void 0!==r&&(a.currCode=r.currCode,a.currencySymbol=r.currencySymbol),4!==a.dbnum||n.isKorea||void 0===a.currCode&&!n.isThai||(a.dbnum=void 0),a},e.prototype.readToken=function(e,t,r){var n=this.config,a=n.mathpack,i=n.localeInfo,o=db(i,i.pictureSpecial,t,r);if(void 0!==o){var u=o,s=hb(i.pictureSpecial,u);i.isJapan&&u===yu.GeneralOldMAC&&(u=yu.General);var l=t.substring(r,r+s.length);switch(u){case yu.AP1:case yu.AP2:return{kind:ub.AMPM,tokenStr:l,count:1,pictureKind:u};case yu.AP3:return{kind:ub.AMPMFE,tokenStr:l,count:1};case yu.General:return{kind:ub.General,tokenStr:l};case yu.Currency:return{kind:ub.Currency,tokenStr:l}}}var c,d=Ii(t,r),f=Fi(d),h=t.substring(r,r+f),v=fb(i,i.pictureSingle,t,r);if(void 0!==v){u=v;if((i.isJapan||i.isChinaT)&&(u===Cu.E||u===Cu.EraYear)){var p=void 0,m=void 0;u=!(r+f+1<t.length)||45!==(p=t.charCodeAt(r+f))&&43!==p||48!==(m=t.charCodeAt(r+f+1))&&35!==m&&46!==m?Cu.EraYear:Cu.E}if(u===Cu.BidiDate||u===Cu.EngYearTh){p=void 0;if(r+f<t.length&&(49===(p=t.charCodeAt(r+f))||50===p))return{kind:49===p?ub.LatinDate:ub.BidiDate,tokenStr:t.substring(r,r+f+1),count:1};u=Cu.EngYearTh}if(u===Cu.BidiNum)throw new _b(this.notFormatString("bidi num not allowed"));switch(u){case Cu.Star:case Cu.Underscore:if(r+f>=t.length)throw new _b(this.notFormatString("unterminated "+h));var g=Fi(p=Ii(t,r+f)),S=Ri(p);return{kind:u,tokenStr:l=t.substring(r,r+f+g),escaped:S};case Cu.Backslash:return this.readToken_Backslash(t,r,f);case Cu.Quote:var b=t.indexOf(h,r+f);if(b<0)throw new _b(this.notFormatString("unterminated quoted string"));var y=t.substring(r+f,b),C=(l=t.substring(r,b+f),db(i,i.pictureSpecial,y,0));return void 0!==C&&C===yu.Currency&&hb(i.pictureSpecial,C).length===y.length?{kind:ub.Currency,tokenStr:l}:{kind:ub.StrLit,tokenStr:l,escaped:y};case Cu.E:if(i.isEastAsia){if(void 0!==e.dbnum)throw new _b(this.notFormatString("invalid DBNUM with exp"));e.dbnum=1}if(r+f>=t.length)throw new _b(this.notFormatString("unterminated exp"));if(43!==(p=t.charCodeAt(r+f))&&45!==p)throw new _b(this.notFormatString("exp not followed by sign"));l=t.substring(r,r+f+1);return{kind:ub.Exp,tokenStr:l,eStr:h,isNeg:45===p};case Cu.Hash:case Cu.Year:case Cu.Month:case Cu.Day:case Cu.Hour:case Cu.Minute:case Cu.Second:case Cu.YearTh:case Cu.MonthTh:case Cu.DayTh:case Cu.HourTh:case Cu.MinuteTh:case Cu.SecondTh:case Cu.EngYearTh:case Cu.ThYear:case Cu.Question:case Cu.Comma:case Cu.Reign:case Cu.LocDay:case Cu.Era:case Cu.EraYear:if(u===Cu.Reign&&!i.isJapan&&!i.isChinaT)break;for(var k=f,E=1;V(t,h,r+k)&&void 0===db(i,i.pictureSpecial,t,r+k);)k+=f,E+=1;if(u===Cu.LocDay&&E<3)break;return{kind:u,tokenStr:l=t.substring(r,r+k),count:E};case Cu.Sep:case Cu.Text:case Cu.Decimal:case Cu.Slash:case Cu.Minus:case Cu.Plus:return{kind:u,tokenStr:h};case Cu.Space:return{kind:ub.Char,tokenStr:h,escaped:h};case Cu.Colon:return{kind:u,tokenStr:h,count:1};case Cu.Percent:if(i.isEastAsia){if(void 0!==e.dbnum)throw new _b(this.notFormatString("invalid DBNUM with pct"));e.dbnum=1}return{kind:Cu.Percent,tokenStr:h};case Cu.DateSep:return h===hb(i.pictureSingle,Cu.Slash)?{kind:Cu.Slash,tokenStr:h}:h===hb(i.pictureSingle,Cu.Minus)?{kind:Cu.Minus,tokenStr:h}:{kind:Cu.DateSep,tokenStr:h,count:1};case Cu.ColorStart:var A=hb(i.pictureSingle,Cu.ColorEnd),R=t.indexOf(A,r+f);if(R<0)throw new _b(this.notFormatString("unterminated ["));var N=t.substring(r+f,R),T=(l=t.substring(r,R+A.length),db(i,sb,N,0));if(void 0!==T){for(var I=hb(sb,T).length;I<N.length&&Di(N.charCodeAt(I));)I+=1;var F=function(e,t,r,n,a){var i=n,o=!1;if(i<r.length){var u=r.charCodeAt(i);if((43===u||45===u)&&(o=45===u,i+=1,a))for(;i<r.length&&Di(r.charCodeAt(i));)i+=1}var s=_i(e,t,r,i,!1,!1,!1);return void 0===(null==s?void 0:s.value)?[t.zero,n]:(i=s.i,[o?t.neg(s.value):s.value,i])}(i,a,N,I,!1);if(F[1]===I)throw new _b(Pn(["invalid number in condition"]));if(F[1]!==N.length)throw new _b(Pn(["trailing junk after condition"]));return{kind:ub.Cond,tokenStr:l,cond:{operator:lb[T],operand:F[0]}}}var O=db(i,i.pictureColor,N,0);if(void 0!==O){var D=hb(i.pictureColor,O);if(O!==ku.Color){if(D.length!==N.length)throw new _b(Pn(["trailing junk after named color"]));return{kind:ub.Color,tokenStr:l,color:(c=O,ku[c])}}if(O===ku.Color){for(var M=D.length;M<N.length&&Di(N.charCodeAt(M));)M+=1;var w=Mi(i,4,N,M),_=w[0],L=w[1];if(L===M)throw new _b(this.notFormatString("missing number for numbered color"));if(L!==N.length)throw new _b(Pn(["trailing junk after numbered color"]));if(_<1||_>56)throw new _b(this.notFormatString("out-of-range numbered color"));return{kind:ub.Color,tokenStr:l,color:_+8}}}var P=db(i,i.pictureDbnum,N,0);if(void 0!==P){if(hb(i.pictureDbnum,P).length!==N.length)throw new _b(Pn(["trailing junk after DBNUM"]));return{kind:ub.Dbnum,tokenStr:l,dbnum:ob(P)}}return V(N,"$")?Object(fe.a)({kind:ub.CurrCode,tokenStr:l},this.parseCurrCode(N.substring("$".length))):{kind:u,tokenStr:h};case Cu.ColorEnd:return{kind:u,tokenStr:h};case Cu.OpenParen:case Cu.CloseParen:return{kind:u,tokenStr:h,escaped:h};case Cu.Extra:case Cu.APDelim:case Cu.Nen1:case Cu.Gatsu1:case Cu.Nichi1:case Cu.Nen2:case Cu.Gatsu2:case Cu.Nichi2:break;case Cu.Zero:case Cu.ZeroTh:break;default:return te("calc.numfmt.NumberFormatImpl: readToken single picKind",u)}}if(i.isNumeral(d)){if(i.getNumberShape(d)!==Si.ASCII)throw new _b(Pn(["non-ASCII digits"]));var x=i.getOrdinal(d);if(0===x){var B=f;for(E=1;V(t,h,r+B);)B+=f,E+=1;l=t.substring(r,r+B);return{kind:Cu.Zero,tokenStr:l,count:E}}return{kind:ub.Numeral,tokenStr:h,ordinal:x}}switch(d){case 40:return{kind:Cu.OpenParen,tokenStr:h,escaped:h};case 41:return{kind:Cu.CloseParen,tokenStr:h,escaped:h};case 92:return this.readToken_Backslash(t,r,f);case 116:if(i.isThai)return{kind:ub.PrefixDigTh,tokenStr:h}}return{kind:ub.Char,tokenStr:h,escaped:h}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new _b(this.notFormatString("unterminated backslash"));var n=Ii(e,t+r),a=Fi(n),i=Ri(n),o=e.substring(t,t+r+a);return 40===n||41===n?{kind:40===n?Cu.OpenParen:Cu.CloseParen,tokenStr:o,escaped:i}:{kind:ub.Char,tokenStr:o,escaped:i}},e.prototype.convertTokToSun=function(e){var t,r,n,a,i,o,u,s=this,l=e.color,c=e.dbnum,d=e.cond,f=e.currCode,h=e.tokens,v=this.config.localeInfo,p={suns:[],dtrRounding:Wo.RoundSec,color:l,dbnum:c,currCode:f,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===d&&void 0===l&&void 0===c&&void 0===f}},m=0===v.stringCompareCI(hb(v.pictureSingle,Cu.Month),hb(v.pictureSingle,Cu.Minute)),S=!1,b=0,y=0,C=!1,A=!1,R=!1,N=!1,T=0,I=function(e,t){var n=kb[e];if(t){if(A)throw new _b(s.notFormatString("more than one absolute time"));if(void 0!==r&&n>=r)throw new _b(s.notFormatString("absolute time must be largest division"));A=!0}else if(A&&n<=r)throw new _b(Pn(["larger time division after absolute time"]));(void 0===r||n<r)&&(r=n)};function F(e,t,n){var a=r;if(I(e,t),e===Cu.Hour||e===Cu.HourTh)R=!0,i=n,o=void 0;else if(e===Cu.Second||e===Cu.SecondTh)if(void 0===o||A)void 0===a&&(R=!0);else{var u=o.code[0];ne("calc.numfmt.NumberFormatImpl: onTime ambigCode",u.kind===Cu.Month);var s=Cu.Minute,l=u.count;ne("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===l||2===l);I(s,!1),b-=1,y+=1,o.code=[{kind:s,count:l,isAbs:!1}],o=void 0}else R=!1}function O(e){var t=hb(v.pictureSingle,e.kind);return{kind:406,printAsTimeSep:b>0||y>0,formattedStr:t}}function D(e){var t=hb(v.pictureSingle,e.kind);return t===hb(v.pictureSingle,Cu.DateSep)?{kind:405}:t===hb(v.pictureSingle,Cu.Colon)?O(e):{kind:400,formattedStr:t}}for(var M=0;M<h.length;M+=1){var w=h[M];switch(w.kind){case ub.AMPM:case ub.AMPMFE:case Cu.Colon:case Cu.DateSep:case Cu.Year:case Cu.Month:case Cu.Day:case Cu.Hour:case Cu.Minute:case Cu.Second:case Cu.Reign:case Cu.LocDay:case Cu.Era:case Cu.EraYear:case Cu.EngYearTh:case ub.LatinDate:case ub.BidiDate:case Cu.DayTh:case Cu.MonthTh:case Cu.YearTh:case Cu.ThYear:case Cu.HourTh:case Cu.MinuteTh:case Cu.SecondTh:var _={kind:1,code:[]};switch(p.suns.push(_),C=!0,w.kind){case ub.LatinDate:case ub.BidiDate:if(0!==M)throw new _b(this.notFormatString("bidi date must be first"));_.code.push(w);break;case Cu.DateSep:_.code.push({kind:405});break;case Cu.Colon:_.code.push(O(w));break;case Cu.Reign:b+=1,v.isJapan&&w.count>=2&&_.code.push({kind:Cu.Era,count:3}),_.code.push({kind:Cu.EraYear,count:v.isChinaT?1:2});break;case Cu.Era:b+=1,_.code.push({kind:Cu.Era,count:k(3,w.count)});break;case Cu.EraYear:b+=1,_.code.push({kind:Cu.EraYear,count:k(2,w.count)});break;case Cu.Year:case Cu.YearTh:case Cu.EngYearTh:case Cu.ThYear:o=void 0,b+=1,_.code.push({kind:w.kind,count:w.count<=2?2:4});break;case Cu.Month:if(m&&w.count<=2){if(R){F(Q=Cu.Minute,L=!1,_),y+=1,_.code.push({kind:Q,count:w.count,isAbs:L}),R=!1;break}o=_}else o=void 0;b+=1,_.code.push({kind:w.kind,count:k(5,w.count)});break;case Cu.MonthTh:b+=1,_.code.push({kind:w.kind,count:k(4,w.count)});break;case Cu.Day:case Cu.DayTh:o=void 0,b+=1,_.code.push({kind:w.kind,count:k(4,w.count)});break;case Cu.LocDay:o=void 0,b+=1,_.code.push({kind:Cu.LocDay,count:3===w.count?3:4});break;case Cu.Hour:case Cu.HourTh:case Cu.Minute:case Cu.MinuteTh:case Cu.Second:case Cu.SecondTh:var L=!1;F(w.kind,L,_),y+=1;var P=k(2,w.count);w.kind===Cu.Hour||w.kind===Cu.HourTh?_.code.push({kind:w.kind,count:P,isAbs:L,isAMPM:!1}):_.code.push({kind:w.kind,count:P,isAbs:L});break;case ub.AMPM:case ub.AMPMFE:if(A)throw new _b(this.notFormatString("AM/PM after absolute time"));if(w.count>1)throw new _b(Pn(["multiple AM/PM symbols"]));if(void 0!==i)(W=i.code[0]).isAMPM=!0,i=void 0;N=!0,_.code.push(w);break;default:return te("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",w)}break;case Cu.Decimal:case ub.Numeral:case Cu.Hash:case Cu.Zero:case Cu.Question:case Cu.Comma:if(C){if(w.kind!==Cu.Decimal&&w.kind!==Cu.Comma)throw new _b(this.notFormatString("number picture in date/time format"));var x={kind:1,code:[]};p.suns.push(x);var B=h[M+1];if(w.kind===Cu.Decimal&&(null==B?void 0:B.kind)===Cu.Zero){var U=B.count;if(U>3)throw new _b(this.notFormatString("invalid number of fractional seconds"));M+=1,F(Cu.Second,!1,x),y+=1,x.code.push({kind:404,rounding:U}),p.dtrRounding=E(p.dtrRounding,U)}else x.code.push(D(w));break}if(w.kind===Cu.Comma){var G={kind:7,code:[{kind:400,formattedStr:hb(v.pictureSingle,w.kind)}]};p.suns.push(G);break}_={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};p.suns.push(_),void 0===n&&(n=_),a=_;var j=void 0;for(M-=1;M+1<h.length;M+=1){var V=h[M+1],H=!0;switch(V.kind){case Cu.Decimal:S=_.decimal=!0,_.code.push(V),j=void 0;break;case ub.Numeral:_.code.push({kind:V.kind,formattedStr:V.tokenStr,ordinal:V.ordinal}),_.numVal=_.nonZero=!0,j=void 0;break;case Cu.Hash:case Cu.Zero:case Cu.Question:if(_.decimal?_.numDigDec+=V.count:_.numDigLeft+=V.count,void 0===_.firstDig&&(_.firstDig=V.kind),_.lastDig=V.kind,V.kind===Cu.Hash?_.anyHash=!0:V.kind===Cu.Question?_.anyQuestion=!0:(_.anyZero=!0,_.numVal=!0),void 0!==j&&j.kind===V.kind)j.count+=V.count;else{var W={kind:V.kind,count:V.count};_.code.push(W),j=W}break;case Cu.Comma:B=null===(t=h[M+2])||void 0===t?void 0:t.kind;if((u=B)!==ub.Numeral&&u!==Cu.Hash&&u!==Cu.Zero&&u!==Cu.Question){P=V.count;var K=hb(v.pictureSingle,Cu.Space);K===hb(v.pictureSingle,Cu.Comma)&&(!v.isCurrencySymbolLead&&v.isCurrencySepBySpace&&B===ub.Currency||v.isPercentSepBySpace&&B===Cu.Percent)&&(_.code.push({kind:400,formattedStr:K}),P-=1),P>0&&(_.numThousands+=P)}else S||(_.comma=!0);break;default:H=!1}if(!H)break}break;case Cu.Percent:T+=1;_={kind:3,code:[{kind:Cu.Percent,formattedStr:w.tokenStr}]};p.suns.push(_),p.hasPercent=!0;break;case ub.Exp:_={kind:4,code:[{kind:ub.Exp,formattedStr:w.eStr,isNeg:w.isNeg}],isNeg:w.isNeg};p.suns.push(_);break;case ub.General:_={kind:6,code:[w]};p.suns.push(_);break;case Cu.Text:_={kind:5,code:[w]};p.suns.push(_);break;case Cu.Slash:if(C){var z={kind:1,code:[D(w)]};p.suns.push(z);break}_={kind:2,code:[{kind:Cu.Slash,formattedStr:w.tokenStr}]};p.suns.push(_);break;case Cu.Star:case ub.PrefixDigTh:case Cu.Underscore:case ub.Currency:case ub.CurrCode:case ub.StrLit:_={kind:7,code:[w]};p.suns.push(_);break;case Cu.ColorEnd:case Cu.Plus:_={kind:7,code:[{kind:400,formattedStr:w.tokenStr}]};p.suns.push(_);break;case Cu.OpenParen:case Cu.CloseParen:case ub.Char:_={kind:7,code:[{kind:400,formattedStr:w.escaped}]};p.suns.push(_);break;case Cu.Minus:if(C){var Y={kind:1,code:[D(w)]};p.suns.push(Y);break}_={kind:7,code:[{kind:400,formattedStr:hb(v.pictureSingle,w.kind)}]};p.suns.push(_);break;case Cu.ColorStart:var q=0;for(_={kind:1,code:[]};M+1<h.length&&2!==q;M+=1){var J=h[M+1];switch(J.kind){case Cu.ColorEnd:if(1!==q)throw new _b(this.notFormatString("unexpected closing ]"));q=2;continue;case Cu.Hour:case Cu.Month:case Cu.Minute:case Cu.Second:if(J.kind===Cu.Month&&!m)break;var Q;F(Q=J.kind===Cu.Month?Cu.Minute:J.kind,L=!0,_),y+=1;P=k(2,J.count);Q===Cu.Hour?_.code.push({kind:Q,count:P,isAbs:L,isAMPM:!1}):_.code.push({kind:Q,count:P,isAbs:L}),C=!0,q=1;continue;case ub.Char:if(J.tokenStr===hb(v.pictureSingle,Cu.Space))continue;break;case Cu.HourTh:throw new _b(Pn(["Thai hour in ["]))}throw new _b(this.notFormatString("unexpected token after ["))}if(2!==q)throw new _b(Pn(["semicolon inside [ ]"]));p.suns.push(_);break;default:return te("calc.numfmt.NumberFormatImpl: convertTokToSun tok",w)}if(p.suns.length>=2){var X=p.suns[p.suns.length-2],Z=p.suns[p.suns.length-1];if(7===X.kind&&7===Z.kind)g(X.code,Z.code),p.suns.pop()}}(void 0!==n&&(n.numThousands=a.numThousands,n.numPercent=T),N&&void 0!==i)&&((W=i.code[0]).isAMPM=!0);if(A)for(var $=0,ee=p.suns;$<ee.length;$++){if(1===(_=ee[$]).kind)for(var re=0,ae=_.code;re<ae.length;re++){switch((W=ae[re]).kind){case Cu.Hour:case Cu.HourTh:case Cu.Minute:case Cu.MinuteTh:case Cu.Second:case Cu.SecondTh:W.isAbs=kb[W.kind]===r}}}if(Le(De["OfficeVSO:3852168_CalcNFLength"])&&p.suns.length>32)throw new _b(this.notFormatString("format string too long: SUNs limit"));return p.hasDate=b>0,p.hasTime=y>0,p},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,a=e.hasDate,i=e.hasTime,o=2===t,u=3===t,s=!o&&!u,l=0,c=r;l<c.length;l++){var d=c[l];switch(d.kind){case 0:case 2:case 3:case 4:o=!0;break;case 5:u=!0;break;case 6:continue;case 7:case 1:break;default:return te("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",d)}s=!1}if((o?1:0)+(a||i?1:0)+(u?1:0)>1)throw new _b(this.notFormatString("cannot mix number/date/text"));return o||a||i?2:u?3:s&&!n?1:t},e.prototype.convertSunToCode=function(t){var r,n=t.suns,a=t.isEmpty,i=t.dtrRounding,o=t.color,u=t.dbnum,s=t.currCode,l=this.config.localeInfo,c=[];function d(e){for(var t=e-1;t>=0;t-=1){var r=n[t];if(0===r.kind)return[t,r]}}function f(e){for(var t=e+1;t<n.length;t+=1){var r=n[t];if(0===r.kind)return[t,r]}}for(var h=!1,v=0,p=0;p<n.length;p+=1){var m=n[p];switch(m.kind){case 5:if(5===r)break;if(void 0!==r)throw new _b(this.notFormatString("@ after other control"));r=5;break;case 6:if(void 0!==r)throw new _b(this.notFormatString("General after other control"));if(h)throw new _b(this.notFormatString("General after number"));r=6;break;case 0:if(h=!0,6===r)throw new _b(this.notFormatString("number after General"));break;case 2:if(void 0!==r)throw new _b(this.notFormatString("/ after other control"));if(l.isEastAsia&&void 0!==u)throw new _b(this.notFormatString("/ not allowed with DBNUM"));r=2;var S=d(p);if(void 0===S)throw new _b(this.notFormatString("no number before /"));var b=this.mergeNumSuns(n,v,S[0]),y=b[0],C=b[1],k=b[2],E=f(p);if(void 0===E)throw new _b(this.notFormatString("no number after /"));var A=n.slice(S[0]+1,E[0]),R=void 0!==f(E[0]);g(c,this.flattenSuns(y)),g(c,this.buildFractCode(C,k,S[1],A,E[1],R)),v=E[0]+1;break;case 4:if(void 0!==r)throw new _b(this.notFormatString("E after other control"));r=4;var N=this.mergeNumSuns(n,v,p),T=N[0],I=N[1],F=N[2];if(void 0===I)throw new _b(this.notFormatString("no number before E"));var O=this.mergeNumSuns(n,p+1,n.length),D=O[0],M=O[1],w=O[2];if(void 0===M)throw new _b(this.notFormatString("no number after E"));g(c,this.flattenSuns(T)),g(c,this.buildExpCode(m.isNeg,I,Object(fe.f)(F,[n[p]],D),M)),g(c,this.flattenSuns(w)),v=n.length;break;case 3:case 7:case 1:break;default:return te("calc.numfmt.NumberFormatImpl: convertSunToCode sun",m)}}if(void 0===r){var _=this.mergeNumSuns(n,v,n.length),L=(y=_[0],_[1]),P=_[2];g(c,void 0!==L?this.buildNumberCode(y,L):this.flattenSuns(y)),g(c,this.flattenSuns(P)),v=n.length}g(c,this.flattenSuns(n.slice(v))),0!==n.length||a||c.push(Ab);var x=null==s?void 0:s.tag;if(cm(x)){var B=x===tm.SysDate?l.sysDateFormat:l.sysTimeFormat,U=new e(this.config,{old:void 0,formatString:B,source:Em.System}),G=U.parts[0];return{part:{code:[{kind:407,codeSysFormat:G.code,codeThisFormat:c}],color:G.color,dbnum:G.dbnum,dtrRounding:G.dtrRounding},applyCurrCode:U.thisCurrCode}}return{part:{code:c,color:o,dbnum:u,dtrRounding:i},applyCurrCode:s}},e.prototype.flattenSuns=function(e){return S([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new _b(this.notFormatString("comma following E"));var a=t.numDigDec;if(a>127&&Le(De["OfficeVSO:3852168_CalcNFLength"]))throw new _b(this.notFormatString("too many decimal digits"));var i=this.bumpDigitsForComma(t),o=i.code,u=i.comma;return[{kind:402,isNeg:e,numMantDigLeft:i.numDigLeft,numMantDigDec:a,numExpDigLeft:n.numDigLeft,commaMant:u,codeMant:o,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=t.numDigDec;if(r>127&&Le(De["OfficeVSO:3852168_CalcNFLength"]))throw new _b(this.notFormatString("too many decimal digits"));var n=this.bumpDigitsForComma(t),a=n.code,i=n.comma;return[{kind:403,numDigLeft:n.numDigLeft,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:i,codeBefore:this.flattenSuns(e),code:a}]},e.prototype.buildFractCode=function(e,t,r,n,a,i){var o,u,s,l,c=this.config.mathpack;if(r.comma)throw new _b(this.notFormatString("comma in numerator"));if(r.decimal)throw new _b(Pn(["decimals in numerator"]));if(a.comma)throw new _b(this.notFormatString("comma in denominator"));if(a.decimal)throw new _b(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new _b(this.notFormatString("decimals in numerator"));if((l=a).numVal&&l.nonZero&&l.digitTokens)throw new _b(this.notFormatString("literal and placeholder digits mixed in denominator"));if(i)throw new _b(Pn(["fraction number formats with trailing numbers"]));var d,f=!1,h=0;if(void 0!==e){if(!e.reallyNum)throw new _b(Pn(["fixed numerals in fraction integer part"]));if(e.decimal)throw new _b(Pn(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new _b(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new _b(Pn(["numerals in fraction integer part"]));d=(o=this.bumpDigitsForComma(e)).code,f=o.comma,h=o.numDigLeft}var v=null!==(u=null==e?void 0:e.numPercent)&&void 0!==u?u:r.numPercent,p=null!==(s=null==e?void 0:e.numThousands)&&void 0!==s?s:r.numThousands;if(p>0)throw new _b(Pn(["fraction number formats with thousands"]));var m,g=a.code,S=a.numDigLeft,b=a.firstDig;if(a.numVal&&a.nonZero){if(i)throw new _b(Pn(["fraction number formats with specified denominator and trailing numbers"]));if(a.code.length>5)throw new _b(Pn(["too many digits in denominator"]));for(var y=0,C=0;C<a.code.length;C+=1){var k=a.code[C];switch(k.kind){case ub.Numeral:y=10*y+k.ordinal;break;case Cu.Zero:if(0===C)throw new _b(Pn(["leading zero in denominator"]));y*=10;break;default:return re("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(y>32767)throw new _b(Pn(["overflow in denominator not emulated"]));g=[{kind:Cu.Hash,count:1}],S=1,b=void 0,m=c.fromNumber(y)}return[{kind:401,numIntDigLeft:h,numPercent:v,numThousands:p,numNumerDig:r.numDigLeft,numDenomDig:S,commaInt:f,codeInt:d,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:g,denomValue:m,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:b,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,a=[],i=[],o=t;o<e.length&&o<r;o+=1){var u=e[o];void 0!==n?0===u.kind?(n.decimal?n.numDigDec+=u.numDigLeft+u.numDigDec:(n.numDigLeft+=u.numDigLeft,n.numDigDec+=u.numDigDec),n.comma=n.comma||u.comma,n.decimal=n.decimal||u.decimal,n.numVal=n.numVal||u.numVal,n.nonZero=n.nonZero||u.nonZero,void 0!==u.lastDig&&(n.lastDig=u.lastDig),void 0===n.firstDig&&(n.firstDig=u.firstDig),n.anyHash=n.anyHash||u.anyHash,n.anyQuestion=n.anyQuestion||u.anyQuestion,n.anyZero=n.anyZero||u.anyZero,g(n.code,this.flattenSuns(i)),i.length=0,g(n.code,u.code)):i.push(u):0===u.kind?n=u:a.push(u)}return[a,n,i]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var a=e.code[n];switch(a.kind){case Cu.Hash:return(i=e.code.slice())[n]=Object(fe.a)(Object(fe.a)({},a),{count:a.count+(r-e.numDigLeft)}),{code:i,comma:!0,numDigLeft:r};case Cu.Zero:case Cu.Question:case Cu.Decimal:var i;return(i=e.code.slice()).splice(n,0,{kind:Cu.Hash,count:r-e.numDigLeft}),{code:i,comma:!0,numDigLeft:r}}}throw new _b(Pn(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t=null==e?void 0:e.kind;return t===Cu.Hash||t===Cu.Zero||t===Cu.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var a=e.code[n];if(a.kind===Cu.Decimal)return!1;if(t(a))for(var i=0;i<a.count;i+=1)if((r-=1)>0&&r%3==0&&(i+1<a.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){var t,r,n,a=this.config.localeInfo,i=e.indexOf("-");if(0!==e.length&&0!==i){if((t=i<0?e:e.substring(0,i)).length>61)throw new _b(this.notFormatString("currencySymbol too long"));for(var o=0,u=Oi(t);o<u.length;o++){var s=u[o];if(a.isNumeral(s)&&a.getNumberShape(s)!==Si.ASCII)throw new _b(Pn(["non-ASCII digits in currencySymbol"]))}}if(i>=0&&(n=e.substring(i+"-".length)),void 0!==n&&void 0===(r=this.parseFormatCulture(n)))throw new _b(Pn(["unhandled CurrCode: "+G(e)]));if(cm(null==r?void 0:r.tag)){if(void 0!==t)throw new _b(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===Em.System)throw new _b(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:t,currCode:r}},e.prototype.parseFormatCulture=function(e){var t,r,n={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},a=e.match(mb);if(null!=a){n.culture=null!==(t=a[1])&&void 0!==t?t:"";var i=null!==(r=a[2])&&void 0!==r?r:a[3];if(null!=i){if(n.tag=bb[i.toLowerCase()],void 0===n.tag)return;switch(n.tag){case tm.SysDate:case tm.SysTime:case tm.Euro1:case tm.Euro2:case tm.Bitcoin1:case tm.Bitcoin2:if(""!==n.culture)return;break;case tm.GenLower:case tm.GenUpper:case tm.NomLower:case tm.Gannen:if(""===n.culture)return}}var o=a[4];if(null!=o){var u=Cb(o),s=(32512&u)>>8;if(0!==s&&(n.numberShape=gb[s],void 0===n.numberShape))return;n.nationalNumberInput=0!=(32768&u);var l=127&u;if(0!==l&&(n.calendar=Sb[l],void 0===n.calendar))return;n.localCalendarInput=0!=(128&u)}return n}if(pb.test(e)){var c=Cb(e);switch(c){case bu.SystemLongDate:n.tag=tm.SysDate;break;case bu.SystemTime:n.tag=tm.SysTime;break;case bu.EuroTrailing:n.tag=tm.Euro1;break;case bu.EuroLeading:n.tag=tm.Euro2;break;default:64512==(64512&c)&&(n.tag=tm.GenLower),63488==(64512&c)&&(n.tag=tm.GenUpper),62464==(64512&c)&&(n.tag=tm.NomLower),void 0!==n.tag&&(c&=-63489),n.culture=function(e){var t;return"string"==typeof e?e:null!==(t=qS[e])&&void 0!==t?t:e}(c)}return n}},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,n=this.parts;r<n.length;r++){var a=n[r];t.accountFill=!1;var i=this.determineValueTypeCodes(t,a.code);if(void 0!==i)return i;if(t.accountFill&&(t.fvt===$p.Number||t.fvt===$p.Currency))return $p.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===hb(e.pictureSpecial,yu.General)?$p.General:$p.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,n=0;n<t.length;n+=1){var a=t[n];switch(a.kind){case ub.General:break;case Cu.Text:return $p.Text;case Cu.Star:e.accountFill=!0;break;case 400:case ub.Exp:case Cu.Slash:case ub.StrLit:case Cu.Percent:case Cu.Underscore:case ub.Numeral:case 405:case 406:break;case ub.Currency:e.fvt=$p.Currency;break;case ub.CurrCode:void 0!==a.currencySymbol&&(e.fvt=$p.Currency);break;case 403:e.fvt=1===a.numPercent&&0===a.numThousands?$p.Percentage:$p.Number;var i=a.codeBefore,o=0;if(r.isEastAsia){if(o<i.length&&"("===Eb(i[o])&&(o+=1),o<i.length&&"US$"===Eb(i[o]))return $p.Currency;if(r.isChinaT){if(o<i.length&&"NT$"===Eb(i[o]))return $p.Currency}else if(o<i.length&&"$"===Eb(i[o]))return $p.Currency}var u=void 0;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBefore.slice(o))))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.code)))return u;break;case 402:e.fvt=$p.Scientific;u=void 0;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeMant)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeExp)))return u;break;case 401:e.fvt=$p.Fraction;u=void 0;if(void 0!==a.codeInt&&void 0!==(u=this.determineValueTypeCodes(e,a.codeInt)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween1)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeNumer)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween2)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeDenom)))return u;break;case Cu.Decimal:case Cu.Hash:case Cu.Zero:case Cu.Question:break;case ub.PrefixDigTh:case ub.LatinDate:case ub.BidiDate:break;case Cu.HourTh:case Cu.MinuteTh:case Cu.SecondTh:case Cu.Hour:case Cu.Minute:case Cu.Second:case 404:return $p.Time;case ub.AMPM:case ub.AMPMFE:break;case Cu.Era:case Cu.EraYear:case Cu.YearTh:case Cu.EngYearTh:case Cu.ThYear:case Cu.MonthTh:case Cu.DayTh:case Cu.Year:case Cu.Month:case Cu.Day:case Cu.LocDay:return $p.Date;case 407:return this.determineValueTypeCodes(e,a.codeThisFormat);default:return te("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",a)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[0].code;e<t.length;e++){var r=t[e];switch(r.kind){case 403:return r.numDigDec;case 402:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=hb(this.config.localeInfo.pictureSingle,Cu.BidiDate);return V(this.formatString,e+"1")?em.English:V(this.formatString,e+"2")?em.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],a=t[2],i=t[3],o=!(Tb(i)||i===r),u=this.posBeforeText||!o,s="";return u&&(s+=this.printPart(r,this.condPos),n!==r&&(s+=hb(e.pictureSingle,Cu.Sep),s+=this.printPart(n,this.condNeg),a!==r&&(s+=hb(e.pictureSingle,Cu.Sep),s+=this.printPart(a,void 0)))),o&&(u&&(s+=hb(e.pictureSingle,Cu.Sep)),s+=this.printPart(i,void 0)),s},e.prototype.printPart=function(e,t){var r,n=this.config,a=n.mathpack,i=n.localeInfo,o="";if(void 0!==e.color&&(o+=hb(i.pictureSingle,Cu.ColorStart)+("number"==typeof e.color?hb(i.pictureColor,ku.Color)+String(e.color-8):hb(i.pictureColor,(r=e.color,ku[r])))+hb(i.pictureSingle,Cu.ColorEnd)),void 0!==t){o+=hb(i.pictureSingle,Cu.ColorStart)+hb(sb,cb[t.operator])+a.formatGeneral(i,t.operand,21)+hb(i.pictureSingle,Cu.ColorEnd)}return void 0!==e.dbnum&&(o+=hb(i.pictureSingle,Cu.ColorStart)+hb(i.pictureDbnum,e.dbnum-1)+hb(i.pictureSingle,Cu.ColorEnd)),o+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var n,a=this.config,i=a.mathpack,o=a.localeInfo,u="";if(void 0!==r&&r.numThousands>0){for(var s=0;s<t.length;s+=1){var l=t[s].kind;l!==Cu.Zero&&l!==Cu.Hash&&l!==Cu.Question&&l!==Cu.Decimal&&l!==ub.Numeral||(n=s)}ne("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==n)}var c=function(a){var s=t[a],l=e.wasPrevDig;switch(e.wasPrevDig=!1,s.kind){case ub.General:u+=hb(o.pictureSpecial,yu.General);break;case Cu.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,u+=hb(o.pictureSingle,Cu.Decimal);break;case Cu.Hash:case Cu.Zero:case Cu.Question:e.seenDig=!0,e.wasPrevDig=!0;var c=W(s.kind===Cu.Zero?"0":hb(o.pictureSingle,s.kind),s.count);if(void 0===r||r.decimal){u+=c;break}if(r.comma){var f=r.numDigLeft-s.count;u+=Um({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>f||((n=null===(r=t[a+1])||void 0===r?void 0:r.kind)===Cu.Hash||n===Cu.Zero||n===Cu.Question))},thousandsSeparator:hb(o.pictureSingle,Cu.Comma)},c,f)}else u+=c;r.numDigLeft-=s.count;break;case ub.Numeral:e.wasPrevDig=!0,u+=s.formattedStr;break;case 402:u+=d.printCodes(e,s.codeMant,{comma:s.commaMant,numThousands:0,decimal:!1,numDigLeft:s.numMantDigLeft})+d.printCodes(e,s.codeBetween,void 0)+d.printCodes(e,s.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:s.numExpDigLeft});break;case 403:u+=d.printCodes(e,s.codeBefore,void 0)+d.printCodes(e,s.code,{comma:s.comma,numThousands:s.numThousands,decimal:!1,numDigLeft:s.numDigLeft});break;case 401:var h=void 0===s.codeInt?"":d.printCodes(e,s.codeInt,{comma:s.commaInt,numThousands:0,decimal:!1,numDigLeft:s.numIntDigLeft}),v=d.printCodes(e,s.codeBetween1,void 0),p=d.printCodes(e,s.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:s.numNumerDig}),m=d.printCodes(e,s.codeBetween2,void 0),g=d.printCodes(e,s.codeDenom,{comma:!1,numThousands:s.numThousands,decimal:!1,numDigLeft:s.numDenomDig});u+=h+v+p+m+(void 0!==s.denomValue?ZS(i,s.denomValue):g);break;case 400:var S=hb(o.pictureSingle,Cu.Backslash),b=fb(o,o.pictureSingle,s.formattedStr,0),y=function(e,t,r,n){var a=r.substring(n,n+Fi(Ii(r,n)));for(var i in t){var o=t[i];if(null!=o&&0!==o.length){var u=o.substring(0,Fi(Ii(o,0)));if(0===e.stringCompareCI(a,u))return!0}}return!1}(o,o.pictureSpecial,s.formattedStr,0);if(void 0!==b&&b!==Cu.Extra&&b!==Cu.Zero)switch(b){case Cu.Comma:var C=t[a+1];if(l){var k=hb(o.pictureSingle,Cu.Space);if(s.formattedStr!==k||void 0===C||(o.isCurrencySymbolLead||!o.isCurrencySepBySpace||C.kind!==ub.Currency)&&(!o.isPercentSepBySpace||C.kind!==Cu.Percent)){u+=S;break}}if(400===(null==C?void 0:C.kind)&&(null==C?void 0:C.formattedStr)===s.formattedStr){u+=S;break}break;case Cu.Decimal:u+=S;break;case Cu.Slash:e.seenDig&&(u+=S);break;case Cu.Space:case Cu.Minus:case Cu.Plus:case Cu.OpenParen:case Cu.CloseParen:break;case Cu.DateSep:hb(o.pictureSingle,Cu.DateSep)!==hb(o.pictureSingle,Cu.Minus)&&(u+=S);break;default:u+=S}else(y||o.isNumeral(Ii(s.formattedStr,0)))&&(u+=S);u+=s.formattedStr;break;case ub.Exp:u+=s.formattedStr+(s.isNeg?"-":"+");break;case ub.StrLit:S=hb(o.pictureSingle,Cu.Quote);ne("calc.numfmt.NumberFormatImpl: printCodes StrLit",s.escaped.indexOf(S)<0),u+=S+s.escaped+S;break;case Cu.Slash:u+=hb(o.pictureSingle,Cu.Slash);break;case Cu.Percent:u+=hb(o.pictureSingle,Cu.Percent);break;case Cu.Star:u+=hb(o.pictureSingle,Cu.Star)+s.escaped;break;case Cu.Underscore:u+=hb(o.pictureSingle,Cu.Underscore)+s.escaped;break;case ub.PrefixDigTh:u+="t";break;case ub.Currency:u+=hb(o.pictureSpecial,yu.Currency);break;case ub.CurrCode:if(u+=hb(o.pictureSingle,Cu.ColorStart),u+="$",void 0!==s.currencySymbol&&(u+=s.currencySymbol),void 0!==s.currCode){var E=s.currCode,A=E.culture,R=E.numberShape,N=E.nationalNumberInput,T=E.calendar,I=E.localCalendarInput,F=E.tag;switch(u+="-",typeof A){case"number":var O=A;switch(ne("calc.numfmt.NumberFormatImpl: printCodes lcid",void 0===R&&!N&&void 0===T&&!I),F){case void 0:break;case tm.GenLower:O|=64512;break;case tm.GenUpper:O|=63488;break;case tm.NomLower:O|=62464;break;default:re("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var D=yb(O);/^[a-f]{1,7}$/i.test(D)&&(D="0"+D),u+=D;break;case"string":u+=A,void 0!==F&&(""!==A&&(u+="-"),u+="x-",u+=String(F));var M=0;void 0!==R&&(M|=gb.indexOf(R)<<8),N&&(M|=32768),void 0!==T&&(M|=Sb.indexOf(T)),I&&(M|=128),0!==M&&(u+=",",u+=yb(M))}}u+=hb(o.pictureSingle,Cu.ColorEnd);break;case Cu.Text:u+=hb(o.pictureSingle,Cu.Text);break;case ub.LatinDate:u+=hb(o.pictureSingle,Cu.BidiDate)+"1";break;case ub.BidiDate:u+=hb(o.pictureSingle,Cu.BidiDate)+"2";break;case 404:u+=hb(o.pictureSingle,Cu.Decimal)+W("0",s.rounding);break;case 405:u+=hb(o.pictureSingle,Cu.DateSep);break;case 406:u+=hb(o.pictureSingle,Cu.Colon);break;case Cu.Era:case Cu.EraYear:case Cu.Year:case Cu.YearTh:case Cu.EngYearTh:case Cu.ThYear:case Cu.Month:case Cu.MonthTh:case Cu.Day:case Cu.DayTh:case Cu.LocDay:u+=W(hb(o.pictureSingle,s.kind),s.count);break;case Cu.Hour:case Cu.HourTh:case Cu.Minute:case Cu.MinuteTh:case Cu.Second:case Cu.SecondTh:if(s.isAbs){u+=hb(o.pictureSingle,Cu.ColorStart)+W(hb(o.pictureSingle,s.kind),s.count)+hb(o.pictureSingle,Cu.ColorEnd);break}u+=W(hb(o.pictureSingle,s.kind),s.count);break;case ub.AMPM:case ub.AMPMFE:s.kind===ub.AMPMFE||o.isEastAsia||s.pictureKind===yu.AP2?u+=s.tokenStr:u+=hb(o.pictureSpecial,s.pictureKind);break;case 407:u+=d.printCodes(e,s.codeThisFormat,void 0);break;default:return{value:te("calc.numfmt.NumberFormatImpl: printCodes code",s)}}a===n&&(u+=W(hb(o.pictureSingle,Cu.Comma),r.numThousands))},d=this;for(s=0;s<t.length;s+=1){var f=c(s);if("object"==typeof f)return f.value}return u},e.prototype.countBytecodeBuffer=function(e){for(var t,r,n=this.config,a=n.mathpack,i=n.localeInfo,o=0,u=0;u<e.length;u+=1){var s=e[u],l=1;switch(s.kind){case Cu.Percent:case ub.Numeral:case 400:case Cu.Star:case Cu.Underscore:l+=2;break;case ub.StrLit:l+=1+2*s.escaped.length;break;case 404:case Cu.Hash:case Cu.Zero:case Cu.Question:case ub.Exp:l+=1;break;case Cu.Hour:case Cu.HourTh:case Cu.Minute:case Cu.MinuteTh:case Cu.Second:case Cu.SecondTh:s.isAbs&&(l+=1);break;case 401:if(l+=5,void 0!==s.codeInt&&(l+=this.countBytecodeBuffer(s.codeInt)),l+=this.countBytecodeBuffer(s.codeBetween1),l+=this.countBytecodeBuffer(s.codeNumer),l+=this.countBytecodeBuffer(s.codeBetween2),l+=this.countBytecodeBuffer(s.codeDenom),void 0!==s.denomValue)l-=2,l+=2+2*ZS(a,s.denomValue).length;s.commaInt&&(l+=1);break;case 402:l+=3,l+=this.countBytecodeBuffer(s.codeMant),l+=this.countBytecodeBuffer(s.codeBetween),l+=this.countBytecodeBuffer(s.codeExp),s.commaMant&&(l+=1);break;case 403:l+=3,l+=this.countBytecodeBuffer(s.codeBefore),l+=this.countBytecodeBuffer(s.code),s.comma&&(l+=1);break;case 407:l=0,l+=this.countBytecodeBuffer(s.codeThisFormat);break;case ub.CurrCode:l+=2*((null!==(r=null===(t=s.currencySymbol)||void 0===t?void 0:t.length)&&void 0!==r?r:0)+1),l+=8;break;case ub.AMPM:var c=i.isEastAsia||s.pictureKind===yu.AP2?vb(i,s.tokenStr):i.ampmSymbols;l+=2+2*(c[0].length+c[1].length);break;case ub.AMPMFE:break;case ub.General:case Cu.Decimal:case Cu.Slash:case ub.PrefixDigTh:case ub.Currency:case Cu.Text:case ub.LatinDate:case ub.BidiDate:case 405:case 406:case Cu.Era:case Cu.EraYear:case Cu.Year:case Cu.YearTh:case Cu.EngYearTh:case Cu.ThYear:case Cu.Month:case Cu.MonthTh:case Cu.Day:case Cu.DayTh:case Cu.LocDay:break;default:return te("calc.numfmt.NumberFormatImpl: printCodes code",s)}o+=l}return o},e.prototype.countBytecodePart=function(e){var t=e.code,r=0;return void 0!==e.color&&(r+=2),void 0!==e.dbnum&&(r+=2),0!==e.dtrRounding&&(r+=2),r+=this.countBytecodeBuffer(t)},e.prototype.countBytecode=function(){for(var e=0,t=0;t<=3;t+=1){(0===t&&void 0!==this.condPos||1===t&&void 0!==this.condNeg)&&(e+=10);for(var r=this.parts[t],n=!1,a=0;a<t;a+=1)if(this.parts[a]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e},e.prototype.checkBytecode=function(){if(Le(De["OfficeVSO:3852168_CalcNFLength"])){if(this.countBytecode()>255)throw new _b(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new _b(Pn(["format string too long: close to bytecode limit"]))}},e.prototype.getBundledLocaleInfo=function(e,t){if(void 0!==(null==t?void 0:t.culture)){var r=Le(De["OfficeVSO:3852168_CalcNFLocaleData"])?xS(t):void 0;if(void 0===r)throw new wb(this.notImplementedCulture(e,t.culture));return r}return this.config.localeInfo},e.prototype.notFormatString=function(e){return Qp(e+": "+this.logFormatString)},e.prototype.notImplementedCulture=function(e,t){return Pn([e+": culture = "+("number"==typeof t?"lcid:"+yb(t):"lang:"+t)])},e}();function Pb(e,t,r,n){try{var a=void 0,i=void 0,o=void 0,u=e.config.localeInfo;switch(r.kind){case Tt.String:a=function(e){if(0===e.length)return!1;var t=Ii(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?nm.Right:nm.Left,i=im.None,o=r;break;case Tt.Number:a=t.isTextOnly?nm.Left:nm.Right,i=im.All,o=r;break;case Tt.Boolean:a=nm.Center,i=im.All,o=Fa(r.value?u.trueName:u.falseName);break;case Tt.Blank:return he(gm([],void 0,nm.Left,im.All));case Tt.Error:var s=u.errorNames[r.type];return null==s?ge(Bn("missing error name")):he(gm([fm(s)],void 0,nm.Center,im.All));case Tt.Array:return ge(Pn(["Array applyFormat"]));case Tt.Rich:return ge(Pn(["Rich applyFormat"]))}return t.apply(o,a,i,n)}catch(e){return ge(be(e))}}function xb(e,t){try{switch(e.valueType){case $p.General:return ge(Pn(["changeDecimals General"]));case $p.Number:case $p.Currency:case $p.Accounting:case $p.Percentage:case $p.Scientific:if(0===e.decimals&&t<0)return me;var r=E(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?me:he(n);default:return me}}catch(e){return ge(be(e))}}var Bb=function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}},Ub={},Gb=Un("InferenceError"),jb={getDocumentLoc:function(){return re("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return re("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return re("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return re("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return re("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return re("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return re("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return re("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return re("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return re("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return re("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return re("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return re("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function Vb(e,t){var r,n,a=function(e){var t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,y,C,k,E,A,R,N;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:jb.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:jb.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:jb.getSheetName,getNameLoc:null!==(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e))&&void 0!==s?s:jb.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(l=e.getUserDefinedFuncLoc)||void 0===l?void 0:l.bind(e))&&void 0!==c?c:jb.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:jb.getSheetRangeIndexes,getCellFormat:null!==(v=null===(h=e.getCellFormat)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:jb.getCellFormat,getKnownFormat:null!==(m=null===(p=e.getKnownFormat)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:jb.getKnownFormat,getIformat:null!==(S=null===(g=e.getIformat)||void 0===g?void 0:g.bind(e))&&void 0!==S?S:jb.getIformat,getFormatString:null!==(y=null===(b=e.getFormatString)||void 0===b?void 0:b.bind(e))&&void 0!==y?y:jb.getFormatString,getContainingTable:null!==(k=null===(C=e.getContainingTable)||void 0===C?void 0:C.bind(e))&&void 0!==k?k:jb.getContainingTable,getStructRefColumn:null!==(A=null===(E=e.getStructRefColumn)||void 0===E?void 0:E.bind(e))&&void 0!==A?A:jb.getStructRefColumn,getStructRefSpecialRef:null!==(N=null===(R=e.getStructRefSpecialRef)||void 0===R?void 0:R.bind(e))&&void 0!==N?N:jb.getStructRefSpecialRef}}(e);return{globals:a,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!Se(e))throw new Gb(e);return e.value.document},get defaultFormat(){var e=Jb(this,yi.General);return Bb(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=Jb(this,yi.General);return Bb(!0,e,e.valueType,e.decimals)},resolver:Es(a),multOrDivTainted:!1}}var Hb,Wb=((Fb={})[$p.General]=0,Fb[$p.Number]=1,Fb[$p.Currency]=2,Fb[$p.Accounting]=2,Fb[$p.Percentage]=3,Fb[$p.Date]=4,Fb[$p.Time]=5,Fb[$p.Fraction]=6,Fb[$p.Scientific]=7,Fb[$p.Text]=8,Fb[$p.Custom]=9,Fb);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(Hb||(Hb={}));var Kb=((Ob={})[Ka.INT]=Hb.Propagate,Ob[Ka.MOD]=Hb.Propagate,Ob[Ka.ROUND]=Hb.Propagate,Ob[Ka.SUM]=Hb.Propagate,Ob[Ka.TRUNC]=Hb.Propagate,Ob[Ka.AVERAGE]=Hb.Propagate,Ob[Ka.MAX]=Hb.Propagate,Ob[Ka.MEDIAN]=Hb.Propagate,Ob[Ka.MIN]=Hb.Propagate,Ob[Ka.ROUNDUP]=Hb.Propagate,Ob[Ka.ROUNDDOWN]=Hb.Propagate,Ob[Ka.NPV]=yi.CoCurrencyDec,Ob[Ka.PV]=yi.CoCurrencyDec,Ob[Ka.FV]=yi.CoCurrencyDec,Ob[Ka.PMT]=yi.CoCurrencyDec,Ob[Ka.RATE]=yi.Pct0,Ob[Ka.MIRR]=yi.Pct0,Ob[Ka.IRR]=yi.Pct0,Ob[Ka.DATE]=yi.MMDDYY,Ob[Ka.TIME]=yi.HHMMAP,Ob[Ka.NOW]=yi.MDYHMS,Ob[Ka.SLN]=yi.CoCurrencyDec,Ob[Ka.SYD]=yi.CoCurrencyDec,Ob[Ka.DDB]=yi.CoCurrencyDec,Ob[Ka.IPMT]=yi.CoCurrencyDec,Ob[Ka.PPMT]=yi.CoCurrencyDec,Ob[Ka.TODAY]=yi.MMDDYY,Ob[Ka.VDB]=yi.CoCurrencyDec,Ob[Ka.DB]=yi.CoCurrencyDec,Ob);var zb=[[$p.General,$p.Number,$p.Currency,$p.Percentage,$p.Date,$p.Time,$p.Fraction,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.Number,$p.Currency,$p.Percentage,$p.Date,$p.Time,$p.Number,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.Currency,$p.General,$p.General,$p.General,$p.Currency,$p.Currency,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.Percentage,$p.General,$p.General,$p.Percentage,$p.Percentage,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.Date,$p.General,$p.General,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.Time,$p.General,$p.General,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Fraction,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Custom]],Yb=[[$p.General,$p.Number,$p.Currency,$p.General,$p.Date,$p.Time,$p.Fraction,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.Number,$p.Currency,$p.Number,$p.Date,$p.Time,$p.Fraction,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.Currency,$p.General,$p.General,$p.Currency,$p.Currency,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.Percentage,$p.Date,$p.Time,$p.Percentage,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Date,$p.Date,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Time,$p.Time,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Fraction,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Scientific,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Text,$p.Custom],[$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.General,$p.Custom]];function qb(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!Se(r))throw new Gb(r.reason);return r.value}function Jb(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!Se(r))throw new Gb(r.reason);return r.value}function Qb(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!Se(r))throw new Gb(r.reason);return void 0!==r.value?r.value:t}function Xb(e,t,r){return ne("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,t[0],t[1])}function Zb(e,t,r,n){var a=r[0],i=n[0],o=Wb[a.valueType],u=Wb[i.valueType],s=o<=u?t[o][u]:t[u][o],l=Wb[s],c=i.decimals>a.decimals?i.decimals:a.decimals;switch(l){case o:return Bb(!0,a.format,a.valueType,c);case u:return Bb(!0,i.format,i.valueType,c);default:return e.unitlessFormat}}function $b(e,t,r){return Zb(e,Yb,t,r)}function ey(e,t,r){var n=t[0],a=r[0];if(n.format===a.format&&n.valueType===a.valueType&&n.valueType===$p.Time)return Bb(!0,n.format,n.valueType,n.decimals);if(n.valueType===$p.Date&&a.valueType===$p.Time||n.valueType===$p.Time&&a.valueType===$p.Date){var i=Jb(e,yi.MDYHMS),o=i.valueType,u=i.decimals;return Bb(!0,i,o,u)}return Zb(e,zb,t,r)}var ty=function(e){return e.unitlessFormat};function ry(e,t,r){var n=t[0],a=r[0];return n.format===a.format?Bb(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function ny(e){return Wb[e]===Wb[$p.General]}var ay=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Ue(t,e)},this.lazyVisitFormulaNode=function(e){return Oe.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){switch(e.kind){case Tt.String:case Tt.Boolean:case Tt.Error:case Tt.Missing:return Oe.resolve(this.context.defaultFormat);case Tt.Number:var t=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),21),r=t.indexOf(this.context.localeInfo.decimalSeparator),n=r>=0?t.length-r-1:0,a=Jb(this.context,yi.General);return Oe.resolve(Bb(!1,a,a.valueType,n));default:return te("calc.numfmt.evalFormat: unexpected literal oper",e)}},e.prototype.arrayNode=function(e){return Oe.resolve(this.context.defaultFormat)},e.prototype.appNode=function(e,t){var r,n=this;if(fn(e))return Oe.all(t.map((function(e){return n.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return function(e,t,r){switch(t){case Qa.Mul:case Qa.Div:return e.multOrDivTainted=!0,Xb(e,r,$b);case Qa.Pow:return Xb(e,r,$b);case Qa.Add:case Qa.Sub:return Xb(e,r,ey);case Qa.Percent:ne("calc.numfmt.evalFormat: well-formed unary op",1===r.length);var n=r[0],a=n[0];if(!mn(n[1]))return e.defaultFormat;var i=a.strong,o=a.decimals,u=Jb(e,yi.Pct);return Bb(i,u,u.valueType,o);case Qa.Pound:case Qa.At:return e.defaultFormat;case Qa.Neg:case Qa.Pos:return ne("calc.numfmt.evalFormat: well-formed unary op",1===r.length),a=r[0][0];case Qa.Lt:case Qa.Le:case Qa.Eq:case Qa.Ge:case Qa.Gt:case Qa.Ne:return Xb(e,r,ty);case Qa.Isect:case Qa.Union:case Qa.Range:case Qa.Concat:return Xb(e,r,ry);case Qa.And:case Qa.Or:case Qa.Xor:case Qa.Min:case Qa.Max:throw new Gb(Pn(["evalFormat for Yellow ops"]));default:return te("calc.numfmt.evalFormat: unexpected operator id",t)}}(n.context,e.id,t)}));if(hn(e)){var a=e.id,i=null!==(r=Kb[a])&&void 0!==r?r:Hb.Ignore,o=vi(a),u=dn(Zt(e,t));if(ne("calc.numfmt.evalFormula: well-formed WSF args",Sn(o,u.length)),i===Hb.Ignore)return Oe.resolve(this.context.defaultFormat);if(i===Hb.Propagate)return 0===u.length?Oe.resolve(this.context.defaultFormat):Oe.all(t.map(this.lazyVisitFormulaNode)).bind((function(e){var t=e[0],r=t.format,a=t.valueType,i=t.decimals,o=!ny(a);if(!t.strong&&o)return n.context.unitlessFormat;for(var u=o,s=1;s<e.length;s+=1){var l=e[s],c=!ny(l.valueType);if(!l.strong&&c)return n.context.unitlessFormat;u||(r=l.format,a=l.valueType,i=l.decimals,u=c)}return Bb(!0,r,a,i)}));var s=Jb(this.context,i),l=s.valueType,c=s.decimals;return Oe.resolve(Bb(!0,s,l,c))}return this.lazyVisitFormulaNode(e)},e.prototype.letNode=function(e,t,r,n){return Oe.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(e,t,r,n){return Oe.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return Oe.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(e,t){var r=this.context.resolver.resolveCellRef(this.context.locals,Sr(e,t)).resolution;if(!Se(r))throw ne("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==ns.NoOriginSheet),new Gb(r.reason);var n=r.value;if(void 0===n)throw Ub;return Gr(n)?Oe.resolve(oy(this.context,n)):Oe.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(e,t){var r=this;return this.lazyVisitFormulaNode(e).bind((function(e){return r.context.defaultFormat}))},e.prototype.structRefNode=function(e,t){var r=Cr(e,t),n=this.context.resolver.resolveStructRef(this.context.locals,r).resolution;if(!Se(n)){if(ne("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==ns.NoOriginSheet),n.reason.kind===ns.EmptyIntersection)throw Ub;throw new Gb(n.reason)}var a=n.value;if(void 0===a)throw Ub;return Oe.resolve(oy(this.context,a))},e.prototype.badSequenceNode=function(e,t){return re("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badStringNode=function(e,t){return re("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(e,t){return Oe.resolve(lr(e,t))},e.prototype.wsfNode=function(e,t,r){return Oe.resolve(cr(e,t,r))},e}();function iy(e,t){return yt(new ay(e),t)}function oy(e,t){var r=un(t),n=e.globals.getCellFormat(r);if(!Se(n))throw new Gb(n.reason);var a=n.value,i=qb(e,a);if(!Zr(r.sheet.document,e.document)&&("number"!=typeof a||i.source!==Em.Builtin))return e.defaultFormat;var o=i.valueType,u=i.decimals;return Bb(!0,a,o,u)}function uy(e,t,r){try{var n=Vb(e,t);return he(function(e,t){var r=t.strong,n=t.format,a=t.valueType,i=t.decimals;if(a!==$p.Number||!e.multOrDivTainted){if(i>0&&r&&(a===$p.Number||a===$p.Currency||a===$p.Accounting||a===$p.Percentage)){var o=qb(e,n);i!==o.decimals&&(n=o.synthesizeDecimals(i))}if(a!==$p.General&&r)return n=Qb(e,n)}}(n,iy(n,r)))}catch(e){return e instanceof Gb?ge(e.reason):e===Ub?me:ge(be(e))}}var sy,ly,cy,dy={getKnownFormat:function(){return re("calc.numfmt: default getKnownFormat")},getIformat:function(){return re("calc.numfmt: default getIformat")},getFormatString:function(){return re("calc.numfmt: default getFormatString")}};function fy(e,t,r,n,a){var i=t.getFormatString(r,n);if(!Se(i))return i;if(void 0!==i.value)return t.getIformat(r,i.value);var o=e.createFormat(n,a);return Se(o)?o:o.reason.kind===Hp.NotFormatString?ge(lm()):ge(o.reason)}function hy(e,t,r){var n=Cn(r)?im.None:im.All,a=t.apply(r,nm.Right,n,!0);if(!Se(a))return a;var i=e.renderValue(a.value,Nm);return Se(i)?bm(i.value)?he(i.value.units):he(Tm(i.value)):i}function vy(e){return e.value.kind}function py(e,t,r,n){var a=r;if(n.kind===km.Number&&n.format!==yi.General){var i=n.format,o="string"==typeof i?i:tg(t,i),u="string"!=typeof i,s=e.createFormat(o,u);if(!Se(s))return s;var l=s.value;Hg(l,r)&&(a=l)}return e.applyFormat(a,n.value,!0)}function my(e,t,r,n,a){if(a.isDate||a.isTime){var i=function(e,t,r,n,a){var i=t.config,o=i.mathpack,u=i.localeInfo;if(o.cond(n)<0)return he(void 0);var s="",l=0!==o.fix(n)||a.isDate,c=n;if(l){var d=o.trunc(n),f=fy(e,t,r,$m(u,!0),Em.CustomString);if(!Se(f))return f;if(!Se(v=hy(e,f.value,d)))return v;if("string"!=typeof v.value)return he(void 0);s+=v.value;var h=o.sub(n,d);ne("calc.numfmt.renderFormulaBar: sub error",!En(h)),c=h}if(o.cond(c)>0||a.isTime){l&&(s+="  ");var v,p=t.getKnownFormat(r,u.clock24Hour?yi.HHMMSS:yi.HHMMSSAP);if(!Se(p))return p;if(!Se(v=hy(e,p.value,c)))return v;if("string"!=typeof v.value)return he(void 0);s+=v.value}return he(s)}(e,function(e){var t,r,n,a,i,o;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:dy.getKnownFormat,getIformat:null!==(a=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:dy.getIformat,getFormatString:null!==(o=null===(i=e.getFormatString)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:dy.getFormatString}}(t),r,n,a);if(!Se(i))return i;if(void 0!==i.value){i.value;return i}}var o=t.config,u=o.mathpack,s=o.localeInfo;if(a.isPercent){var l=u.mul(n,u.fromNumber(100));return En(l)?ge(Pn(["renderFormulaBar % overflow"])):he(u.formatGeneral(s,l,21)+"%")}return he(u.formatGeneral(s,n,21))}function gy(e){return{createFormat:function(t,r){return function(e,t,r){try{return he(new Lb(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return ge(e instanceof _b?e.reason:be(e))}}(e,t,"boolean"!=typeof r?r:r?Em.Builtin:Em.CustomString)},applyFormat:function(t,r,n){return Pb(e,t,r,n)},changeFormatDecimals:xb,renderValue:function(t,r){return _S(e.config.mathpack,t,r)},renderHashesValue:function(e,t){return function(e,t){try{var r=FS(Cm(t),e.clip,"","","#",(function(e){return W("#",e)}));if("number"==typeof r)switch(r){case im.MaxChars:r=W("#",255);break;case im.CellWidth:r="";break;default:return te("calc.numFmt.renderHashesValue",r)}var n=fm(r);return he(Sm([n],e.color,e.alignment,e.clip))}catch(e){return ge(be(e))}}(e,t)},renderFormulaBar:function(t,r,n,a){return function(e,t,r,n,a,i){try{var o=t.config.localeInfo;switch(n.kind){case Tt.Number:return my(e,t,r,n,a);case Tt.String:return he(i?"'"+n.value:n.value);case Tt.Boolean:return he(n.value?o.trueName:o.falseName);case Tt.Error:var u=o.errorNames[n.type];return null==u?ge(Bn("missing error name")):he(u);case Tt.Array:return ge(Pn(["Array renderFormulaBar"]));case Tt.Rich:return ge(Pn(["Rich renderFormulaBar"]));case Tt.Blank:return he("");default:return te("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return ge(be(e))}}(this,e,t,r,n,a)},parseGeneral:function(t,r,n,a){return function(e,t,r,n,a){try{var i=e.config,o=cg(i.localeInfo,i.mathpack,t,r,n,!1);return Se(o)?void 0!==o.value?o:Bg(fg(e),t,void 0,a):o}catch(e){return ge(be(e))}}(e,t,r,n,a)},parseDate:function(t,r){return function(e,t,r){try{return Bg(fg(e),t,void 0,r)}catch(e){return ge(be(e))}}(e,t,r)},parseEdit:function(t,r){return function(e,t,r){try{if(r.valueType===$p.Text)return Ug(t);if(""===t)return he(Dm(Ya));if(V(t,"="))return he(Im(t));if(!V(t,"'")){var n=Vg(e,t,r);if(!Se(n))return n;if(void 0!==n.value)return he(n.value)}return"="===(a=t.charAt(0))||"+"===a||"-"===a||"@"===a?he(Im(t)):Ug(t)}catch(e){return ge(be(e))}var a}(e,t,r)},evalFormat:function(t,r){return uy(e,t,r)}}}(ly=sy||(sy={})).FormatReasonKind=Hp,ly.ReasonKind=qp,ly.notValueString=Jp,ly.notFormatString=Qp,ly.noFormatPart=Xp,ly.tooWide=Zp,ly.dateOverflow=um,ly.fractionOverflow=sm,ly.previousFormatFailure=lm,ly.FormatValueType=$p,ly.BidiDate=em,ly.CultureTag=tm,ly.NamedColor=rm,ly.Alignment=nm,ly.GetTimeKind=am,ly.Clip=im,ly.FormattedUnitKind=om,ly.formattedUnitGeneral=dm,ly.formattedUnitString=fm,ly.formattedUnitBlank=hm,ly.formattedUnitFlexible=vm,ly.formattedValue=gm,ly.renderedValue=Sm,ly.hashesValue=mm,ly.isHashesValue=bm,ly.renderCallback=ym,ly.memoizedRenderCallback=Cm,ly.renderInfiniteWidth=Nm,ly.renderedValueToString=Tm,ly.EditKind=km,ly.formulaEdit=Im,ly.stringEdit=Fm,ly.numberEdit=Om,ly.otherEdit=Dm,ly.NumberFormatSource=Em,ly.createFormatGlobals=Mm,ly.evalFormatLocalsGrid=wm,ly.KnownFormat=yi,ly.CurrencyFormat=mi,ly.DateOrder=gi,ly.NumberShape=Si,ly.Calendar=bi,ly.getKnownFormat=tg,ly.isKnownFormatDefined=rg,ly.englishXLSXKnownFormat=ag,ly.RibbonFormat=ng,ly.getRibbonFormat=og,ly.shouldInstallFormat=Hg,ly.createNumberFormatter=gy,ly.getValueEditOperKind=vy,ly.applyValueEdit=py,function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(cy||(cy={}));var Sy=Object(fe.a)(Object(fe.a)(Object(fe.a)(Object(fe.a)({},Ln),cy),Hp),ns);function by(e){return{config:e}}function yy(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:he(t),allowUnqualifiedCell:!0}}function Cy(e,t){return{config:null!=t?t:void 0,lexicalKind:Xn.NameManager,originGridCell:he(e),allowUnqualifiedCell:!1}}var ky,Ey,Ay,Ry=function(e,t){return oe("calc.runtime.interval: end",t),ue("calc.runtime.interval: start",e,t),{start:e,end:t}};function Ny(e,t,r){return{kind:Sy.IllFormedFormula,message:e,mode:t,diagnostics:r}}function Ty(e){return{kind:ky.FinalValue,oper:e}}function Iy(e){return{kind:ky.PendingValue,anchor:e}}function Fy(e,t){return{source:e,formula:t}}function Oy(e,t){return{source:e,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(ky||(ky={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Ey||(Ey={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(Ay||(Ay={}));var Dy={kind:Sy.Stopped};function My(e,t){return{arity:e,func:t}}function wy(e,t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,y,C,k,E,A,R,N,T,I,F){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:s,getWorksheetFunc:l,getUserDefinedFunc:c,getNameFormula:d,getCellFormula:f,getUsedRange:h,interruptToken:[Ey.Continue],getHiddenRows:v,getHiddenCols:p,isInFilterMode:m,getKnownFormat:g,getIformat:S,getFormatString:b,getRandom:y,getTime:C,schedulerConfig:null!=I?I:{},limits:null!=F?F:{},setCellValue:k,setCellValues:E,setCellFailure:A,getContainingTable:R,getStructRefColumn:N,getStructRefSpecialRef:T}}var _y,Ly,Py,xy=function(e,t,r,n,a,i,o,u,s,l){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,allowUnqualifiedCell:u,wrapCellReferences:s,followHyperlinks:l}};function By(e){return{kind:Sy.NameCycle,names:e}}function Uy(e){return{kind:Sy.CellCycle,cells:e}}function Gy(e){return{kind:Sy.PreviousFailure,range:e}}function jy(e){return{kind:Sy.PreviousNameFailure,name:e}}function Vy(e){return{kind:Sy.LimitExceeded,limit:e}}function Hy(e){return{kind:le.Paused,reason:Sy.Timeout,resume:e}}function Wy(e){if(e.kind===le.Failure)return e.reason.kind}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.StructRef=-2147483638]="StructRef",e[e.CallLambda=-2147483637]="CallLambda"}(Py||(Py={}));var Ky,zy=(_y=u(f,f)).wrap,Yy=_y.unwrap,qy=(Ly=u((function(e){return-e}),(function(e){return-e}))).wrap,Jy=Ly.unwrap;function Qy(e){return e>0}function Xy(e){return{kind:e,data:void 0,children:void 0}}function Zy(e,t,r){var n=Xy(Py.Array);return n.children=r,n.data={rows:e,cols:t},n}function $y(e,t,r,n){var a=Xy(Py.Lambda);return a.children=n,a.data={arity:e,closureId:t,closedIdents:r},a}function eC(e,t,r){var n=Xy(Py.Let);return n.children=Object(fe.f)(e,[r]),n.data={rec:t},n}function tC(e,t,r,n){var a=Xy(Py.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function rC(e,t,r,n){var a=Xy(Py.Name);return a.data={name:e,qualifier:t,source:r},a.children=n,a}function nC(e,t,r){var n=Xy(Py.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function aC(e,t){var r=Xy(Py.CellRef);return r.data={ref:e,qualifier:t},r}function iC(e){var t=Xy(Py.ReadStack);return t.data=e,t}function oC(e,t,r,n,a){var i=Xy(Py.Conditional);return i.children=Object(fe.f)([n],a),i.data={funName:e,funType:t,isFormulaRoot:r},i}function uC(e){return e.kind>0}var sC=Un("CompileError"),lC=Dr(1,[Tt.Number|Tt.String|Tt.Boolean|Tt.Rich|Tt.Error|Tt.Blank|Tt.Array],[Tt.Number|Tt.String|Tt.Boolean|Tt.Rich|Tt.Error|Tt.Blank|Tt.Missing|Tt.Array|Tt.Range],[],It.All,Ft.None,Ot.Allow3dRef),cC=uS(vi(Ka.IF)),dC=uS(vi(Ka.CHOOSE));function fC(e){return uC(e)&&wn(e)}var hC=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),vC=zl.create((function(e,t){return e-t})),pC=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Ue(t,e)},this.lazyVisitFormulaNode=function(e){return Oe.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e,t,r){return Oe.resolve(e)},e.prototype.arrayNode=function(e,t,r){var n=this;return Oe.all(e.map((function(e){return Oe.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.toArrayTerm(e)}))},e.prototype.toArrayTerm=function(e){var t=e.length,r=void 0===e[0]?0:e[0].length;return e.every((function(e){return e.every(fC)}))?Va(t,r,e):Zy(t,r,e)},e.prototype.appNode=function(t,r,n,a){var i,o=this,u=dn(Zt(t,r,n)),s=(null===(i=this.context.annotations[a])||void 0===i?void 0:i.kind)===mt.FormulaRoot;if(fn(t)){var l=hi(t.id);return Oe.all(u.map(this.lazyVisitFormulaNode)).bind((function(e){return tC(zy(t.id),l,s,e)}))}if(hn(t)){var c=t.id;switch(c){case Ka.IFERROR:case Ka.IFNA:ne("calc.runtime.toIfPredicateTerm: expected wff",2===u.length);var d=u[0],f=u[1],h=new e(Object(fe.a)(Object(fe.a)({},this.context),{numNames:this.context.numNames+1}));return Oe.all([this.lazyVisitFormulaNode(d),Oe.try((function(){return Ue(h,f)}))]).bind((function(e){var t=e[0],r=e[1];return o.toIfPredicateTerm(c===Ka.IFERROR?Ka.ISERROR:Ka.ISNA,t,r)}));case Ka._UDF:return re("calc.runtime.appNode: expected wff (not UDF)")}return Oe.all(u.map(this.lazyVisitFormulaNode)).bind((function(e){switch(c){case Ka.IF:return o.toIfTerm(e);case Ka.CHOOSE:return o.toChooseTerm(e)}var t=vi(c);return tC(qy(c),t,!1,e)}))}return this.lazyVisitFormulaNode(t).bind((function(e){return Oe.all(u.map(o.lazyVisitFormulaNode)).bind((function(t){return o.toAppTerm(e,t)}))}))},e.prototype.toIfPredicateTerm=function(e,t,r){var n=iC(0);return eC([t],!1,oC(qy(Ka.IF),cC,!1,tC(qy(e),vi(e),!1,[n]),[r,n]))},e.prototype.toIfTerm=function(e){switch(e.length){case 3:return oC(qy(Ka.IF),cC,!1,e[0],[e[1],e[2]]);case 2:return oC(qy(Ka.IF),cC,!1,e[0],[e[1],Ja]);case 1:throw new sC(Pn(["single-argument IF"]));default:return re("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(e){return ne("calc.runtime.toChooseTerm: expected wff",e.length>=1),oC(qy(Ka.CHOOSE),dC,!1,e[0],e.slice(1))},e.prototype.toAppTerm=function(e,t){return tC(qy(Ka._UDF),lC,!1,Object(fe.f)([e],t))},e.prototype.letNode=function(t,r,n,a,i,o){var u=this,s=t.id===Ka.LETREC||t.id!==Ka.LET&&re("calc.runtime.compile");ne("calc.runtime.letNode: expected wff",void 0!==n);var l=this.context,c=l.names,d=l.numNames,f=l.closures,h=[c];r.reduce((function(e,t,r){var n=t.name,a=e.setValue(Wn(u.context.localeInfo,n.arg.whole),{closureId:f.getCount(),nameId:d+r});return h.push(a),a}),c);var v=new e(Object(fe.a)(Object(fe.a)({},this.context),{names:h[r.length],numNames:d+r.length}));return(s?Oe.all(r.map((function(e){var t=e.binder;return Oe.try((function(){return Ue(v,t.arg)}))}))):Oe.all(r.map((function(t,r){var n=t.binder,a=new e(Object(fe.a)(Object(fe.a)({},u.context),{names:h[r],numNames:d+r}));return Oe.try((function(){return Ue(a,n.arg)}))})))).bind((function(e){return Ue(v,n.arg).bind((function(t){return eC(e,s,t)}))}))},e.prototype.lambdaNode=function(t,r,n,a,i,o){var u=this;ne("calc.runtime.lambdaNode: expected wff",void 0!==n);var s=this.context,l=s.names,c=s.numNames,d=s.closures,f=new hC(d.getCount()+1),h=d.setValue(f.id,f),v=r.reduce((function(e,t,r){var n=t.name;return e.setValue(Wn(u.context.localeInfo,n.arg.whole),{closureId:h.getCount(),nameId:c+r})}),l),p=new e(Object(fe.a)(Object(fe.a)({},this.context),{names:v,numNames:c+r.length,closures:h}));return Oe.try((function(){return Ue(p,n.arg)})).bind((function(e){var t=f.slots.map((function(e){return c-e-1}));return $y(r.length,f.id,t,e)}))},e.prototype.parenNode=function(e,t,r){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t,r){var n,a=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===mt.AppHeadName;return Oe.resolve(this.toNameTerm(e,t,a))},e.prototype.toNameTerm=function(e,t,r){var n=this,a=this.context,i=a.locals,o=a.names,u=a.numNames,s=a.closures;if(!t){var l=mr(e);if(l.kind===Et.IdentNamePart){var c=l.parts,d=c[0],f=c.slice(1),h=o.getEntry(Wn(this.context.localeInfo,d.asWhole));if(void 0!==h){var v=h.value,p=v.closureId,m=v.nameId,g=void 0;if(p===s.getCount())g=iC(u-m-1);else{var S=s.getValue(p+1);ne("calc.runtime.toNameTerm: closure",void 0!==S),g=function(e,t){var r=Xy(Py.ReadClosure);return r.data=[e,t],r}(S.id,S.mapStackId(m))}return Oe.resolve(f.reduce((function(e,t){return n.toFieldRefTerm(e,t.rhs)}),g))}}}var b=function(e,r){var a=Oe.resolve(void 0);return r.kind===Et.FieldRefNamePart&&(a=Oe.try((function(){return b(!1,r.lhs)})).bind((function(e){return void 0===e?void 0:n.toFieldRefTerm(e,r.rhs)}))),r.kind===Et.CellRefNamePart&&(null==t&&i.allowUnqualifiedCell||null!=t&&t.kind!==ht.Document)&&(a=Oe.resolve(aC(r.ref,null!=t&&t.kind===ht.Ident?xt(t.name):t))),r.canDenoteNamedObject&&(!e||t&&t.kind!==ht.Document&&t.kind!==ht.Ident||(a=a.bind((function(e){return nC(r.asWhole,t,e)}))),a=a.bind((function(n){return rC(r.asWhole,t,e?Zn.AppHead:Zn.Plain,n)}))),a};return b(r,e).bind((function(e){return void 0!==e?e:re("calc.runtime.compile: expected wff NameNode")}))},e.prototype.cellRefNode=function(e,t,r){return Oe.resolve(aC(e,t))},e.prototype.fieldRefNode=function(e,t,r,n){var a=this;return this.lazyVisitFormulaNode(e).bind((function(e){return a.toFieldRefTerm(e,t.field)}))},e.prototype.toFieldRefTerm=function(e,t){var r=Ka.FIELDVALUE;return tC(qy(r),vi(r),!1,[e,Fa(t)])},e.prototype.structRefNode=function(e,t,r){return Oe.resolve((n=Cr(e,t,r),(a=Xy(Py.StructRef)).data=n,a));var n,a},e.prototype.badSequenceNode=function(e,t,r){return re("calc.runtime.compile: unexpected bad node")},e.prototype.badStringNode=function(e,t,r){return re("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(e,t){return Oe.resolve(lr(e,t))},e.prototype.wsfNode=function(e,t,r){return Oe.resolve(cr(e,t,r))},e}(),mC=((Ky={})[Qa.At]=Ka.SINGLE,Ky[Qa.Pound]=Ka.ANCHORARRAY,Ky);var gC,SC=[function(e){if(!uC(e)&&e.kind===Py.App&&Qy(e.data.funName)){var t=mC[Yy(e.data.funName)];if(void 0!==t)return tC(qy(t),vi(t),e.data.isFormulaRoot,e.children)}return e}],bC=function(e,t){return t(e)},yC=function(e){return SC.reduce(bC,e)};function CC(e){return function(e,t){function r(e){if(uC(e))return Oe.resolve(e);switch(e.kind){case Py.Let:return Oe.all(e.children.map(n)).bind((function(t){return eC(t.slice(0,t.length-1),e.data.rec,t[t.length-1])}));case Py.App:return Oe.all(e.children.map(n)).bind((function(t){return tC(e.data.funName,e.data.funType,e.data.isFormulaRoot,t)}));case Py.Conditional:return Oe.all(e.children.map(n)).bind((function(t){var r=t[0],n=t.slice(1);return oC(e.data.funName,e.data.funType,e.data.isFormulaRoot,r,n)}));case Py.Lambda:return n(e.children).bind((function(t){return $y(e.data.arity,e.data.closureId,e.data.closedIdents,t)}));case Py.Array:return Oe.all(e.children.map((function(e){return Oe.all(e.map(n))}))).bind((function(t){return Zy(e.data.rows,e.data.cols,t)}));case Py.Name:return(void 0===e.children?Oe.resolve(void 0):n(e.children)).bind((function(t){return rC(e.data.name,e.data.qualifier,e.data.source,t)}));case Py.Udf:return(void 0===e.children?Oe.resolve(void 0):n(e.children)).bind((function(t){return nC(e.data.name,e.data.qualifier,t)}));case Py.CellRef:case Py.StructRef:case Py.ReadStack:case Py.ReadClosure:return Oe.resolve(e);default:return te("calc.runtime.transformBottomUp",e)}}function n(e){return Oe.resolve(e).bind(r).bind(t)}return Oe.settleOrThrow(n(e))}(e,yC)}function kC(e,t){return"object"!=typeof t.term?re(e+": expected known compiled formula type; given "+D(t)):t.term}function EC(e,t,r){var n,a,i,o;try{var u=null!==(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==a?a:e.config.localeInfo,s=zl.create(u.stringCompareCI),l={globals:e,locals:t,localeInfo:u,annotations:r.annotations,names:s,numNames:0,closures:vC},c=CC(yt(new pC(l),r));return he((i=r,o=c,Object(fe.a)(Object(fe.a)({},i),{term:o})))}catch(e){return ge(e instanceof sC?e.reason:be(e))}}function AC(e){return{compileFormula:function(t,r){return EC(e,t,r)}}}function RC(e){return 0===e.length&&re("calc.runtime.unevaluated: expected nonempty array"),{kind:gC.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(gC||(gC={}));var NC=Un("EvaluationError");function TC(e){throw new NC(e)}function IC(e,t,r){var n;switch(r.kind){case gC.Unevaluated:if(t.map.getCount()+1>(null!==(n=e.globals.limits.maxCellChain)&&void 0!==n?n:1/0))return ge(Vy(Ay.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return ke(new Fe(a),Ae());default:return ge(r)}}function FC(){return Ta([],[],Ft.None,ga.Lower)}function OC(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function DC(e,t){return e<t?-1:e===t?0:1}function MC(e,t){return"string"==typeof e?"string"!=typeof t?1:DC(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function wC(e,t){var r;return 0!==(r=DC(e.name,t.name))?r:OC(e.path,t.path,DC)}function _C(e,t){return{current:e,map:t}}var LC=_C(void 0,zl.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=MC(e.sheet.index,t.sheet.index))?r:wC(e.sheet.document,t.sheet.document)})));function PC(e,t){return{current:e,map:t}}var xC=PC(void 0,zl.create((function(e,t){var r;return 0!==(r=DC(e.name,t.name))||0!==(r=OC(e.scope.index,t.scope.index,MC))?r:wC(e.scope.document,t.scope.document)})));var BC=function(){function e(e,t,r,n){var a=this;this.context=e,this.visitedCells=t,this.cell=r,this.isPrecedent=n,this.receiveSuccess=function(e){return function(t){if(An(t)||Nn(t)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+D(t));return ee.ULS.assertTag(595980815,I.LogCategory.msoulscat_ES_EWAJS,!1,r)}return a.writeSuccess(e.source,t,e.precedents),t}},this.receiveFailure=function(e){return function(t){if(t.kind===gC.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+D(t));return ee.ULS.assertTag(595980817,I.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=t.kind===Sy.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return a.writeFailure(e.source,n,e.precedents),Oe.reject(a.isPrecedent?Gy(e.source.range):n)}}}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===le.Failure)return Oe.reject(e.reason);var t=e.value;if(t.kind===ky.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===le.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return ee.ULS.assertTag(595980813,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=r.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+D(t.anchor)+") != null");return ee.ULS.assertTag(595980814,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i,o,u,s,l,c,d=this.visitAnchor(a),f=this.context.createFormulaEvaluationMachine(this.context,(u=d.source,s=un(u.range),l=he(s.range),c=he(s.sheet),xy(u,l,c,u.kind===Xn.Range,l,c,u.kind===Xn.Cell,!0,!1,he(!1))),d.precedents,(i=this.visitedCells,ne("calc.runtime.appendVisitedCell",(o=d).previous===i.current),_C(o,i.map.setValue(o.cell,o))),a.formula);return Oe.fromMachine(f).bind(this.receiveSuccess(d)).catch(this.receiveFailure(d))},e.prototype.visitAnchor=function(e){var t=un(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+D(t)+"; given "+D(r));return ee.ULS.assertTag(595980812,I.LogCategory.msoulscat_ES_EWAJS,!1,n)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:FC()}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=Tn(t)?n:t;if(e.kind===Xn.Cell){if(Rn(a)){var i=void 0===a.opers[0]?xa:a.opers[0][0],o=Tn(i)?n:i;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,a,r)}var u=e.range.range,s=iS(u.rows,u.cols,a).opers,l=function(e){return Tn(e)?n:e},c=s.map((function(e){return e.map(l)}));return this.context.globals.setCellValues(e.range,c,r)},e}();function UC(e,t,r,n){return Oe.try((function(){return new BC(e,t,r,n).evalCell()}))}function GC(e,t){for(var r=WC(e),n=[],a=0;a<t.length;a+=1)n.push(UC(r.machineContext,LC,t[a],!1));return new YC(r,n)}function jC(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:N()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function VC(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=N()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:k(e.endTimeMs,t)}}var HC={kind:Sy.Timeout};function WC(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&N()>=e}},machineContext:KC(e)}}function KC(e){return{globals:e,resolver:Es(e),numberFormatter:gy(e),parser:ap(e),printer:zs(e),analyzer:Yp(e),createCellEvaluationMachine:UC,createFormulaEvaluationMachine:Tk,createLambdaEvaluationMachine:Ik}}var zC,YC=function(){function e(e,t){oe("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new Ie(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===Ey.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(VC(e));return Array.isArray(r)?Promise.resolve(r):new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))}))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===Ey.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return Array.isArray(a)?a:Hy((function(t){return r(void 0!==t?t:VC(e))}))};return r(VC(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return HC;this.pushResult(n)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+q(e);return ee.ULS.assertTag(595980807,I.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.pushResult=function(e){return this.results.push(e),Ce},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(ge(Dy))},e}();function qC(e){return{kind:zC.RangeValues,arrays:e}}function JC(e){return e.kind===zC.RangeValues}function QC(e,t,r,n){if(r.kind===pt.Abs)return r;var a=io(e,r.index,n)-t;return a===r.index?r:Gt(pt.Rel,a)}function XC(e,t,r,n){var a=QC(t.row,r.row,n.row,1<<20),i=QC(t.col,r.col,n.col,16384);return Vt(a,i,oo(e,a)||oo(e,i),n.label)}function ZC(e,t,r,n){switch(n.kind){case vt.Error:return n;case vt.Single:return XC(e,t,r,n);case vt.Range:var a=XC(e,t,r,n.ref1),i=XC(e,t,r,n.ref2);return a===n.ref1&&i===n.ref2?n:Ht(a,i,n.label);case vt.Row:var o=QC(t.row,r.row,n.row1,1<<20),u=QC(t.row,r.row,n.row2,1<<20);return Wt(o,u,oo(e,o)||oo(e,u),n.label);case vt.Col:var s=QC(t.col,r.col,n.col1,16384),l=QC(t.col,r.col,n.col2,16384);return Kt(s,l,oo(e,s)||oo(e,l),n.label)}}!function(e){e.RangeValues="RangeValues"}(zC||(zC={}));var $C=Un("TransformRefsError"),ek=function(e){function t(t,r,n,a){var i=e.call(this)||this;return i.fn=t,i.locals=n,i.annotations=a,i.resolver=Es(r),i}return Object(fe.c)(t,e),t.prototype.nameNode=function(e,t,r){var n=fr(e,t,r),a=this.resolver.resolveDottedName(this.locals,n,this.annotations).resolved;if(a.kind===cs.ResolvedCellRef){var i=mr(e);ne("calc.lang.adjustFormulaOrigin",i.kind===Et.CellRefNamePart);var o=i.parts,u=o[0],s=o[1],l=function(e,t){return pr(e,t.rhs,t.canDenoteNamedObject,t.label)};return fr(o.slice(2).reduce(l,l(vr(this.fn(u.ref),u.asWhole,u.label),s)),t,r)}if(a.resolution.kind!==le.Success&&a.resolution.reason.kind!==ns.NoOriginSheet)throw new $C(a.resolution.reason);return n},t.prototype.cellRefNode=function(e,t,r){return Sr(this.fn(e),t,r)},t}(ze);function tk(e,t,r,n){var a=t.originGridCell.value;if(tn(a,r))return he(n);try{var i=St(new ek(ZC.bind(void 0,e.config.refStyle,a,r),e,t,n.annotations),n);return he(Object(fe.a)(Object(fe.a)({},n),{node:i}))}catch(e){if(e instanceof $C)return ge(e.reason);throw e}}var rk,nk=function(){function e(e,t){void 0===t&&(t=wa),this._fields=e,this._fallback=t,this.kind=Tt.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),ak=function(){function e(e,t,r,n){this.arity=e,this.kind=Tt.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return wa},e.prototype.getField=function(e){},e}();function ik(e,t){var r=t.map.getValue(e);if(void 0!==r)return TC(function(e,t){for(var r=[],n=Uy(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current))}function ok(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===le.Failure)return TC(n.reason);var a=n.value;if(a.kind===ky.FinalValue)return a.oper;ik(a.anchor,e.visitedCells),r.push(a.anchor)}function uk(e,t,r,n){var a;if(e.precedents.cells.push(t),!n||Xr(t.range)<=16)a=t;else{var i=e.globals.getUsedRange(t.sheet),o=void 0;Se(i)?o=null==i.value?void 0:i.value.range:TC(i.reason);var u=void 0===o?void 0:zr(t.range,ha(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new zg(t.range.rows,t.range.cols,0,0,[],Ya);a=ba(t.sheet,u)}var s=e.globals.getCellValues(a);if(s.kind===le.Failure)return TC(s.reason);var l=r.length,c=function(e,t,r,n,a){var i=[],o=n.length,u=0;ne("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var s=0;s<o;s+=1){i.push([]);var l=n[s].length;ne("calc.runtime.deference: readIntoArray2D number of cols",l===r.cols),u=0===s?l:k(l,u);for(var c=0;c<l;c+=1){var d=n[s][c];ky.FinalValue===d.kind?i[s][c]=d.oper:(ik(d.anchor,e.visitedCells),ne("calc.runtime.deference: readIntoArray2D correct sheet",$r(d.anchor.sheet,t.sheet)),a.push(d.anchor),i[s][c]=_a)}}return new zg(t.range.rows,t.range.cols,o,u,i,Ya)}(e,t,a.range,s.value,r);return l===r.length?c:void 0}function sk(e,t,r){var n,a=uk(e,t,r,!1);if(null!=a)return Va(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:Jg((n=a).rows,n.cols,n.get.bind(n)))}function lk(e,t,r,n){if(0!=(r&Tt.Range))return t;if(!An(t))return t;var a=t.sheets;if(!xr(a))return aS("calc.runtime.dereference",Na.REF,"3D range, oper = "+D(t)),_a;if(1!==t.ranges.length)return aS("calc.runtime.dereference",Na.VALUE,"union range, oper = "+D(t)),wa;var i=t.ranges[0];if(0!=(r&rS)){if(Ur(i))return ok(e,ya(a,i),n);if(e.locals.implicitIntersect&&!Le(De.CalcSupportDynamicArrays)&&!Le(De.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!Se(o))return TC(o.reason);var u=qr(o.value,i);return null==u?(aS("calc.runtime.dereference",Na.VALUE,"empty intersection, oper = "+D(t)),wa):ok(e,ya(a,u),n)}return sk(e,ba(a,i),n)}return 0!=(r&Tt.Array)?sk(e,ba(a,i),n):(aS("calc.runtime.dereference",Na.VALUE,"bad target type "+r),wa)}function ck(e,t,r){var n=[],a=lk(e,t,r,n);if(null==a){if(n.length>0)return TC(RC(n));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+D(t);return ee.ULS.assertTag(595980819,I.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function dk(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=lk(e,t[a],gn(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return TC(RC(n))}function fk(e,t){return 0!=(t&Tt.Number)?e.zero:0!=(t&Tt.String)?vS:0!=(t&Tt.Boolean)?Ja:wa}function hk(e,t,r){var n=function e(t,r,n){var a=t.globals.config,i=a.localeInfo,o=a.mathpack;if(yn(r)){if(0!=(n&Tt.Number))return r;if(0!=(n&Tt.String)){return Fa(o.formatGeneral(i,r,20))}return 0!=(n&Tt.Boolean)?Ia(0!==o.cond(r)):0!=(n&Tt.Array)?Va(1,1,[[r]]):wa}if(Cn(r)){if(0!=(n&Tt.String))return r;if(0!=(n&Tt.Number)){if(0===r.value.length)return wa;if(r.value.length>255)return wa;var u=t.numberFormatter.parseGeneral(r.value,!1,!0,am.NonVolatile);return Se(u)||TC(u.reason),void 0!==u.value?u.value.value:wa}return 0!=(n&Tt.Boolean)?0===i.stringCompareCI(r.value,i.trueName)?qa:0===i.stringCompareCI(r.value,i.falseName)?Ja:wa:0!=(n&Tt.Array)?Va(1,1,[[r]]):wa}if(kn(r))return 0!=(n&Tt.Boolean)?r:0!=(n&Tt.Number)?r.value?o.one:o.zero:0!=(n&Tt.String)?Fa(r.value?i.trueName:i.falseName):0!=(n&Tt.Array)?Va(1,1,[[r]]):wa;if(0!=(n&r.kind))return r;switch(r.kind){case Tt.Error:return r;case Tt.Missing:return 0!=(n&Tt.Blank)?Ya:fk(o,n);case Tt.Blank:return fk(o,n);case Tt.Rich:return e(t,r.getFallback(),n);default:return wa}}(e,t,r);return En(n)&&!En(t)&&aS("calc.runtime.coerceOper",n.type,"kind = "+t.kind),n}function vk(e,t){return ne("calc.runtime.lambdaCall",t.length===e.arity),{kind:rk.LambdaCall,lambda:e,args:t}}function pk(e){return e.kind===rk.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(rk||(rk={}));var mk=function(){function e(e){this.kind=Tt.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return re("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return re("calc.runtime.UdfOper.getField")},e}(),gk=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=Ft.RefStyle,o},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return Se(e)?e.value:TC(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return Se(e)?e.value:TC(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return Se(e)?e.value:TC(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return Se(e)?e.value:TC(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return Se(e)?e.value:TC(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=vi(e),n=t.some(An)?t.slice(0):t;return dk(this,n,r),this.handleLambda(this.dispatchFunction(qy(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(vk(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof NC)return IC(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Qy(e))return RS(this.globals,Yy(e),t,r);var n=Jy(e);if(n===Ka._UDF){if(t[0]instanceof ak){var a=t[0];return t.length-1!==a.arity?wa:vk(a,t.slice(1))}if(t[0]instanceof mk){var i=t[0];if(t.length-1!==i.arity)return wa;if((l=i.func(this,t.slice(1))).kind===Tt.Error){var o="UDF function return value";aS("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,o)}return l}switch(t[0].kind){case Tt.Error:return t[0];case Tt.Number:return wa;case Tt.Rich:return TC(Pn(["Rich UDF head"]));case Tt.String:case Tt.Boolean:case Tt.Blank:case Tt.Missing:case Tt.Array:return _a;case Tt.Range:return re("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: UDF head should be derefed");default:return te("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var u=this.globals.getWorksheetFunc(n);if(u.kind===le.Failure)return TC(u.reason);var s=u.value;if(null==s){o="nonexistent worksheet function "+n;return aS("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Na.NAME,o),La}try{var l;if((l=s(this,t)).kind===Tt.Error){o="worksheet function "+n+" return value";aS("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,o)}return l}catch(e){throw J(e,"(in WSF "+Qu(n)+")")}},e.prototype.handleLambda=function(e){return pk(e)?Zg(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var a=this;if(!Sn(t,n.length)){var i=JSON.stringify(t),o="calc.runtime.FunctionDispatcher.dispatchFunction: "+(p="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+i);return ee.ULS.assertTag(593372499,I.LogCategory.msoulscat_ES_EWAJS,!1,o)}for(var u=n.length,s=It.None,l=0;l<u;l+=1){var c=n[l],d=c.kind;0==(d&gn(t,l,u))&&(s|=d),An(c)&&0==(t.flags&Ot.Allow3dRef)&&!xr(c.sheets)&&(s|=d)}if(s===It.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(s&Tt.Array)){return lS(this,t,(function(r){return a.handleLambda(a.dispatchFunction(e,t,!1,r))}),n)}s&=~Tt.Array;var f=[];for(l=0;l<u;l+=1){var h=n[l];if(0!=(s&h.kind)){var v=gn(t,l,u);if(En(h=this.coerceOper(h,v))&&0==(v&Tt.Error))return h;if(An(h)&&0==(t.flags&Ot.Allow3dRef)&&!xr(h.sheets)){var p="3D reference, oper = "+D(h);return aS("calc.runtime.FunctionDispatcher.dispatchFunction",Na.VALUE,p),wa}}f[l]=h}return this.applyOperatorOrFunction(e,f,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return Se(t)?y(t.value)?void 0:t.value:TC(t.reason)},e.prototype.getNameFormula=function(e,t,r){var n=this.context.resolver.resolveName(this.locals,fr(hr(t,!0),e),r).resolution;if(Se(n)){var a=n.value;if(a){this.precedents.names.push(a);var i=this.globals.getNameFormula(a,r);Se(i)||TC(i.reason);var o=i.value;if(!y(o))return[a,o.node]}}else n.reason.kind!==ns.NoOriginSheet&&TC(n.reason)},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:he(r.range),originSheet:he(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},i=this.context.resolver.resolveCellRef(a,Sr(t,e)).resolution;if(Se(i)){var o=i.value;if(o)return Wa(o.sheet,o.range)}else i.reason.kind!==ns.NoOriginSheet&&TC(i.reason)},e.prototype.dereferenceOper=function(e,t){return ck(this,e,t)},e.prototype.dereferenceOpers=function(e,t){dk(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return Se(t)?this.getAvailableFormula(e):TC(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return Se(r)?(this.precedents.special|=Ft.OwnDocSheets,null==r.value?void 0:la(e,r.value)):TC(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=Ft.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return Se(t)?t.value.position:TC(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=Ft.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return Se(t)?t.value.sheets:TC(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],i=[],o=function(o){var s=e[o];if(!An(s))return i.push(s),"continue";for(var l=[],c=function(e){var r=uk(n,e,a,!0);void 0!==r&&l.push(t(r,e))},d=u.getSheetRangeIndexes(s.sheets),f=function(e){for(var t=la(s.sheets.document,d[e]),n=function(e){var n=s.ranges[e];if(!r)return c(ba(t,n)),"continue";var a=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!Se(a))return{value:TC(a.reason)};var i=a.value;if(0===i.length)return c(ba(t,n)),"continue";for(var o=function(e,r){var a=ha(e,n.col,r-e,n.cols);c(ba(t,a))},l=0;l<i.length;l+=1){var d=i[l],f=d.start,h=d.end,v=0===l?n.row:i[l-1].end;ne("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",v<=f&&f<h&&h<=n.row+n.rows),v!==f&&o(v,f);var p=ha(f,n.col,h-f,n.cols);u.precedents.cells.push(ba(t,p))}var m=i[i.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},a=0;a<s.ranges.length;a+=1){var i=n(a);if("object"==typeof i)return i}},h=0;h<d.length;h+=1){var v=f(h);if("object"==typeof v)return v}i.push({kind:zC.RangeValues,arrays:l})},u=this,s=0;s<e.length;s+=1){var l=o(s);if("object"==typeof l)return l.value}return a.length>0?TC(RC(a)):i},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,f,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new qg(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=ya(t.sheet,va(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(Ql(r.lexicalKind,t,{refStyle:e}),n);if(!Se(a))return a;var i=this.context.analyzer.checkFormula(r,a.value);if(!Se(i))return i;if(!Br(i.value))return ge(Ny("ill-formed indirect formula","indirect"));i.value;return i},e.prototype.getRandom=function(){this.precedents.special|=Ft.Calc;var e=this.globals.getRandom();return Se(e)||TC(e.reason),e.value},e.prototype.getTime=function(e){this.precedents.special|=Ft.Time;var t=this.globals.getTime(e,am.Volatile);return Se(t)||TC(t.reason),t.value},e.prototype.coerceOper=function(e,t){return hk(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,am.NonVolatile);return Se(n)||TC(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,am.NonVolatile);return Se(r)||TC(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=hi(e),n=[Ja,Ja];return function(a,i){n[0]=a,n[1]=i,dk(t,n,r);var o=t.dispatchFunction(zy(e),r,!1,n);return ne("calc.runtime.FunctionDispatcher.getBinaryOperator",!pk(o)&&!$g(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=hi(e),n=[Ja];return function(a){n[0]=a,dk(t,n,r);var i=t.dispatchFunction(zy(e),r,!1,n);return ne("calc.runtime.FunctionDispatcher.getUnaryOperator",!pk(i)&&!$g(i)),i}},e.prototype.isInFilterMode=function(e){this.precedents.special|=Ft.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if(An(n))for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var o=i[a],u=this.globals.isInFilterMode(la(n.sheets.document,o));if(!Se(u))return TC(u.reason);if(u.value)return!0}}return!1},e.prototype.printFormula=function(e,t){var r=ya(e.source.range.sheet,t),n=tk(this.globals,gp(Xn.Cell,un(e.source.range)),t,e.formula);if(!Se(n))return TC(n.reason);var a=this.context.printer.printFormula(Zl(e.source,r,{refStyle:this.config.refStyle}),n.value);return Se(a)?a.value:TC(a.reason)},e.prototype.applyFormat=function(e,t,r,n){var a;if("number"==typeof t){var i=this.globals.getKnownFormat(e,t);if(!Se(i))return TC(i.reason);a=i.value}else{var o=fy(this.context.numberFormatter,this.globals,e,t,n);if(!Se(o))switch(o.reason.kind){case Hp.PreviousFormatFailure:return;default:return TC(o.reason)}a=o.value}var u=hy(this.context.numberFormatter,a,r);return Se(u)?"string"==typeof u.value?u.value:void 0:TC(u.reason)},e}(),Sk=[void 0,La],bk=[void 0,_a],yk=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?TC(Pn(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),Ck=zl.create((function(e,t){return e-t})),kk={kind:Py.CallLambda};var Ek,Ak,Rk,Nk=function(){function e(e,t,r,n,a,i,o,u,s,l,c){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.stackEnv=i,this.closureEnv=o,this.usage=u,this.target=s,this.isLambda=l,this.runStatus=!1,this.term=c,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof NC)return IC(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return Se(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(uC(this.term)){var e=this.continuation;if(0===e.length){var t=hk(this,ck(this,this.term,this.target),this.target);return this.precedents.bound=ga.Exact,!Le(De.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==Xn.Cell||!Rn(t)||1===t.rows&&1===t.cols?he(t):ge(Pn(["spilling"]))}var r=e[e.length-1];return this.applyContinuation(this.term,r)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case Py.App:var n=t.holeIndex,a=r.children.length;return(i=t.locals)[n]=e,n+1<a?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case Py.Conditional:var i;if(0===(n=t.holeIndex)){var o=Jy(r.data.funName),u=o===Ka.IF?Tt.Boolean:Tt.Number,s=ck(this,e,u);if(Rn(s))return t.locals=[s],this.nextHoleTransition(t,r.children[n+1]);if(In(s))return ge(Pn(["IF/CHOOSE with a rich value condition"]));if(s=hk(this,s,u),o===Ka.IF&&kn(s))return this.popContextTransition(r.children[s.value?1:2]);if(o===Ka.CHOOSE&&yn(s)){var l=this.context.globals.config.mathpack.fix(s);if(l<1||l>r.children.length-1){var c="CHOOSE; out of bounds option = "+D(l);return aS("calc.runtime.FormulaEvaluationMachine.applyContinuation",Na.VALUE,c),this.popContextTransition(wa)}return this.popContextTransition(r.children[l])}return ne("calc.runtime.FormulaEvaluationMachine.applyContinuation",En(s)),this.popContextTransition(s)}return(i=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case Py.Name:var d=this.popContextTransition(e),f=t.locals;return this.locals=f.locals,this.visitedNames=f.visitedNames,d;case Py.Let:n=t.holeIndex;var h=r.children.length-1;if(n>=h){d=this.popContextTransition(e),f=t.locals;return this.stackEnv.length=f.stackEnvLen,d}if(r.data.rec){var v=this.stackEnv.length-h+n;this.stackEnv[v].value=e,this.stackEnv[v]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case Py.Array:var p=ck(this,e,tS),m=r.data,g=m.rows,S=m.cols,b=t.holeIndex,y=b%S,C=S===y+1,k=(b-y)/S,E=t.locals;if(E[k][y]=hk(this,p,tS),g===k+1&&C)return this.popContextTransition(Va(g,S,E));var A=C?k+1:k,R=C?0:y+1;return this.nextHoleTransition(t,r.children[A][R]);case Py.CallLambda:d=this.popContextTransition(e),f=t.locals;return this.locals=f.locals,this.stackEnv.length=f.stackEnvLen,this.closureEnv=f.closureEnv,this.usage.lambdaDepth-=1,d;default:return te("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case Py.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case Py.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case Py.App:var r=e.data.funName;if(!Qy(r)){var n=Jy(r);if(n!==Ka._UDF){var a=this.globals.getWorksheetFunc(n);if(a.kind===le.Failure)return TC(a.reason)}}return 0===e.children.length?pk(i=new gk(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,i):$g(i)?this.evaluateMachineTransition(void 0,i):this.updateTermTransition(i):this.pushContextTransition(e,e.children[0],[]);case Py.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case Py.Let:return this.evaluateLetTransition(e);case Py.Name:var i;if(void 0!==(i=this.evalNameTerm(e))[0]){var o=i[0],u=i[1],s=i[2],l=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=he(n);else{var a=t.originSheet;if(!Se(a))return TC(a.reason);r=Zr(a.value.document,n.document)?a:he(n)}var i=t.originGridCell;return xy(e,i,r,t.calcingArray,i,r,!1,!1,!0,he(!1))}(ia(o),this.locals),this.visitedNames=s,l}var c=i[1];return this.updateTermTransition(c);case Py.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case Py.ReadStack:return ne("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(d=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(d instanceof yk?d.value:d);case Py.ReadClosure:var d;return ne("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(h=this.closureEnv.getValue(e.data[0]))),ne("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(d=h[e.data[1]])),d instanceof yk&&(d=d.value,h[e.data[1]]=d),this.updateTermTransition(d);case Py.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case Py.Lambda:var f=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return ne("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),h=this.closureEnv.setValue(e.data.closureId,f);return this.updateTermTransition(new ak(e.data.arity,this.locals,h,e.children));default:return te("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;dk(this,t,a);var o=new gk(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return pk(o)?this.evaluateLambdaTransition(e,o):$g(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),ke(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a,i=t.lambda,o=t.args,u=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],s=(null==u?void 0:u.context.kind)===Py.CallLambda?u:void 0;return this.usage.lambdaCalls[0]+1>(null!==(r=this.globals.limits.maxLambdaCalls)&&void 0!==r?r:1/0)?TC(Vy(Ay.LambdaCalls)):void 0===s&&this.usage.lambdaDepth+1>(null!==(n=this.globals.limits.maxLambdaDepth)&&void 0!==n?n:1/0)?TC(Vy(Ay.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==s?(a=this.updateTermTransition(i.term),this.stackEnv.length=s.locals.stackEnvLen):(a=this.pushContextTransition(kk,i.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),g(this.stackEnv,o),this.closureEnv=i.env,this.locals=function(e,t){return xy(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.allowUnqualifiedCell,e.locals.wrapCellReferences,he(!1))}(i,this.locals),this.usage.lambdaCalls[0]+=1,a)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new yk);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,Ce},e.prototype.getNameFormulaAsTerm=function(e,t){this.precedents.names.push(e);var r=this.globals.getNameFormula(e,t);if(r.kind===le.Failure)return TC(r.reason);var n=r.value;return null!=n?kC("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?TC(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),By(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?TC(Vy(Ay.NameChain)):function(e,t){var r={name:t,previous:e.current};return PC(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,fr(hr(e.data.name,!0),e.data.qualifier),e.data.source).resolution;if(!Se(t)){if(t.reason.kind===ns.NoOriginSheet){var r="error ref, no sheet, qualifier = "+D(e.data.qualifier);return aS("calc.runtime.FormulaEvaluationMachine.evalName",Na.REF,r),bk}return TC(t.reason)}var n,a=t.value;if(void 0===a||void 0===(n=this.getNameFormulaAsTerm(a,e.data.source))){var i=e.children;if(void 0===i){r="error ref, qualifier = "+D(e.data.qualifier);return aS("calc.runtime.FormulaEvaluationMachine.evalName",Na.NAME,r),Sk}return[void 0,i]}return[a,n,this.checkForNameCycle(a)]},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,Sr(e.data.ref,e.data.qualifier)).resolution;if(!Se(t)){if(t.reason.kind===ns.NoOriginSheet){var r="error ref, no sheet, qualifier = "+D(e.data.qualifier);return aS("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Na.REF,r),_a}return TC(t.reason)}var n=t.value;if(!n){r="error ref, qualifier = "+D(e.data.qualifier);return aS("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Na.REF,r),_a}return Wa(n.sheet,n.range)},e.prototype.evalStructRefTerm=function(e){var t=this.context.resolver.resolveStructRef(this.locals,e.data).resolution;if(!Se(t)){if(t.reason.kind===ns.NoOriginSheet){var r="error ref, no sheet, struct ref = "+D(e.data);return aS("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Na.REF,r),_a}if(t.reason.kind===ns.EmptyIntersection){r="error ref, empty intersection, struct ref = "+D(e.data);return aS("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Na.VALUE,r),wa}return TC(t.reason)}var n=t.value;if(!n){r="error ref, struct ref = "+D(e.data);return aS("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Na.REF,r),_a}return Wa(n.sheet,n.range)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,fr(hr(e.data.name,!0),e.data.qualifier)).resolution;Se(t)||TC(t.reason);var r=t.value;if(!r){var n=e.children;if(void 0===n){var a="UDF resolution, qualifier = "+D(e.data.qualifier);return aS("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Na.NAME,a),La}return n}if(r.length>1){a="UDF resolution, ambiguous name";return aS("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Na.NAME,a),La}var i=this.globals.getUserDefinedFunc(r[0]);return Se(i)||TC(i.reason),new mk(i.value)},e}();function Tk(e,t,r,n,a){return new Nk(e,t,r,n,xC,[],Ck,{lambdaCalls:[0],lambdaDepth:0},nS,!1,kC("calc.runtime.createFormulaEvaluationMachine",a))}function Ik(e,t,r,n,a,i,o,u){return ne("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new Nk(e,t,r,n,a,Object(fe.f)(u),o.env,i,It.All,!0,o.term)}function Fk(e,t,r){var n,a=WC(e),i=FC(),o=Tk(a.machineContext,t,i,LC,r),u=new YC(a,[o]),s=jC(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:Hy((function(r){return e(t.resume(r))}))}(u.evaluateSync(s))}function Ok(e){return{evalFormula:function(t,r){return Fk(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=GC(e,t),n=jC(e.schedulerConfig);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=GC(e,t),n=jC(e.schedulerConfig);return r.evaluateAsync(n)}(e,t)}}}function Dk(e,t,r,n){var a=ap(Jl(e)).parseFormula(ft.A1,n,Xn.Range,r);if(Se(a)){var i=a.value;if(!(t<0||t>=r.length))return{formula:i,subexpression:ln(i,t)}}}function Mk(e){return e.formula.spans[e.subexpression.label]}function wk(e,t,r){var n=t.formula;return function(e,t,r,n){if((t.kind===kt.App||t.kind===kt.Let)&&hn(t.head)&&t.head.id===Ka.LET){for(var a=[],i=r.spans[t.label],o=0;o<t.args.length-1;o+=2){var u=0===o?r.spans[t.head.label]:r.spans[t.args[o].label],s=r.spans[t.args[o+1].label];if(i&&u&&s){var l=n.indexOf(e.listSeparator,s.end);l>=0?l+=1:(l=n.indexOf(")",s.end))<0&&(l=s.end);var c=Yt(0===o?u.end+1:u.start,l,"","");a.push(c)}}return a}if(t.kind===kt.Name||t.kind===kt.Bad)return function e(t,r,n,a){switch(r.kind){case kt.App:case kt.Let:case kt.Lambda:if(hn(r.head)&&r.head.id===Ka.LET)for(var i=0;i<r.args.length;i+=1)if(i%2==0&&i<r.args.length-1){var o=r.args[i],u=r.args[i+1];if(o.kind===kt.Name&&a.kind===kt.Name&&0===t.stringCompareCI(o.whole,a.whole)||o.kind===kt.Bad&&a.kind===kt.Bad&&o.type===Nt.CellRef&&a.type===Nt.CellRef&&0===t.stringCompareCI(o.contents,a.contents)){var s=[],l=n.spans[o.label],c=n.spans[u.label],d=n.spans[a.label];if(d&&l&&c&&l.start===d.start&&l.end===d.end)return s.push(Yt(l.start,c.end,"","")),s}}else{if((s=e(t,r.args[i],n,a)).length>0)return s}else for(i=0;i<r.args.length;i+=1){if((s=e(t,r.args[i],n,a)).length>0)return s}return[];case kt.Array:for(i=0;i<r.nodes.length;i+=1)for(var f=0;f<r.nodes[i].length;f+=1){if((s=e(t,r.nodes[i][f],n,a)).length>0)return s}return[];case kt.Paren:return e(t,r.node,n,a);case kt.Bad:case kt.CellRef:case kt.FieldRef:case kt.Literal:case kt.Name:case kt.StructRef:return[];default:return te("calc.runtime.addLETNameSubspans",r)}}(e,r.node,r,t);return[]}(e,t.subexpression,n,r)}function _k(e,t,r,n){var a=r;a.startsWith("=")||(a="="+r);var i=ap(Jl(e)),o=i.parseFormula(ft.A1,n,Xn.Range,t),u=i.parseFormula(ft.A1,n,Xn.Range,a);if(Se(o)&&Se(u))return{formula:o.value,subexpression:u.value.node}}function Lk(e,t,r,n){var a=Pk(e.localeInfo,t.formula,t.formula.node,r,t.subexpression),i=gu(os()),o=t.formula,u=o.spans,s=o.annotations,l=o.depthUpperBound,c=zs(Rs(i)).printFormula(Ns(aa(Xn.Cell,n),n,i),zt(a,u,s,l));return Se(c)?c.value:""}function Pk(e,t,r,n,a){switch(r.kind){case kt.App:case kt.Let:case kt.Lambda:if(hn(r.head)&&r.head.id===Ka.LET)return function(e,t,r,n,a){for(var i=[],o=0;o<r.args.length;o+=1){var u=t.spans[r.args[o].label];if(u&&n.start>=u.start&&n.end<=u.end){var s=r.args[o];if((n.start>u.start||n.end<u.end)&&(s=Pk(e,t,r.args[o],n,a)),o===r.args.length-1&&r.args.length%2==1)i.push(s);else if(o%2==1){if(1===o)return s;i.pop(),i.push(s)}else i.push(s),i.push(r.args[o+1]),i.push(s);return Zt(r.head,i,!0,r.label)}i.push(r.args[o])}return a}(e,t,r,n,a);for(var i=0;i<r.args.length;i+=1){var o=t.spans[r.args[i].label];if(o&&n.start>=o.start&&n.end<=o.end)return Pk(e,t,r.args[i],n,a)}return a;case kt.Array:for(i=0;i<r.nodes.length;i+=1)for(var u=0;u<r.nodes[i].length;u+=1){var s=t.spans[r.nodes[i][u].label];if(s&&n.start>=s.start&&n.end<=s.end)return Pk(e,t,r.nodes[i][u],n,a)}return a;case kt.Paren:var l=t.spans[r.node.label];return l&&n.start>=l.start&&n.end<=l.end?Pk(e,t,r.node,n,a):a;case kt.Bad:case kt.CellRef:case kt.FieldRef:case kt.Literal:case kt.Name:case kt.StructRef:return a;default:return te("calc.runtime.makeSubstitutions",r)}}function xk(e,t){var r=[];for(r.push(t.subexpression);r.length>0;){var n=r.pop();if(void 0!==n)switch(n.kind){case kt.App:case kt.Let:case kt.Lambda:if(hn(n.head)&&0!=(vi(n.head.id).staticPrecs&(Ft.Time|Ft.Calc)))return!0;n.args.map((function(e){r.push(e)}));break;case kt.Array:n.nodes.map((function(e){return e.map((function(e){r.push(e)}))}));break;case kt.FieldRef:r.push(n.lhs);break;case kt.Paren:r.push(n.node);break;case kt.Bad:case kt.CellRef:case kt.StructRef:case kt.Literal:case kt.Name:case kt.Operator:break;default:te("calc.runtime.isVolatile",n)}}return!1}(Rk=Ek||(Ek={})).ReasonKind=Sy,Rk.interval=Ry,Rk.CellKind=ky,Rk.Interrupt=Ey,Rk.finalValue=Ty,Rk.pendingValue=Iy,Rk.cellWellFormedFormula=Fy,Rk.cellFormula=Oy,Rk.userDefinedFunc=My,Rk.stopped=Dy,Rk.nameCycle=By,Rk.cellCycle=Uy,Rk.paused=Hy,Rk.previousFailure=Gy,Rk.previousNameFailure=jy,Rk.evalGlobals=wy,Rk.evalLocals=xy,Rk.compileLocalsGrid=yy,Rk.compileLocalsName=Cy,Rk.getEvalFailureReason=Wy,Rk.illFormedFormula=Ny,Rk.createCompileGlobals=by,Rk.limitExceeded=Vy,Rk.LimitKind=Ay,Rk.createCompiler=AC,Rk.createEvaluator=Ok,(Ak=Rk.extension||(Rk.extension={})).DerefOperKind=zC,Ak.machine=a,Rk.getSubExpressionFromFormulaCharacterIndex=Dk,Rk.getSubExpressionSpan=Mk,Rk.getFormulaSubExpressionObject=_k,Rk.getSubstitutedSubExpressionString=Lk,Rk.getSubExpressionSubspans=wk,Rk.isFormulaSubExpressionVolatile=xk;var Bk=function(e,t){return{functionId:e,functionName:t}},Uk=function(e,t){return{errorType:e,errorName:t}},Gk=function(e,t,r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,y,C,k,E,A,R,N,T,I,F,O,D,M,w,_,L,P,x,B,U,G,j,V,H,W,K,z,Y,q,J,Q){return{worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:q,trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:u,leftBracket:s,rightBracket:l,decimalSeparator:c,listSeparator:d,columnSeparator:f,rowSeparator:h,thousandsData:v,thousandsSeparator:p,lcid:m,country:g,numberDecimals:S,isExpSepBySpace:b,fractionSeparator:y,isPercentSepBySpace:C,currencyFormat:k,isCurrencySymbolLead:E,isCurrencySepBySpace:A,currencySymbol:R,currencyDecimals:N,dateOrder:T,dateSeparator:I,dateAltSeparator:F,year4Digits:O,month2Digits:D,day2Digits:M,longDateFormat:w,timeSeparator:_,timeAltSeparator:L,hour2Digits:P,clock24Hour:x,isAMPMSepBySpace:B,ampmSymbols:U,dayNameShort:G,dayNameLong:j,monthNameShort:V,monthNameLong:H,pictureSpecial:W,pictureSingle:K,pictureColor:z,pictureDbnum:Y,sysDateFormat:J,sysTimeFormat:Q}},jk=function(e,t,r){return{iformat:e,formatString:t,builtIn:r}},Vk=function(e,t){return{sheetId:e,sheetName:t}},Hk={kind:"Blank"},Wk=function(e){return{kind:"Error",type:e}},Kk=function(e){return{kind:"Rich",fields:e}};function zk(e){return"object"==typeof e?e.kind:typeof e}function Yk(e){return"object"==typeof e?e.kind:typeof e}var qk=function(e,t){return{row:e,column:t}},Jk=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},Qk=function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}},Xk=function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}},Zk=function(e,t,r,n,a){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}};function $k(e,t,r,n){return Zk(e,t,r,n,"CellFormula")}function eE(e,t,r){return Zk(void 0,e,t,r,"ArrayFormula")}function tE(e,t,r,n){return Zk(e,t,r,n,"Value")}var rE=function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}},nE=function(e,t,r,n){return rE(e,t,void 0,r,n)};function aE(e,t,r,n){return rE(e,void 0,t,r,n)}var iE=function(e,t){return{isSpilled:e,formulaBarText:t}},oE=function(e,t,r){return{range:e,data:t,fromStateId:r}};function uE(e,t){return oE(e,t,void 0)}function sE(e,t){return oE(e,void 0,t)}var lE=function(e,t){return{sheetId:e,usedRange:t}},cE=function(e){return{kind:"NamedValue",value:e}},dE=function(e){return{kind:"NamedFormula",formulaBarText:e}},fE=function(e){return{kind:"NamedRange",range:e}},hE=function(e,t){return{column:e,name:t}},vE=function(e,t,r,n){return{kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}},pE=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},mE=function(e,t){return{name:e,data:t}},gE=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function SE(e,t){return gE(e,t,void 0)}function bE(e){return gE(e,void 0,void 0)}function yE(e,t){return gE(e,void 0,t)}var CE=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function kE(e,t,r,n){return CE(e,t,void 0,r,n,"CellFormula")}function EE(e,t,r,n){return CE(e,t,r,void 0,n,"Value")}function AE(e,t,r,n){return CE(e,t,void 0,r,n,"Inferred")}var RE=function(e,t,r,n){return{kind:e,format:t,ribbon:r,changeDecimals:n}};function NE(e){return RE("SetFormat",e,void 0,void 0)}function TE(e){return RE("RibbonFormat",void 0,e,void 0)}function IE(e){return RE("ChangeDecimals",void 0,void 0,e)}var FE=function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}},OE=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},DE=function(e,t,r,n){return{kind:e,target:t,source:r,viewport:n}},ME=function(e,t,r){return{isExact:"number"==typeof e,iformat:"number"==typeof e?e:0,format:e,category:t,decimals:r}},wE=function(e,t,r,n,a){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:a}},_E=function(e,t){return{range:e,data:t}},LE=function(e,t){return{range:e,data:t}},PE=function(e,t){return{range:e,reason:t}},xE=function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:i}},BE=function(e,t){return{kind:e,iformat:t}};function UE(){return BE("Origin")}function GE(e){return BE("Iformat",e)}function jE(){return BE("Inferred")}function VE(e,t){return{value:e,formatted:t}}var HE,WE=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},KE=function(e,t){return{name:e,param:t}},zE=function(e,t,r,n,a,i,o,u,s,l,c,d){return void 0===c&&(c=null==l?void 0:l/(l>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:s}},YE=function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}},qE=fe.a;function JE(e){var t,r,n,a=Object(fe.a)(Object(fe.a)({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=t(e),i=e===r?0:e.depth;return void 0!==i&&i<n&&(e.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a})});return function(e){return QE(a,dA(a,a.top,e))}}function QE(e,t){return t===lA||t===sA?t:{setOperations:e,root:t}}function XE(e,t){return t===lA?e:t===sA||e===lA?t:e===sA?e:QE(e.setOperations,ZE(e.setOperations,e.setOperations.top,e.root,t.root))}function ZE(e,t,r,n){if(n===lA)return r;if(n===sA)return n;if(r===lA)return n;if(r===sA)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key,o=e.compare(a,i);if(void 0!==o)return o<0?n:r;var u=e.union(a,i);if(void 0!==u){var s=e.compare(u,t);return void 0!==s&&0===s?sA:fA(e,t,u,!0)}return}(e,t,r,n);if(void 0!==a)return a}var i=hA(e,t,r),o=hA(e,t,n),u=e.split(t),s=u[0][0],l=u[1][0];return uA(e,s,l,ZE(e,s,i.left,o.left),ZE(e,l,i.right,o.right))}function $E(e,t){return e===lA?e:t===lA||e===sA?t:t===sA?e:QE(e.setOperations,eA(e.setOperations,e.setOperations.top,e.root,t.root))}function eA(e,t,r,n){if(r===lA)return r;if(n===lA)return n;if(r===sA)return n;if(n===sA)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return lA;var o=e.compare(a,i);if(void 0!==o)return o<0?r:n;var u=e.intersect(a,i);if(void 0!==u)return fA(e,t,u,!0);return}(e,t,r,n);if(void 0!==a)return a}var i=hA(e,t,r),o=hA(e,t,n),u=e.split(t),s=u[0][0],l=u[1][0];return uA(e,s,l,eA(e,s,i.left,o.left),eA(e,l,i.right,o.right))}function tA(e,t,r,n){if(r===lA||n===lA)return!1;if(r===sA||n===sA)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var a=hA(e,t,r),i=hA(e,t,n),o=e.split(t),u=o[0][0],s=o[1][0];return tA(e,u,a.left,i.left)||tA(e,s,a.right,i.right)}function rA(e,t){return e===lA||t===lA?e:t===sA?lA:e===sA?QE(t.setOperations,nA(t.setOperations,t.setOperations.top,e,t.root)):QE(e.setOperations,nA(e.setOperations,e.setOperations.top,e.root,t.root))}function nA(e,t,r,n){if(r===lA)return r;if(n===lA)return r;if(n===sA)return lA;if(r===sA){var a=hA(e,t,n),i=e.split(t),o=i[0][0],u=i[1][0];return uA(e,o,u,nA(e,o,sA,a.left),nA(e,u,sA,a.right))}if(r.isExact&&n.isExact){var s=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return fA(e,t,o,!0);return}(e,t,r,n);if(void 0!==s)return s}var l=hA(e,t,r),c=hA(e,t,n),d=e.split(t),f=d[0][0],h=d[1][0];return uA(e,f,h,nA(e,f,l.left,c.left),nA(e,h,l.right,c.right))}function aA(e,t){return e===t?0:e===lA?-1:t===lA?1:e===sA?t===sA?0:1:t===sA?-1:oA(e.setOperations,e.setOperations.top,e.root,t.root)}function iA(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function oA(e,t,r,n){if(r===n)return 0;if(r===lA)return-1;if(n===lA)return 1;if(r===sA)return n===sA?0:1;if(n===sA)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var a=hA(e,t,r),i=hA(e,t,n),o=e.split(t),u=o[0][0],s=o[1][0],l=oA(e,u,a.left,i.left);if(void 0!==l){var c=oA(e,s,a.right,i.right);if(void 0!==c)return iA(l,c)}}function uA(e,t,r,n,a){return n===lA?a===lA?lA:a===sA?cA(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):cA(n,a,void 0,!1,a.infimum,a.supremum):a===lA?n===sA?cA(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):cA(n,a,void 0,!1,n.infimum,n.supremum):n===sA?a===sA?sA:cA(n,a,void 0,!1,e.combineInfima(e.infimum(t,t),a.infimum),e.combineSuprema(e.supremum(t,t),a.supremum)):a===sA?cA(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):cA(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(HE||(HE={}));var sA=HE.Dense,lA=HE.Empty;function cA(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function dA(e,t,r){if(!e.meets(t,r))return lA;var n=e.compare(t,r);if(void 0!==n)return n<=0?sA:fA(e,t,r,!0);var a=e.intersect(t,r);return void 0!==a?fA(e,t,a,!0):fA(e,t,r,!1)}function fA(e,t,r,n){return cA(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function hA(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),a=n[0][0],i=n[1][0],o=uA(e,a,i,dA(e,a,r.key),dA(e,i,r.key));if(o===lA||o===sA)throw new Error("incorrect set operations implementation");var u=o;return qE(r,{left:u.left,right:u.right})}function vA(e){return e===lA||e===sA?0:function e(t){if(void 0===t||t===lA||t===sA)return 0;return e(t.left)+e(t.right)+1}(e.root)}function pA(e,t){return e===lA||function(e,t,r){return function t(n,a){if(a===lA)return!0;if(a===sA)return r(n);if(a.isExact)return r(a.key);var i=hA(e,n,a),o=e.split(n),u=o[0][0],s=o[1][0];return t(u,i.left)&&t(s,i.right)}(e.top,t)}(e.setOperations,e.root,t)}function mA(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,u=i-n,s=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*u)/o)}:function(e){return Math.pow((i-e*u)/o,s)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=n.cdf(r),i=n.cdf(t+1),o=n.invCdf((a+i)/2),u=k(E(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function gA(e,t,r,n,a){var i=mA(e,t,r);return{id:a,split:function(e){return i.split(e)},canSplit:function(e){return i.canSplit(e)},meets:_r,intersect:wr,union:function(e,t){return n=t,a=(r=e)[0],i=r[1],o=n[0],u=n[1],E(a,o)<=k(i,u)?Mr(e,t):void 0;var r,n,a,i,o,u},except:Lr,compare:Pr,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return k(e,t)},combineSuprema:function(e,t){return E(e,t)}}}var SA=function(e,t){var r,n,a=e[0],i=t[0];return r=String(a),n=String(i),r<n?-1:r>n?1:0},bA={};var yA=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=function(e){for(var t="",r=0,n=e;r<n.length;r++){var a=n[r];t+=String(a[0]),t+="\0",t+=String(a[1]),t+="\0"}return t}(t.sort(SA)),o=bA[i];return void 0===o&&(o={box:{},probabilities:{},depth:1},bA[i]=o),o};function CA(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?sA:{isSubspace:!0,bounds:e}}function kA(e){return e.isSubspace?1:e.subspaceCount}var EA=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:kA(e)+kA(t)}};function AA(e,t){if(t===sA)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){r=!0;break}}if(!r)return sA}return{productOperations:e,root:t}}function RA(e){return void 0===e?sA:e}var NA={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(o===lA)return lA;if(o===sA)continue;t[i]=o.setOperations,r[i]=o.root}}return AA(t,CA(r))},combineProduct:function(e,t,r,n){for(var a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(Object.prototype.hasOwnProperty.call(e,u)){var s=n(e[u],e[u].top,RA(t[u]),RA(r[u]));if(s===lA)return s;if(s===sA)continue;a[u]=s}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,i=r;a<i.length;a++){var o=i[a],u=t[o];n[o]=QE(e[o],void 0!==u?u:sA)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=sA}return t}},TA=NA.unzip.bind(NA);function IA(e,t,r){var n=NA.combineProduct(e,t,r,ZE);if(n===lA)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function FA(e,t,r){for(var n=0,a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=RA(t[o]),s=RA(r[o]),l=e[o];if(void 0===(n=iA(n,oA(l,l.top,u,s))))return}}return n}var OA,DA=(OA={},function(e,t,r){var n;if(t===OA.left&&r===OA.right)return OA.res;OA.left=t,OA.right=r;var a,i=FA(e,t.bounds,r.bounds);if(void 0!==i)return OA.res=i<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(e,s)&&0!==oA(e[s],e[s].top,RA(t.bounds[s]),RA(r.bounds[s]))){if(void 0!==a)return OA.res=void 0;a=s}}if(void 0!==a){var l=ZE(e[a],e[a].top,RA(t.bounds[a]),RA(r.bounds[a]));if(l===lA)return OA.res=lA;if(l===sA){var c=t.bounds,d=a,f=(c[d],Object(fe.e)(c,["symbol"==typeof d?d:d+""]));return OA.res=CA(f)}var h=Object(fe.a)(Object(fe.a)({},t.bounds),((n={})[a]=l,n));return OA.res=CA(h)}return OA.res=void 0});function MA(e,t,r){if(r===lA)return t;if(r===sA)return r;if(t===lA)return r;if(t===sA)return t;if(!t.isSubspace||!r.isSubspace)return EA(t,r,IA(e,t.bounds,r.bounds));var n=DA(e,t,r);return void 0!==n?n:EA(t,r,IA(e,t.bounds,r.bounds))}function wA(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=NA.restrict.apply(NA,Object(fe.f)([t.bounds],r));if(t.isSubspace)return CA(a);var i=wA.apply(void 0,Object(fe.f)([e,t.left],r));if(i===sA)return sA;var o=wA.apply(void 0,Object(fe.f)([e,t.right],r));return MA(e,i,o)}function _A(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===sA||e===lA)return e;var n=NA.restrict.apply(NA,Object(fe.f)([e.productOperations],t)),a=wA.apply(void 0,Object(fe.f)([n,e.root],t));return a===lA?a:AA(n,a)}function LA(e,t){var r,n,a,i;if(void 0!==t.children)return t.children;for(var o,u,s=t.box,l=t.probabilities,c=0,d=0,f=Object.keys(e);d<f.length;d++){var h=f[d];if(Object.prototype.hasOwnProperty.call(e,h)){var v=l[h],p=e[h];if(void 0===v){o=h,u=p.top;break}if(v>c){var m=RA(s[h]);if(m===lA)throw new Error("the key split can never return empty");var g=p.top;if(m!==sA){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!p.canSplit(g))continue;o=h,c=v,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var S=e[o],b=S.split(u),y=b[0],C=y[0],k=y[1],E=b[1],A=E[0],R=E[1],N=[{box:Object(fe.a)(Object(fe.a)({},s),(r={},r[o]=dA(S,S.top,C),r)),probabilities:Object(fe.a)(Object(fe.a)({},l),(n={},n[o]=k,n)),depth:t.depth+1},{box:Object(fe.a)(Object(fe.a)({},s),(a={},a[o]=dA(S,S.top,A),a)),probabilities:Object(fe.a)(Object(fe.a)({},l),(i={},i[o]=R,i)),depth:t.depth+1}];return t.depth<10&&(t.children=N),N}var PA=function(e,t,r,n){return function e(t,r,n,a){if(r===lA)return[lA,lA];if(r===sA)return[CA(n),CA(a)];var i=FA(t,r.bounds,n);if(void 0!==i&&i<=0)return[r,lA];var o=NA.combineProduct(t,r.bounds,n,eA);if(o===lA)return[lA,r];var u=NA.combineProduct(t,r.bounds,a,eA);if(r.isSubspace)return[CA(o),u===lA?lA:CA(u)];var s=e(t,r.left,n,a),l=s[0],c=s[1],d=e(t,r.right,n,a),f=d[0],h=d[1];return[MA(t,l,f),MA(t,c,h)]}(e,t,r.box,n.box)};function xA(e,t,r,n,a){var i=LA(e,n),o=i[0],u=i[1],s=PA(e,t,o,u),l=s[0],c=s[1],d=PA(e,r,o,u),f=d[0],h=d[1],v=a(e,l,f,o);return v===sA?sA:MA(e,v,a(e,c,h,u))}function BA(e,t,r,n){if(r===lA)return t;if(t===lA)return r;if(t===sA)return t;if(r===sA)return r;if(t.isSubspace&&r.isSubspace){var a=DA(e,t,r);if(void 0!==a)return a}return xA(e,t,r,n,BA)}function UA(e,t){if(t===lA)return e;if(t===sA)return t;if(e===lA)return t;if(e===sA)return e;var r=Object(fe.a)(Object(fe.a)({},e.productOperations),t.productOperations),n=BA(r,e.root,t.root,yA(r));return n===lA?n:AA(r,n)}function GA(e,t,r,n){if(t===lA||r===lA)return lA;if(t===sA)return r;if(r===sA)return t;if(t.isSubspace&&r.isSubspace){var a=NA.combineProduct(e,t.bounds,r.bounds,eA);return a===lA?lA:CA(a)}return xA(e,t,r,n,GA)}function jA(e,t){if(e===lA)return e;if(t===lA)return t;if(e===sA)return t;if(t===sA)return e;var r=Object(fe.a)(Object(fe.a)({},e.productOperations),t.productOperations),n=GA(r,e.root,t.root,yA(r));return n===lA?n:AA(r,n)}function VA(e,t,r,n){if(t===lA)return t;if(r===sA)return lA;if(r===lA)return t;if(t===sA)return xA(e,t,r,n,VA);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var n,a,i=FA(e,t.bounds,r.bounds);if(0===i||-1===i)return lA;for(var o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(e,s)){var l=oA(e[s],e[s].top,RA(t.bounds[s]),RA(r.bounds[s]));if(void 0===l||l>0){if(void 0!==a)return;a=s}}}if(void 0!==a){var c=nA(e[a],e[a].top,RA(t.bounds[a]),RA(r.bounds[a]));if(c===lA)return lA;if(c===sA){var d=t.bounds,f=a;d[f];return CA(Object(fe.e)(d,["symbol"==typeof f?f:f+""]))}return CA(Object(fe.a)(Object(fe.a)({},t.bounds),((n={})[a]=c,n)))}}(e,t,r);if(void 0!==a)return a}return xA(e,t,r,n,VA)}function HA(e,t){if(e===lA)return e;if(t===lA)return e;if(t===sA)return lA;if(e===sA){var r=VA(t.productOperations,sA,t.root,yA(t.productOperations));return r===lA?r:AA(t.productOperations,r)}var n=Object(fe.a)(Object(fe.a)({},e.productOperations),t.productOperations),a=VA(n,e.root,t.root,yA(n));return a===lA?a:AA(n,a)}function WA(e,t){if(e===t)return 0;if(e===lA)return-1;if(t===lA)return 1;if(e===sA)return t===sA?0:1;if(t===sA)return-1;var r=Object(fe.a)(Object(fe.a)({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===lA)return-1;if(n===lA)return 1;if(r===sA)return n===sA?0:1;if(n===sA)return-1;if(r.isSubspace&&n.isSubspace)return FA(t,r.bounds,n.bounds);var i=LA(t,a),o=i[0],u=i[1],s=PA(t,r,o,u),l=s[0],c=s[1],d=PA(t,n,o,u),f=d[0],h=d[1],v=e(t,l,f,o);return void 0!==v?iA(v,e(t,c,h,u)):void 0}(r,e.root,t.root,yA(r))}function KA(e,t,r,n){if(t===lA||r===lA)return!1;if(t===sA||r===sA)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=RA(t[i]),u=RA(r[i]),s=e[i];if(!tA(s,s.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=LA(e,n),i=a[0],o=a[1],u=PA(e,t,i,o),s=u[0],l=u[1],c=PA(e,r,i,o),d=c[0],f=c[1];return KA(e,s,d,i)||KA(e,l,f,o)}function zA(e,t){if(e===lA||t===lA)return!1;if(e===sA||t===sA)return!0;var r=Object(fe.a)(Object(fe.a)({},e.productOperations),t.productOperations);return KA(r,e.root,t.root,yA(r))}function YA(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=_A.apply(void 0,Object(fe.f)([e],r));if(a===lA)return!0;if(a===sA)return t(NA.denseProduct(r));var i=a.productOperations,o=a.root;function u(e){return e.isSubspace?t(NA.fromUntypedProduct(i,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}function qA(e){return e===lA||e===sA?0:kA(e.root)}var JA=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!0,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),QA=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function XA(e,t){return function(r,n){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];var o=t.get(r);void 0===o?(e.apply(void 0,Object(fe.f)([r,n],a)),t.set(r,t.size)):n.push("__cached__",o)}}function ZA(e,t){return function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];if("__cached__"===r.pick()){r.pop();var i=r.pop();return t[i]}var o=e.apply(void 0,Object(fe.f)([r],n));return t.push(o),o}}var $A;!function(){function e(t){var r,n,a,i,o=this;for(var u in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new QA,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==lA&&e!==sA){var r=e,n=o.getDims(r.productOperations);t.push(n),o.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===lA||t===sA)return t;e.putBack(t);for(var r={},n=e.pop(),a=0,i=n;a<i.length;a++){var u=i[a],s=o.globalProductOperations[u];r[u]=s}return{productOperations:r,root:o.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(o.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(o.serializers[n].serializeBound(null==t?void 0:t.supremum));var a=e.normalizeKey(null==t?void 0:t.key);r.push(o.serializers[n].serializeKey(a));for(var i=0,u=[null==t?void 0:t.left,null==t?void 0:t.right];i<u.length;i++){var s=u[i];null==s||s===lA||s===sA?r.push(s):(r.push("us"),o.serializeUntypedSparseCached(s,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=o.serializers[t].deserializeBound(e.pop()),a=o.serializers[t].deserializeBound(e.pop()),i=o.serializers[t].deserializeKey(e.pop()),u=["left","right"].map((function(r){var n=e.pop();return"us"===n?o.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:a,isExact:r,key:i,left:u[0],right:u[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,a=r;n<a.length;n++){var i=a[n],u=e.bounds[i];o.serializeUntypedSparseCached(u,t,i)}e.isSubspace||(o.serializeUntypedSparseProductCached(e.left,t,r),o.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},a=0,i=t;a<i.length;a++){var u=i[a],s=o.deserializeUntypedSparseCached(e,u);n[u]=s}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:o.deserializeUntypedSparseProductCached(e,t),right:o.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=XA(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=ZA(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=XA(this.serializeProductSet,this.cached),this.deserializeProductSetCached=ZA(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=XA(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=ZA(this.deserializeUntypedSparseProduct,this.cache),t){var s={serializeKey:null!==(r=t[u].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[u].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(a=t[u].serializeBound)&&void 0!==a?a:function(e){return JSON.stringify(e)},deserializeBound:null!==(i=t[u].deserializeBound)&&void 0!==i?i:function(e){return JSON.parse(e)}};this.serializers[u]=s}}e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var a=n[r];this.serializeProductSetCached(a,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new JA(JSON.parse(e)),r=t.pop(),n=[],a=0;a<r;a+=1){var i=this.deserializeProductSetCached(t);n.push(i)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=Object(fe.a)({},e);return delete t.depth,delete t.split,t}return e}}();!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}($A||($A={}));var eR=[$A.AvailableSet,$A.AvailableRead+1],tR=[0,1<<20],rR=[0,16384],nR={availability:gA(1,eR[0]+1,eR[1],eR,"Availability operations, alpha = 1"),row:gA(.2,tR[0]+1,tR[1],tR,"Row operations, alpha = 0.2"),col:gA(.35,rR[0]+1,rR[1],rR,"Col operations, alpha = 0.35")},aR={availability:JE(nR.availability),row:JE(nR.row),col:JE(nR.col)};function iR(e){return TA({row:aR.row([e.row,e.row+e.rows]),col:aR.col([e.col,e.col+e.cols])})}function oR(e){if(e!==lA){var t,r,n=e===sA?void 0:e.root.bounds.row,a=e===sA?void 0:e.root.bounds.col,i=void 0===n?nR.row.top:(t=QE(nR.row,n),r=[],fR(t,(function(e){return r.push(e),!0})),r.reduce(Mr)),o=i[0],u=i[1],s=void 0===a?nR.col.top:function(e){var t=[];return hR(e,(function(e){return t.push(e),!0})),t.reduce(Mr)}(QE(nR.col,a)),l=s[0];return ha(o,l,u-o,s[1]-l)}}var uR,sR,lR=TA({availability:aR.availability([$A.AvailableSet,$A.AvailableSet+1])}),cR=TA({availability:aR.availability([$A.AvailableRead,$A.AvailableRead+1])}),dR=TA({availability:aR.availability([$A.AvailableSet,$A.AvailableRead+1])});function fR(e,t){return e!==sA?pA(e,t):t(nR.row.top)}function hR(e,t){return e!==sA?pA(e,t):t(nR.col.top)}function vR(e,t){return YA(e,(function(e){return fR(e.row,(function(r){var n=r[0],a=r[1];return hR(e.col,(function(e){var r=e[0],i=e[1];return t(ha(n,r,a-n,i-r))}))}))}),"row","col")}function pR(e,t){return vR(e,(function(e){return Vr(e,t)}))}function mR(e,t){return{sheet:e,set:t}}function gR(e){return mR(e.sheet,iR(e.range))}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(uR||(uR={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(sR||(sR={}));var SR,bR,yR,CR,kR,ER,AR={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function RR(e,t){var r;return Object(fe.a)(Object(fe.a)({},e),((r={})[t]=(e[t]||0)+1,r))}function NR(e,t){switch(t.message){case SR.ChangedCell:return Object(fe.a)(Object(fe.a)({},e),{changedCellCount:RR(e.changedCellCount,t.cellKind),calculatedCellCount:RR(e.calculatedCellCount,t.cellKind)});case SR.UnchangedCell:return Object(fe.a)(Object(fe.a)({},e),{calculatedCellCount:RR(e.calculatedCellCount,t.cellKind)});case SR.ContinueComputation:return Object(fe.a)(Object(fe.a)({},e),{continueCount:e.continueCount+1});case SR.StateTimedOut:return Object(fe.a)(Object(fe.a)({},e),{stateTimedOut:!0});case SR.EditFinished:return Object(fe.a)(Object(fe.a)({},e),{editFinishedCount:e.editFinishedCount+1});case SR.RecalcFinished:return Object(fe.a)(Object(fe.a)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return te("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function TR(e,t){e[t]=(e[t]||0)+1}function IR(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function FR(e,t){return function(r,n,a){return b(r)&&e(r)||IR(n,a,t)}}function OR(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,u=a;o<u.length;o++){TR(r,u[o])}return i}function DR(e,t,r,n){if(!OR(e,QR,r,n))return[];var a=n+".<index>";return e.filter((function(e){return OR(e,t,r,a)}))}function MR(e){return function(t,r,n){return!!y(t)||e(t,r,n)}}function wR(e){return function(t,r,n){if(y(t))return IR(r,n,"non-null object");var a=n.length;try{var i=!0;for(var o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function _R(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function LR(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function PR(e){return function(t,r,n){if(!Array.isArray(t))return IR(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function xR(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e).sort());return function(r,n,a){if(y(r))return IR(n,a,"non-null object");var i=a.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return y(o)?(a.push("kind"),IR(n,a,t)):o(r,n,a)}finally{a.length=i}}}function BR(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e).sort());return function(r,n,a){var i=e[typeof r];return y(i)?IR(n,a,t):i(r,n,a)}}function UR(e){return"number"==typeof e&&e>-1/0&&e<1/0}function GR(e){return(0|e)===e||Math.floor(e)===e}function jR(e,t,r){return void 0===r&&(r=0!==e?"integer >= "+e+" and < "+t:"natural < "+t),FR((function(r){return"number"==typeof r&&r>=e&&r<t&&GR(r)}),r)}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(SR||(SR={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(bR||(bR={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Inferred="Inferred"}(yR||(yR={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(CR||(CR={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(kR||(kR={}));var VR=FR((function(e){return!1}),"never"),HR=FR((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),WR=FR(UR,"finite number"),KR=FR((function(e){return UR(e)&&GR(e)}),"integer"),zR=jR(0,1/0,"natural"),YR=FR((function(e){return"string"==typeof e}),"string"),qR=FR((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),JR=FR((function(e){return"boolean"==typeof e}),"boolean"),QR=FR((function(e){return Array.isArray(e)}),"Array");function XR(e){return FR((function(t){return t===e}),JSON.stringify(e))}function ZR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of "+JSON.stringify(e.sort());return FR((function(e){return"string"==typeof e&&!0===r[e]}),o)}function $R(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var eN=FR((function(e){return"string"==typeof e&&$R(e)}),"formula text"),tN=wR({functionId:zR,functionName:qR}),rN=wR({errorType:zR,errorName:FR((function(e){return"string"==typeof e&&e.length>1&&V(e,"#")}),"error name")}),nN=wR({iformat:zR,formatString:YR,builtIn:JR}),aN=FR((function(e){return"string"==typeof e||UR(e)}),"string or finite number"),iN=wR({sheetId:aN,sheetName:YR}),oN=jR(0,1<<20),uN=jR(0,16384),sN=wR({row:oN,column:uN}),lN=FR((function(e){return null==e.lastRow||e.lastRow>=e.row}),"lastRow >= row"),cN=FR((function(e){return null==e.lastColumn||e.lastColumn>=e.column}),"lastColumn >= column"),dN=LR(_R(sN,wR({lastRow:MR(oN),lastColumn:MR(uN)})),(function(e){return lN}),(function(e){return cN})),fN=_R(dN,wR({sheetId:aN})),hN=_R(fN,wR({lastRow:MR(VR),lastColumn:MR(VR)})),vN=wR({kind:XR("Blank")}),pN=wR({kind:XR("Error"),type:zR}),mN=BR({number:WR,string:YR,boolean:JR,object:xR({Blank:vN,Error:pN})}),gN=BR({number:zR,string:YR}),SN=_R(wR({value:mN,iformat:zR,failureReason:MR(YR)}),xR({CellFormula:wR({formulaBarText:eN}),ArrayFormula:wR({formulaBarText:MR(VR)}),Value:wR({formulaBarText:YR})})),bN=wR({range:fN,excludeRows:MR(PR(oN)),excludeColumns:MR(PR(uN)),data:MR(SN),fromStateId:MR(KR)}),yN=wR({isSpilled:JR,formulaBarText:eN}),CN=wR({range:fN,data:MR(yN),fromStateId:MR(KR)}),kN=wR({sheetId:aN,usedRange:MR(dN)}),EN=BR({number:WR,string:YR,boolean:JR,object:xR({Error:pN})}),AN=wR({kind:XR("NamedValue"),value:EN}),RN=wR({kind:XR("NamedFormula"),formulaBarText:eN}),NN=wR({kind:XR("NamedRange"),range:fN}),TN=wR({column:zR,name:qR}),IN=function(e){var t;return(null!==(t=e.lastRow)&&void 0!==t?t:e.row)-e.row+1},FN=function(e){var t;return(null!==(t=e.lastColumn)&&void 0!==t?t:e.column)-e.column+1},ON=FR((function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+IN(e.range)<1<<20)}),"enough rows for headers and totals"),DN=FR((function(e){var t=e.range.column,r=e.range.column+FN(e.range);return e.columns.every((function(e){return e.column>=t&&e.column<r}))}),"column names in range"),MN=LR(wR({kind:XR("NamedTable"),range:fN,hasHeadersRow:JR,hasTotalsRow:JR,columns:PR(TN)}),(function(e){return ON}),(function(e){return DN})),wN=wR({kind:XR("NamedFailure"),failureReason:YR,objectKind:MR(ZR("NamedValue","NamedFormula","NamedRange","NamedTable"))}),_N=wR({name:YR,data:MR(xR({NamedValue:AN,NamedFormula:RN,NamedRange:NN,NamedTable:MN,NamedFailure:wN}))}),LN=function(e){return LR(_N,(function(t){return function(e){return FR((function(t){var r;return"NamedTable"!==(null===(r=t.data)||void 0===r?void 0:r.kind)||null==e}),"NamedTable at global scope")}(e)}))},PN=wR({scope:MR(aN),objects:MR(QR),fromStateId:MR(KR)}),xN=FR((function(e){return e.length>0}),"a non-empty array"),BN=FR((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),UN=LR(PR(fN),(function(e){return xN}),(function(e){return BN})),GN=_R(wR({range:UN,origin:MR(sN),viewport:MR(fN)}),xR({CellFormula:wR({formulaBarText:eN,value:MR(VR)}),Value:wR({formulaBarText:YR,value:mN}),Inferred:wR({formulaBarText:YR,value:MR(VR)})})),jN=xR({SetFormat:wR({format:gN}),RibbonFormat:wR({ribbon:ZR.apply(void 0,m(ng))}),ChangeDecimals:wR({changeDecimals:jR(-20,20)})}),VN=wR({range:UN,operation:jN,origin:MR(sN),viewport:MR(fN)}),HN=wR({range:fN,formulaBarText:FR((function(e){return"string"==typeof e&&(0===e.length||$R(e))}),"empty string or text denoting formula"),origin:MR(sN),viewport:MR(fN)}),WN=FR((function(e){var t=FN(e.source),r=IN(e.source);return e.target.column+t<=16384&&e.target.row+r<=1<<20}),"(target,source) in range"),KN=LR(wR({kind:ZR("CopyPaste"),target:hN,source:fN,viewport:MR(fN)}),(function(e){return WN})),zN=FR((function(e){return 2===e.length}),"2 AM/PM symbols"),YN=FR((function(e){return 7===e.length}),"7 day symbols"),qN=FR((function(e){return 12===e.length}),"12 month symbols");function JN(e){var t=p(e,f);return FR((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var QN=JN(At),XN=JN(yu),ZN=JN(Cu),$N=JN(ku),eT=JN(Eu),tT=wR({worksheetFunctionNames:QR,thousandsData:MR(PR(zR)),errorTypeNames:QR,specialRefNames:MR(LR(PR(MR(qR)),(function(e){return QN}))),trueName:qR,falseName:qR,rowLetter:qR,columnLetter:qR,leftBrace:qR,rightBrace:qR,leftBracket:qR,rightBracket:qR,decimalSeparator:qR,listSeparator:qR,columnSeparator:qR,rowSeparator:qR,thousandsSeparator:MR(YR),lcid:MR(zR),country:MR(zR),numberDecimals:MR(zR),isExpSepBySpace:MR(JR),fractionSeparator:MR(qR),isPercentSepBySpace:MR(JR),currencyFormat:MR(ZR(mi.Paren,mi.Lead,mi.Intern,mi.Trail)),isCurrencySymbolLead:MR(JR),isCurrencySepBySpace:MR(JR),currencySymbol:MR(YR),currencyDecimals:MR(zR),dateOrder:MR(ZR(gi.MDY,gi.DMY,gi.YMD,gi.MYD,gi.DYM,gi.YDM)),dateSeparator:MR(YR),dateAltSeparator:MR(YR),year4Digits:MR(JR),month2Digits:MR(JR),day2Digits:MR(JR),longDateFormat:MR(JR),timeSeparator:MR(YR),timeAltSeparator:MR(YR),hour2Digits:MR(JR),clock24Hour:MR(JR),isAMPMSepBySpace:MR(JR),ampmSymbols:MR(LR(PR(YR),(function(e){return zN}))),dayNameShort:MR(LR(PR(YR),(function(e){return YN}))),dayNameLong:MR(LR(PR(YR),(function(e){return YN}))),monthNameShort:MR(LR(PR(YR),(function(e){return qN}))),monthNameLong:MR(LR(PR(YR),(function(e){return qN}))),pictureSpecial:MR(LR(PR(MR(qR)),(function(e){return XN}))),pictureSingle:MR(LR(PR(MR(qR)),(function(e){return ZN}))),pictureColor:MR(LR(PR(MR(qR)),(function(e){return $N}))),pictureDbnum:MR(LR(PR(MR(qR)),(function(e){return eT}))),sysDateFormat:MR(YR),sysTimeFormat:MR(YR)}),rT=wR({yr:KR,mon:jR(1,13),dom:jR(1,6),wdy:jR(1,8),hour:jR(0,24),min:jR(0,60),sec:jR(0,60),fracSec:XR(0),rounding:jR(0,4)}),nT=LR(wR({bias:WR,standardDate:MR(rT),standardBias:WR,daylightDate:MR(rT),daylightBias:WR}),(function(e){return FR((function(e){return y(e.standardDate)===y(e.daylightDate)}),"standardDate iff daylightDate")})),aT=wR({date1904:MR(JR),dateCompatibility:MR(JR),timezone:MR(nT)}),iT=MR(xR({Origin:wR({value:MR(VR)}),Iformat:wR({value:MR(zR)}),Inferred:wR({value:MR(VR)})})),oT=((ER={})[Tt.Number]=!0,ER[Tt.String]=!0,ER[Tt.Boolean]=!0,ER[Tt.Error]=!0,ER[Tt.Array]=!1,ER[Tt.Blank]=!0,ER[Tt.Rich]=!1,ER),uT=FR((function(e){return oT[e.kind]}),"supported ReadOper");function sT(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function lT(e,t,r){return{kind:e,key:t,value:r}}function cT(e,t){return lT(1,e,t)}function dT(e,t){return lT(2,e,t)}function fT(e,t){return lT(3,e,t)}var hT=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var a=r.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var i=0,o=n.value;i<o.length;i++){var u=t(r,o[i]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:Lo(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=bT(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,ST(this.lattice,this.root,cT(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==bT(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return vT(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return vT(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return vT(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return vT(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],a=this.lattice,i=function(e,r){var o=a.keyCompare(e.key,t);if(void 0===o||o<0)return C(e,1);if(2===e.kind){for(var u=e.value,s=0;s<u.length;s+=1)if(0===a.keyCompare(u[s].key,t)){if((h=sT(u,s)).length<r){var l=dT(e.key,h);return n.push(l),C(l,3)}return C(dT(mT(a,h),h),2)}}else for(u=e.value,s=0;s<u.length;s+=1){var c=i(u[s],a.minChildren),d=c[0],f=c[1];if(3===f){var h;if((h=sT(u,s)).length>=r)return C(fT(mT(a,h),h),2);l=fT(e.key,h);return n.push(l),C(l,3)}if(2===f)return C(fT(e.key,sT(u,s,d)),2)}return C(e,1)},o=2===this.root.kind?1:2,u=i(this.root,o),s=u[0],l=u[1];if(s===this.root)return this;for(var c=3===l?void 0:s,d=0;d<n.length;d+=1)vT(n[d],(function(e,t){return c=ST(r.lattice,c,cT(e,t)),!0}));return new e(this.lattice,c,this.count-1)},e}();function vT(e,t,r,n){var a=void 0!==r?r:function(){return!0},i=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(i(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function pT(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),i=2;i<t.length;i+=1)for(var o=0;o<i;o+=1){var u=e.keyDistance(t[o].key,t[i].key);u>a&&(r=o,n=i,a=u)}return C(r,n)}(e,t),n=r[0],a=r[1],i=t[n].key,o=t[a].key,u=[],s=0;s<t.length;s+=1){var l=t[s];u.push([l,e.keyDistance(i,l.key)-e.keyDistance(o,l.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var c=e.minChildren;c<t.length-e.minChildren&&u[c][1]<0;c+=1);var d=[],f=[];for(s=0;s<c;s+=1)d.push(u[s][0]);for(s=c;s<t.length;s+=1)f.push(u[s][0]);return C(d,f)}function mT(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function gT(e,t,r){var n=pT(e,r),a=n[0],i=n[1];return C(lT(t,mT(e,a),a),lT(t,mT(e,i),i))}function ST(e,t,r){if(null==t)return dT(r.key,[r]);var n=function t(n){if(2===n.kind){var a=Object(fe.f)(n.value,[r]);if(a.length>e.maxChildren){var i=gT(e,n.kind,a),o=i[0],u=i[1];return C(dT(o.key,o.value),u)}return C(dT(e.keyJoin(n.key,r.key),a),void 0)}var s=n.value.slice(),l=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],s=e.keyDistance(u.key,r);(s<a||s===a&&u.value.length<i)&&(n=o,a=s,i=u.value.length)}return n}(e,s,r.key),c=t(s[l]),d=c[0],f=c[1];if(s[l]=d,null!=f&&(s.push(f),s.length>e.maxChildren)){var h=gT(e,n.kind,s),v=h[0];u=h[1];return C(fT(v.key,v.value),u)}return C(fT(e.keyJoin(n.key,r.key),s),void 0)}(t),a=n[0],i=n[1];return null!=i?fT(e.keyJoin(a.key,i.key),[a,i]):a}function bT(e,t,r,n,a){if(void 0!==t)return function t(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){o=n.value[a];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return fT(n.key,sT(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var o,u;if(void 0!==(u=i(o=n.value[a])))return dT(n.key,sT(n.value,a,u))}}(t);function i(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?cT(t.key,a):t}}function yT(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,l=t.cols;return A(r-o+.5*(a-s))+A(n-u+.5*(i-l))}function CT(){return hT.create(Hr,Yr,Jr,yT)}function kT(e){return Array.isArray(e)}var ET,AT,RT=function(e){return 0===e};!function(e){e.ClientValueUnknown="ClientValueUnknown"}(ET||(ET={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(AT||(AT={}));var NT,TT={fmla:"",lexicalKind:Xn.Cell,origin:va(0,0),compiledFmla:void 0,hasHyperlink:!1},IT={fmla:"",lexicalKind:Xn.Range,origin:va(0,0),compiledFmla:void 0,hasHyperlink:!1},FT=function(e,t){return""===e&&!t},OT=TT;!function(e){e.ClientValueUnknown="ClientValueUnknown"}(NT||(NT={}));var DT={kind:NT.ClientValueUnknown};function MT(e){return e.kind===NT.ClientValueUnknown}var wT={oper:Ya,failure:void 0};function _T(e,t){return Tn(e)&&void 0===t}function LT(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!tn(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function PT(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===Xn.Cell?TT:IT;e=e.setValue(t,n)}return!0})),e}function xT(e,t){return e.forEachMeets(t,(function(t,r){return(r.fmla===AT.ClientValueUnknown||r.fmla.length>0)&&(e=e.setValue(t,OT)),!0})),e}function BT(e,t,r,n){var a=jA(t,cR);return pR(HA(t,_A(jA(r,a),"row","col")),(function(t){return e=e.setValue(t,n),!0})),e}var UT={values:CT(),formats:CT(),styles:CT(),formulae:CT(),dirty:lA},GT={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0};var jT=ha(0,0,1<<20,16384);function VT(e,t){return void 0===e?t:void 0===t?e:Hr(e,t)}function HT(e,t){return void 0===e||void 0===t?void 0:zr(e,t)}var WT=function(){function e(e,t,r,n,a,i,o,u,s,l,c){void 0===t&&(t=UT),void 0===r&&(r=lA),void 0===n&&(n=jT),void 0===a&&(a=lA),void 0===i&&(i=lA),void 0===o&&(o=lA),void 0===u&&(u=lA),void 0===s&&(s=CT()),void 0===l&&(l=!1),void 0===c&&(c=!1),this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=t,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=a,this.hiddenRowsAvailability=i,this.hiddenCols=o,this.hiddenColsAvailability=u,this.mergeCells=s,this.inFilterMode=l,this.filterModeAvailable=c,this.rollBackToServerState()}return e.create=function(t){return new e(t)},e.prototype.clone=function(t){void 0===t&&(t=Ow.Server);var r=new e(this.sheet,this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return t===Ow.Client&&(r.editedContents=this.editedContents,r.clientContents=this.clientContents,r.recalcValues=this.recalcValues,r.recalcDirty=this.recalcDirty,r.recalcFailures=this.recalcFailures,r.editedTaint=this.editedTaint,r.recalcTaint=this.recalcTaint,r.editedAvailability=this.editedAvailability),r},e.prototype.advanceState=function(e){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=lA,this.serverUsed=jT,this.hiddenRows=this.hiddenRowsAvailability=lA,this.hiddenCols=this.hiddenColsAvailability=lA,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState()},e.prototype.rollBackToServerState=function(){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=lA,this.rollBackToEditedState()},e.prototype.rollBackToEditedState=function(){this.clientContents=this.editedContents,this.recalcValues=this.editedContents.values,this.recalcFailures=lA,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=jA(iR(e),cR),n=jA(t,r),a=_A(HA(r,n),"row","col"),i=WA(n,r);return!!(void 0!==i&&i>=0)||a},e.prototype.forEachRecalcDirty=function(e,t){return pR(jA(this.recalcDirty,iR(e)),t)},e.prototype.hasRecalcDirty=function(e){return zA(this.recalcDirty,iR(e))},e.prototype.hasRecalcFailure=function(e){return zA(this.recalcFailures,iR(e))},e.prototype.hasEditedEditTaint=function(e){return zA(this.editedTaint,iR(e))},e.prototype.hasRecalcEditTaint=function(e){return zA(this.recalcTaint,iR(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r=aR.row(C(e,t)),n=aA(this.hiddenRowsAvailability,r);if(!(void 0!==n&&n>=0))return ge({kind:Nw.HiddenRows});var a=[];return fR($E(this.hiddenRows,r),(function(e){var t=e[0],r=e[1];return a.push(Ry(t,r)),!0})),he(a)},e.prototype.setHiddenRows=function(e,t){var r=aR.row(C(e.row,e.row+e.rows));this.hiddenRows=XE(rA(this.hiddenRows,r),$E(t,r)),this.hiddenRowsAvailability=XE(this.hiddenRowsAvailability,r)},e.prototype.getHiddenCols=function(e,t){var r=aR.col(C(e,t)),n=aA(this.hiddenColsAvailability,r);if(!(void 0!==n&&n>=0))return ge({kind:Nw.HiddenCols});var a=[];return hR($E(this.hiddenCols,r),(function(e){var t=e[0],r=e[1];return a.push(Ry(t,r)),!0})),he(a)},e.prototype.setHiddenCols=function(e,t){var r=aR.col(C(e.row,e.row+e.rows));this.hiddenCols=XE(rA(this.hiddenCols,r),$E(t,r)),this.hiddenColsAvailability=XE(this.hiddenColsAvailability,r)},e.prototype.setMergeCell=function(e){this.mergeCells=this.mergeCells.setValue(e,!0)},e.prototype.getMergeCell=function(e){var t;return this.mergeCells.forEachGe(e,(function(e){return t=e,!0})),t},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?he(this.inFilterMode):ge({kind:Nw.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,t,r,n){var a=jA(e,lR);return vR(jA(r,a),(function(e){return n.formulae.forEachMeets(e,(function(r,n){return!!FT(n.fmla,void 0!==n.compiledFmla)||Vr(zr(e,r),t)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=jA(e,cR);return vR(jA(r,n),(function(e){return Vr(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=jA(e,lR),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=WA(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,jA(e,dR)),this.unionTaint(!0,lA),this.unionUsed(!0,oR(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?lA:iR(e),r=HA(sA,t),n=this.serverContents,a=n.values,i=n.formats,o=n.styles,u=n.formulae,s=n.dirty;vR(r,(function(e){return a.forEachLe(e,(function(e,t){return _T(t.oper,t.failure)||(a=a.setValue(e,wT)),!0})),i.forEachLe(e,(function(e,t){return RT(t)||(i=i.setValue(e,0)),!0})),o.forEachLe(e,(function(e,t){return t!==CR.Blank&&(o=o.setValue(e,CR.Blank)),!0})),!0})),vR(r,(function(e){return u=PT(u,e),!0})),s=HA(s,r),this.setContents(!0,{values:a,formats:i,styles:o,formulae:u,dirty:s});var l=jA(r,cR);this.serverAvailability=this.editedAvailability=UA(this.serverAvailability,l),this.editedTaint=this.recalcTaint=lA;var c=this.serverUsed;c=HT(c,e),this.serverUsed=this.editedUsed=c},e.prototype.setRecalcFailure=function(e){this.recalcFailures=UA(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=UA(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;Vr(e,(function(e,n,a){return r.recalcValues=r.recalcValues.setValue(e,{oper:kT(t)?t[n][a]:t,failure:void 0}),!0})),this.recalcDirty=HA(this.recalcDirty,iR(e))},e.prototype.setClientValue=function(e,t){var r=this.clientContents.values;Vr(e,(function(e,n,a){return r=r.setValue(e,{oper:kT(t)?t[n][a]:t,failure:void 0}),!0})),this.clientContents=Object(fe.a)(Object(fe.a)({},this.clientContents),{values:r})},e.prototype.setClientFormula=function(e,t,r){var n=this.clientContents.formulae;n=xT(n,e),void 0!==t?n=n.setValue(t,r):Vr(e,(function(e){return n=n.setValue(e,r),!0})),this.clientContents=Object(fe.a)(Object(fe.a)({},this.clientContents),{formulae:n})},e.prototype.setClientFormat=function(e,t){var r=this.clientContents.formats;Vr(e,(function(e){return r=r.setValue(e,t),!0})),this.clientContents=Object(fe.a)(Object(fe.a)({},this.clientContents),{formats:r})},e.prototype.getRecalcValues=function(e){for(var t=e.row,r=e.col,n=e.rows,a=e.cols,i=new Array(n),o=0;o<n;o+=1)i[o]=K(new Array(a),wT);return this.recalcValues.forEachLe(e,(function(e,n){return i[e.row-t][e.col-r]=n,!0})),i},e.prototype.getClientValue=function(e){var t=this.clientContents.values.getValue(e);return null!=t?t:wT},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return null!=t?t:wT},e.prototype.getEditedValue=function(e){var t=this.editedContents.values.getValue(e);return null!=t?t:wT},e.prototype.forEachEditedValue=function(e,t){return this.editedContents.values.forEachMeets(e,t)},e.prototype.getServerFormula=function(e){return this.getFormula(e,this.serverContents.formulae)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(fe.a)(Object(fe.a)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return null!=t?t:0},e.prototype.forEachEditedFormat=function(e,t){return this.editedContents.formats.forEachMeets(e,t)},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return null!=t?t:0},e.prototype.getEditedStyle=function(e){var t=this.editedContents.styles.getValue(e);return null!=t?t:CR.Blank},e.prototype.getServerStyle=function(e){var t=this.serverContents.styles.getValue(e);return null!=t?t:CR.Blank},e.prototype.getClientFormat=function(e){var t=this.clientContents.formats.getValue(e);return null!=t?t:0},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(e,t){return this.editedContents.formulae.forEachMeets(e,t)},e.prototype.getFormula=function(e,t){var r=void 0;return t.forEachGe(e,(function(e,t){return!!FT(t.fmla,void 0!==t.compiledFmla)||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,e&&(this.clientContents=this.editedContents),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=lA},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=UA(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?lA:UA(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r=e?this.serverUsed:this.editedUsed;r=VT(r,t),e&&(this.serverUsed=r),this.editedUsed=r},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u){this.setCommon(e,t,void 0,r,n,a,i,o,u)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=iR(t);this.setCommon(e,u,t,r,n,void 0,a,i,o)},e.prototype.setCommon=function(e,t,r,n,a,i,o,u,s){var l=this,c=e?this.serverContents:this.editedContents,d=c.values,f=c.formats,h=c.styles,v=c.formulae,p=c.dirty,m=void 0===n&&void 0!==a||void 0!==(null==n?void 0:n.compiledFmla),g=n;void 0!==n&&(vR(t,(function(e){return v=PT(v,e),!0})),FT(n.fmla,void 0!==n.compiledFmla)&&(g=void 0));var S=void 0!==g&&void 0===r?n:void 0,b=void 0!==g&&void 0!==r?n:void 0,y=a;void 0!==a&&_T(a,i)&&(vR(t,(function(e){return d.forEachLe(e,(function(e,t){return _T(t.oper,t.failure)||(d=d.setValue(e,wT)),!0})),!0})),p=m?UA(p,t):HA(p,t),y=void 0);var C=void 0!==y?{oper:y,failure:i}:void 0,k=o;void 0!==o&&RT(o)&&(vR(t,(function(e){return f.forEachLe(e,(function(e,t){return RT(t)||(f=f.setValue(e,0)),!0})),!0})),k=void 0);var E=k===yR.Weak?void 0:k,A=k===yR.Weak?k:void 0,R=u;void 0!==u&&u===CR.Blank&&(vR(t,(function(e){return h.forEachLe(e,(function(e,t){return t!==CR.Blank&&(h=h.setValue(e,CR.Blank)),!0})),!0})),R=void 0);var N=R===CR.Weak?void 0:R,T=R===CR.Weak?R:void 0,I=t;if(!e){var F=jA(t,lR);I=UA(_A(jA(this.editedAvailability,F),"row","col"),jA(t,void 0!==s?iR(s):lA))}if(void 0===S&&void 0===E&&void 0===N&&void 0===C||(pR(I,(function(e){return void 0!==S&&(v=LT(v,e,S)),void 0!==E&&(f=f.setValue(e,E)),void 0!==N&&(h=h.setValue(e,N)),void 0!==C&&(d=d.setValue(e,C)),!0})),void 0===S&&void 0===C||(p=m?UA(p,I):HA(p,I))),void 0!==b){v=LT(v,r,b);var O=iR(r);p=m?UA(p,O):HA(p,O)}void 0!==A&&(f=BT(f,I,e?this.serverAvailability:this.editedAvailability,yR.Unavailable)),void 0!==T&&(h=function(e,t,r){var n=jA(t,cR);return pR(HA(t,_A(jA(r,n),"row","col")),(function(t){return e=e.setValue(t,CR.Unavailable),!0})),e}(h,I,e?this.serverAvailability:this.editedAvailability));var D=void 0===a?lA:I,M=void 0===n?lA:I,w=void 0===o?lA:I,_=void 0===a&&void 0===o?lA:I;e||(vR(D,(function(e){return l.setClientValue(e,DT),!0})),void 0!==n&&(void 0!==r?this.setClientFormula(r,r,n):vR(M,(function(e){return l.setClientFormula(e,void 0,n),!0}))),o===yR.Weak?this.clientContents=Object(fe.a)(Object(fe.a)({},this.clientContents),{formats:BT(this.clientContents.formats,w,this.editedAvailability,yR.ClientValueUnknown)}):vR(w,(function(e){return l.setClientFormat(e,yR.ClientValueUnknown),!0}))),this.setContents(e,{values:d,formats:f,styles:h,formulae:v,dirty:p}),this.unionAvailability(e,jA(D,dR)),e||(this.editedAvailability=HA(this.editedAvailability,HA(t,I))),this.unionTaint(e,_),this.unionUsed(e,oR(t))},e.prototype.copyRange=function(e){function t(t,r){return t.forEachLe(e,(function(e,t){return r=r.setValue(e,t),!0})),r}var r=UT.values,n=UT.formats,a=UT.styles,i=UT.formulae,o=this.editedContents,u=o.values,s=o.formats,l=o.styles,c=o.formulae;r=t(u,r),n=t(s,n),a=t(l,a),c.forEachMeets(e,(function(t,r){return i=i.setValue(zr(t,e),r),!0}));var d=on(e),f=jA(this.editedAvailability,iR(e)),h=HT(this.editedUsed,e);return{origin:d,formats:n,styles:a,values:r,formulae:i,availability:f,used:h}},e.prototype.pasteRange=function(e,t){var r=iR(e),n=ha(t.origin.row,t.origin.col,e.rows,e.cols),a=this.editedContents,i=a.values,o=a.formats,u=a.styles,s=a.formulae,l=a.dirty,c=this.editedUsed,d=e.row-t.origin.row,f=e.col-t.origin.col;function h(e){return ha(e.row+d,e.col+f,e.rows,e.cols)}function v(t,r,a){return r.forEachMeets(e,(function(e,t){return r=r.setValue(e,a),!0})),t.forEachLe(n,(function(e,t){return r=r.setValue(h(e),t),!0})),r}var p=VT(c,void 0!==t.used?h(t.used):void 0),m=HT(p,e);i=v(t.values,i,wT),void 0!==m&&this.setClientValue(m,DT),o=v(t.formats,o,0),u=v(t.styles,u,CR.Blank),void 0!==m&&this.setClientFormat(m,yR.ClientValueUnknown),s=v(t.formulae,s,TT),l=HA(l,r);var g=this.clientContents.formulae;g=xT(g,e),s.forEachLe(e,(function(e,t){var r=t.origin,n=t.compiledFmla;return void 0!==n&&(l=UA(l,iR(e))),g=g.setValue(e,{fmla:AT.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:ET.ClientValueUnknown}),!0})),this.clientContents=Object(fe.a)(Object(fe.a)({},this.clientContents),{formulae:g});this.setContents(!1,{values:i,formats:o,styles:u,formulae:s,dirty:l}),this.editedAvailability=HA(this.editedAvailability,r),this.unionAvailability(!1,function(e,t,r){var n=lA;return YA(e,(function(e){var a=lA;fR(e.row,(function(e){var r=e[0],n=e[1];return a=XE(a,aR.row([r+t,n+t])),!0}));var i=lA;hR(e.col,(function(e){var t=e[0],n=e[1];return i=XE(i,aR.col([t+r,n+r])),!0}));var o=TA({row:a,col:i,availability:e.availability});return n=UA(n,o),!0}),"row","col","availability"),n}(t.availability,d,f)),this.unionTaint(!1,void 0===m?lA:iR(m)),this.unionUsed(!1,p)},e.prototype.getDirtyEditedCells=function(){return jA(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return HA(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return HA(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,lA),this.unionTaint(e,lA),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:qA(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:qA(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:qA(this.recalcDirty),recalcFailuresSetSubspaceCount:qA(this.recalcFailures),recalcTaintSetSubspaceCount:qA(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:qA(this.editedAvailability),hiddenRowsNodeCount:vA(this.hiddenRows)+vA(this.hiddenRowsAvailability),hiddenColsNodeCount:vA(this.hiddenCols)+vA(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(e){var t=lA;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=UA(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return zA(jA(iR(e),lR),t)}function i(e,t){return!FT(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return!RT(t)&&a(e)}function u(e,t){return t!==CR.Blank&&a(e)}function s(e,t){return!(!MT(t.oper)&&_T(t.oper,t.failure))&&a(e)}var l=_A(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),styles:this.serverContents.styles.filter(u),values:this.serverContents.values.filter(s),dirty:jA(this.serverContents.dirty,l)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),styles:this.editedContents.styles.filter(u),values:this.editedContents.values.filter(s),dirty:jA(this.editedContents.dirty,l)},this.clientContents={formulae:this.clientContents.formulae.filter(i),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(s)},this.recalcValues=this.recalcValues.filter(s),this.recalcDirty=jA(this.recalcDirty,l)},e}(),KT=function(e){return{kind:"NamedValue",value:e}},zT=function(e){return{kind:"NamedRange",value:e}},YT=zl.create((function(e,t){return e-t}));function qT(e,t,r,n,a){var i,o=e.sheet,u=e.range,s=t?ha(u.row-1,u.col,1,u.cols):void 0,l=r?ha(u.row+u.rows,u.col,1,u.cols):void 0,c=Wr(Wr(s,e.range),l),d=n.reduce((function(t,r){return ne("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name)}),YT),f=zl.create(a);d.forEach((function(e,t){return f=f.setValue(t,e),!0}));var h=d.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(i={},i[At.Data]=e,i[At.Headers]=s?ba(o,s):void 0,i[At.Totals]=l?ba(o,l):void 0,i[At.All]=ba(o,c),i),columnNames:f,columnIndexes:d,allColumnNamesAvailable:h,hasHeadersRow:t,hasTotalsRow:r}}var JT=function(e){return{kind:"NamedFormula",fmla:e}},QT=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},XT=CT(),ZT=CT(),$T={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var eI,tI=function(){function e(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}return e.create=function(t){return new e(zl.create(t),!1,XT,ZT)},e.prototype.update=function(t,r,n,a){return t!==this.names||r!==this.allAvailable||n!==this.tables||a!==this.ranges?new e(t,r,n,a):this},e.prototype.getEntry=function(e,t,r){var n=this.names.getEntry(t);return void 0===n?this.allAvailable?he(void 0):ge({kind:Nw.NameLoc,name:Aa(e,t),source:r}):he(!1!==n.value?n:void 0)},e.prototype.getEntryIfDefined=function(e){var t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(e){var t;return this.tables.forEachGe(e,(function(e,r){return t=r,!1})),t},e.prototype.getIntersectingTables=function(e){var t=[];return this.tables.forEachMeets(e,(function(e,r){return t.push(r),!0})),t},e.prototype.getNamedRanges=function(e){var t;return null!==(t=this.ranges.getValue(e))&&void 0!==t?t:[]},e.prototype.forEachAvailableName=function(e){return this.names.forEach((function(t,r){return!1===r||e(t,r)}))},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter((function(e,t){return!1!==t})):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e.prototype.onWriteNamedTable=function(e,t,r){var n=t.specialRefRanges[At.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)},e.prototype.onWriteNamedRange=function(e,t,r){var n,a=t.value.ranges[0],i=null!==(n=this.ranges.getValue(a))&&void 0!==n?n:[],o="remove"===r?i.filter((function(t){return en(e.scope,t.scope)&&e.name===t.name})):Object(fe.f)(i,[e]);return this.update(this.names,this.allAvailable,this.tables,0===o.length?this.ranges.remove(a):this.ranges.setValue(a,o))},e}(),rI=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=tI.create(e),this.emptyRecalcFailures=this.recalcFailures=Po.create(e)}return e.prototype.clone=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return Se(r)?he(void 0!==r.value?Aa(this.scope,r.value.key):void 0):r},e.prototype.getNameFormula=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return Se(r)?he(void 0!==r.value?r.value.value:void 0):r},e.prototype.getContainingTable=function(e){return this.contents.getContainingTable(e)},e.prototype.getIntersectingTables=function(e){return this.contents.getIntersectingTables(e)},e.prototype.getNamedRanges=function(e){return this.contents.getNamedRanges(e)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r,n){var a,i=this.contents.getEntryIfDefined(t);if(void 0!==i&&(a=n(Aa(this.scope,i.key),i.value,"remove")).kind===le.Failure)return a;if((this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0,void 0!==r)&&(a=n(Aa(this.scope,t),r,"add")).kind===le.Failure)return a;return me},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e,t){var r=this;if(this.isChanged||e!==this.oldStateId)return he(!1);this.contents=this.oldContents,this.isCurrent=!0;var n=he(!0);return this.contents.forEachAvailableName((function(e,a){var i=t(Aa(r.scope,e),a,"add");return i.kind===le.Success||(n=i,!1)})),n},e.prototype.onWriteNamedTable=function(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)},e.prototype.onWriteNamedRange=function(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)},e}(),nI=function(){function e(e,t,r,n,a,i,o){var u=this;this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=a,this.oldSheets=i,this.onWriteNamedObject=function(e,t,r){var n=t.obj;if("NamedRange"===n.kind){var a=n.value;if(ne("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",Zr(n.value.sheets.document,e.scope.document)),(i=u.getNameManager(a.sheets.index)).kind===le.Failure)return i;i.value.onWriteNamedRange(e,n,r)}if("NamedTable"===n.kind){var i;if((i=u.getNameManager(n.specialRefRanges[At.All].sheet.index)).kind===le.Failure)return i;i.value.onWriteNamedTable(e,n,r)}return me},this.globalNames=null!=o?o:new rI(t,ka(e))}return e.prototype.clone=function(t){var r;if(void 0===t&&(t=Ow.Server),this.sheets){for(var n=this.sheets,a=n.data,i=n.sheetPosToId,o=n.sheetNameToId,u=Object.create(null),s=0,l=i;s<l.length;s++){var c=l[s],d=a[c];u[c]=Object(fe.a)(Object(fe.a)({},d),{grid:d.grid.clone(t)})}r={data:u,sheetPosToId:i,sheetNameToId:o}}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),r,void 0,this.globalNames.clone())},e.prototype.setClientValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.setClientValue(e.range,t))},e.prototype.setClientFormula=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.setClientFormula(e.range,e.range,t))},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===le.Failure?r:he(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===le.Failure?r:he(r.value.grid.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.setClientFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:he(n.value.grid.setHiddenRows(t,r))},e.prototype.setHiddenCols=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:he(n.value.grid.setHiddenCols(t,r))},e.prototype.setMergeCell=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.setMergeCell(e.range))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===le.Failure?r:he(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u){var s=this.getSheetById(t.sheet.index);if(s.kind===le.Failure)return s;var l=void 0!==u&&$r(t.sheet,u.sheet)?u.range:void 0;return he(s.value.grid.setCellContents(e,t.set,r,n,a,i,o,l))},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=this.getSheetById(t.sheet.index);if(u.kind===le.Failure)return u;var s=void 0!==o&&$r(t.sheet,o.sheet)?o.range:void 0;return he(u.value.grid.setRangeFormula(e,t.range,r,n,a,i,s))},e.prototype.copyRange=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.copyRange(e.range))},e.prototype.pasteRange=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.pasteRange(e.range,t))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(mR(t.grid.sheet,t.grid.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(mR(t.grid.sheet,t.grid.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t){e.push(mR(t.grid.sheet,t.grid.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===le.Failure?n:he(n.value.setNamedObject(e,t.name,r,this.onWriteNamedObject))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===le.Failure?t:he(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===le.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)},e.prototype.setSheetNames=function(t){for(var r,n,a=null===(n=null!==(r=this.sheets)&&void 0!==r?r:this.oldSheets)||void 0===n?void 0:n.data,i=Object.create(null),o=[],u=[],s=0;s<t.length;s+=1){var l=t[s],c=l.sheetName,d=l.sheetId;o[s]=d,u.push([c,d]);var f=null==a?void 0:a[d];if(void 0===f){var h=la(this.document,d);i[d]={grid:WT.create(h),names:new rI(this.stringCompareCI,h),pos:s,name:c}}else i[d]=Object(fe.a)(Object(fe.a)({},f),{pos:s,name:c})}var v=Po.create(this.stringCompareCI).setValues(u);return new e(this.document,this.stringCompareCI,this.formats,this.styles,{data:i,sheetPosToId:o,sheetNameToId:v},void 0,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===le.Failure?r:he(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:he(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t,r){var n=this.getNameManager(e);if(n.kind===le.Failure)return n;var a=n.value.getNameLoc(t,r);return a.kind,le.Failure,a},e.prototype.getNameFormula=function(e,t){var r=this.getNameManager(e.scope.index);return r.kind===le.Failure?r:r.value.getNameFormula(e.name,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===le.Failure?t:he(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===le.Failure?t:he(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return he(this.globalNames);var t=this.getSheetById(e);return t.kind===le.Failure?t:he(t.value.names)},e.prototype.getContainingTable=function(e){var t=this.getNameManager(e.sheet.index);if(t.kind===le.Failure)return t;var r=t.value.getContainingTable(e.range);if(void 0!==r)return he(r);var n=this.getSheetById(e.sheet.index);return n.kind===le.Failure?n:zA(jA(iR(e.range),lR),n.value.grid.getServerAvailability())?me:ge({kind:Nw.ContainingTable,range:e})},e.prototype.getNamedRanges=function(e){var t=this.getNameManager(e.sheet.index);if(t.kind===le.Failure)return t;var r=t.value.getNamedRanges(e.range);if(void 0!==r)return he(r);var n=this.getSheetById(e.sheet.index);return n.kind===le.Failure?n:zA(jA(iR(e.range),lR),n.value.grid.getServerAvailability())?he([]):ge({kind:Nw.NamedRanges,range:e})},e.prototype.getIntersectingTables=function(e){var t=this.getNameManager(e.sheet.index);return t.kind===le.Failure?t:he(t.value.getIntersectingTables(e.range))},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getEditedFormula(e.range))},e.prototype.forEachEditedFormula=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.forEachEditedFormula(e.range,t))},e.prototype.getEditedValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getEditedValue(e.range))},e.prototype.forEachEditedValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.forEachEditedValue(e.range,t))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getEditedFormat(e.range))},e.prototype.forEachEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.forEachEditedFormat(e.range,t))},e.prototype.getEditedStyle=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getEditedStyle(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===le.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getHiddenCols=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:n.value.grid.getHiddenCols(t,r)},e.prototype.getMergeCell=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getMergeCell(e.range))},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getServerFormat(e.range))},e.prototype.getServerStyle=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getServerStyle(e.range))},e.prototype.getClientFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getClientValue(e.range))},e.prototype.getRecalcValues=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getRecalcValues(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getSheetById(e);return t.kind===le.Failure?t:he(t.value.grid.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.allEditedAvailable(e.range))},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===le.Failure?r:he(r.value.grid.forEachRecalcDirty(e.range,t))},e.prototype.hasRecalcDirty=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===le.Failure?t:he(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:he(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:he(n.value.grid.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===le.Failure?n:he(n.value.grid.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===le.Failure||void 0===t.value?t:he(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===le.Failure?t:he(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===le.Failure?t:he(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r,n,a=null===(t=this.sheets)||void 0===t?void 0:t.sheetPosToId;if(!a)return this.unavailableFailure({kind:Nw.SheetNames});if(void 0===e.index)r=0,n=a.length;else{var i=this.getSheetById(e.index);if(!Se(i))return i;var o=this.getSheetById(e.index2);if(!Se(o))return o;r=k(i.value.pos,o.value.pos),n=E(i.value.pos,o.value.pos)+1}for(var u=[],s=r;s<n;s+=1)u.push(a[s]);return he(da(u,r))},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.resolveCellStyle=function(e){return this.styles.resolveCellStyle(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.setStyles=function(e,t){this.styles.setStyles(e,t)},e.prototype.setFonts=function(e,t){this.styles.setFonts(e,t)},e.prototype.setFills=function(e,t){this.styles.setFills(e,t)},e.prototype.setBorders=function(e,t){this.styles.setBorders(e,t)},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheets=this.sheets,this.sheets=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=GT;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverStylesNodeCount:r.serverStylesNodeCount+n.serverStylesNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,serverDirtySetSubspaceCount:r.serverDirtySetSubspaceCount+n.serverDirtySetSubspaceCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedStylesNodeCount:r.editedStylesNodeCount+n.editedStylesNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,editedDirtySetSubspaceCount:r.editedDirtySetSubspaceCount+n.editedDirtySetSubspaceCount,clientFormulaeNodeCount:r.clientFormulaeNodeCount+n.clientFormulaeNodeCount,clientFormatsNodeCount:r.clientFormatsNodeCount+n.clientFormatsNodeCount,clientValuesNodeCount:r.clientValuesNodeCount+n.clientValuesNodeCount,recalcValuesNodeCount:r.recalcValuesNodeCount+n.recalcValuesNodeCount,recalcDirtySetSubspaceCount:r.recalcDirtySetSubspaceCount+n.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount,hiddenColsNodeCount:r.hiddenColsNodeCount+n.hiddenColsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,tablesCount:r.tablesCount+n.tablesCount,rangesCount:r.rangesCount+n.rangesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getServerAvailableCells=function(){var e=[],t=this.sheets;if(t)for(var r=0,n=t.sheetPosToId;r<n.length;r++){var a=n[r],i=t.data[a],o=la(this.document,a);e.push({sheetIdx:o,availableCells:i.grid.getServerAvailability()})}return e},e.prototype.forEachSheet=function(e){var t,r=null===(t=this.sheets)||void 0===t?void 0:t.data;for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n))e(r[n])}},e.prototype.getSheetById=function(e){var t=this.sheets;if(!t)return this.unavailableFailure({kind:Nw.SheetNames});var r=t.data[e];return void 0===r?this.unavailableFailure({kind:Nw.SheetId,document:this.document,sheetId:e}):he(r)},e.prototype.getSheetByName=function(e){var t,r=null===(t=this.sheets)||void 0===t?void 0:t.sheetNameToId;if(!r)return this.unavailableFailure({kind:Nw.SheetNames});var n=r.getValue(e);return void 0===n?he(void 0):this.getSheetById(n)},e.prototype.unavailableFailure=function(e){return ge(e)},e}(),aI=function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();function iI(e){var t=e.value;if(Se(t)){var r=t.value;switch(typeof r){case"object":switch(r.kind){case"Blank":return Tt.Blank;case"Error":return Tt.Error;case"Rich":return Tt.Rich;default:te("calc.calc.extractResultValue",r)}case"boolean":return Tt.Boolean;case"number":return Tt.Number;case"string":return Tt.String;default:return te("calc.calc.extractResultValue",r)}}}function oI(e){var t=e.value;if(!Se(t))return t.reason.kind}!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(eI||(eI={}));var uI=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);if(126===i&&a+1<t.length){var o=Ii(t,a+1);n+=Ri(o),a+=Fi(o)}else 126!==i&&(63!==i&&42!==i?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(42)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(eI.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(eI.OP_DOT):this.bytecode.push(eI.OP_DOTSTAR)},e.prototype.test=function(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var a=0;a<n.length;a+=1){var i=Number(n[a]);if(i!==this.bytecode.length){var o=this.bytecode[i];switch(o){case eI.OP_DOT:this.addState(t,i+1);break;case eI.OP_DOTSTAR:this.addState(t,i);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,i+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,n=t;n<r.length&&r[n]===eI.OP_DOTSTAR;n+=1)e[n+1]=!0},e.prototype.testSimple=function(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))},e}(),sI={"=":Qa.Eq,"<":Qa.Lt,">":Qa.Gt},lI={"<>":Qa.Ne,"<=":Qa.Le,">=":Qa.Ge};function cI(e,t){if(!Cn(t))return t;var r,n,a=(r=t.value).length>=2&&void 0!==(n=lI[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=sI[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return qa;if(0===r.stringCompareCI(t,r.falseName))return Ja;for(var n=1;n<r.errorNames.length;n+=1){var a=r.errorNames[n];if(null!=a&&0===r.stringCompareCI(a,t))return Oa(n)}var i=e.parseGeneral(t,!1);return void 0!==i?i:Fa(t)}(e,a[1])}}function dI(e,t,r,n){var a=function(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:Qa.Eq,operand:t},n=e.config,a=n.mathpack,i=n.localeInfo;if(r.operator===Qa.Ne&&pS(r.operand))return function(e){return!Tn(e)};if(r.operator===Qa.Eq&&pS(r.operand))return Tn;if(void 0!==r.operator&&pS(r.operand))return function(e){return!1};if(void 0===r.operator&&pS(r.operand))return function(e){return Tn(e)||pS(e)};var o,u,s=void 0===r.operator?Qa.Eq:r.operator;switch(r.operand.kind){case Tt.Number:return o=s,u=r.operand,function(t){var r=In(t)?t.getFallback():t;if(yn(r))return ES(a,o,r,u);if(Cn(r)&&o===Qa.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&ES(a,o,n,u)}return o===Qa.Ne};case Tt.Boolean:return function(e,t){return function(r){var n=In(r)?r.getFallback():r;return kn(n)?CS(e,n,t):e===Qa.Ne}}(s,r.operand);case Tt.String:return function(e,t){switch(e){case Qa.Eq:case Qa.Ne:var r=new uI(i,t.value);return function(t){var n=In(t)?t.getFallback():t;return Cn(n)?r.test(n.value)===(e===Qa.Eq):e===Qa.Ne};case Qa.Lt:case Qa.Gt:case Qa.Le:case Qa.Ge:return function(r){var n=In(r)?r.getFallback():r;return!!Cn(n)&&kS(i,e,n,t)}}}(s,r.operand);case Tt.Error:return function(e,t){return function(r){var n=In(r)?r.getFallback():r;return En(n)?yS(e,n.type-t.type):e===Qa.Ne}}(s,r.operand);default:return te("calc.funcs.criteria.compileCriteria",r.operand)}}(e,cI(e,r)),i=t,o=void 0===n?i:n;return new qg(o.rows,o.cols,E(i.denseRows,o.denseRows),E(i.denseCols,o.denseCols),(function(e,t){var r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(function(){var e=i.getSparse();return a(e)?o.getSparse():void 0}))}var fI=Tt.Number|Tt.String|Tt.Boolean;function hI(e,t,r,n,a){var i=function(n,i,u,s){if((null==i?void 0:i.kind)===Tt.Array){for(var l=new Wg(i.rows,i.cols,i.opers),c=n,d=0;d<u;d+=1)c=o(c,l);return c}var f=(s&&void 0!==a?a:r)(e,i);return null==f?n:t(n,f,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var s=t.get(o,u);void 0!==s&&(r=i(r,s,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var l=(t.rows-t.denseRows)*t.cols;return l>0&&void 0!==n&&(r=i(r,n,l,!1)),r}return n.reduce((function(e,t){return JC(t)?t.arrays.reduce(u,e):i(e,t,1,!1)}),void 0)}function vI(e,t){var r=In(t)?t.getFallback():t;switch(r.kind){case Tt.Number:return r;case Tt.Boolean:case Tt.String:return;case Tt.Error:return r;case Tt.Missing:case Tt.Blank:return;default:return te("calc.funcs.arithmeticOperationCoerce",r)}}function pI(e,t){var r=In(t)?t.getFallback():t;switch(r.kind){case Tt.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case Tt.Number:return r;case Tt.String:return e.mathpack.zero;case Tt.Error:return r;case Tt.Missing:case Tt.Blank:return;default:return te("calc.funcs.arithmeticAOperationCoerce",r)}}function mI(e){return function(t,r,n){if(void 0!==t&&En(t))return t;if(ne("calc.funcs.numberReducer",void 0===t||yn(t)),En(r))return r;var a,i;ne("calc.funcs.numberReducer",yn(r)),void 0===t?(a=r,i=n-1):(a=t,i=n);for(var o=0;o<i;o+=1){var u=e(a,r);if(En(u))return u;a=u}return a}}function gI(e){return function(t,r,n){return e.count+=n,r}}function SI(e,t,r){if(!yn(r))return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if(void 0!==r&&JC(r))for(var n=r.arrays.length-1;n>=0;n-=1){var a=r.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols)if((null==(u=a.getSparse())?void 0:u.kind)===Tt.Number)return u;for(var i=a.denseRows-1;i>=0;i-=1)for(var o=a.denseCols-1;o>=0;o-=1){var u;if((null==(u=a.get(i,o))?void 0:u.kind)===Tt.Number)return u}}}}(t);return(null==n?void 0:n.kind)!==Tt.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function bI(e,t,r){var n=hI(t,mI(t.mathpack.add),vI,r);return null==n?t.mathpack.zero:(e&&(n=SI(t,r,n)),n)}var yI=bI.bind(void 0,!1),CI=bI.bind(void 0,!0);function kI(e){return An(e)&&1!==e.ranges.length}function EI(e,t,r){if(kI(t))return ge(wa);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return he({values:n,valuesToFilter:n})}if(kI(r))return ge(wa);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=k(r.cols,16384-n.col),i=k(r.rows,(1<<20)-n.row),o=ha(r.row,r.col,i,a),u=Wa(e.sheets,o),s=ha(n.row,n.col,i,a),l=Wa(t.sheets,s);return{actualEvalRange:u,actualFilterRange:l}}(t,r),i=a.actualEvalRange,o=a.actualFilterRange,u=i.ranges[0],s=o.ranges[0],l=e.dereferenceAllOpers([i])[0];return u.col===s.col&&u.row===s.row?he({values:l,valuesToFilter:l}):he({values:l,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function AI(e,t){var r=t[0],n=t[1],a=EI(e,r,t[2]);if(!Se(a))return a.reason;var i=a.value,o=i.values,u=i.valuesToFilter,s=[qC([dI(e,o.arrays[0],n,u.arrays[0])])];return yI(e,s)}function RI(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,o=t[0];if(kI(o))return ge(wa);if(r){var u=t[1],s=e.dereferenceAllOpers([o])[0];a=dI(e,s.arrays[0],u),i=2}else{a=e.dereferenceAllOpers([o])[0].arrays[0],i=1}for(var l=i;l<t.length;l+=2){var c=t[l],d=t[l+1];if(kI(c))return ge(wa);if(c.ranges[0].cols!==o.ranges[0].cols||c.ranges[0].rows!==o.ranges[0].rows)return ge(wa);s=e.dereferenceAllOpers([c])[0];a=dI(e,s.arrays[0],d,a)}return n&&(a=a.strict()),he(qC([a]))}function NI(e,t){var r=hI(e,mI(e.mathpack.mul),vI,t);return null==r?e.mathpack.zero:r}function TI(e,t,r,n,a,i){var o=hI(a,mI(a.mathpack.add),e,i,t);if(null==o)return n;if(r&&(o=SI(a,i,o)),En(o))return o;var u={count:0},s=hI(a,gI(u),e,i,t);ne("calc.funcs.averageCoerceInner",yn(o)&&(null==s?void 0:s.kind)===Tt.Number&&u.count>0);var l=a.mathpack.div(o,a.mathpack.fromNumber(u.count));return En(l)?l:[l,u.count]}function II(e,t,r,n,a){var i=TI(e,t,r,Ma,n,a);return Array.isArray(i)?i[0]:i}var FI=II.bind(void 0,vI,void 0,!1),OI=II.bind(void 0,vI,void 0,!0),DI=II.bind(void 0,pI,(function(e,t){var r=In(t)?t.getFallback():t;return Cn(r)?e.mathpack.zero:vI(0,r)}),!0);function MI(e,t){var r=t[0],n=t[1],a=EI(e,r,t[2]);if(!Se(a))return a.reason;var i=a.value,o=i.values,u=i.valuesToFilter,s=[qC([dI(e,o.arrays[0],n,u.arrays[0]).strict()])];return FI(e,s)}function wI(e,t,r,n,a){for(var i=void 0,o=0,u="",s=function(e,t){return e.coerceOper(t,Tt.String)},l=function(e,n,a){if(void 0!==e&&En(e))return e;for(var s=0;s<a;s+=1){if(void 0!==i&&t.length>0&&(!r||i.value.length>0)){var l=t[o];if(o=(o+1)%t.length,u.length+l.value.length>32767)return wa;u+=l.value}if(En(n))return n;if(ne("calc.funcs.concatInner: expected string in reducer",Cn(n)),u.length+n.value.length>32767)return wa;if(u+=n.value,i=n,""===n.value&&(0===t.length||r))break}return n},c=0;c<a.length;c+=1){var d=n[c];if(An(d)&&d.ranges.length>1)return wa;var f=hI(e,l,s,a.slice(c,c+1));if(void 0!==f&&En(f))return f;ne("calc.funcs.concatInner: expected string from reduce",void 0!==f&&Cn(f))}if(r&&void 0!==i&&""===i.value&&t.length>0&&u.length>0){var h=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-h.value.length)}return Fa(u)}function _I(e,t,r){var n={count:0};return hI(t,gI(n),e,r),t.mathpack.fromNumber(n.count)}var LI=_I.bind(void 0,(function(e,t){var r=In(t)?t.getFallback():t;return yn(r)?r:void 0}));var PI=_I.bind(void 0,(function(e,t){var r=In(t)?t.getFallback():t;return Tn(r)||pS(r)?r:void 0}));var xI=_I.bind(void 0,(function(e,t){var r=In(t)?t.getFallback():t;return On(r)||En(r)?r:void 0}));var BI=_I.bind(void 0,(function(e,t){return t}));function UI(e,t){var r=t[0],n=t[1];if(kI(r))return wa;var a=e.dereferenceAllOpers([r])[0],i=[qC([dI(e,a.arrays[0],n)])];return BI(e,i)}var GI=function(e,t,r){return e.mathpack.cond2(t,r)>0},jI=function(e,t,r){return e.mathpack.cond2(t,r)<0};function VI(e,t,r,n,a){var i=hI(n,(function(t,r,a){return void 0===t?r:En(t)?t:(ne("calc.funcs.minMaxCoerceInner",yn(t)),En(r)?r:(ne("calc.funcs.minMaxCoerceInner",yn(r)),e(n,t,r)?t:r))}),t,a,r);return null==i?n.mathpack.zero:i}var HI=VI.bind(void 0,GI,vI,void 0),WI=VI.bind(void 0,jI,vI,void 0),KI=VI.bind(void 0,GI,pI,vI),zI=VI.bind(void 0,jI,pI,vI);function YI(e,t){var r=In(t)?t.getFallback():t;switch(r.kind){case Tt.Boolean:return r;case Tt.Number:return Ia(0!==e.mathpack.cond(r));case Tt.String:return;case Tt.Error:return r;case Tt.Missing:case Tt.Blank:return;default:return te("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function qI(e,t,r){var n=hI(t,(function(t,r,n){return void 0!==t&&En(t)?t:En(r)?r:(ne("calc.funcs.booleanInner",(void 0===t||kn(t))&&kn(r)),Ia(e(null==t?void 0:t.value,r.value,n)))}),YI,r);return null==n?wa:n}var JI=qI.bind(void 0,(function(e,t){return!1!==e&&t})),QI=qI.bind(void 0,(function(e,t){return!0===e||t})),XI=qI.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function ZI(e,t){return function(r,n,a){if(void 0!==r&&En(r))return r;if(!En(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function $I(e,t,r,n){var a=[],i=hI(t,ZI(a,fS),vI,[r]);if(null==i)return Pa;if(En(i))return i;var o=t.mathpack;if(o.cond2(n,o.one)<0)return Pa;if(o.cond2(n,o.fromNumber(a.length))>0)return Pa;var u=a.sort(o.cond2);if(e){var s=fS(o.add(fS(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(s)-1]}return u[o.lfix(n)-1]}var eF=$I.bind(void 0,!0),tF=$I.bind(void 0,!1);function rF(e,t,r,n){var a=e.mathpack,i=[],o=hI(e,ZI(i,fS),vI,t);if(null==o)return Pa;if(En(o))return o;if(En(r))return r;if(a.cond(r)<0)return Pa;if(a.cond2(r,a.one)>0)return Pa;var u=i.sort(a.cond2),s=fS(a.sub(a.fromNumber(u.length),a.one)),l=fS(a.add(a.fromNumber(u.length),a.one)),c=fS(n?a.mul(s,r):a.sub(fS(a.mul(l,r)),a.one));if(a.cond(c)<0||a.cond2(c,s)>0)return Pa;var d=a.lfix(c),f=fS(a.sub(c,a.fromNumber(d)));if(0===a.cond(f))return u[d];var h=a.sub(u[d+1],u[d]);return En(h)?h:a.add(u[d],fS(a.mul(h,f)))}var nF=function(e,t,r){return rF(e,[t],r,!0)};function aF(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return nF(e,n,a)}var iF=function(e,t,r){return rF(e,[t],r,!1)};function oF(e,t){var r=e.mathpack;if(r.cond(t)<0)return Pa;if(r.cond2(t,r.fromNumber(5))>=0)return Pa;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var uF=function(e,t,r){return rF(e,[t],oF(e,r),!0)};function sF(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return uF(e,n,a)}var lF=function(e,t,r){return rF(e,[t],oF(e,r),!1)};function cF(e,t){return rF(e,t,e.mathpack.fromNumber(.5),!0)}function dF(e){return function(t,r){var n=e(t,r);return void 0!==n&&yn(n)?t.mathpack.mul(n,n):n}}function fF(e,t){return function(r,n){var a=e(r,n);if((null==a?void 0:a.kind)!==Tt.Number)return a;var i=r.mathpack,o=i.sub(a,t);return En(o)?o:i.mul(o,o)}}function hF(e,t,r,n){var a={count:0};if(null==hI(r,gI(a),e,n,t))return Ma;ne("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var i=mI(r.mathpack.add),o=hI(r,i,e,n,t),u=hI(r,i,dF(e),n,void 0===t?void 0:dF(t));if(ne("calc.funcs.varFirstPass: unexpected sum type",null!=o),En(o))return o;ne("calc.funcs.varFirstPass: unexpected error",yn(o)&&(null==u?void 0:u.kind)===Tt.Number);var s=r.mathpack,l=s.div(o,s.fromNumber(a.count));return En(l)?l:[a.count,o,u,l]}function vF(e,t,r,n,a){var i=hI(r,mI(r.mathpack.add),fF(e,a),n,void 0===t?void 0:fF(t,a));return ne("calc.funcs.varSecondPass: unexpected error",(null==i?void 0:i.kind)===Tt.Number),i}function pF(e,t,r,n){var a=hF(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],s=a[2],l=a[3];if(o<2)return Ma;var c=i.mul(u,u);if(En(c))return c;var d=fS(i.div(c,i.fromNumber(o))),f=fS(i.sub(s,d));if(0===i.cond(l))return i.cond(f)<0?i.zero:i.div(f,i.fromNumber(o-1));if(i.cond(f)>=0){var h=fS(i.div(f,i.fromNumber(o-1)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(d,s),p=En(v)?v:i.sub(v,i.one);if(!En(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(l,h),g=En(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!En(g)&&i.cond(g)<0)return h}}}var S=vF(e,t,r,n,l);return i.cond(S)<0?i.zero:i.div(S,i.fromNumber(o-1))}function mF(e,t,r,n){var a=hF(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],s=a[2],l=a[3];if(o<1)return Ma;var c=i.mul(u,u);if(En(c))return c;var d=i.mul(s,i.fromNumber(o));if(En(d))return d;var f=fS(i.sub(d,c));if(0===i.cond(l))return i.cond(f)<0?i.zero:i.div(f,i.fromNumber(o*o));if(i.cond(f)>=0){var h=fS(i.div(f,i.fromNumber(o*o)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(fS(i.div(c,i.fromNumber(o))),s),p=En(v)?v:i.sub(v,i.one);if(!En(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(l,h),g=En(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!En(g)&&i.cond(g)<0)return h}}}var S=vF(e,t,r,n,l);return i.cond(S)<0?i.zero:i.div(S,i.fromNumber(o))}var gF=pF.bind(void 0,vI,void 0),SF=mF.bind(void 0,vI,void 0),bF=pF.bind(void 0,pI,vI),yF=mF.bind(void 0,pI,vI);function CF(e){return function(t,r){var n=e(t,r);return yn(n)?t.mathpack.sqrt(n):n}}var kF=CF(gF),EF=CF(SF),AF=CF(bF),RF=CF(yF);function NF(e,t){var r=e.dereferenceAllOpers(t);return kF(e,r)}function TF(e,t){var r=e.dereferenceAllOpers(t);return EF(e,r)}function IF(e,t){var r=e.dereferenceAllOpers(t);return gF(e,r)}function FF(e,t){var r=e.dereferenceAllOpers(t);return SF(e,r)}var OF=[OI,LI,xI,HI,WI,NI,kF,EF,CI,gF,SF];function DF(e,t){var r,n=[],a=hI(e,(r=n,function(e,t,n){if(void 0!==e&&En(e))return e;if(yn(t))for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),vI,t);if(null==a)return xa;if(En(a))return a;var i=e.mathpack,o=n.sort((function(e,t){return i.cond2(e.value,t.value)})),u=1,s=0,l=1/0,c=[];function d(e){u=1,l=e.index}var f,h,v,p=function(e){var t=e.value;u>s?(s=u,c.length=0,c.push({value:t,index:l})):u===s&&c.push({value:t,index:l})};d(o[0]);for(var m=1;m<o.length;m+=1)h=o[m-1],v=o[m],0===i.cond2(h.value,v.value)?((f=o[m]).index<l&&(l=f.index),u+=1):(p(o[m-1]),d(o[m]));return p(o[o.length-1]),s<2?xa:(ne("calc.funcs.modeInner: unexpected error",0!==c.length),c.sort((function(e,t){return e.index-t.index})))}function MF(e,t){var r=DF(e,t);return Array.isArray(r)?r[0].value:r}function wF(e,t){return MF(e,t)}var _F=$e(Object(fe.a)(Object(fe.a)({},Je(!1)),{wsfNode:function(e){return e===Ka.SUBTOTAL||e===Ka.AGGREGATE}}),(function(e,t){return e||t}));function LF(e){return JC(e)?qC(e.arrays.map((function(e){return e.map((function(e){var t,r=e[0],n=e[1];return void 0!==n&&(t=n.formula,St(_F,t))?void 0:r}))}))):e}var PF=Object(fe.f)(OF,[cF,MF]),xF=[eF,tF,nF,uF,iF,lF];function BF(e,t){return UF(e,t,!1)}function UF(e,t,r){var n=t[0],a=t[1],i=t[2],o=(void 0===i?Ja:i).value?1:-1,u=0,s=0,l=e.mathpack,c=hI(e,(function(e,t,r){if(void 0!==e)return e;if(En(t))return t;var a=l.cond2(n,fS(t));0===a?u+=r:a===o&&(s+=r)}),vI,e.dereferenceAllOpers([a]));if(void 0!==c)return c;if(0===u)return xa;var d=l.fromNumber(s+1);if(r){var f=l.div(l.fromNumber(u-1),l.fromNumber(2));return l.add(d,fS(f))}return d}function GF(e){return function(t,r){var n=e(t,r);return(null==n?void 0:n.kind)===Tt.Number?t.mathpack.abs(n):n}}function jF(e,t,r){var n=TI(vI,void 0,!0,Pa,t,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1],o=hI(t,mI(t.mathpack.add),e(function(e,t){return function(r,n){var a=e(r,n);return(null==a?void 0:a.kind)===Tt.Number?r.mathpack.sub(a,t):a}}(vI,a)),r);return ne("calc.funcs.sumDevAndCount",void 0!==o),En(o)?o:[fS(o),i]}function VF(e,t,r){var n=r[0],a=t.datepack,i=t.config,o=a.fromNum(i,n,Wo.RoundSec);return!1===o?Pa:t.mathpack.fromNumber(e(o))}var HF=VF.bind(void 0,(function(e){return e.yr})),WF=VF.bind(void 0,(function(e){return e.mon})),KF=VF.bind(void 0,(function(e){return e.dom})),zF=VF.bind(void 0,(function(e){return e.hour})),YF=VF.bind(void 0,(function(e){return e.min})),qF=VF.bind(void 0,(function(e){return e.sec}));function JF(e,t,r){var n=t[0],a=t[1];void 0===r&&(r=!1);var i,o=e.config,u=e.mathpack,s=e.datepack.fromNum(Object(fe.a)(Object(fe.a)({},o),{date1904:o.date1904&&!r}),n,Wo.RoundSec);if(!1===s)return Pa;switch(void 0!==a?u.sfix(a):1){case 1:case 17:i=s.wdy;break;case 2:case 11:i=1===s.wdy?7:s.wdy-1;break;case 3:i=1===s.wdy?6:s.wdy-2;break;case 12:i=(s.wdy+4)%7+1;break;case 13:i=(s.wdy+3)%7+1;break;case 14:i=(s.wdy+2)%7+1;break;case 15:i=(s.wdy+1)%7+1;break;case 16:i=s.wdy%7+1;break;default:return Pa}return u.fromNumber(i)}function QF(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return Pa}function XF(e,t,r){var n=r[0],a=r[1],i=gS(t,n);if(En(i))return i;var o=function(e,t,r){if(void 0===t||Nn(t))return[r?2:1,r];var n=mS(e,t);if(!En(n)){var a=e.mathpack.sfix(n);if(r){if(1===a||2===a)return[a,r]}else{if(1===a||2===a)return[a,r];if(a>=11&&a<=16)return[a-9,r];if(17===a)return[1,r];if(21===a)return[2,!0]}}return[void 0,r]}(t,a,e),u=o[0],s=o[1];if(void 0===u)return Pa;var l=t.mathpack,c=t.datepack,d=t.config,f=Object(fe.a)(Object(fe.a)({},d),{date1904:!1}),h=c.fromNum(f,i,Wo.RoundSec);if(!1===h)return QF(l,f.dateCompatibility,i);var v=Ko(h.yr,1,1,0,0,0,0,0,Wo.RoundSec),p=c.toNum(f,v);if(En(p))return QF(l,f.dateCompatibility,i);var m=JF(t,[p],!0);if(En(m))return m;var g=fS(l.add(fS(l.sub(m,l.fromNumber(u))),l.fromNumber(7))),S=fS(bS(l,g,l.fromNumber(7))),b=fS(l.add(l.floor(fS(l.div(fS(l.add(fS(l.sub(i,p)),S)),l.fromNumber(7)))),l.one));return s?function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=Object(fe.a)({},n),s=(t+6-u.wdy)%7;if(12===u.mon&&u.dom+s>=35)return a.one;u.dom=4,u.mon=1;var l=i.toDays(o,u);if(ne("calc.funcs.weeknumISOAmendments",!1!==l),((l=(l-1)%7+1)-t+7)%7<3){var c=fS(a.sub(r,a.one));if(0===a.cond(c)){var d=u.yr-1;return t===l||d%4==0&&(d%100!=0||d%400==0)&&(t-l+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return c}return r}(t,u,b,h):b}var ZF=XF.bind(void 0,!0),$F=XF.bind(void 0,!1);var eO;function tO(e,t){var r;if(Cn(t)){var n=t.value.replace(/^\s+/,"");if(En(r=e.coerceOper(Fa(n),Tt.Number)))return r}else r=t;return gS(e,r)}function rO(e,t,r){return r?fS(e.sub(t,e.fromNumber(1462))):t}function nO(e,t){return 0!=(e>>t%7&1)}function aO(e){switch(e){case 1:return eO.Saturday|eO.Sunday;case 2:return eO.Sunday|eO.Monday;case 3:return eO.Monday|eO.Tuesday;case 4:return eO.Tuesday|eO.Wednesday;case 5:return eO.Wednesday|eO.Thursday;case 6:return eO.Thursday|eO.Friday;case 7:return eO.Friday|eO.Saturday;case 11:return eO.Sunday;case 12:return eO.Monday;case 13:return eO.Tuesday;case 14:return eO.Wednesday;case 15:return eO.Thursday;case 16:return eO.Friday;case 17:return eO.Saturday;default:return!1}}function iO(e){if(7!==e.length)return!1;for(var t=eO.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function oO(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=eO.Saturday|eO.Sunday,u=gS(e,r);if(En(u))return u;var s=mS(e,n);if(En(s))return s;var l=e.mathpack,c=e.config;s=l.floor(s);var d=l.cond(s)>0?l.one:l.fromNumber(-1),f=l.abs(s);if(!SS(e,fS(l.add(u,s))))return Pa;if(0===l.cond(f))return rO(l,u,c.date1904);var h=null,v=[];if(a){if(!Nn(a)){if(yn(a)){var p=aO(l.lfix(a));if(!1===p)return Pa;o=p}else{if(!Cn(a))return Pa;var m=iO(a.value);if(!1===m)return wa;o=m}if(127===o)return wa}if(i&&!Nn(i)){var g=function e(t,r){switch(r.kind){case Tt.Number:return he(new zg(1,1,1,1,[[r]],Ya));case Tt.String:var n=t.coerceOper(r,Tt.Number);return En(n)?ge(wa):he(new zg(1,1,1,1,[[n]],Ya));case Tt.Blank:return he(new zg(1,1,1,1,[[t.mathpack.zero]],Ya));case Tt.Missing:return ge(xa);case Tt.Error:return ge(r);case Tt.Range:return e(t,oS(t,r,!1));case Tt.Array:return he(new zg(r.rows,r.cols,r.rows,r.cols,r.opers,Ya));default:return ge(wa)}}(e,i);if(!Se(g))return g.reason;h=g.value}}for(var S=null==h?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,a=0;a<e.denseRows;a+=1){for(var i=0;i<e.denseCols;i+=1){var o=e.get(a,i);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var u=0;u<n;u+=1)t.push(r)}var s=(e.rows-e.denseRows)*e.cols;if(s>0&&void 0!==r)for(a=0;a<s;a+=1)t.push(r);return t}(h),b=S.length-1;b>=0;b-=1){var y=S[b];switch(y.kind){case Tt.Number:case Tt.String:case Tt.Blank:var C=gS(e,y);if(En(C))return C;v[b]=C;break;case Tt.Error:return y;default:return wa}}for(;l.cond(f)>0;){if(u=fS(l.add(u,d)),!nO(o,l.lfix(u))){var k=!0;for(b=0;b<S.length;b+=1)if(0===l.cond2(v[b],u)){k=!1;break}k&&(f=fS(l.sub(f,l.one)))}}return SS(e,u=rO(l,u,c.date1904))?u:Pa}!function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(eO||(eO={}));function uO(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=Object(fe.a)(Object(fe.a)({},o),{date1904:!1}),s=i.fromNum(u,t,Wo.RoundSec);if(!1===s)return s;var l=a.fromNumber(s.dom),c=a.fromNumber(s.mon),d=a.fromNumber(12),f=a.fromNumber(s.yr);if(a.cond(r)>=0){f=fS(a.add(a.floor(fS(a.div(r,d))),f));var h=fS(bS(a,r,d)),v=fS(a.add(h,c));1===a.cond2(v,d)&&(f=fS(a.add(f,a.one))),c=fS(bS(a,v,d))}else{var p=a.neg(r),m=a.floor(fS(a.div(p,d)));f=fS(a.sub(f,m));h=fS(bS(a,p,d));if(a.cond2(h,c)>=0)f=fS(a.sub(f,a.one)),c=fS(a.add(fS(a.sub(c,h)),d));else{var g=fS(a.sub(c,h));c=fS(bS(a,g,d))}}0===a.cond(c)&&(c=d);var S=a.lfix(c);switch(S){case 4:case 6:case 9:case 11:var b=a.fromNumber(30);a.cond2(l,b)>0&&(l=b);break;case 2:a.cond2(l,a.fromNumber(28))>0&&(l=a.fromNumber(i.daysPerMonth(2,a.toNumber(f),!1)))}if(n&&(l=a.fromNumber(i.daysPerMonth(S,a.toNumber(f),!1))),a.lfix(f)<(u.dateCompatibility?1900:-9999))return!1;var y=function(e,t,r,n,a,i){var o=e.lfix(n),u=e.lfix(a),s=e.lfix(i);return t.toNum(r,Ko(s,u,o,0,0,0,0,0,Wo.RoundSec))}(a,i,u,l,c,f);return!En(y)&&y}function sO(e,t,r){var n=r[0],a=r[1],i=gS(t,n);if(En(i))return i;var o=mS(t,a);if(En(o))return o;var u=t.mathpack,s=t.config,l=uO(t,i,o=u.cond(o)>0?u.floor(o):u.ceil(o),!e);return!1===l?Pa:rO(u,l,s.date1904)}var lO,cO=sO.bind(void 0,!0),dO=sO.bind(void 0,!1);function fO(e,t){var r,n=t[0],a=t[1],i=t[2],o=t[3],u=e.mathpack,s=eO.Saturday|eO.Sunday,l=5;function c(e){l=7;for(var t=s=e;0!==t;)1==(1&t)&&(l-=1),t>>=1}if(void 0!==i&&!Nn(i))if(Cn(i)){var d=iO(i.value);if(!1===d)return wa;c(d)}else{var f=mS(e,i);if(En(f))return wa;var h=aO(u.lfix(f));if(!1===h)return Pa;c(h)}var v=null!=o?o:za,p=gS(e,n);if(En(p))return p;var m=gS(e,a);if(En(m))return m;var g,S=u.lfix(p),b=u.lfix(m);S>b?(g=S,S=b,b=g,r=-1):r=1,g=S%7,g=b%7;for(var y=0,C=S<b?S:b,k=S<b?b:S;C%7!=0&&C!==k;)nO(s,C)||(y+=1),C+=1;for(;k%7!=6&&C!==k;)nO(s,k)||(y+=1),k-=1;if(k===C&&1!=(s>>C%7&1)&&(y+=1),S>b){var E=C;C=k,k=E}var A=u.fromNumber(l*Math.floor((k+1-C)/7)+y);switch(v.kind){case Tt.Number:case Tt.String:var R=gS(e,v);if(En(R))return R;(g=u.lfix(R))>=S&&g<=b&&g%7>=2&&(A=fS(u.sub(A,u.one)));break;case Tt.Range:case Tt.Array:var N=function(e,t,r,n,a,i){var o,u=e.mathpack;if(void 0===i||Nn(i))o=eO.Saturday|eO.Sunday;else if(Cn(i)){var s=iO(i.value);if(!1===s)return wa;o=s}else{var l=mS(e,i);if(En(l))return wa;var c=aO(u.lfix(l));if(!1===c)return Pa;o=c}var d=u.fromNumber(r),f=u.fromNumber(n),h=e.dereferenceOper(a,Tt.Array);if(!Rn(h))return wa;var v=[];function p(e){if(u.cond2(e,d)>=0&&u.cond2(e,f)<=0){var t=u.lfix(e);nO(o,t)||v.push(e)}}for(var m=0;m<h.rows;m+=1)for(var g=0;g<h.cols;g+=1){var S=h.opers[m][g];switch(S.kind){case Tt.Number:case Tt.String:var b=gS(e,S);if(En(b))return b;p(b);break;case Tt.Blank:break;case Tt.Error:return S;default:return wa}}var y=t;if(0!==v.length){var C=v.sort((function(e,t){return u.cond2(e,t)})),k=C[0];y=fS(u.sub(y,u.one));for(m=0;m<C.length;m+=1){var E=C[m];0!==u.cond2(E,k)&&(k=E,y=fS(u.sub(y,u.one)))}}return y}(e,A,S,b,v,i);if(En(N))return N;A=N;break;case Tt.Error:return v;case Tt.Missing:break;default:return wa}return u.mul(u.fromNumber(r),A)}function hO(e,t,r,n,a,i,o){var u=360*(r-t),s=30*(a-n);return e.mathpack.fromNumber(o-i+s+u)}function vO(e,t,r,n){var a=e.datepack,i=e.config;return t===a.daysPerMonth(r,n,i.dateCompatibility)}function pO(e,t,r,n,a){var i=e.mathpack;switch(i.cond2(t,r)){case 1:break;case 0:return i.zero;case-1:switch(n){case lO.Basis30360:return function(e,t,r,n,a){var i=e.datepack,o=e.config,u=i.fromNum(o,t,Wo.RoundSec);if(!1===u)return!1;var s=u.dom,l=u.mon,c=u.yr,d=i.fromNum(o,r,Wo.RoundSec);if(!1===d)return!1;var f=d.dom,h=d.mon,v=d.yr;return 2===f&&vO(e,f,h,v)&&(2===s&&vO(e,s,l,c)||3===n)&&(f=30),31===f&&(s>=30||3===n)&&(f=30),31===s&&(s=30),a&&2===l&&vO(e,s,l,c)&&(s=30),hO(e,c,v,l,h,s,f)}(e,t,r,a,!0);case lO.BasisActual360:case lO.BasisActual365:case lO.BasisActual:return fS(i.sub(r,t));case lO.BasisE30360:return function(e,t,r){var n=e.datepack,a=e.config,i=n.fromNum(a,t,Wo.RoundSec);if(!1===i)return!1;var o=i.dom,u=i.mon,s=i.yr,l=n.fromNum(a,r,Wo.RoundSec);if(!1===l)return!1;var c=l.dom,d=l.mon;return 31===o&&(o=30),31===c&&(c=30),hO(e,s,l.yr,u,d,o,c)}(e,t,r)}}return!1}function mO(e,t){var r=t[0],n=t[1],a=void 0===n||Nn(n)?e.mathpack.zero:mS(e,n);if(En(a))return a;var i=mS(e,r);return En(i)?i:[i,a]}function gO(e,t){if(An(t)){if(xr(t.sheets)){var r=Ha(t.sheets,[on(t.ranges[0])]);return e.dereferenceOper(r,nS)}return wa}return t}function SO(e,t,r){var n=oS(e,t,!0);return n instanceof ak?void 0!==r&&n.arity!==r?xa:n:En(n)?n:_a}function bO(e,t){var r=t[0],n=t.slice(1),a=SO(e,r,n.length);return En(a)?a:e.applyLambda(a,n)}function yO(e,t){var r=t[0],n=t[1],a=t[2],i=SO(e,a,2);if(En(i))return i;var o=e.mathpack,u=Nn(r)?1:o.fix(r),s=Nn(n)?1:o.fix(n);if(u<1||s<1)return wa;if(u*s>1e6)return TC(Pn(["MAKEARRAY with very large size"]));var l=[Ja,Ja];return Zg(new eS(e,u,s,(function(t,r){var n=e.mathpack;return l[0]=n.fromNumber(t+1),l[1]=n.fromNumber(r+1),e.applyLambda(i,l)})))}function CO(e,t){var r=oS(e,t[0],!0);return r instanceof ak?e.mathpack.fromNumber(r.arity):xa}!function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(lO||(lO={}));var kO=uS(vi(Ka.IFS)),EO=uS(vi(Ka.SWITCH));function AO(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),lS(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=gn(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}var RO=function(e){return e<0?Qa.Lt:e>0?Qa.Gt:Qa.Eq};function NO(e,t,r){void 0===r&&(r=!1);var n,a=e.config,i=a.localeInfo,o=a.mathpack;switch(t.kind){case Tt.Number:n=function(e){return{correctType:!0,sgnT:(r=o,n=e,a=t,RO(r.cond2(n,a)))};var r,n,a};break;case Tt.String:if(r){var u=new uI(i,t.value);n=function(e){return{correctType:!0,sgnT:u.test(e.value)?Qa.Eq:Qa.Ne}}}else n=function(e){return{correctType:!0,sgnT:RO(i.stringCompareCI(e.value,t.value))}};break;case Tt.Boolean:n=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,RO(r-n))};var r,n};break;case Tt.Rich:return TC(Pn(["lookup with rich value condition"]));default:return te("calc.funcs.makeLookupComparer",t)}return function(e){var r=In(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:Qa.Ne}:n(r)}}function TO(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,u=a,s=NO(e,t);;){var l=s(r.get(i)).sgnT;if(l===Qa.Ne){if(i<u)for(var c=i+1;c<=u;c+=1)if((l=s(r.get(c)).sgnT)!==Qa.Ne){i=c;break}l===Qa.Ne&&(i=Math.floor((o+u)/2),l=Qa.Gt)}if(l===Qa.Eq){if(i<a){n=!0,o=i+=1,u=i;continue}return i}if(l===Qa.Lt?o=i+1:u=i-1,!(o<=u)){if(n)i-=1;else if(l===Qa.Gt&&(i-=1)>=0){o=i,u=i;continue}return i}i=Math.floor((o+u)/2)}}function IO(e,t,r,n){for(var a=-1,i=NO(e,t,n===Qa.Eq),o=0;o<r.length;o+=1){var u=i(r.get(o)),s=u.correctType,l=u.sgnT;if(s){if(l===Qa.Eq)return o;if(l!==Qa.Ne&&l===n)return a;a=o}o===r.denseLength&&(o=E(o,r.length-2))}return n!==Qa.Eq?a:r.length}function FO(e){switch(e.kind){case Tt.Number:return xa;case Tt.Range:return xr(e.sheets)?e.ranges.length>1?xa:e:wa;case Tt.Array:return e}}function OO(e,t){var r;switch(t.kind){case Tt.Number:return t;case zC.RangeValues:r=t.arrays[0].get(0,0);break;case Tt.Array:r=t.opers[0][0];break;default:return te("calc.funcs.lookupFuncs.getNumFromRef",t)}return En(r=e.coerceOper(r,Tt.Number))?_a:r}function DO(e){switch(e.kind){case Tt.Number:case Tt.Rich:return xa;case Tt.Range:if(!xr(e.sheets))return wa;if(e.ranges.length>1)return xa;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?xa:e;case Tt.Array:return 1!==e.rows&&1!==e.cols?xa:e}}function MO(e){switch(e.kind){case zC.RangeValues:return e.arrays[0];case Tt.Array:return new zg(e.rows,e.cols,e.rows,e.cols,e.opers,Ya)}}function wO(e,t){switch(t.kind){case Tt.Range:var r=t.sheets,n=t.ranges[0];return new qg(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=va(n.row+t,n.col+a);return e.dereferenceAllOpers([Ha(r,[i])])[0].arrays[0].get(0,0)}),(function(){return re("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case Tt.Array:return new zg(t.rows,t.cols,t.rows,t.cols,t.opers,Ya)}}function _O(e){if(An(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function LO(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],u=void 0===o?qa:o,s=FO(a);if(En(s))return s;var l=xO(s,r),c=PO(MO(e.dereferenceAllOpers([l])[0]),r),d=!u.value?IO(e,n,c,Qa.Eq):TO(e,n,c);if(d<0||d>=c.length)return xa;var f=function(e,t){switch(t.kind){case Tt.Number:return t;case Tt.Range:if(!xr(t.sheets))return wa;if(t.ranges.length>1)return _a;var r=t.ranges;return e.calcingArray?TC(Pn(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?TC(Pn(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case Tt.Array:return TC(Pn(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,i);if(En(f))return f;var h=e.dereferenceAllOpers([f])[0],v=OO(e,h);if(En(v))return v;var p=e.mathpack.sfix(v)-1,m=wO(e,s);return p<0?wa:p>=(r?m.rows:m.cols)?_a:r?m.get(p,d):m.get(d,p)}function PO(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function xO(e,t){if(An(e)){var r=e.ranges[0],n=ha(r.row,r.col,t?1:r.rows,t?r.cols:1);return Ha(e.sheets,[n])}return e}var BO=cS((function(e){return e.mathpack.sqrt})),UO=cS((function(e){return e.mathpack.exp})),GO=dS((function(e){return e.mathpack.power})),jO=cS((function(e){return e.mathpack.ln})),VO=cS((function(e){return e.mathpack.log}));var HO=cS((function(e){return e.mathpack.sin})),WO=cS((function(e){return e.mathpack.cos})),KO=cS((function(e){return e.mathpack.tan})),zO=cS((function(e){return e.mathpack.asin})),YO=cS((function(e){return e.mathpack.acos})),qO=cS((function(e){return e.mathpack.atan})),JO=dS((function(e){return e.mathpack.atan2}));var QO=dS((function(e){return e.mathpack.round}));var XO=dS((function(e){return e.mathpack.roundUp})),ZO=dS((function(e){return e.mathpack.roundDown}));function $O(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return Pa;if(0===n||0===a)return e.zero;var i=e.div(t,r);return En(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function eD(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return Pa;if(0===n&&0===a)return t;var i=e.div(t,r);return En(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function tD(e,t){var r=t[0],n=t[1];return $O(e.mathpack,r,n)}function rD(e,t){var r=t[0],n=t[1],a=e.mathpack,i=void 0===n||Nn(n)?a.one:a.abs(n);return 0===a.cond(i)?a.zero:$O(a,r,i)}function nD(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(fS(bS(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(fS(bS(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var aD=nD.bind(void 0,!0),iD=nD.bind(void 0,!1),oD=cS((function(e){return e.mathpack.abs}));function uD(e,t,r,n){if(void 0===r||Nn(r))return{formatValue:t,formatDecimals:null!=n?n:2};var a=e.config.mathpack;if(a.cond(r)<0){var i=QO(e,[t,r]);return ne("calc.funcs.fixedDollarRound",yn(i)||En(i)),{formatValue:i,formatDecimals:0}}var o=a.sfix(r);return o<0||o>127?{formatValue:wa,formatDecimals:0}:{formatValue:t,formatDecimals:o}}function sD(e){for(var t=0;t<e.length&&32===e.charCodeAt(t);)t+=1;return e.substring(t)}function lD(e,t){var r;return Cn(t)?t.value.length>255?wa:null!==(r=e.parseDate(sD(t.value)))&&void 0!==r?r:wa:wa}function cD(e,t){return Ia(oS(e,t[0],!0)instanceof ak)}function dD(e,t){var r=mS(e,t[0]);if(En(r))return r;var n=e.mathpack,a=fS(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=fS(n.div(n.floor(a),n.fromNumber(2)));return Ia(0===n.cond2(i,n.floor(i)))}function fD(e,t,r){if(!xr(t.sheets))return wa;var n=t.ranges[0];if(e.calcingArray||!Ur(n)){var a=t.sheets;return Va(n.rows,n.cols,Jg(n.rows,n.cols,(function(t,i){var o=ya(a,va(n.row+t,n.col+i));return r(e.getCellFormula(o),o)})))}var i=un(ba(t.sheets,n));return r(e.getCellFormula(i),i)}function hD(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!xr(t.sheets))return wa;if(t.ranges.length>1)return _a;var r=t.ranges[0];return[r,Ur(r)]}function vD(e,t){var r=t[0],n=t[1].value;if(In(r)){var a=r.getField(n);if(void 0!==a)return a}return Ua}function pD(e,t){for(var r=t[0],n=e.config.localeInfo,a=zl.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i].value,u=t[i+1];a=a.setValue(o,u)}return new nk(a,r)}function mD(e,t){return void 0===t?1:e.cond(t)<0?wa:e.sfix(t)}function gD(e){return e>=65&&e<=90||e>=97&&e<=122}function SD(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():TC(Pn([t+" for non-ASCII input"]))}var bD={};bD[Ka.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return CI(e,r)},bD[Ka.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return NI(e,r)},bD[Ka.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return OI(e,r)},bD[Ka.COUNTBLANK]=function(e,t){var r=t[0];if(!xr(r.sheets)||1!==r.ranges.length)return wa;var n=e.dereferenceAllOpers(t);return PI(e,n)},bD[Ka.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return HI(e,r)},bD[Ka.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return WI(e,r)},bD[Ka.AND]=function(e,t){var r=e.dereferenceAllOpers(t);return JI(e,r)},bD[Ka.COUNTA]=function(e,t){var r=e.dereferenceAllOpers(t);return xI(e,r)},bD[Ka.OR]=function(e,t){var r=e.dereferenceAllOpers(t);return QI(e,r)},bD[Ka.CONCAT]=function(e,t){var r=e.dereferenceAllOpers(t);return wI(e,[],!0,t,r)},bD[Ka.AVERAGEIF]=MI,bD[Ka.AVERAGEIFS]=function(e,t){if(3===t.length)return MI(e,[t[1],t[2],t[0]]);var r=RI(e,t,void 0,!0);return Se(r)?FI(e,[r.value]):r.reason},bD[Ka.COUNT]=function(e,t){var r=e.dereferenceAllOpers(t);return LI(e,r)},bD[Ka.COUNTIF]=UI,bD[Ka.COUNTIFS]=function(e,t){if(2===t.length)return UI(e,t);var r=RI(e,t,!0);return Se(r)?BI(e,[r.value]):r.reason},bD[Ka.MEDIAN]=function(e,t){var r=e.dereferenceAllOpers(t);return cF(e,r)},bD[Ka.SUMSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=dF(vI),a=hI(e,mI(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a},bD[Ka.SUMIF]=AI,bD[Ka.SUMIFS]=function(e,t){if(3===t.length)return AI(e,[t[1],t[2],t[0]]);var r=RI(e,t);return Se(r)?yI(e,[r.value]):r.reason},bD[Ka.LARGE]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return eF(e,n,a)},bD[Ka.SMALL]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return tF(e,n,a)},bD[Ka.RANK]=BF,bD[Ka.RANK_EQ]=BF,bD[Ka.RANK_AVG]=function(e,t){return UF(e,t,!0)},bD[Ka.PERCENTILE]=aF,bD[Ka.PERCENTILE_INC]=aF,bD[Ka.PERCENTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return iF(e,n,a)},bD[Ka.QUARTILE]=sF,bD[Ka.QUARTILE_INC]=sF,bD[Ka.QUARTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return lF(e,n,a)},bD[Ka.TRIMMEAN]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],i=[],o=hI(e,ZI(i,fS),vI,[n]);if(null==o)return Pa;if(En(o))return o;var u=e.mathpack;if(u.cond(a)<0)return Pa;if(u.cond2(a,u.one)>=0)return Pa;i=i.sort(u.cond2);var s=u.lfix(fS(u.div(fS(u.mul(u.fromNumber(i.length),a)),u.fromNumber(2))));ne("calc.funcs.trimmean",s+s<i.length);var l=i[s],c=i[i.length-1-s],d=0,f=0,h=hI(e,mI(e.mathpack.add),(function(e,t){var r=vI(0,t);if(void 0===r)return r;ne("calc.funcs.trimmean: unexpected error",yn(r));var n=e.mathpack;if(n.cond2(r,l)<0)d+=1;else{if(!(n.cond2(r,c)>0))return r;f+=1}}),[n]);ne("calc.funcs.trimmean: found no elements",void 0!==h&&yn(h)),ne("calc.funcs.trimmean: trimmed too many",d<=s&&f<=s);for(var v=h;d<s;d+=1){if(En(p=u.sub(v,l)))return p;v=p}for(;f<s;f+=1){var p;if(En(p=u.sub(v,c)))return p;v=p}return u.div(v,u.fromNumber(i.length-s-s))},bD[Ka.AVERAGEA]=function(e,t){var r=e.dereferenceAllOpers(t);return DI(e,r)},bD[Ka.MAXA]=function(e,t){var r=e.dereferenceAllOpers(t);return KI(e,r)},bD[Ka.MINA]=function(e,t){var r=e.dereferenceAllOpers(t);return zI(e,r)},bD[Ka.MAXIFS]=function(e,t){var r=RI(e,t);return Se(r)?HI(e,[r.value]):r.reason},bD[Ka.MINIFS]=function(e,t){var r=RI(e,t);return Se(r)?WI(e,[r.value]):r.reason},bD[Ka.XOR]=function(e,t){var r=e.dereferenceAllOpers(t);return XI(e,r)},bD[Ka.AGGREGATE]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t.slice(4),u=e.mathpack,s=u.sfix(r),l=u.sfix(n);if(!(s>=1&&s<=PF.length+xF.length&&l>=0&&l<=7))return wa;var c=1==(1&l),d=2==(2&l),f=!(4==(4&l));function h(t){var r=f?e.dereferenceAllOpersAndFormulae(t,c).map(LF):e.dereferenceAllOpers(t,c);return d&&(r=r.map((function(e){if(function(e){var t=e.kind;return"number"==typeof t&&0!=(t&fI)}(e))return e;if(JC(e))return qC(e.arrays.map((function(e){return e.map((function(e){return void 0===e||En(e)?void 0:e}))})));if(function(e){return e.kind===Tt.Array}(e)){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||En(e)?void 0:e}))}));return function(e,t,r){return ie("calc.runtime.coercedArrayOper",e),ie("calc.runtime.coercedArrayOper",t),r.length!==e?re("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:Tt.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(s>PF.length){if(void 0===i||o.length>0)return wa;var v=Tt.Number,p=e.coerceOper(e.dereferenceOper(i,v),v);if(En(p))return wa;if(An(a)&&!xr(a.sheets))return wa;var m=h([a])[0],g=PF.length;return(0,xF[s-g-1])(e,m,p)}for(var S=2;S<t.length;S+=1){var b=t[S];if(!b||!An(b)||!xr(b.sheets))return wa}var y=h(t.slice(2));return ne("calc.funcs.aggregate: requested non-array function with unexpected number",s>=1&&s<=PF.length),(0,PF[s-1])(e,y)},bD[Ka.SUBTOTAL]=function(e,t){var r=t[0],n=t.slice(1),a=e.mathpack.sfix(r),i=OF.length;if(!(a>=1&&a<=i||a>=101&&a<=i+100))return wa;var o=a>100||e.isInFilterMode(n),u=e.dereferenceAllOpersAndFormulae(n,o).map(LF);return(0,OF[a%100-1])(e,u)},bD[Ka.VAR]=IF,bD[Ka.VAR_S]=IF,bD[Ka.VARP]=FF,bD[Ka.VAR_P]=FF,bD[Ka.STDEV]=NF,bD[Ka.STDEV_S]=NF,bD[Ka.STDEVP]=TF,bD[Ka.STDEV_P]=TF,bD[Ka.VARA]=function(e,t){var r=e.dereferenceAllOpers(t);return bF(e,r)},bD[Ka.VARPA]=function(e,t){var r=e.dereferenceAllOpers(t);return yF(e,r)},bD[Ka.STDEVA]=function(e,t){var r=e.dereferenceAllOpers(t);return AF(e,r)},bD[Ka.STDEVPA]=function(e,t){var r=e.dereferenceAllOpers(t);return RF(e,r)},bD[Ka.AVEDEV]=function(e,t){var r=e.dereferenceAllOpers(t),n=jF(GF,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))},bD[Ka.DEVSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=jF(dF,e,r);return Array.isArray(n)?n[0]:n},bD[Ka.MODE]=wF,bD[Ka.MODE_SNGL]=wF,bD[Ka.MODE_MULT]=function(e,t){var r=DF(e,t);return Array.isArray(r)?Va(r.length,1,r.map((function(e){return[e.value]}))):r},bD[Ka.TEXTJOIN]=function(e,t){var r=t[0],n=t[1],a=t.slice(2),i=[];if(!Nn(r)){if(An(r)&&r.ranges.length>1)return wa;var o=hI(e,ZI(i,hS),(function(e,t){return e.coerceOper(t,Tt.String)}),e.dereferenceAllOpers([r]));if(void 0!==o&&En(o))return o;ne("calc.funcs.textjoin: expected string from reduce",void 0!==o&&Cn(o))}return wI(e,i,Nn(n)||n.value,a,e.dereferenceAllOpers(a))},bD[Ka.YEAR]=HF,bD[Ka.MONTH]=WF,bD[Ka.DAY]=KF,bD[Ka.HOUR]=zF,bD[Ka.MINUTE]=YF,bD[Ka.SECOND]=qF,bD[Ka.WEEKNUM]=$F,bD[Ka.ISOWEEKNUM]=ZF,bD[Ka.WEEKDAY]=function(e,t){return JF(e,t)},bD[Ka.DATE]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=e.datepack,u=e.config,s=i.sfix(r);if(s>9999)return Pa;var l=i.sfix(n);if(l>32767||l<-32768)return Pa;var c=i.sfix(a);(c>32767||c<-32768)&&(c=32767),u.dateCompatibility?s<1900&&(s+=1900):s<1900&&!(1899===s&&12===l&&c>=30)&&(s+=1900);var d=Ko(s,l,c,0,0,0,0,0,Wo.RoundSec);return o.toNum(u,d)},bD[Ka.TIME]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=e.datepack,u=e.config,s=i.sfix(r);if(s>32767)return Pa;var l=i.sfix(n);if(l>32767)return Pa;var c,d,f,h=i.sfix(a);if(h>32767)return Pa;u.dateCompatibility?(c=u.date1904?1904:1900,d=1,f=u.date1904?1:0):(c=1899,d=12,f=30);var v=Ko(c,d,f,s,l,h,0,0,Wo.RoundSec),p=o.toNum(u,v);return En(p)?p:i.cond(p)<0?Pa:i.sub(p,i.trunc(p))},bD[Ka.DAYS360]=function(e,t){var r,n=t[0],a=t[1],i=t[2],o=e.mathpack,u=e.datepack,s=e.config,l=null!==(r=null==i?void 0:i.value)&&void 0!==r&&r,c=u.fromNum(s,n,Wo.RoundSec);if(!1===c)return xa;var d=31===c.dom||!l&&2===c.mon&&c.dom===u.daysPerMonth(2,c.yr,s.dateCompatibility)?30:c.dom,f=o.fromNumber(360*(c.yr-1900)+30*c.mon+d),h=u.fromNum(s,a,Wo.RoundSec);if(!1===h)return xa;var v=31!==h.dom||!l&&30!==c.dom?h.dom:30,p=o.fromNumber(360*(h.yr-1900)+30*h.mon+v);return o.sub(p,f)},bD[Ka.DAYS]=function(e,t){var r=t[0],n=t[1];if(Cn(r)&&r.value.length>255||Cn(n)&&n.value.length>255)return wa;var a=tO(e,r);if(En(a))return a;var i=tO(e,n);return En(i)?i:e.mathpack.sub(a,i)},bD[Ka.DATEDIF]=function(e,t){var r=t[0],n=t[1],a=t[2].value;if(a.length>2||0===a.length)return Pa;var i=e.mathpack,o=e.datepack,u=e.config,s=i.lfix(r),l=o.fromNum(u,r,Wo.RoundSec);if(!1===l)return Pa;var c=e.mathpack.lfix(n),d=o.fromNum(u,n,Wo.RoundSec);if(!1===d)return Pa;if(s>c)return Pa;var f=d.dom,h=d.mon,v=d.yr;l.dom>f&&(0===(h-=1)&&(h=12,v-=1),f+=o.daysPerMonth(h,v,u.dateCompatibility)),l.mon>h&&(h+=12,v-=1);var p=function(e,t){return 0===u.localeInfo.stringCompareCI(e,t)};if(p(a,"Y"))return i.fromNumber(v-l.yr);if(p(a,"M"))return i.fromNumber(12*(v-l.yr)+(h-l.mon));if(p(a,"D"))return i.fromNumber(c-s);if(p(a,"MD"))return i.fromNumber(f-l.dom);if(p(a,"YM"))return i.fromNumber(h-l.mon);if(p(a,"YD")){for(var m=0,g=l.mon;g<h;g+=1)m+=o.daysPerMonth(g,l.yr,u.dateCompatibility);return i.fromNumber(m+(f-l.dom))}return Pa},bD[Ka.WORKDAY]=function(e,t){var r=t[0],n=t[1],a=t[2];return oO(e,a?[r,n,za,a]:[r,n])},bD[Ka.WORKDAY_INTL]=oO,bD[Ka.EDATE]=cO,bD[Ka.EOMONTH]=dO,bD[Ka.NETWORKDAYS]=function(e,t){var r=t[0],n=t[1],a=t[2];return fO(e,a?[r,n,za,a]:[r,n])},bD[Ka.NETWORKDAYS_INTL]=fO,bD[Ka.YEARFRAC]=function(e,t){var r=t[0],n=t[1],a=t[2],i=lO.DefaultBasis;if(void 0!==a){var o=function(e,t){var r=lO.DefaultBasis;if(void 0===t||Nn(t))return r;var n=mS(e,t);if(En(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case lO.Basis30360:case lO.BasisActual:case lO.BasisActual360:case lO.BasisActual365:case lO.BasisE30360:return r;default:return Pa}}(e,a);if("number"!=typeof o)return o;i=o}var u=gS(e,r);if(En(u))return u;var s=gS(e,n);if(En(s))return s;var l=e.mathpack;if(l.cond2(u,s)>0){var c=u;u=s,s=c}var d=pO(e,u,s,i,0);if(!1===d)return Pa;var f=function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=a.fromNumber(360),s=a.fromNumber(365),l=a.fromNumber(366);switch(t){case lO.BasisActual:var c=i.fromNum(o,r,Wo.RoundSec);if(!1===c)return!1;var d=c.dom,f=c.mon,h=c.yr,v=i.fromNum(o,n,Wo.RoundSec);if(!1===v)return!1;var p,m=v.dom,g=v.mon,S=v.yr,b=S-1;if(h===S)return 29===i.daysPerMonth(2,h,o.dateCompatibility)?l:s;if(b===h&&(f>g||f===g&&d>=m))return 29===i.daysPerMonth(2,h,o.dateCompatibility)?!En(p=i.toNum(o,Ko(h,2,29,0,0,0,0,0,Wo.RoundSec)))&&(a.cond2(p,r)>=0?l:s):29===i.daysPerMonth(2,S,o.dateCompatibility)?!En(p=i.toNum(o,Ko(h,2,29,0,0,0,0,0,Wo.RoundSec)))&&(a.cond2(p,n)<=0?l:s):s;for(var y=0,C=h;C<=S;C+=1)29===i.daysPerMonth(2,C,o.dateCompatibility)?y+=366:y+=365;var k=a.fromNumber(S-h+1);return fS(a.div(a.fromNumber(y),k));case lO.Basis30360:case lO.BasisActual360:case lO.BasisE30360:return u;case lO.BasisActual365:return s;default:return u}}(e,i,u,s);return!1===f?Pa:l.div(d,f)},bD[Ka.DELTA]=function(e,t){var r=mO(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero},bD[Ka.GESTEP]=function(e,t){var r=mO(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero},bD[Ka.NA]=function(e,t){return xa},bD[Ka.T]=function(e,t){var r=gO(e,t[0]);return Cn(r)||En(r)?r:vS},bD[Ka.N]=function(e,t){var r=gO(e,t[0]);if(yn(r)||En(r))return r;var n=e.mathpack;return kn(r)&&r.value?n.one:n.zero},bD[Ka.TYPE]=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case Tt.Number:return n.fromNumber(1);case Tt.String:return n.fromNumber(2);case Tt.Boolean:return n.fromNumber(4);case Tt.Error:return n.fromNumber(16);case Tt.Array:return n.fromNumber(64);case Tt.Rich:return n.fromNumber(128);default:return te("calc.funcs.type",r)}},bD[Ka.ERROR_TYPE]=function(e,t){var r=t[0];return En(r)?e.mathpack.fromNumber(r.type):xa},bD[Ka.INFO]=function(e,t){return wa},bD[Ka.IF]=function(e,t){var r=t[0];ne("calc.funcs.if: condition is not a boolean",kn(r));var n=t[r.value?1:2];return ne("calc.funcs.if: result is undefined",void 0!==n),n},bD[Ka.IFS]=function e(t,r){for(var n=0;n<r.length;n+=2){var a=r[n];if(Rn(a)){var i=r.slice(n);return AO(t,kO,e,i)}if(En(a))return a;if(ne("calc.funcs.ifs",kn(a)),a.value)return r[n+1]}return xa},bD[Ka.SWITCH]=function e(t,r){var n=r[0];if(Rn(n))return AO(t,EO,e,r);if(En(n))return n;for(var a=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case Tt.Number:return function(e){return In(e)?TC(Pn(["SWITCH with a rich value case"])):yn(e)&&0===r.compare(t,e)};case Tt.String:return function(e){return In(e)?TC(Pn(["SWITCH with a rich value case"])):Cn(e)&&0===n.stringCompareCI(t.value,e.value)};case Tt.Boolean:return function(e){return In(e)?TC(Pn(["SWITCH with a rich value case"])):kn(e)&&t.value===e.value};case Tt.Rich:return TC(Pn(["SWITCH with a rich value condition"]));default:return te("calc.funcs.makeSwitchComparer",t)}}(t.config,n),i=1;i<r.length-1;i+=2){var o=Tt.Error|Tt.Rich|Tt.Number|Tt.Boolean|Tt.String|Tt.Array,u=t.coerceOper(t.dereferenceOper(r[i],o),o);if(Rn(u))return AO(t,EO,e,r);if(En(u))return u;if(a(u))return r[i+1]}return r.length%2==0?r[r.length-1]:xa},bD[Ka.TRUE]=function(e,t){return qa},bD[Ka.FALSE]=function(e,t){return Ja},bD[Ka.NOT]=function(e,t){return Ia(!t[0].value)},bD[Ka.CHOOSE]=function(e,t){var r=t[0];ne("calc.funcs.choose",yn(r));var n=e.mathpack.fix(r);return n<1||n>t.length-1?wa:t[n]},bD[Ka.INDEX]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=e.mathpack,u=o.sfix(n);if(u<0)return wa;var s=void 0===a?void 0:o.sfix(a);if(void 0!==s&&s<0)return wa;var l,c,d=void 0===i?0:o.sfix(i)-1;if(d<0)return wa;switch(r.kind){case Tt.Range:if(!xr(r.sheets))return wa;if(d>=r.ranges.length)return _a;var f=r.ranges[d];if(void 0===s)if(1===f.rows)l=0,c=u-1;else{if(1!==f.cols)return _a;l=u-1,c=-1}else l=u-1,c=s-1;if(l>=f.rows||c>=f.cols)return _a;var h=ha(f.row+E(l,0),f.col+E(c,0),-1===l?f.rows:1,-1===c?f.cols:1);return Ha(r.sheets,[h]);case Tt.Array:return d>0?_a:(void 0===s?1===r.rows?(l=0,c=u-1):(l=u-1,c=-1):(l=u-1,c=s-1),l>=r.rows||c>=r.cols?_a:-1===l&&-1===c?r:-1===l?Va(r.rows,1,r.opers.map((function(e){return[e[c]]}))):-1===c?Va(1,r.cols,[r.opers[l]]):r.opers[l][c]);default:return te("calc.funcs.lookupFuncs: INDEX",r)}},bD[Ka.MATCH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=void 0===a?e.mathpack.one:a,o=e.mathpack,u=function(e){switch(e.kind){case Tt.Number:return e;case Tt.Range:if(!xr(e.sheets))return wa;if(e.ranges.length>1)return _a;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?_a:e}}(i);if(En(u))return u;var s=e.dereferenceAllOpers([u])[0],l=OO(e,s);if(En(l))return l;var c=DO(n);if(En(c))return c;var d=MO(e.dereferenceAllOpers([c])[0]),f=PO(d,1===d.rows),h=-1;return(h=o.cond(l)>0?TO(e,r,f):0===o.cond(l)?IO(e,r,f,Qa.Eq):IO(e,r,f,Qa.Lt))<0||h>=f.length?xa:e.mathpack.fromNumber(h+1)},bD[Ka.LOOKUP]=function(e,t){var r=t[0],n=t[1],a=t[2],i=FO(n);if(En(i))return i;var o=_O(i),u=xO(i,o),s=PO(MO(e.dereferenceAllOpers([u])[0]),o),l=TO(e,r,s);if(l<0)return xa;if(void 0!==a){var c=DO(a);if(En(c))return c;var d=_O(c),f=PO(wO(e,function(e,t,r){if(An(r)){var n=r.ranges[0],a=ha(n.row,n.col,k(t?1:e,(1<<20)-n.row),k(t?e:1,16384-n.col));return Wa(r.sheets,a)}return r}(s.length,d,c)),d);return l>=f.length?Rn(c)?xa:Ya:f.get(l)}var h=wO(e,i);return o?h.get(h.rows-1,l):h.get(l,h.cols-1)},bD[Ka.HLOOKUP]=function(e,t){return LO(e,t,!0)},bD[Ka.VLOOKUP]=function(e,t){return LO(e,t,!1)},bD[Ka.ABS]=oD,bD[Ka.CEILING]=tD,bD[Ka.ECMA_CEILING]=tD,bD[Ka.DEGREES]=function(e,t){var r=t[0],n=e.mathpack,a=fS(n.div(n.fromNumber(180),n.pi));return n.mul(r,a)},bD[Ka.FLOOR]=function(e,t){var r=t[0],n=t[1];return eD(e.mathpack,r,n)},bD[Ka.RADIANS]=function(e,t){var r=t[0],n=e.mathpack,a=fS(n.div(n.pi,n.fromNumber(180)));return n.mul(r,a)},bD[Ka.ROUND]=QO,bD[Ka.ROUNDUP]=XO,bD[Ka.ROUNDDOWN]=ZO,bD[Ka.EVEN]=aD,bD[Ka.SIGN]=function(e,t){var r=t[0],n=e.mathpack;return n.fromNumber(n.cond(r))},bD[Ka.PI]=function(e,t){return e.mathpack.pi},bD[Ka.SQRT]=BO,bD[Ka.EXP]=UO,bD[Ka.POWER]=GO,bD[Ka.LN]=jO,bD[Ka.LOG10]=VO,bD[Ka.LOG]=function(e,t){var r=t[0],n=t[1],a=e.mathpack;if(void 0===n)return a.log(r);var i=a.ln(r);if(En(i))return i;var o=a.ln(n);return En(o)?o:a.div(i,o)},bD[Ka.SIN]=HO,bD[Ka.COS]=WO,bD[Ka.TAN]=KO,bD[Ka.ASIN]=zO,bD[Ka.ACOS]=YO,bD[Ka.ATAN]=qO,bD[Ka.ATAN2]=JO,bD[Ka.FACT]=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return Pa;for(var i=n.one,o=a;o>0;o-=1){if(En(i))return i;i=n.mul(n.fromNumber(o),i)}return i},bD[Ka.SQRTPI]=function(e,t){var r=mS(e,t[0]);if(En(r))return r;var n=e.mathpack;if(n.cond(r)<0)return Pa;var a=n.mul(n.pi,r);return En(a)?a:n.sqrt(a)},bD[Ka.FACTDOUBLE]=function(e,t){var r=mS(e,t[0]);if(En(r))return r;var n=e.mathpack,a=n.floor(r);if(n.cond2(a,n.fromNumber(-1))<0||n.cond2(a,n.fromNumber(300))>0)return Pa;for(var i=n.one,o=n.toNumber(a);o>1;o-=2){if(En(i))return i;i=n.mul(n.fromNumber(o),i)}return i},bD[Ka.INT]=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},bD[Ka.TRUNC]=function(e,t){var r=t[0],n=t[1],a=void 0===n?e.mathpack.zero:n;return e.mathpack.roundDown(r,a)},bD[Ka.ODD]=iD,bD[Ka.MROUND]=function(e,t){var r=t[0],n=t[1],a=mS(e,r);if(En(a))return a;var i=mS(e,n);if(En(i))return i;var o=e.mathpack;if(0===o.cond(i))return o.zero;if(0!==o.cond(a)&&o.cond(a)<0!=o.cond(i)<0)return Pa;var u=o.div(a,i);if(En(u))return Pa;var s=o.floor(u),l=fS(o.sub(u,s)),c=o.fromNumber(.5-5e-15);if(o.cond2(l,c)<0)return o.mul(s,i);var d=o.add(s,o.one);return En(d)?d:o.mul(d,i)},bD[Ka.QUOTIENT]=function(e,t){var r=t[0],n=t[1],a=mS(e,r);if(En(a))return a;var i=mS(e,n);if(En(i))return i;var o=e.mathpack;if(0===o.cond(i))return Ma;var u=o.div(a,i);return En(u)?Pa:o.cond(u)>0?o.floor(u):o.ceil(u)},bD[Ka.FLOOR_MATH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=void 0===n||Nn(n)?i.one:i.abs(n),u=void 0===a||Nn(a)?i.zero:a;return 0!==i.cond(u)&&i.cond(r)<0&&(o=i.neg(o)),0===i.cond(o)?i.zero:eD(i,r,o)},bD[Ka.FLOOR_PRECISE]=function(e,t){var r=t[0],n=t[1],a=e.mathpack,i=void 0===n||Nn(n)?a.one:a.abs(n);return 0===a.cond(i)?a.zero:eD(a,r,i)},bD[Ka.CEILING_MATH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=void 0===n||Nn(n)?i.one:i.abs(n),u=void 0===a||Nn(a)?i.zero:a;return 0!==i.cond(u)&&i.cond(r)<0&&(o=i.neg(o)),0===i.cond(o)?i.zero:$O(i,r,o)},bD[Ka.CEILING_PRECISE]=rD,bD[Ka.ISO_CEILING]=rD,bD[Ka.TEXT]=function(e,t){var r,n=t[0],a=t[1].value,i=In(n)?n.getFallback():n;if(Cn(i)&&i.value.length>255||a.length>255)return wa;switch(i.kind){case Tt.String:r=yn(o=e.coerceOper(i,Tt.Number))?o:i;break;case Tt.Number:r=i;break;case Tt.Boolean:var o;ne("calc.funcs.text",Cn(o=e.coerceOper(i,Tt.String))),r=o;break;case Tt.Error:return wa}var u=e.applyFormat(e.originSheet.document,a,r,Em.CustomString);return void 0!==u?Fa(u):wa},bD[Ka.FIXED]=function(e,t){var r,n,a=t[0],i=t[1],o=t[2],u=uD(e,a,i,void 0),s=u.formatValue,l=u.formatDecimals;if(En(s))return s;n=null!==(r=null==o?void 0:o.value)&&void 0!==r&&r?0===l?yi.NoComFixed0:2===l?yi.NoComFixed:Vm(e.config.localeInfo,!1,1,l):0===l?yi.Fixed0:2===l?yi.Fixed:Vm(e.config.localeInfo,!0,4,l);var c=e.applyFormat(e.originSheet.document,n,s,Em.CustomBytecode);return void 0!==c?Fa(c):wa},bD[Ka.DOLLAR]=function(e,t){var r=t[0],n=t[1],a=e.config.localeInfo,i=uD(e,r,n,a.isEastAsia?a.currencyDecimals:void 0),o=i.formatValue,u=i.formatDecimals;if(En(o))return o;var s=0===u?yi.Currency:2===u?yi.CurrencyDec:Ym(a,!1,u,!0,!1),l=e.applyFormat(e.originSheet.document,s,o,Em.CustomBytecode);return void 0!==l&&l.length>0&&32===l.charCodeAt(l.length-1)?Fa(l.substring(0,l.length-1)):void 0!==l?Fa(l):wa},bD[Ka.VALUE]=function(e,t){var r=t[0];switch(r.kind){case Tt.Boolean:return wa;case Tt.Number:return r;case Tt.String:return r.value.length>255?wa:e.coerceOper(Fa(sD(r.value)),Tt.Number)}},bD[Ka.DATEVALUE]=function(e,t){var r=lD(e,t[0]);return En(r)?r:e.mathpack.trunc(r)},bD[Ka.TIMEVALUE]=function(e,t){var r=lD(e,t[0]);return En(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},bD[Ka.ISERROR]=function(e,t){return Ia(En(t[0]))},bD[Ka.ISERR]=function(e,t){var r=t[0];return Ia(En(r)&&r.type!==Na.NA)},bD[Ka.ISBLANK]=function(e,t){return Ia(Tn(t[0]))},bD[Ka.ISLOGICAL]=function(e,t){return Ia(kn(t[0]))},bD[Ka.ISNA]=function(e,t){var r=t[0];return Ia(En(r)&&r.type===Na.NA)},bD[Ka.ISNONTEXT]=function(e,t){return Ia(!Cn(t[0]))},bD[Ka.ISTEXT]=function(e,t){return Ia(Cn(t[0]))},bD[Ka.ISNUMBER]=function(e,t){return Ia(yn(t[0]))},bD[Ka.ISREF]=function(e,t){return Ia(An(t[0]))},bD[Ka.ISEVEN]=dD,bD[Ka.ISODD]=function(e,t){var r=dD(e,t);return kn(r)?Ia(!r.value):r},bD[Ka.ISFORMULA]=function(e,t){return fD(e,t[0],(function(e){return Ia(void 0!==e)}))},bD[Ka.FORMULATEXT]=function(e,t){var r=t[0];return fD(e,r,(function(t,r){if(void 0===t)return xa;var n=e.printFormula(t,r.range);return t.source.kind===Xn.Cell?Fa(n):Fa("{"+n+"}")}))},bD[Ka.ROWS]=function(e,t){var r=t[0],n=e.mathpack;return Rn(r)?n.fromNumber(r.rows):xr(r.sheets)?r.ranges.length>1?_a:n.fromNumber(r.ranges[0].rows):wa},bD[Ka.COLUMNS]=function(e,t){var r=t[0],n=e.mathpack;return Rn(r)?n.fromNumber(r.cols):xr(r.sheets)?r.ranges.length>1?_a:n.fromNumber(r.ranges[0].cols):wa},bD[Ka.AREAS]=function(e,t){var r=t[0];return xr(r.sheets)?e.mathpack.fromNumber(r.ranges.length):wa},bD[Ka.SHEETS]=function(e,t){var r=t[0],n=e.mathpack;return r?Rn(r)?xa:n.fromNumber(e.getSheetRangeIndexes(r.sheets).length):n.fromNumber(e.getSheetRangeIndexes(ca(e.reflectionSheet.document)).length)},bD[Ka.ROW]=function(e,t){var r=hD(e,t[0]);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):Va(n.rows,1,Jg(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))},bD[Ka.COLUMN]=function(e,t){var r=hD(e,t[0]);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):Va(1,n.cols,Jg(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))},bD[Ka.SHEET]=function(e,t){var r=t[0],n=e.mathpack;if(!r){var a=e.reflectionSheet;return void 0===a.index?xa:n.fromNumber(e.getSheetRangePosition(a)+1)}if(Cn(r)){var i=e.getSheetIndex(e.reflectionSheet.document,r.value);return void 0===i?xa:n.fromNumber(e.getSheetRangePosition(i)+1)}return An(r)?n.fromNumber(e.getSheetRangePosition(r.sheets)+1):Rn(r)?xa:te("calc.funcs.sheet",r)},bD[Ka.OFFSET]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4];if(!xr(r.sheets))return wa;if(1!==r.ranges.length)return wa;var u=e.mathpack,s=r.ranges[0],l=s.row,c=s.col,d=s.rows,f=s.cols,h=l;yn(n)&&(h+=u.lfix(n));var v=c;yn(a)&&(v+=u.lfix(a));var p=h+d-1;if(void 0!==i&&yn(i)){if(0===(g=u.cond(i)))return _a;p=h+u.lfix(i)-(g>0?1:-1)}var m=v+f-1;if(void 0!==o&&yn(o)){var g;if(0===(g=u.cond(o)))return _a;m=v+u.lfix(o)-(g>0?1:-1)}var S=k(h,p),b=k(v,m),y=E(h,p)-S+1,C=E(v,m)-b+1;return S<0||b<0||S+y>1<<20||b+C>16384?_a:Ha(r.sheets,[ha(S,b,y,C)])},bD[Ka.TRANSPOSE]=function(e,t){var r=t[0];return Rn(r)?Va(r.cols,r.rows,Jg(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},bD[Ka.SINGLE]=function(e,t){var r=t[0];if(On(r)||Nn(r)||Tn(r)||In(r))return r;if(Rn(r))return r.opers[0][0];if(!xr(r.sheets))return _a;if(1!==r.ranges.length)return wa;var n=qr(e.originGridCell,r.ranges[0]);return void 0===n?wa:Ha(r.sheets,[n])},bD[Ka.ADDRESS]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],u=e.mathpack,s=(null==a?void 0:a.kind)===Tt.Number?u.sfix(a)-1:0;if(s<0||s>3)return wa;var l=0!=(1&s),c=0!=(2&s),d=(null==i?void 0:i.kind)!==Tt.Boolean||i.value?ft.A1:ft.R1C1,f=function(e,t,r){return d===ft.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},h=u.sfix(r);if(!f(c,1<<20,h))return wa;if(!yn(n))return wa;var v=u.sfix(n);if(!f(l,16384,v))return wa;var p=va(h<0?1048575:0,v<0?16383:0),m=Gt(c?pt.Rel:pt.Abs,d===ft.R1C1&&c?h:h-1),g=Gt(l?pt.Rel:pt.Abs,d===ft.R1C1&&l?v:v-1),S=So(e.config.localeInfo,d,p,m,g,!1);return ne("calc.funcs.address: cell wrapped",void 0!==S),(null==o?void 0:o.kind)===Tt.String?""===o.value?Fa("!"+S):o.value.length>255?wa:Fa(Ro(e.config.localeInfo,e.config.refStyle,o.value)+"!"+S):Fa(S)},bD[Ka.INDIRECT]=function(e,t){var r,n=t[0].value,a=t[1],i=null===(r=null==a?void 0:a.value)||void 0===r||r?ft.A1:ft.R1C1;if(n.length>255||V(n," "))return wa;var o=Ca(e.originSheet,e.originGridCell),u={lexicalKind:Xn.Indirect,originGridCell:he(o.range),originSheet:he(o.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},s=e.parseFormula(i,o.range,u,"="+n);if(!Se(s))return _a;for(var l=s.value.node,c=!1,d=!1;;){if(!c&&l.kind===kt.App&&fn(l.head)&&l.head.id===Qa.Pound&&1===l.args.length&&(c=!0,l=l.args[0]),d||l.kind!==kt.Name){if(l.kind===kt.CellRef){var f=e.getCellRef(l.qualifier,l.ref,o,!0);return void 0===f?_a:xr(f.sheets)?c?RS(e,Qa.Pound,[f]):f:_a}return _a}var h=e.getNameFormula(l.qualifier,l.whole,Zn.Indirect);if(void 0===h)return _a;o=Ca(o.sheet,va(0,0)),l=h[1],d=!0}},bD[Ka.LEFT]=function(e,t){var r,n=t[0].value,a=t[1];if(void 0!==a&&En(a))return a;var i=mD(e.mathpack,a);if("number"!=typeof i&&En(i))return wa;var o=null!==(r=Ni(n,0,i))&&void 0!==r?r:n.length;return Fa(n.substring(0,o))},bD[Ka.RIGHT]=function(e,t){var r,n=t[0].value,a=t[1];if(void 0!==a&&En(a))return a;var i=mD(e.mathpack,a);if("number"!=typeof i&&En(i))return wa;var o=null!==(r=function(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;ki(e.charCodeAt(n-1))&&n-2>=0&&Ci(e.charCodeAt(n-2))?n-=2:n-=1}return n}(n,n.length,i))&&void 0!==r?r:0;return Fa(n.substring(o))},bD[Ka.MID]=function(e,t){var r,n,a=t[0].value,i=t[1],o=t[2],u=e.mathpack,s=u.fix(i)-1,l=u.fix(o);if(u.cond(i)<0||s<0||u.cond(o)<0||l<0)return wa;var c=null!==(r=Ni(a,0,s))&&void 0!==r?r:a.length,d=null!==(n=Ni(a,c,l))&&void 0!==n?n:a.length;return Fa(a.substring(c,d))},bD[Ka.LEN]=function(e,t){var r=t[0].value;return e.mathpack.fromNumber(Ti(r,0,r.length))},bD[Ka.CONCATENATE]=function(e,t){for(var r="",n=0;n<t.length;n+=1){var a=t[n].value;if(r.length+a.length>32767){r+=a.substring(0,32767-r.length);break}r+=a}return Fa(r)},bD[Ka.EXACT]=function(e,t){var r=t[0],n=t[1];return(In(r)||In(n))&&TC(Pn(["EXACT rich argument"])),Ia(r.value===n.value)},bD[Ka.REPT]=function(e,t){var r=t[0].value,n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?wa:""===r?vS:i*r.length>32767?wa:Fa(W(r,i))},bD[Ka.TRIM]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;){for(;a<r.length&&32===r.charCodeAt(a);)a+=1;for(var i=a;a<r.length;){var o=32===r.charCodeAt(a);if(a+=1,o)break}n+=r.substring(i,a)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),Fa(n)},bD[Ka.CLEAN]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return Fa(n)},bD[Ka.CHAR]=function(e,t){var r=t[0],n=e.mathpack.sfix(r);return n<1||n>255?wa:Fa(String.fromCharCode(n))},bD[Ka.UNICHAR]=function(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||a>=1114112?wa:a<=65535&&Ei(a)||a>=64976&&a<=65007||(65535&a)>=65534?xa:Fa(Ri(a))},bD[Ka.CODE]=function(e,t){var r=t[0].value;if(0===r.length)return wa;var n=r.charCodeAt(0);return n>255?TC(Pn(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)},bD[Ka.UNICODE]=function(e,t){var r=t[0].value;if(0===r.length)return wa;var n=r.charCodeAt(0),a=e.mathpack;if(!Ei(n))return a.fromNumber(n);if(1===r.length)return wa;var i=Ai(n,r.charCodeAt(1));return void 0===i?wa:a.fromNumber(i)},bD[Ka.LOWER]=function(e,t){var r=t[0].value;return Fa(SD(r,"LOWER",r.toLowerCase.bind(r)))},bD[Ka.UPPER]=function(e,t){var r=t[0].value;return Fa(SD(r,"UPPER",r.toUpperCase.bind(r)))},bD[Ka.PROPER]=function(e,t){var r=t[0].value;return Fa(SD(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!gD(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n,o=Ii(e,n);for(t+=Ri(o).toUpperCase(),n+=Fi(o);n<e.length&&gD(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t})))},bD[Ka.FIND]=function(e,t){var r,n=t[0].value,a=t[1].value,i=t[2],o=void 0!==i?e.mathpack.sfix(i)-1:0;if(o<0||o>=2147483647)return wa;var u=null!==(r=Ni(a,0,o))&&void 0!==r?r:a.length,s=a.indexOf(n,u);return s>=0?e.mathpack.fromNumber(Ti(a,0,s)+1):wa},bD[Ka.REPLACE]=function(e,t){var r,n,a=t[0].value,i=t[1],o=t[2],u=t[3].value,s=e.mathpack.sfix(i)-1;if(s<0||s>=32767)return wa;var l=e.mathpack.sfix(o);if(l<0||l>32767)return wa;var c=null!==(r=Ni(a,0,s))&&void 0!==r?r:a.length,d=null!==(n=Ni(a,c,l))&&void 0!==n?n:a.length,f=a.slice(0,c),h=a.slice(d);return f.length+u.length+h.length>32767?wa:Fa(f+u+h)},bD[Ka.SEARCH]=function(e,t){var r,n=t[0].value,a=t[1].value,i=t[2],o=void 0!==i?e.mathpack.sfix(i)-1:0;if(o<0||o>=2147483647)return wa;for(var u=null!==(r=Ni(a,0,o))&&void 0!==r?r:a.length,s=new uI(e.config.localeInfo,n,!0);u<a.length;u+=1)if(s.test(a.slice(u)))return e.mathpack.fromNumber(Ti(a,0,u)+1);return wa},bD[Ka.SUBSTITUTE]=function(e,t){var r=t[0],n=t[1].value,a=t[2].value,i=t[3],o=r.value,u=1/0;if(void 0!==i){var s=e.coerceOper(i,Tt.Number);if(En(s))return s;if((u=e.mathpack.sfix(s))<1||u>2147483646)return wa}var l=n.length;if(l>0){for(var c="",d=0,f=0;u>=0&&-1!==(f=o.indexOf(n,f));)if((u-=1)===1/0||0===u){var h=o.slice(d,f);if(c.length+h.length+a.length>32767)return wa;c+=h,c+=a,d=f+=l}else f+=1;var v=o.slice(d);return c.length+v.length>32767?wa:Fa(c+=v)}return r},bD[Ka.RAND]=function(e,t){return e.getRandom()},bD[Ka.RANDBETWEEN]=function(e,t){var r=t[0],n=t[1],a=mS(e,r),i=mS(e,n);if(En(a))return a;if(En(i))return i;var o=e.mathpack;if(o.cond2(a,i)>0)return Pa;var u=e.getRandom(),s=o.ceil(a),l=o.floor(i),c=o.sub(l,s);return En(c)?c:o.add(o.floor(fS(o.mul(fS(o.add(c,o.one)),u))),s)},bD[Ka.NOW]=function(e,t){return e.getTime(Go.Instant)},bD[Ka.TODAY]=function(e,t){return e.getTime(Go.Day)},bD[Ka.HYPERLINK]=function(e,t){var r=t[0],n=t[1];return e.followHyperlinks?r:null!=n?n:r};var yD=!1;function CD(e){return yD||(yD=!0,Be("Microsoft.Office.Excel.CalcTSDotOperator")&&(bD[Ka.FIELDVALUE]=vD,bD[Ka._FV]=vD),Le(De.CalcRecordFunctions)&&(bD[Ka.RECORD]=pD),Le(De.CalcNestedRecordFunction)&&(bD[Ka.NESTEDRECORD]=pD),Le(De.CalcLambdaFunctions)&&(bD[Ka.ARITY]=CO,bD[Ka.APPLY]=bO,bD[Ka.MAKEARRAY]=yO,bD[Ka.ISLAMBDA]=cD)),bD[e]}var kD,ED,AD,RD,ND,TD,ID,FD=function(){function e(e){this.iformats=[],this.formatStrings=h(),this.knownFormats=e}return e.prototype.clone=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=h(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?ge({kind:Nw.NumberFormat,iformat:e}):he(t.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(e){return he(this.knownFormats[e])},e.prototype.getFormatString=function(e){return he(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=h()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var a=e[t];r.iformats[t]=a,r.formatStrings[a.formatString]=t}))},e}();!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(kD||(kD={})),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(ED||(ED={})),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(AD||(AD={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(RD||(RD={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(ND||(ND={})),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(TD||(TD={})),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(ID||(ID={}));var OD={type:ND.None,color:{argb:"00000000"}},DD={font:{name:"Calibri",bold:!1,italic:!1,underline:kD.None,strikethrough:!1,verticalAlign:ED.None,size:11,color:{argb:"ff000000"}},fill:{kind:AD.Pattern,pattern:RD.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:OD,bottom:OD,left:OD,right:OD},alignment:{horizontal:TD.Automatic,vertical:ID.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}},MD=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function t(e,t){Object.keys(e).map(Number).forEach((function(r){t[r]=e[r]}))}var r=new e;return t(this.styles,r.styles),t(this.fonts,r.fonts),t(this.fills,r.fills),t(this.borders,r.borders),r},e.prototype.resolveCellStyle=function(e){if(e===CR.Blank)return he(DD);var t=this.styles[e];if(void 0===t)return ge({kind:Nw.StyleId,styleId:e});var r=t.fontId,n=t.fillId,a=t.borderId,i=t.alignment,o=void 0!==r?this.fonts[r]:DD.font;if(void 0===o)return ge({kind:Nw.FontId,fontId:r});var u=void 0!==n?this.fills[n]:DD.fill;if(void 0===u)return ge({kind:Nw.FillId,fillId:n});var s=void 0!==a?this.borders[a]:DD.border;return void 0===s?ge({kind:Nw.BorderId,borderId:a}):he({font:o,fill:u,border:s,alignment:i})},e.prototype.setStyles=function(e,t){var r=this;t||(this.styles=[]),Object.keys(e).map(Number).forEach((function(t){r.styles[t]=e[t]}))},e.prototype.setFonts=function(e,t){var r=this;t||(this.fonts=[]),Object.keys(e).map(Number).forEach((function(t){r.fonts[t]=e[t]}))},e.prototype.setFills=function(e,t){var r=this;t||(this.fills=[]),Object.keys(e).map(Number).forEach((function(t){r.fills[t]=e[t]}))},e.prototype.setBorders=function(e,t){var r=this;t||(this.borders=[]),Object.keys(e).map(Number).forEach((function(t){r.borders[t]=e[t]}))},e}(),wD=va(0,0),_D=function(e){function t(){var t=e.call(this,void 0)||this;return t.fns=[],t}return Object(fe.c)(t,e),t.prototype.wsfNode=function(e){this.fns.push(Qu(e))},t.prototype.operatorNode=function(e){this.fns.push(Zu(e))},t}(qe);var LD,PD=Ta([],[],Ft.None,ga.Exact);!function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(LD||(LD={}));var xD={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}},BD="I am changing the config, sorry! Please let the x10 scheduler know",UD=function(){function e(e,t,r,n,a,i){this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=a,this.isServerWorkbookLoad=i,this.random=new de(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.interruptToken=[Ey.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=e,this.parser=ap(this),this.printer=zs(this),this.analyzer=Yp(this),this.formatter=gy(this),this.compiler=AC(this),this.evaluator=Ok(this)}return e.prototype.clone=function(t,r){var n;void 0===t&&(t=xD),void 0===r&&(r=Ow.Server);var a=new e(this.config,t,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return a.documentLoc=this.documentLoc,a.document=null===(n=this.document)||void 0===n?void 0:n.clone(r),a.worksheetFuncOverrides=this.worksheetFuncOverrides,a.userDefinedFuncOverrides=this.userDefinedFuncOverrides,a},e.prototype.reconfigure=function(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n},e.prototype.setConfig=function(e,t){this.config=t},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?ge(Dw([{kind:Nw.DocumentLoc,document:oa(e,t)}])):he(r)},e.prototype.getNameLoc=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===le.Failure)return ge(Dw([n.reason]));var a=n.value.getNameLoc(e.index,t,r);return a.kind===le.Failure?ge(Dw([a.reason])):a},e.prototype.getUserDefinedFuncLoc=function(e,t){return void 0!==this.userDefinedFuncOverrides[t]?he([Ra(e,t)]):ge(Pn(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===le.Failure)return ge(Dw([t.reason]));if(!0!==t.value)return ge(Dw([{kind:Nw.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===le.Failure?ge(Dw([r.reason])):r.value===yR.Unavailable?ge(Dw([{kind:Nw.CellFormat}])):he(r.value)},e.prototype.getCellStyle=function(e){var t=this.allEditedAvailable(e);if(!Se(t))return ge(Dw([t.reason]));if(!0!==t.value)return ge(Dw([{kind:Nw.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedStyle(e);return Se(r)?r.value===CR.Unavailable?ge(Dw([{kind:Nw.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):ge(Dw([r.reason]))},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getIformat(t);if(n.kind===le.Failure)return ge(Dw([n.reason]));var a=n.value.getValue();return a.kind===le.Failure?ge(lm()):a},e.prototype.getIformats=function(e,t,r){var n=this.getDocument(e);if(n.kind===le.Failure)return ge(Dw([n.reason]));for(var a=n.value.getIformats(),i=[],o=t,u=k(a.length,r);o<u;o+=1){var s=a[o];void 0!==s&&i.push({iformat:o,formatString:s.formatString,builtIn:s.builtIn})}return he(i)},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===le.Failure)return ge(Dw([n.reason]));var a=n.value.getValue();return a.kind===le.Failure?ge(lm()):a},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getFormatString(t);return n.kind===le.Failure?ge(Dw([n.reason])):n},e.prototype.getNameFormula=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getNameFormula(e,t);if(n.kind===le.Failure)return ge(Dw([n.reason]));if(void 0===n.value)return he(void 0);var a=n.value.compiledFmla.getValue();if(Se(a))return a;var i=this.hasRecalcNameFailure(e);return Se(i)?i.value||this.setNameFailure(e,a.reason):this.cb.onUnavailableObject(i.reason),ge(jy(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===le.Failure)return ge(Dw([t.reason]));if(void 0===t.value)return he(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return he(void 0);var i=ba(e.sheet,n),o=this.readCompiledFmla(i,a.compiledFmla);return Se(o)?he(Oy(aa(a.lexicalKind,i),o.value)):o},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===le.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===le.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===le.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setRecalcValue(e,t);if(a.kind===le.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===le.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValues(e,t,r,i.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if(0!=(vi(e).staticPrecs&(Ft.Time|Ft.Calc))){var r=!1,n=this.evalParams.volatileMode;switch(e){case Ka.RAND:case Ka.RANDBETWEEN:case Ka.RANDARRAY:case Ka.NOW:r=n===LD.GroundTruth;break;case Ka.TODAY:r=n===LD.GroundTruth||n===LD.Estimation;break;default:r=void 0===Ka[e]}if(!r)return ge(Dw([{kind:Nw.VolatileFunction,name:Qu(e)}]))}var a=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:CD(e);return null!=a?he(a):ge(Pn([Qu(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?he(this.userDefinedFuncOverrides[t]):ge(Pn(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===le.Failure?ge(Dw([t.reason])):he(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,iR(e.range));if(n.kind===le.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setClientValue(e,DT);if(a.kind===le.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.setRecalcValue(e,Ya);if(i.kind===le.Failure)return this.cb.onUnavailableObject(i.reason);var o=this.propagateEditTaint(e,r);if(o.kind===le.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onRangeFailure(e,t,r,o.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===le.Failure?ge(Dw([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getSheetName(t);return n.kind===le.Failure?ge(Dw([n.reason])):void 0===n.value?n:he(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===le.Failure?ge(Dw([n.reason])):void 0===n.value?n:he(n.value.index)},e.prototype.getContainingTable=function(e){var t=this.getDocument(e.sheet.document);if(t.kind===le.Failure)return ge(Dw([t.reason]));var r=t.value.getContainingTable(e);return Se(r)?r:ge(Dw([r.reason]))},e.prototype.getNamedRanges=function(e){var t=this.getDocument(e.sheet.document);if(t.kind===le.Failure)return ge(Dw([t.reason]));var r=t.value.getNamedRanges(e);return Se(r)?r:ge(Dw([r.reason]))},e.prototype.getStructRefColumn=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getNameFormula(e,Zn.StructRef);if(n.kind===le.Failure)return ge(Dw([n.reason]));if(void 0===n.value)return he(void 0);if("NamedTable"!==n.value.obj.kind)return ge(ls(as.NamedObjectNotTable));var a,i=n.value.obj;if("string"==typeof t)a=i.columnNames.getEntry(t);else{var o=i.columnIndexes.getValue(t);a=void 0===o?void 0:Lo(o,t)}if(void 0===a)return i.allColumnNamesAvailable?ge(ls(as.UndefinedColumnName)):ge(Dw([{kind:Nw.ColumnName,table:e,columnNameOrIndex:t}]));var u=i.specialRefRanges[At.Data],s=u.sheet,l=u.range,c=ba(s,ha(l.row,a.value,l.rows,1));return he(ua(a.key,c,i.hasHeadersRow,i.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getNameFormula(e,Zn.StructRef);return n.kind===le.Failure?ge(Dw([n.reason])):void 0===n.value?he(void 0):"NamedTable"!==n.value.obj.kind?ge(ls(as.NamedObjectNotTable)):he(n.value.obj.specialRefRanges[t])},e.prototype.getIntersectingTables=function(e){var t=this.getDocument(e.sheet.document);if(t.kind===le.Failure)return ge(Dw([t.reason]));var r=t.value.getIntersectingTables(e);return Se(r)?r:ge(Dw([r.reason]))},e.prototype.getNamedObject=function(e,t){var r,n=this.getDocument(e.scope.document);if(n.kind===le.Failure)return ge(Dw([n.reason]));var a=n.value.getNameFormula(e,t);return a.kind===le.Failure?ge(Dw([a.reason])):he(null===(r=a.value)||void 0===r?void 0:r.obj)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===le.Failure)return ge(Dw([n.reason]));var a=n.value.getHiddenRows(e.index,t,r);return a.kind===le.Failure?ge(Dw([a.reason])):a},e.prototype.getHiddenCols=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===le.Failure)return ge(Dw([n.reason]));var a=n.value.getHiddenCols(e.index,t,r);return a.kind===le.Failure?ge(Dw([a.reason])):a},e.prototype.getMergeCell=function(e){var t=this.allEditedAvailable(e);if(t.kind===le.Failure)return ge(Dw([t.reason]));if(!0!==t.value)return ge(Dw([{kind:Nw.GridRange,unavailableCells:t.value,range:e}]));var r=this.getDocument(e.sheet.document);if(r.kind===le.Failure)return ge(Dw([r.reason]));var n=r.value.getMergeCell(e);return n.kind===le.Failure?ge(Dw([n.reason])):n},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===le.Failure)return ge(Dw([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===le.Failure?ge(Dw([r.reason])):r},e.prototype.getRandom=function(){return ne("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===LD.GroundTruth),he(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){var r=this.evalParams.volatileMode;switch(r){case LD.PrecisionTest:return ge(Dw([{kind:Nw.GetTimeKind,getTimeKind:t}]));case LD.Estimation:switch(t){case am.NonVolatile:return ge(Dw([{kind:Nw.GetTimeKind,getTimeKind:t}]));case am.ValueCell:case am.Volatile:}break;case LD.GroundTruth:}var n=this.config,a=n.mathpack,i=n.datepack,o=new Date,u=i.utcToLocal(this.config,Ko(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCDay()+1,o.getUTCMilliseconds(),Wo.Round1000ths),this.config.timezone);ne("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==u);var s=u.yr,l=u.rounding,c=u.mon,d=u.dom,f=u.hour,h=u.min,v=u.sec,p=u.fracSec;e<Go.Instant&&(p=0,v=0,h=0,f=0),e<Go.Day&&(d=1,c=1);var m=Ko(s,c,d,f,h,v,1,p,l),g=i.toNum(this.config,m);ne("calc.calc.PartialWorkbookDocumentCollection: toNum",!En(g));var S=a.toNumber(g);if(r===LD.GroundTruth)return he(g);var b=i.toNum(this.config,u);ne("calc.calc.PartialWorkbookDocumentCollection: toNum",!En(b));var y,C=a.toNumber(b);switch(e){case Go.Instant:y=C;break;case Go.Day:y=S+1;break;case Go.Year:var k=Ko(s+1,c,d,f,h,v,1,p,l),E=i.toNum(this.config,k);ne("calc.calc.PartialWorkbookDocumentCollection: toNum",!En(E)),y=a.toNumber(E)}return C<S+10/1440||C>y-10/1440?ge(Dw([{kind:Nw.TimeGranularity,granularity:e}])):he(g)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:Hy((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==le.Paused?a:Hy((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r){var n=this;return this.withEvalParams({computeKind:e,computeCell:t,volatileMode:r},(function(){return n.evaluator.evalCells([t])}))},e.prototype.evalFormula=function(e,t,r,n){var a=this,i={lexicalKind:Xn.Other,originGridCell:he(t.range),originSheet:he(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1},o={lexicalSource:{kind:Xn.Other},originGridCell:he(t.range),originSheet:he(t.sheet),calcingArray:!1,reflectionGridCell:he(t.range),reflectionSheet:he(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:he(!1)},u=function(e,n){if(n.kind===le.Paused)return Hy((function(){return u(e,n.resume())}));if(!Se(n))return he({value:n});var i=a.evalFormulaFormat(t,e,n.value,r);return he({value:he(n.value),formatted:i})};return this.withEvalParamsEvalFormula({computeKind:uR.EvalFormula,computeCell:t,volatileMode:n},(function(){var t=a.parser.parseFormula(i,e),r=a.checkFormula(i,t,e,"eval-formula"),n=a.compileFormula(i,r);return Se(n)?u(n.value,a.evaluator.evalFormula(o,n.value)):he({value:n})}))},e.prototype.evalFormulaFormat=function(e,t,r,n){if(void 0!==n){if(n===yR.Origin){var a=this.allEditedAvailable(e);return Se(a)?!0!==a.value?ge(Dw([{kind:Nw.GridRange,unavailableCells:a.value,range:e}])):this.formatValueCell(e,r):void this.cb.onUnavailableObject(a.reason)}if(n===yR.Inferred){var i={lexicalSource:{kind:Xn.Other},originGridCell:he(e.range),originSheet:he(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},o=this.formatter.evalFormat(i,t);return Se(o)?void 0===o.value?this.formatValueKnownFormat(e.sheet.document,yi.General,r):"number"==typeof o.value?this.formatValueIformat(e.sheet.document,o.value,r):this.formatter.applyFormat(o.value,r,!0):o}return this.formatValueIformat(e.sheet.document,n,r)}},e.prototype.evalValue=function(e,t,r){var n,a=this.evalParams;this.evalParams={computeKind:t,computeCell:e,volatileMode:r};try{var i=this.getEditedFormula(e);if(!Se(i))return this.cb.onUnavailableObject(i.reason);if(void 0!==(null===(n=i.value)||void 0===n?void 0:n[1].compiledFmla))return;var o=this.hasRecalcDirty(e);if(!Se(o))return this.cb.onUnavailableObject(o.reason);if(o.value)return;var u=this.tryGetCellValue(e.range,e.sheet);if(void 0===u)return;ne("calc.calc.PartialWorkbookDocumentCollection.evalValue",u.kind===ky.FinalValue),this.cb.onReturnCellValue(e,u.oper,sR.EditedCell)}finally{this.evalParams=a}},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===le.Failure?r:(this.document=r.value.setSheetNames(t),he(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===le.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===le.Failure?i:i.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===le.Failure?i:i.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():GT},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():$T},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getEditedFormula(e)},e.prototype.forEachEditedFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.forEachEditedFormula(e,t)},e.prototype.getEditedValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getEditedValue(e)},e.prototype.forEachEditedValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.forEachEditedValue(e,t)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getEditedFormat(e)},e.prototype.forEachEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.forEachEditedFormat(e,t)},e.prototype.getEditedStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getEditedStyle(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getServerFormat(e)},e.prototype.getServerStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getServerStyle(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValues=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getRecalcValues(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===le.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===le.Failure||void 0===r.value?r:he(ba(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){g(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===le.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===le.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,s,l){var c=this.getDocument(t.sheet.document);if(c.kind===le.Failure)return c;var d=void 0===r?void 0:n?this.compileFmla(e,Xn.Cell,ya(t.sheet,a),void 0,r):""===r?TT:{fmla:r,lexicalKind:Xn.Cell,origin:a,compiledFmla:void 0,hasHyperlink:ET.ClientValueUnknown};return c.value.setCellContents(e,t,d,i,o,u,s,l)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o,u){var s=this.getDocument(t.sheet.document);if(s.kind===le.Failure)return s;var l=""===r?IT:this.compileFmla(e,Xn.Range,ya(t.sheet,n),on(t.range),r);return s.value.setRangeFormula(e,t,l,a,i,o,u)},e.prototype.copyRange=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.copyRange(e)},e.prototype.pasteRange=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.pasteRange(e,t)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===le.Failure)return n;var a,i,o,u=ia(t),s=n.value.getNameFormula(t,Zn.StructRef);if(void 0!==r&&"NamedTable"===r.kind&&Se(s)&&void 0!==s.value&&"NamedTable"===s.value.obj.kind&&(i=s.value.obj,o=r,an(i.specialRefRanges[At.Data],o.specialRefRanges[At.Data])&&i.hasHeadersRow===o.hasHeadersRow&&i.hasTotalsRow===o.hasTotalsRow)){var l=function(e,t){var r=e.columnNames,n=e.columnIndexes;t.columnIndexes.forEach((function(t,n){var a=e.columnIndexes.getValue(t);return void 0!==a&&(r=r.remove(a)),!0})),t.columnIndexes.forEach((function(e,t){return r=r.setValue(t,e),n=n.setValue(e,t),!0}));var a=n.getCount()===t.specialRefRanges[At.All].range.cols;return Object(fe.a)(Object(fe.a)({},t),{columnNames:r,columnIndexes:n,allColumnNamesAvailable:a})}(s.value.obj,r);a=this.compileNamedObject(e,u,l)}else a=void 0===r?void 0:this.compileNamedObject(e,u,r);return n.value.setNamedObject(e,t,a)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===le.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===le.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,a=this.ensureDocument(e);if(a.kind===le.Failure)return a;var i=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,a=e.builtIn,o=n.compileNumberFormat(r,a);i[t]={formatString:r,builtIn:a,compiledFormat:o}})),he(a.value.setNumberFormats(i,r))},e.prototype.setStyles=function(e,t,r){var n=this.ensureDocument(e);return n.kind===le.Failure?n:he(n.value.setStyles(t,r))},e.prototype.setFonts=function(e,t,r){var n=this.ensureDocument(e);return n.kind===le.Failure?n:he(n.value.setFonts(t,r))},e.prototype.setFills=function(e,t,r){var n=this.ensureDocument(e);return n.kind===le.Failure?n:he(n.value.setFills(t,r))},e.prototype.setBorders=function(e,t,r){var n=this.ensureDocument(e);return n.kind===le.Failure?n:he(n.value.setBorders(t,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===le.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===le.Failure?n:n.value.setHiddenCols(e.index,t,r)},e.prototype.writeMergeCell=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.setMergeCell(e)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===le.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return he(t);var r=this.getDocument(e);if(!Se(r))return ge(Dw([r.reason]));var n=r.value.getIformat(t);return Se(n)?n.value.getValue():ge(Dw([n.reason]))},e.prototype.resolveCellStyle=function(e,t){var r=this.getDocument(e);if(!Se(r))return ge(Dw([r.reason]));var n=r.value.resolveCellStyle(t);return Se(n)?he(n.value):ge(Dw([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!Se(n))return n;var a=this.getFormatString(e,n.value.formatString);return Se(a)?he(null!==(r=a.value)&&void 0!==r?r:n.value):a},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return Se(r)?void 0!==r.value?he(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveObjectFormat=function(e,t){var r=this.getFormatString(e,t.formatString);return Se(r)?void 0!==r.value?he(r.value):he(t):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?he(t):this.resolveStringFormat(e,t)},e.prototype.resolveRibbonFormat=function(e,t,r){var n;switch(t){case ng.GalleryShortDate:case ng.GalleryLongDate:var a=this.getCellFormat(r);if(!Se(a))return a;var i=this.resolveCellFormat(r.sheet.document,a.value);if(!Se(i))return i;n=i.value}var o=og(this.config.localeInfo,t,n);return this.resolveStringFormat(e,o)},e.prototype.resolveChangeDecimals=function(e,t,r){var n=this.getCellFormat(r);if(!Se(n))return n;var a=this.resolveCellFormat(r.sheet.document,n.value);if(!Se(a))return a;var i=this.formatter.changeFormatDecimals(a.value,t);return Se(i)?void 0===i.value?me:this.resolveObjectFormat(e,i.value):i},e.prototype.parseInferredEdit=function(e,t,r){var n=this.getCellFormat(e);if(!Se(n))return n;var a=this.resolveCellFormat(e.sheet.document,n.value);if(!Se(a))return a;var i=this.evalParams;this.evalParams={computeKind:uR.ParseEdit,computeCell:e,volatileMode:r};try{return this.formatter.parseEdit(t,a.value)}finally{this.evalParams=i}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!Se(t))return he(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return he(void this.cb.onUnavailableObject({kind:Nw.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!Se(r))return r;var n=aa(t.value[1].lexicalKind,ba(e.sheet,t.value[0])),a=r.value;return this.formatter.evalFormat(wm(n),a)},e.prototype.fillInferredFormat=function(e,t){var r=this,n=t,a=t===yR.Unavailable?he(yR.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!Se(a)){var i=a.reason;vR(e.set,(function(t){var n=ba(e.sheet,t);return r.cb.onInferFormatFailure(n,i),!0})),a=he(yR.Unavailable),n=yR.Unavailable}var o=a.value;pR(e.set,(function(t){var a=ya(e.sheet,t),i=r.getEditedFormat(a);if(!Se(i))return r.cb.onUnavailableObject(i.reason),!0;if(i.value===yR.Unavailable)return!0;var u=r.resolveCellFormat(e.sheet.document,i.value);if(!Se(u))return r.cb.onInferFormatFailure(a,u.reason),!0;if(Hg(o===yR.Unavailable?void 0:o,u.value)){var s=r.setEditedFormat(a,n);Se(s)||r.cb.onUnavailableObject(s.reason)}return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,a,i=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==i&&Se(i)?[Gs(this.config,i.value,e),(n=i.value,a=new _D,St(a,n),a.fns)]:[G(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new aI((function(){var o=i.parser.parseFormula(Ql(t,r.range),a),u=e?o:i.autocorrectFormula(gp(t,r),o),s=e&&i.isServerWorkbookLoad,l=i.checkFormula(gp(t,r,void 0,s),u,a,e?"server-cell-formula":"edit-cell-formula"),c=i.adjustFormulaOrigin(l,r,n);return i.compileFormula(yy(t,r.range),c)})),hasHyperlink:ET.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return Se(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.compileNamedObject=function(e,t,r){var n=this,a=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new aI((function(){var t=r.fmla,i=n.parser.parseFormula(Ql(Xn.NameManager,wD),t);ne("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var o=e&&n.isServerWorkbookLoad,u=Sp(Ca(ka(n.documentLoc),wD),void 0,o),s=i,l=n.checkFormula(u,s,t,a);return n.compileFormula(Cy(wD),l)}))};case"NamedValue":case"NamedRange":case"NamedTable":return{obj:r,compiledFmla:new aI((function(){var e,a;if("NamedRange"===r.kind){var i=r.value;ne("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",Zr(r.value.sheets.document,t.name.scope.document));var o=i.sheets,u=n.getDocument(o.document);if(!Se(u))return n.cb.onUnavailableObject(u.reason),ge(Dw([u.reason]));var s=u.value.getSheetName(o.index);if(!Se(s))return n.cb.onUnavailableObject(s.reason),ge(Dw([s.reason]));var l=r.value.ranges[0];e=zt(Sr(Ht(Vt(Gt(pt.Abs,l.row),Gt(pt.Abs,l.col)),Vt(Gt(pt.Abs,l.row+l.rows-1),Gt(pt.Abs,l.col+l.cols-1))),xt(s.value)),[],[],1),a=ya(o,wD)}else"NamedTable"===r.kind?(e=zt(Cr(fr(t.name.name),Fr(void 0)),[],[],1),a=Ca(ka(n.documentLoc),wD)):(e=zt(Qt(r.value,!0),[],[],1),a=Ca(ka(n.documentLoc),wD));var c=n.analyzer.checkFormula(Sp(a),e);return Se(c)&&Br(c.value)?n.compileFormula(Cy(wD),he(c.value)):re("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+Gs(n.config,e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new aI((function(){return ge(Dw([{kind:Nw.ClientFailure,reason:r.failureReason}]))}))};default:return te("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.checkFormula=function(e,t,r,n){if(!Se(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value);return Se(a)?Br(a.value[0])?he(a.value[0]):ge(Ny("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+G(r),n,pp(a.value[1]))):a},e.prototype.autocorrectFormula=function(e,t){return Se(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){return Se(e)&&void 0!==r?tk(this,us(t),r,e.value):e},e.prototype.compileNumberFormat=function(e,t){var r=this;return new aI((function(){var n=r.formatter.createFormat(e,t);return Se(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return p(yi,(function(t){return e.compileNumberFormat(tg(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.printer.printFormula(Zl(e,ya(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return Se(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,V(r,"'")):n},e.prototype.formatValueCell=function(e,t){if(Tn(t))return he(gm([],void 0,nm.Left,im.All));var r=this.getEditedResolvedFormat(e);if(!Se(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return Se(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return Se(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return Se(t)?t.value===yR.Unavailable?ge(Dw([{kind:Nw.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):ge(Dw([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&Zr(this.documentLoc,e)?he(this.document):this.unavailableFailure({kind:Nw.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new nI(e,this.config.localeInfo.stringCompareCI,new FD(this.compileKnownFormats()),new MD)),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return ge(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=ba(t,e),a=e.row,i=e.col,o=e.rows,u=e.cols,s=this.getRecalcValues(n);if(s.kind!==le.Failure){for(var l=!1,c=0;c<o;c+=1)for(var d=s.value[c],f=0;f<u;f+=1){var h=d[f].failure;void 0!==h&&(this.setCellFailure(ya(t,va(a+c,i+f)),h,PD),l=!0)}if(!l){var v=function(e){return Ty(e.oper)},p=s.value.map((function(e){return e.map(v)})),m=this.forEachRecalcDirty(n,(function(e){var n=ya(t,e),o=r.getEditedFormula(n);if(o.kind===le.Failure)return r.cb.onUnavailableObject(o.reason),!1;if(void 0===o.value)return r.setCellFailure(n,Dw([{kind:Nw.CellMissingFormula}]),PD),l=!0,!0;var u=o.value,s=u[0],c=u[1];return void 0===c.compiledFmla?(r.cb.onUnavailableObject({kind:Nw.CellEvaluatingValue}),!1):Se(r.readCompiledFmla(ba(t,s),c.compiledFmla))?(p[e.row-a][e.col-i]=Iy(ya(t,on(s))),!0):(l=!0,!0)}));if(Se(m)){if(m.value&&!l)return p}else this.cb.onUnavailableObject(m.reason)}}else this.cb.onUnavailableObject(s.reason)},e.prototype.tryGetCellValue=function(e,t){var r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===le.Failure)return ge(Dw([n.reason]));if(!0!==n.value)return ge(Dw([{kind:Nw.GridRange,range:r,unavailableCells:n.value}]));var a=t.hasRecalcFailure(r);if(a.kind===le.Failure)return ge(Dw([a.reason]));if(a.value)return ge(Gy(r));if(Xr(r.range)>t.maxDereferenceCells)return ge(Dw([{kind:Nw.GridRangeSize,range:r}]));var i=e(r.range,r.sheet);return void 0===i?ge(Gy(r)):he(i)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(Se(r))return r;if(this.setCellFailure(e,r.reason,PD),r.reason.kind===Sy.Unavailable){r.reason;return r}return ge(Dw([{kind:Nw.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===le.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===le.Failure||void 0===r.value?r:he(ba(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===le.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.allEditedAvailable(e)},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.forEachRecalcDirty(e,t)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===le.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.setClientFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===le.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===le.Failure)return r;var n=MT(r.value.oper)||!_n(this.config.mathpack,r.value.oper,t,!0);if(n){var a=this.setClientValue(e,t);if(a.kind===le.Failure)return a}return he(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===le.Failure)return r;var n=t!==r.value;if(n){var a=this.setClientFormat(e,t);if(a.kind===le.Failure)return a}return he(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,a=this.getClientFormula(un(e));if(a.kind===le.Failure)return a;var i=null!==(n=a.value)&&void 0!==n?n:[e.range,OT],o=i[0],u=i[1],s=on(e.range),l=void 0!==t&&t!==u.fmla||void 0!==u.compiledFmla&&!tn(s,u.origin),c=void 0!==r&&r!==u.hasHyperlink;if(l||c){var d=u.compiledFmla,f=this.setClientFormula(ba(e.sheet,o),{fmla:null!=t?t:u.fmla,compiledFmla:d,origin:void 0!==t?s:u.origin,hasHyperlink:null!=r?r:u.hasHyperlink});if(f.kind===le.Failure)return f}return he({hasFmlaChanged:l,hasHyperlinkChanged:c})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===le.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===le.Failure)return r;if(r.value)return he(sR.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i,o=a[n],u=this.hasRecalcEditTaint(o);if(u.kind===le.Failure)return u;if(u.value)return(i=this.setRecalcEditTaint(e.sheet,iR(e.range))).kind===le.Failure?i:he(sR.DependentCell)}return 0!=(t.special&(Ft.Calc|Ft.Time))?(i=this.setRecalcEditTaint(e.sheet,iR(e.range))).kind===le.Failure?i:he(sR.DependentCell):t.bound===ga.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===uR.EditedCell?he(sR.IndependentCell):he(sR.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.setClientValue(e,t)},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===le.Failure?r:r.value.setClientFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===le.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===le.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===le.Failure)return this.cb.onUnavailableObject(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e}();function GD(e,t){return e&t-1}var jD,VD=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[GD(this.front+t,r)]=this.values[GD(this.front+t,e)];this.values.length=r,this.front=GD(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[GD(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=GD(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[GD(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.popBack=function(){var e=GD(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=GD(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[GD(this.front+r,t)]))return!1}return!0},e}();!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(jD||(jD={}));var HD,WD,KD,zD,YD=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var n,a=null!==(n=this.taskDeqs[e])&&void 0!==n?n:this.taskDeqs[e]=new VD;t===jD.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}();function qD(e,t){switch(t.kind){case Tt.Number:return{kind:"n",magnitude:L(e.toNumber(t))};case Tt.String:return{kind:"s"};case Tt.Boolean:return{kind:"b"};case Tt.Error:return{kind:"e",type:Xu(t.type)};case Tt.Rich:return{kind:"r"};case Tt.Array:return{kind:"a"};case Tt.Blank:return{kind:"z"};default:return te("calc.calc.precisionValue",t)}}function JD(e,t){var r=e[t.sheet.index];return void 0!==r&&zA(r,iR(t.range))}function QD(e,t){var r,n=null!==(r=e[t.sheet.index])&&void 0!==r?r:lA;e[t.sheet.index]=UA(n,iR(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(KD||(KD={})),function(e){e.Success="Success",e.Timeout="Timeout"}(zD||(zD={}));var XD=((HD={})[Qa.Add]=.05,HD[Qa.Sub]=.069,HD[Qa.Eq]=.097,HD[Qa.Mul]=.1,HD[Qa.Div]=.11,HD[Qa.Concat]=.36,HD[Qa.Gt]=.65,HD[Qa.Ne]=.79,HD[Qa.Lt]=.89,HD[Qa.Le]=1.6,HD[Qa.Ge]=1.9,HD[Qa.Percent]=2.9,HD[Qa.At]=6.2,HD[Qa.Pow]=13,HD[Qa.Range]=67,HD),ZD=((WD={})[Ka.IF]=.076,WD[Ka.SUM]=.11,WD[Ka.IFERROR]=.5,WD[Ka.COUNTIF]=.77,WD[Ka.AND]=.82,WD[Ka.VLOOKUP]=1.5,WD[Ka.AVERAGE]=1.5,WD[Ka.HOUR]=1.9,WD[Ka.MINUTE]=1.9,WD[Ka.TEXT]=2,WD[Ka.OR]=2,WD[Ka.NOW]=2.1,WD[Ka.ISBLANK]=2.3,WD[Ka.CONCATENATE]=2.6,WD[Ka.SUMIF]=2.7,WD[Ka.COUNTIFS]=3.3,WD[Ka.LEFT]=3.4,WD[Ka.ISNUMBER]=3.7,WD[Ka.MID]=3.9,WD[Ka.COUNTA]=4,WD[Ka.MONTH]=4.2,WD[Ka.SECOND]=4.3,WD[Ka.LEN]=4.9,WD[Ka.WEEKNUM]=5,WD[Ka.DAY]=5.2,WD[Ka.ROUND]=5.4,WD[Ka.FIND]=5.8,WD[Ka.NETWORKDAYS]=6.2,WD[Ka.COUNT]=6.2,WD[Ka.YEAR]=6.3,WD[Ka.INT]=6.4,WD[Ka.RIGHT]=6.7,WD[Ka.ABS]=7,WD[Ka.CONCAT]=7.2,WD[Ka.CHAR]=7.4,WD[Ka.MAX]=8,WD[Ka.ROW]=8.1,WD[Ka.WEEKDAY]=9.1,WD[Ka.DAYS]=9.2,WD[Ka.MIN]=9.8,WD[Ka.SEARCH]=9.8,WD[Ka.WORKDAY]=11,WD[Ka.DATEDIF]=12,WD[Ka.TIME]=13,WD[Ka.HYPERLINK]=13,WD[Ka.IFS]=13,WD[Ka.ISERROR]=13,WD[Ka.COUNTBLANK]=14,WD[Ka.TODAY]=14,WD[Ka.VALUE]=18,WD[Ka.ROUNDUP]=18,WD[Ka.MATCH]=19,WD[Ka.DATE]=20,WD[Ka.SUBSTITUTE]=20,WD[Ka.INDIRECT]=22,WD[Ka.INDEX]=23,WD[Ka.TRIM]=24,WD[Ka.UPPER]=25,WD[Ka.SUMIFS]=28,WD[Ka.EXACT]=29,WD[Ka.NOT]=32,WD[Ka.PRODUCT]=35,WD[Ka.ROUNDDOWN]=37,WD[Ka.AVERAGEIF]=38,WD[Ka.ISTEXT]=40,WD[Ka.ISOWEEKNUM]=41,WD[Ka.EOMONTH]=42,WD[Ka.MROUND]=45,WD[Ka.COLUMN]=45,WD[Ka.ROWS]=46,WD[Ka.TIMEVALUE]=52,WD[Ka.TRUNC]=53,WD[Ka.LOOKUP]=59,WD[Ka.NA]=59,WD[Ka.DAYS360]=61,WD[Ka.RANK]=67,WD[Ka.EDATE]=72,WD[Ka.MOD]=82,WD[Ka.OFFSET]=83,WD[Ka.STDEV]=87,WD[Ka.SUBTOTAL]=91,WD),$D=$e(Object(fe.a)(Object(fe.a)({},Je(.01)),{nameNode:function(){return 1},operatorNode:function(e){var t;return null!==(t=XD[e])&&void 0!==t?t:100},wsfNode:function(e){var t;return null!==(t=ZD[e])&&void 0!==t?t:100}}),E);var eM=function(){function e(e){var t,r,n,a,i=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){var t=e.cell,r=e.p;return i.resumeToPledge((function(){return i.docs.evaluate(uR.EditedCell,t,LD.PrecisionTest)}),r)},this.testPrint=function(e){var t=e.cell,r=e.p;return Oe.try((function(){var e=i.getFormula(t);if(!Se(e))return i.onUnavailableObject(e.reason);var n,a=e.value,o=a[0],u=a[1];if(void 0===u.compiledFmla){var s=i.docs.getServerValue(t);if(!Se(s))return i.onUnavailableObject(s.reason);n=i.docs.renderValueBarText(t,s.value.oper,u.fmla)}else{var l=u.compiledFmla.getValue();n=Se(l)?i.docs.printFormulaBarText(o,u.origin,l.value):l}if(Se(n)){var c=G(u.fmla),d=n.value===u.fmla?{expected:c,p:r}:{expected:c,sampled:G(n.value),p:r};i.log.push({kind:KD.PrintFormulaStatistics,stats:{samples:[d],failures:[]}})}else i.log.push({kind:KD.PrintFormulaStatistics,stats:{samples:[],failures:[n.reason]}})}))},this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,samplePrecisionPrintValueRate:null!==(n=e.samplePrecisionPrintValueRate)&&void 0!==n?n:0,rngSeed:null!==(a=e.rngSeed)&&void 0!==a?a:0|N()},this.rng=new de(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(zD.Success)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(zD.Timeout)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new Ie(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return Oe.all(Object(fe.f)(r.map(t.testEval),n.map(t.testPrint)))})).catch((function(e){t.log.push({kind:KD.UnhandledFailure,reason:e})})))},e.prototype.step=function(){this.result||(this.result=this.runtime.step())},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(a){var i=a.sheetIdx;return n.push(Oe.try((function(){e.docs.forEachServerNonBlankCellInSet(i,sA,(function(n){var a=ya(i,n),o=e.config,u=o.samplePrecisionEvalRate,s=o.samplePrecisionPrintFormulaRate,l=o.samplePrecisionPrintValueRate;if(u>0){var c=e.getWeight(a);void 0!==(f=void 0===c?void 0:u>=1?1:k(1,u*c))&&e.rng.next()<f&&(QD(e.sampledSets,a),t.push({cell:a,p:f}))}var d=E(s,l);if(d>0){var f,h=e.rng.next();if(h<d)h<(f=e.isValueCell(a)?l:s)&&r.push({cell:a,p:f})}return!0}))}))),!0})),Oe.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getWeight=function(e){var t=this.getFormula(e);if(!Se(t))return this.onUnavailableObject(t.reason);var r=t.value[1];return void 0!==r.compiledFmla?function(e){return Se(e)?St($D,e.value):1}(r.compiledFmla.getValue()):void 0},e.prototype.isValueCell=function(e){var t=this.getFormula(e);return Se(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)},e.prototype.resumeToPledge=function(e,t){var r=this;return Oe.try((function(){try{r.p=t;var n=e();return Array.isArray(n)?n:r.resumeToPledge(n.resume,t)}finally{r.p=void 0}}))},e.prototype.getFormula=function(e){var t,r=this.docs.getEditedFormula(e);if(!Se(r))return r;var n=null!==(t=r.value)&&void 0!==t?t:[e.range,TT],a=n[0],i=n[1];return he([aa(i.lexicalKind,ba(e.sheet,a)),i])},e.prototype.onRangeFailure=function(e,t,r,n,a){var i={samples:[],failures:[t]};this.log.push({kind:KD.EvalStatistics,stats:i})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=Dw([e]);this.log.push({kind:KD.UnhandledFailure,reason:t})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return JD(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,a){var i=this.getFormula(e);if(!Se(i))return this.onUnavailableObject(i.reason);var o=i.value,u=o[0],s=o[1],l=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,u,s,l)},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,o=this.getFormula(un(e));if(!Se(o))return this.onUnavailableObject(o.reason);var u=o.value,s=u[0],l=u[1],c=this.hasWrongPrecedent(r);Vr(e.range,(function(r,n,a){return i.logPrecisionResult(ya(e.sheet,r),t[n][a],s,l,c),!0}))},e.prototype.logPrecisionResult=function(e,t,r,n,a){var i=this.docs.allServerAvailable(e);if(!Se(i))return this.onUnavailableObject(i.reason);if(!0===i.value){var o=this.docs.getServerValue(e);if(!Se(o))return this.onUnavailableObject(o.reason);var u=JD(this.sampledSets,e),s=this.precisionResult(t,o.value.oper,r,n,u,a);(function(e){return void 0===e.sampled})(s)||QD(this.precisionWrongSets,e);var l={samples:[s],failures:[]};this.log.push({kind:KD.EvalStatistics,stats:l})}},e.prototype.precisionResult=function(e,t,r,n,a,i){var o=this.p,u=this.docs.config.mathpack,s=qD(u,t),l=this.docs.anonymizeFormula(r,n),c=l[0],d=l[1];if(_n(u,e,t,!0))return{expected:s,formula:c,functions:d,root:a,cascaded:i,p:o};var f=qD(u,e);if(yn(t)&&yn(e)){var h=u.toNumber(t),v=u.toNumber(e);return{expected:s,sampled:f,relMagnitude:L(0===h?v:(v-h)/h),formula:c,functions:d,root:a,cascaded:i,p:o}}return{expected:s,sampled:f,formula:c,functions:d,root:a,cascaded:i,p:o}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==zD.Success){for(var n={samples:[],failures:{}},a={samples:[],failures:{}},i={},o=0,u=this.log;o<u.length;o++){var s=u[o];switch(s.kind){case KD.EvalStatistics:(t=n.samples).push.apply(t,s.stats.samples);for(var l=0,c=s.stats.failures;l<c.length;l++){var d=c[l];ML(n.failures,d)}break;case KD.PrintFormulaStatistics:(r=a.samples).push.apply(r,s.stats.samples);for(var f=0,h=s.stats.failures;f<h.length;f++){d=h[f];ML(a.failures,d)}break;case KD.UnhandledFailure:ML(i,s.reason);break;default:te("calc.calc.PrecisionExperiment.createResultMessage",s)}}return["PrecisionExperiment",e,"stateId = "+this.stateId,"evalStats = "+JSON.stringify(n),"printStats = "+JSON.stringify(a),"unhandledFailures = "+JSON.stringify(i)].join(", ")}},e}(),tM=r(12);function rM(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}var nM,aM=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{ee.ULS.traceTag(578588694,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,n,a,i=e.getServerDocument(),o=[],u=0,s=e.getServerAvailableCells();u<s.length;u++){var l=s[u],c="UndefinedSheet";if(void 0!==i){var d=e.getSheetName(i,l.sheetIdx.index);d.kind===le.Success&&(c=d.value)}var f=e.getServerUsedRange(l.sheetIdx);if(f.kind!==le.Failure&&void 0!==f.value){var h=f.value.sheet,v=Object(fe.a)({},f.value.range);v.cols=Math.min(v.cols,75),v.rows=Math.min(v.rows,1e3);for(var p=[],m=[],g=[],S=0,b=v.row,y=v.row+v.rows-1;b<=y;b+=1){for(var C=[],k=[],E=[],A=v.col,R=v.col+v.cols-1;A<=R;A+=1){var N=ya(h,va(b,A)),T=e.getServerValue(N),I=T.kind===le.Success?JSON.stringify(T.value):"";k.push(I);var F=e.getServerFormat(N),O=F.kind===le.Success?rM(JSON.stringify(F.value)).toString():"";E.push(O);var D=e.getServerFormula(N),M=D.kind===le.Success?null===(r=null===(t=D.value)||void 0===t?void 0:t[1].compiledFmla)||void 0===r?void 0:r.getValue():void 0,w=(null==M?void 0:M.kind)===le.Success&&null!==(a=null===(n=D.value)||void 0===n?void 0:n[1].fmla)&&void 0!==a?a:"";""!==w&&(S+=1),C.push(w)}p.push(C),m.push(k),g.push(E)}if(0!==S){var _={sheetName:c,usedRangeAddress:To(e.config.localeInfo,v,c),values:m,formulas:p,styles:g};o.push(_)}}}return{workbookName:"PartialWorkbook",worksheets:o}}(t);this.result=Object(tM.detect_errors)(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: "+e}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],a=e.rangeSizes,i=a.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:i,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(G),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),a=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:a,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: "+JSON.stringify(this.report)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!0,configurable:!0}),e}();function iM(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}!function(e){e.Root="calc.exp.gauss",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(nM||(nM={}));var oM=function(e,t){return iM(e.consts,t)};function uM(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),ne(e,void 0===t.name||1===t.varCount),ne(e,t.varCount===r)}function sM(e,t,r){var n={varCount:e,vars:t,consts:r,name:void 0};return uM(nM.Root,n),n}function lM(){}function cM(){return new lM}var dM=cM();function fM(){return sM(0,{},cM())}function hM(e){return sM(0,{},e)}function vM(e){var t,r=sM(1,((t={})[e]=1,t),dM);return r.name=e,r}var pM=function(){return!1};function mM(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===dM||oM(e,pM))){var t=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==t&&(e.name=t,!0)}return!1}function gM(e,t){return r=function(e,r){return t.vars[e]===r},iM(e.vars,r)&&oM(e,(function(e,r){return t.consts[e]===r}));var r}function SM(e,t){var r,n,a=fM(),i=e.vars,o=e.consts,u=t.vars,s=t.consts;for(var l in i){0!==(c=i[l]+(null!==(r=u[l])&&void 0!==r?r:0))&&(a.vars[l]=c,a.varCount+=1)}for(var l in o){var c;0!==(c=o[l]+(null!==(n=s[l])&&void 0!==n?n:0))&&(a.consts[l]=c)}for(var l in u)void 0===i[l]&&(a.vars[l]=u[l],a.varCount+=1);for(var l in s)void 0===o[l]&&(a.consts[l]=s[l]);return uM(nM.Root,a),a}function bM(e,t,r){var n=t.vars,a=t.consts,i=n[e];if(void 0===i)return t;var o=0,u=fM(),s=u.vars,l=u.consts;for(var c in n){var d=r.vars[c],f=void 0===d?0:d;0!==(h=(c===e?0:n[c])+f*i)&&(o+=1,s[c]=h)}for(var c in r.vars){void 0===n[c]&&(o+=1,s[c]=i*r.vars[c])}for(var c in a){var h,v=r.consts[c];0!==(h=a[c]+i*(void 0===v?0:v))&&(l[c]=h)}for(var c in r.consts){void 0===a[c]&&(l[c]=i*r.consts[c])}return sM(o,s,l)}var yM=function(){},CM={kind:1,substitution:yM},kM=function(e){return{kind:1,substitution:e}},EM={kind:0},AM=function(e){return e<0?-e:e};function RM(e,t,r){var n={};return r===yM?t:t===yM?r:function(a){var i=n[a];if(void 0!==i)return i;var o=r(a);return n[a]=void 0===o?t(a):e(t,o)}}function NM(e,t){return function(r){return e===r?t:void 0}}var TM=function(e,t,r){return function e(t,r,n){if(t>=100)return re(nM.UnifyBound);if(0===n.varCount)return oM(n,pM)?CM:EM;if(1===n.varCount){var a;for(var i in n.vars){a=i;break}ne(nM.Root,void 0!==a);var o=n.vars[a],u={};for(var s in n.consts){if((p=n.consts[s])%o!=0)return EM;u[s]=-p/o}return kM(NM(a,hM(u)))}var l,c=0,d=void 0,f=n.vars,h=n.consts,v=n.varCount;for(var s in f){var p=f[s],m=AM(p);(void 0===d||m<d)&&(c=p,d=m,l=s)}ne(nM.Root,void 0!==l),ne(nM.Root,0!==c);var g={},S={};for(var s in f)if(s===l)g[s]=1;else{p=f[s];g[s]=-Math.floor(p/c)}for(var s in h){p=h[s];S[s]=-Math.floor(p/c)}var b=sM(v,g,S),y=e(t+1,r,bM(l,n,b));return 0===y.kind?y:kM(RM(r,y.substitution,NM(l,b)))}(0,e,function(e,t){var r,n,a=fM(),i=e.vars,o=e.consts,u=t.vars,s=t.consts;for(var l in i){0!==(c=i[l]-(null!==(r=u[l])&&void 0!==r?r:0))&&(a.vars[l]=c,a.varCount+=1)}for(var l in o){var c;0!==(c=o[l]-(null!==(n=s[l])&&void 0!==n?n:0))&&(a.consts[l]=c)}for(var l in u)void 0===i[l]&&(a.vars[l]=-u[l],a.varCount+=1);for(var l in s)void 0===o[l]&&(a.consts[l]=-s[l]);return uM(nM.Root,a),a}(t,r))};function IM(e,t){return void 0===t&&(t=void 0),{kind:0,flags:e,unit:t}}function FM(e){return{kind:1,reference:e,resolution:void 0}}function OM(e,t){return{kind:2,elementType:e,dimensions:t}}function DM(e){return{kind:3,flags:e}}function MM(e){var t;switch(e.kind){case 1:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!Ur(r)||{rows:r.rows,columns:r.cols,exact:!0});case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function wM(e,t){return function(e,t){if("object"==typeof e)return"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:Object(fe.a)(Object(fe.a)({},e),{exact:e.exact&&t});if("object"==typeof t)return Object(fe.a)(Object(fe.a)({},t),{exact:t.exact&&e});return e&&t}(MM(e),MM(t))}function _M(e,t){return!0===t?e:OM(e,t)}var LM=IM(Tt.Boolean),PM=IM(Tt.String),xM=IM(Tt.Number),BM=hM({}),UM=IM(Tt.Number,BM),GM=IM(Tt.Error),jM=IM(Tt.Missing|Tt.Blank),VM=DM(It.None),HM=DM(It.All),WM=IM(Tt.Number|Tt.Boolean|Tt.String),KM=function(e){return IM(Tt.Number|Tt.Boolean|Tt.String,e)};var zM,YM=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),a=this.find(t);if(n!==a){var i=this.roots,o=this.backlinks,u=this.ranks;if(r){var s=o[a];return o[a]=o[n],o[n]=s,i[a]=n,void(u[n]<=u[a]&&(u[n]=u[a]+1))}if(u[n]<u[a]){s=o[n];o[n]=o[a],o[a]=s,i[n]=a}else{s=o[a];o[a]=o[n],o[n]=s,i[a]=n,u[n]===u[a]&&(u[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}(),qM={kind:0},JM={kind:1},QM=function(e){return{kind:2,constraint:e}},XM=hM({error:1}),ZM=hM({}),$M=hM({currency:1}),ew=hM({percentage:1}),tw=hM({date:1});function rw(e,t,r){var n,a=new YM,i=a.makePoint(XM),o=(n=XM,function(e,t){if(0===t.varCount||e===yM)return t;var r=t;for(var a in t.vars){var i=e(a);if(i===n)return n;void 0!==i&&(r=bM(a,r,i))}return r});return{symbolContext:e,typeContext:t,stats:r,uf:a,errorPoint:i,errorUnit:XM,apply:o}}function nw(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function aw(e,t,r,n){return ne(nM.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),qM}function iw(e,t,r,n,a){return t===e.errorUnit?(ne(nM.Root,r===e.errorPoint),void 0!==a&&e.uf.union(e.errorPoint,a,!0),qM):n===e.errorUnit?(ne(nM.Root,a===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),qM):0===t.varCount?0===n.varCount?gM(i=t,o=n)&&gM(o,i)?qM:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==a&&e.uf.union(e.errorPoint,a,!0),JM):(ne(nM.Root,void 0!==a),aw(e,a,t,r)):1===n.varCount?(ne(nM.Root,void 0!==r),ne(nM.Root,void 0!==a),e.uf.union(r,a),qM):(ne(nM.Root,void 0!==r),aw(e,r,n,a));var i,o}function ow(e,t,r){if(!mM(t))return QM({kind:2,unit:t,target:r});var n=nw(e,r),a=e.uf.findWithDescriptor(n),i=a[0],o=a[1];if(1===t.varCount){ne(nM.Root,void 0!==t.name);var u=e.symbolContext.getTable().getValue(t.name);ne(nM.Root,void 0!==u);var s=e.uf.findWithDescriptor(nw(e,u)),l=s[0];return iw(e,s[1],l,o,i)}return iw(e,t,void 0,o,i)}function uw(e){return e!==yR.Unavailable&&0!==e&&("object"!=typeof e||e.valueType!==$p.General)}function sw(e,t,r){var n=e.typeContext.types[t.index];if(void 0===n)return re(nM.Root);var a=n.getValue(r);if(void 0===a){var i=e.typeContext.formats(ya(t,r));if(Se(i)){if(!uw(i.value)){var o=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,KM(o)),o}var u=lw(e,i.value);return void 0===u?u=e.symbolContext.freshSymbol().unit:e.stats.formatCells+=1,e.typeContext.types[t.index]=n.setValue(r,KM(u)),u}var s=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,KM(s)),s}return 0===a.kind?a.unit:void 0}function lw(e,t){var r;if("number"==typeof t){var n=e.typeContext.getIformat(t);if(!Se(n))return;r=n.value}else r=t;switch(r.valueType){case $p.Currency:return $M;case $p.Percentage:return ew;case $p.Accounting:return $M;case $p.Fraction:return ZM;case $p.Date:return tw;default:return}}var cw=((zM={})[2]=function(e,t){return ow(e,t.unit,t.target)},zM[3]=function(e,t){var r=lw(e,t.format);if(void 0===r)return qM;var n=sw(e,t.cell.sheet,t.cell.range);if(void 0===n)return qM;if(!mM(n))return QM(t);if(1===n.varCount){ne(nM.Root,void 0!==n.name);var a=e.symbolContext.getTable().getValue(n.name);ne(nM.Root,void 0!==a);var i=e.uf.findWithDescriptor(nw(e,a)),o=i[0];return iw(e,i[1],o,r,void 0)}return iw(e,n,void 0,r,void 0)},zM[0]=function(e,t){var r=t.type.resolution;if(!xr(r.sheet))return qM;if(Ur(r.range)){var n=sw(e,r.sheet,r.range);return void 0===n?qM:ow(e,n,t.target)}var a=iR(r.range),i=e.typeContext.available[r.sheet.index];if(void 0===i)return qM;var o=jA(a,i.availableCells),u=[];return pR(o,(function(e){return u.push(e),!0})),{kind:3,constraint:{kind:1,cursor:0,index:i.sheetIdx,cells:u,target:t.target},output:void 0}},zM[1]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return qM;var a=n[r],i=sw(e,t.index,a),o=void 0===i?qM:ow(e,i,t.target);return t.cursor+=1,{kind:3,constraint:t,output:o}},zM);function dw(e){return 1===e.kind?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,a=n.apply,i=n.errorUnit,o={kind:2,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=a(o.substitution,e);if(r!==i){var n=a(o.substitution,t);if(n!==i){var u=TM(a,r,n);1!==u.kind?o.stats.errorCount+=1:o.substitution=RM(a,u.substitution,o.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return o}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.deferred,i=t[n],o=cw[i.kind](r,i);switch(o.kind){case 2:a.push(o.constraint);break;case 1:e.stats.errorCount+=1;break;case 3:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case 2:a.push(o.output.constraint);break;case 1:e.stats.errorCount+=1}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.unifyNF,i=t[n];switch(i.kind){case 2:a(i.unit,i.target.unit);break;case 3:var o=lw(r,i.format);if(void 0===o)break;var u=sw(r,i.cell.sheet,i.cell.range);if(void 0===u)break;a(o,u);break;default:return e.constraintCursor+=1,te(nM.Root,i)}return e.constraintCursor+=1,e}(e)}var fw=function(){function e(){this.isDone=!1}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!0,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=[],r={};e.getServerAvailableCells().forEach((function(e){r[e.sheetIdx.index]=e,t.push(e)}));var n=void 0===e.getServerDocument()?function(){return ge(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:0,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:Es(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:r,getIformat:n},constraints:[],stats:{formulaCells:0,formatCells:0,totalCells:0,errorCount:0},sheets:t,mutableState:{symbolContext:hw.init(),cells:void 0,sheetCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return{kind:1,stats:e.stats,context:rw(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,te(nM.Root+"."+nM.Initialised,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case 0:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case 1:return void(this.state=dw(e));case 2:return e.constraintCursor<e.constraints.length?void(this.state=dw(e)):(this.isDone=!0,void(this.statsMessage=JSON.stringify(e.stats)))}}catch(e){return this.statsMessage=nM.Root+"."+nM.Failure+": "+q(e),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e,t){var r=t.mutableState,n=t.stats,a=t.sheets,i=r.sheetCursor,o=[],u=a[i];return e.forEachServerNonBlankCellInSet(u.sheetIdx,u.availableCells,(function(t){var r,a=ya(u.sheetIdx,t),i=e.getServerFormula(a);return i.kind===le.Success&&void 0!==(null===(r=i.value)||void 0===r?void 0:r[1].compiledFmla)&&(o.push(i.value[1]),n.formulaCells+=1),n.totalCells+=1,!0})),t.documentTypeContext.types[u.sheetIdx.index]=CT(),r.cells=o,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){var r=t.sheets,n=t.constraints,a=t.stats,i=t.mutableState,o=i.cells,u=i.sheetCursor,s=i.cellCursor,l=r[u],c=o[s],d=c.compiledFmla.getValue();if(d.kind===le.Success){var f=ya(l.sheetIdx,c.origin),h=function(e,t,r){var n=e.constraints,a=e.locale,i=e.mathpack,o=e.resolver,u=e.documentTypeContext,s=u.types[t.sheet.index],l=e.mutableState.symbolContext.copy(),c={origin:t,locale:a,mathpack:i,resolver:o,symbolContext:l,pushConstraint:function(e){return void 0!==e&&(n.push(e),!0)}},d=function(e,t){return yt(new Cw(e),t)}(c,r),f=gw(c,d),h=function e(t,r){switch(r.kind){case 0:if(void 0===r.unit){var n=t.symbolContext.freshSymbol();return IM(r.flags,n.unit)}return r;case 2:for(var a=r,i=[];2===a.kind;)i.push(a.dimensions),a=a.elementType;var o=e(t,a);return i.reduceRight(OM,o);case 1:case 3:return r;default:return te(nM.Root,r)}}(c,void 0===f?HM:f);if(1===h.kind){var v=l.freshSymbol(),p={kind:0,type:h,target:v};h=KM(v.unit),n.push(p)}if(e.mutableState.symbolContext=l,2===h.kind)return s;return s.setValue(t.range,h)}(t,f,d.value);t.documentTypeContext.types[l.sheetIdx.index]=h;var v=e.getServerFormat(f);v.kind===le.Success&&uw(v.value)&&(n.push({kind:3,cell:f,format:v.value}),a.formatCells+=1)}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.cells}(t))return this.initialiseSheetStep(e,t);var r=t.mutableState;return r.cellCursor<r.cells.length?this.checkCell(e,t):(r.cells=void 0,r.sheetCursor+=1,t)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:nM.Root+"."+nM.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return"Units experiment timed out."},enumerable:!0,configurable:!0}),e}(),hw=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,zl.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t=(void 0===e?"gen":e)+"@"+(this.seed+=1),r={unit:vM(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function vw(e,t,r){switch(e.kind){case 2:if(1===e.elementType.kind)return;return r?vw(e.elementType,t,!1):void 0;case 1:return{kind:0,type:e,target:t};case 0:return void 0===e.unit?void 0:{kind:2,unit:e.unit,target:t};case 3:return;default:return te(nM.Root,e)}}function pw(e,t,r){switch(t.kind){case 2:if(1===t.elementType.kind)return;return r?pw(e,t.elementType,!1):void 0;case 1:var n=e.symbolContext.freshSymbol(),a={kind:0,type:t,target:n};return[n.unit,a];case 0:return void 0===t.unit?void 0:[t.unit,void 0];case 3:return;default:return te(nM.Root,t)}}function mw(e){var t=e.length;if(0===t)return HM;for(var r,n,a=VM,i=e[0].length,o=0;o<e.length;o+=1)for(var u=e[o],s=0;s<u.length;s+=1)r=a,n=u[s],a=r===VM?n:n===VM||r===HM?r:n===HM?n:0===r.kind&&0===n.kind&&void 0===r.unit&&void 0===n.unit?IM(r.flags|n.flags):HM;return OM(a,{rows:t,columns:i,exact:!0})}function gw(e,t){if(1===t.kind&&void 0===t.resolution){var r=function(e,t){var r=us(e.origin),n=e.resolver.resolveCellRef(r,t.reference).resolution;return!!Se(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?function(e,t){var r=FM(e);return r.resolution=t,r}(t.reference,r):r?GM:void 0}if(2===t.kind){var n=gw(e,t.elementType);return void 0===n?n:n===t.elementType?t:OM(n,t.dimensions)}return t}function Sw(e,t,r,n,a){var i=e.symbolContext.freshSymbol(),o=vw(t,i,n),u=vw(r,i,n);if(void 0!==o&&void 0!==u||a&&(void 0!==o||void 0!==u))return e.pushConstraint(o),e.pushConstraint(u),i}function bw(e,t,r){if(r.length<2)return HM;var n=gw(e,r[0][0]),a=gw(e,r[1][0]);if(void 0===n||void 0===a)return HM;var i=wM(n,a);if(!1===i)return HM;var o="object"==typeof i;switch(t){case Qa.Add:case Qa.Sub:case Qa.Min:case Qa.Max:var u=Sw(e,n,a,o,!0);return _M(void 0===u?xM:IM(Tt.Number,u.unit),i);case Qa.Eq:case Qa.Ne:case Qa.Lt:case Qa.Le:case Qa.Gt:case Qa.Ge:return Sw(e,n,a,o,!1),_M(LM,i);case Qa.Mul:case Qa.Div:var s=e.symbolContext.freshSymbol(),l=e.symbolContext.freshSymbol(),c=vw(n,s,o),d=vw(a,l,o);if(e.pushConstraint(c),e.pushConstraint(d),void 0===c&&void 0===d)return _M(xM,i);var f=t===Qa.Mul?SM(s.unit,l.unit):SM(s.unit,function(e){var t=fM(),r=e.vars,n=e.consts;for(var a in r)t.vars[a]=-r[a];for(var a in n)t.consts[a]=-n[a];return t.varCount=e.varCount,uM(nM.Root,t),t}(l.unit));return _M(IM(Tt.Number,f),i);case Qa.Pow:var h=r[1][1];if(mn(h)){var v=e.mathpack.toNumber(h.oper);if(j(v)){var p=pw(e,n,"object"==typeof i);return void 0===p?_M(xM,i):(e.pushConstraint(p[1]),_M(IM(Tt.Number,function(e,t,r){if(0===t)return r;var n=fM(),a=e.vars,i=e.consts;for(var o in a)n.vars[o]=a[o]*t;for(var o in i)n.consts[o]=i[o]*t;return n.varCount=e.varCount,uM(nM.Root,n),n}(p[0],v,BM)),i))}}return HM;case Qa.Range:case Qa.Isect:case Qa.Union:return HM;case Qa.Concat:return _M(PM,i);case Qa.And:case Qa.Or:case Qa.Xor:return _M(LM,i);default:return te(nM.Root,t)}}function yw(e,t,r){switch(t){case Qa.Add:case Qa.Sub:case Qa.Mul:case Qa.Div:case Qa.Pow:case Qa.Eq:case Qa.Ne:case Qa.Lt:case Qa.Le:case Qa.Gt:case Qa.Ge:case Qa.Range:case Qa.Isect:case Qa.Union:case Qa.Concat:case Qa.And:case Qa.Or:case Qa.Xor:case Qa.Min:case Qa.Max:return bw(e,t,r);case Qa.Percent:case Qa.Neg:case Qa.Pos:case Qa.At:case Qa.Pound:return function(e,t,r){if(r.length<1)return HM;var n=gw(e,r[0][0]);if(void 0===n)return HM;var a=MM(n);if(!1===a)return HM;switch(t){case Qa.Percent:return _M(UM,a);case Qa.Neg:case Qa.Pos:var i=pw(e,n,"object"==typeof a);return void 0===i?_M(xM,a):(e.pushConstraint(i[1]),_M(IM(Tt.Number,i[0]),a));case Qa.At:case Qa.Pound:return HM;default:return te(nM.Root,t)}}(e,t,r);default:return te(nM.Root,t)}}var Cw=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Ue(t,e)},this.lazyVisitFormulaNode=function(e){return Oe.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){return Oe.resolve(function(e){switch(e.kind){case Tt.Number:return xM;case Tt.String:return PM;case Tt.Boolean:return LM;case Tt.Error:return GM;default:return jM}}(e))},e.prototype.arrayNode=function(e){var t=this;return Oe.all(e.map((function(e){return Oe.all(e.map(t.lazyVisitFormulaNode))}))).bind(mw)},e.prototype.appNode=function(e,t){var r=this;return e.kind===kt.Operator?Oe.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return yw(r.context,e.id,t)})):e.kind===kt.WSF?Oe.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return function(e,t,r){switch(t){case Ka.SUM:case Ka.AVERAGE:case Ka.MAX:case Ka.MIN:if(0===r.length)return HM;var n=e.symbolContext.freshSymbol(),a=!0;return r.forEach((function(t){var r=gw(e,t);r&&e.pushConstraint(vw(r,n,!0))&&(a=!1)})),a?xM:IM(Tt.Number,n.unit);case Ka.IF:if(r.length<2)return HM;var i=gw(e,r[0]),o=gw(e,r[1]),u=gw(e,void 0===r[2]?LM:r[2]);if(void 0===i)return void 0!==o&&void 0!==u&&Sw(e,o,u,!0,!1),HM;var s=MM(i),l="object"==typeof s;if(void 0===o||void 0===u)return HM;var c=Sw(e,o,u,!0,!0),d=c?KM(c.unit):WM;return l?OM(d,s):d;default:return HM}}(r.context,e.id,t)})):Oe.resolve(HM)},e.prototype.letNode=function(e,t,r,n){return Oe.resolve(HM)},e.prototype.lambdaNode=function(e,t,r,n){return Oe.resolve(HM)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return Oe.resolve(HM)},e.prototype.cellRefNode=function(e,t){return Oe.resolve(FM(Sr(e,t)))},e.prototype.fieldRefNode=function(e,t){return Oe.resolve(HM)},e.prototype.structRefNode=function(e,t){return Oe.resolve(HM)},e.prototype.badSequenceNode=function(e,t){return Oe.resolve(HM)},e.prototype.badStringNode=function(e,t){return Oe.resolve(HM)},e.prototype.operatorNode=function(e,t){return Oe.resolve(lr(e,t))},e.prototype.wsfNode=function(e,t,r){return Oe.resolve(cr(e,t,r))},e}();var kw,Ew=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given "+t;ee.ULS.traceTag(591974878,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=N();N()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(kw||(kw={}));var Aw={TestExperiment:function(e){return{kind:kw.OneShot,create:function(){return Ew.create(e)}}},ExceLintExperiment:function(){return{kind:kw.OneShot,create:function(){return new aM}}},UnitExperiment:function(){return{kind:kw.OneShot,create:function(){return new fw}}},AutocompleteExperiment:void 0};function Rw(e,t){Aw[e]=t}var Nw,Tw=ha(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(Nw||(Nw={}));var Iw,Fw,Ow,Dw=xn,Mw=$e(Object(fe.a)(Object(fe.a)({},Je(!1)),{wsfNode:function(e){return e===Ka.HYPERLINK}}),(function(e,t){return e||t}));!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo"}(Iw||(Iw={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalFormula=6]="ComputeEvalFormula",e[e.RecalcFinished=7]="RecalcFinished",e[e.CompleteDataQuery=8]="CompleteDataQuery",e[e.MaybeCollectGarbage=9]="MaybeCollectGarbage",e[e.RunExperiment=10]="RunExperiment",e[e.TestAdvanceState=11]="TestAdvanceState"}(Fw||(Fw={})),function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(Ow||(Ow={}));var ww,_w,Lw,Pw,xw,Bw,Uw=function(){function e(e,t,r,n,a){var i,o,u=this,s=n.date1904,l=n.dateCompatibility,c=n.timezone,d=n.datepack;void 0===a&&(a={}),this.scheduler=new YD,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.numPrecisionFailures=0,this.printFormulaProperties=function(e){var t=un(e),r=u.getAvailableFormula(t);if(Se(r)){var n=r.value,a=n[0],i=n[1],o=i.compiledFmla.getValue(),s=Se(o)?u.docs.printFormulaBarText(a,t.range,o.value):o;return{formulaBarText:s.kind===le.Success?s.value:void u.outputMessageLog.push({kind:kR.PrintFormulaFailure,stateId:u.stateId,range:e,reason:s.reason}),hasHyperlink:u.formulaHasHyperlink(i),isFormula:!0}}u.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,a=u.docs.getEditedFormula(e);if(Se(a)){var i=null!==(n=null===(r=a.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",o=u.docs.renderValueBarText(e,t,i);return{formulaBarText:Se(o)?o.value:void u.outputMessageLog.push({kind:kR.PrintFormulaFailure,stateId:u.stateId,range:e,reason:o.reason}),hasHyperlink:!1,isFormula:!1}}u.onUnavailableObject(a.reason)},this.scheduleAvailableFormulas=function(e,t){var r=u.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=ya(e.sheet,r),a=u.docs.getEditedFormula(n);return a.kind===le.Failure?(u.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&u.enqueueComputeCellValue(n,t),!0)}));Se(r)||u.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=u.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=ya(e.sheet,r),a=u.docs.getEditedFormula(n);return a.kind===le.Failure?(u.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||u.enqueueReturnCellValue(n,t),!0)}));Se(r)||u.onUnavailableObject(r.reason)},this.docs=new UD(gu(e,r,t,s,l,c,d),this,a,a,null!==(i=a.maxDereferenceCells)&&void 0!==i?i:32768,null!==(o=a.isServerWorkbookLoad)&&void 0!==o&&o),this.reconfigure(a)}return e.prototype.reconfigure=function(e){var t,r;this.config=e,this.rng=new de(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:32768,null!==(r=e.isServerWorkbookLoad)&&void 0!==r&&r)},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==uR.EvalFormula&&this.outputMessageLog.push({kind:kR.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){a.computeKind!==uR.EvalFormula&&this.outputMessageLog.push({kind:kR.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:kR.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:kR.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=Dw([e]);this.outputMessageLog.push({kind:kR.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,a){if(a.computeKind!==uR.EvalFormula){var i=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==i?(this.outputMessageLog.push({kind:kR.RecalcStatistics,message:SR.ChangedCell,stateId:this.stateId,cellKind:n}),n!==sR.EditedCell&&n!==sR.DependentCell||this.outputMessageLog.push(Object(fe.a)(Object(fe.a)({kind:kR.CellWrite,stateId:this.stateId,cellKind:n,cell:e},i),{formatted:this.formatValue(n,e,t)}))):this.outputMessageLog.push({kind:kR.RecalcStatistics,message:SR.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this;if(a.computeKind!==uR.EvalFormula){var o=this.outputRange(e,t,n);void 0!==o&&(n!==sR.EditedCell&&n!==sR.DependentCell||this.outputMessageLog.push(Object(fe.a)(Object(fe.a)({kind:kR.RangeWrite,stateId:this.stateId,cellKind:n,range:e},o),{formatted:t.map((function(t,r){return t.map((function(t,a){return i.formatValue(n,ya(e.sheet,va(e.range.row+r,e.range.col+a)),t)}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var n=this,a=this.outputCell(e,t,r,(function(){return n.printValueProperties(e,t)}));void 0!==a?(this.outputMessageLog.push({kind:kR.RecalcStatistics,message:SR.ChangedCell,stateId:this.stateId,cellKind:sR.EditedCell}),r===sR.EditedCell&&this.outputMessageLog.push(Object(fe.a)(Object(fe.a)({kind:kR.CellWrite,stateId:this.stateId,cellKind:sR.EditedCell,cell:e},a),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:kR.RecalcStatistics,message:SR.UnchangedCell,stateId:this.stateId,cellKind:sR.EditedCell})},e.prototype.createSnapshot=function(e){var t=this;return void 0===e&&(e=Ow.Client),new Promise((function(r){t.scheduler.addTask(Fw.CompleteDataQuery,jD.Back,{onRun:function(){r(t.docs.clone(xD,e))},onDeleted:function(){r(void 0)}})}))},e.prototype.outputCell=function(e,t,r,n){var a;if(r===sR.EditedCell||r===sR.DependentCell){var i=this.docs.testAndSetClientValue(e,t);a=Se(i)?i.value?t:void 0:void this.onUnavailableObject(i.reason)}var o=this.outputFormat(e,r),u=this.outputFormulaProperties(e,r,n);return void 0!==a||void 0!==o||void 0!==u?{value:t,format:o,formulaBarText:null==u?void 0:u.formulaBarText,hasHyperlink:null==u?void 0:u.hasHyperlink}:void 0},e.prototype.outputRange=function(e,t,r){var n=this;if(r===sR.EditedCell||r===sR.DependentCell){var a=this.docs.setClientValue(e,t);Se(a)||this.onUnavailableObject(a.reason)}var i=t.map((function(t,a){return t.map((function(t,i){return n.outputFormat(ya(e.sheet,va(e.range.row+a,e.range.col+i)),r)}))})),o=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:i,formulaBarText:null==o?void 0:o.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===sR.EditedCell){var r=this.docs.getEditedFormat(e);if(Se(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if(Se(n)){if(n.value){var a=r.value;if(a===yR.Unavailable)return{format:Dw([{kind:Nw.CellFormat}]),valueType:$p.Custom,decimals:0};var i=this.docs.resolveCellFormat(e.sheet.document,a);return Se(i)?{format:"number"==typeof a?a:a.formatString,valueType:i.value.valueType,decimals:i.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===sR.EditedCell){var n=r(e);if(void 0!==n){var a=n.formulaBarText,i=n.hasHyperlink,o=n.isFormula,u=this.docs.testAndSetClientFormula(e,a,i);if(Se(u)){var s=u.value,l=s.hasFmlaChanged,c=s.hasHyperlinkChanged;return l||c?{formulaBarText:l?a:void 0,hasHyperlink:c?i:void 0,isFormula:o}:void 0}this.onUnavailableObject(u.reason)}}},e.prototype.formatValue=function(e,t,r){var n=this.docs.formatValueCell(t,r);if(Se(n))return n.value;this.outputMessageLog.push({kind:kR.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:n.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!Se(t))return t;if(void 0===t.value)return ge({kind:Nw.CellMissingFormula});var r=t.value,n=r[0],a=r[1];return void 0===a.compiledFmla?ge({kind:Nw.CellEvaluatingValue}):he([aa(a.lexicalKind,ba(e.sheet,n)),a])},e.prototype.formulaHasHyperlink=function(e){if(e.lexicalKind!==Xn.Cell)return!1;var t=null==e?void 0:e.compiledFmla.getValue();return Se(t)?St(Mw,t.value):void 0},e.prototype.handleSetCellContents=function(e,t,r,n,a,i,o,u,s,l){var c,d,f,h,v=void 0!==s?Dw([{kind:Nw.ClientFailure,reason:s}]):void 0,p=o;void 0!==n?(d=n,ne("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==a),f=a):void 0===r?(ne("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===a&&void 0!==o&&void 0===v),d=!1,f=void 0):(ne("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===v&&p===yR.Weak),d=(c=this.parseInferredEdit(t,r,i,v,p)).isFormula,f=c.oper,v=c.cellFailure,p=c.cellFormat,h=c.inferredFormat);var m=this.docs.setCellContents(e,t,r,d,i,f,v,p,u,l);if(m.kind===le.Failure)return this.onUnavailableObject(m.reason);if(this.docs.onCellModified(e),!e){var g=ya(t.sheet,i),S=void 0===r?he(void 0):d?this.docs.inferFormulaFormat(g):void 0!==h&&h!==yi.General?this.docs.resolveValueFormat(t.sheet.document,h):he(void 0);S.kind!==le.Success&&(this.onInferFormatFailure(g,S.reason),S=he(yR.Unavailable)),void 0!==S.value&&this.docs.fillInferredFormat(t,S.value),this.enqueueBeforeCompute(l)}},e.prototype.parseInferredEdit=function(e,t,r,n,a){var i=this.docs.parseInferredEdit(ya(e.sheet,r),t,this.getVolatileMode());if(!Se(i))return{isFormula:!1,oper:Ya,cellFailure:i.reason,cellFormat:yR.Unavailable};switch(i.value.kind){case km.Formula:return{isFormula:!0,oper:Ya,cellFailure:n,cellFormat:a};case km.String:case km.Other:return{isFormula:!1,oper:i.value.value,cellFailure:n,cellFormat:a};case km.Number:return{isFormula:!1,oper:i.value.value,cellFailure:n,cellFormat:a,inferredFormat:i.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,a){var i=$R(r);ne("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);var o=e?void 0:Ya,u=e?void 0:yR.Weak,s=e?void 0:CR.Weak,l=this.docs.setRangeFormula(e,t,r,n,o,u,s,a);if(l.kind===le.Failure)return this.onUnavailableObject(l.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)},e.prototype.handleEditPaste=function(e,t,r,n){var a=ba(t.sheet,ha(t.range.row,t.range.col,r.range.rows,r.range.cols)),i=this.docs.copyRange(r);if(i.kind===le.Failure)return this.onUnavailableObject(i.reason);var o=this.docs.pasteRange(a,i.value);if(o.kind===le.Failure)return this.onUnavailableObject(o.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)},e.prototype.evalFormula=function(e,t,r,n){var a=this;return new Promise((function(i){var o=function(){return i({value:ge(Dy)})};a.scheduler.deleteTasks(Fw.EvalFormula,void 0),a.scheduler.addTask(Fw.EvalFormula,jD.Back,{onRun:function(){if(!a.trySetStateId(Fw.EvalFormula,e))return o();a.enqueueComputeEvalFormula(t,r,n,i)},onDeleted:o}),a.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(Fw.BeforeCompute,void 0),this.scheduler.addTask(Fw.BeforeCompute,jD.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,uR.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,uR.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,uR.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=N();try{r=e()}finally{this.stateEvalTime+=E(1,N()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(Iw.EvalTimedOut),this.outputMessageLog.push({kind:kR.RecalcStatistics,stateId:this.stateId,message:SR.StateTimedOut}),r=[])}return r},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,a=t===uR.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?Do("calc.calc.PartialWorkbook: recalc edited"):void 0,i=!0,o=function(){return n.docs.evaluate(t,e,n.getVolatileMode())},u=function(){if(i){i=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?Do("calc.calc.PartialWorkbook: cell eval"):void 0;var t=n.docs.getEditedFormula(e);if(!Se(t))return n.onUnavailableObject(t.reason);if(void 0===t.value)return}else n.outputMessageLog.push({kind:kR.RecalcStatistics,stateId:n.stateId,message:SR.ContinueComputation});var s=n.withEvalTiming(o);if(Array.isArray(s))return null==r||r.stop(),void(null==a||a.stop());o=s.resume,n.scheduler.addTask(Fw.ComputeCellValue,jD.Front,u)};this.scheduler.addTask(Fw.ComputeCellValue,jD.Back,u)},e.prototype.enqueueComputeEvalFormula=function(e,t,r,n){var a=this,i=this.getVolatileMode(),o=function(){return a.docs.evalFormula(e,t,r,i)},u={onRun:function(){var e=o();e.kind===le.Paused?(o=e.resume,a.scheduler.addTask(Fw.ComputeEvalFormula,jD.Front,u)):n(e.value)},onDeleted:function(){return n({value:ge(Dy)})}};this.scheduler.addTask(Fw.ComputeEvalFormula,jD.Back,u)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,n=this.getVolatileMode();this.scheduler.addTask(Fw.ComputeCellValue,jD.Back,(function(){r.docs.evalValue(e,t,n)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(Fw.AfterCompute,Iw.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?Do("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(Fw.AfterCompute,jD.Back,{onRun:function(){null==t||t.stop(Iw.EvalFinished),e.outputMessageLog.push({kind:kR.RecalcStatistics,message:SR.EditFinished,stateId:e.stateId})},onDeleted:function(e){null==t||t.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(Fw.RecalcFinished,void 0),this.scheduler.addTask(Fw.RecalcFinished,jD.Back,(function(){e.outputMessageLog.push({kind:kR.RecalcStatistics,message:SR.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var a=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(a.trySetStateId(Fw.ServerUpdate,e)){var i=a.docs.promoteServerAvailability(r,n);if(i.kind===le.Failure)return a.onUnavailableObject(i.reason);a.docs.onCellModified(!0),i.value||a.outputMessageLog.push({kind:kR.UpdateRequest,stateId:a.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,a,i,o,u,s){var l=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){l.trySetStateId(Fw.ServerUpdate,e)&&l.handleSetCellContents(!0,t,r,n,i,a,o,u,s,void 0)}))},e.prototype.editCellContents=function(e,t,r,n,a,i,o){var u=this;void 0===i&&(i=Ya),void 0===o&&(o=ba(t.sheet,Tw)),this.lastViewport=o,this.scheduler.addTask(Fw.ClientEdit,jD.Back,(function(){u.trySetStateId(Fw.ClientEdit,e)&&u.handleSetCellContents(!1,t,r,n,i,a,yR.Weak,CR.Weak,void 0,o)})),this.enqueueRecalcFinished()},e.prototype.editCellFormats=function(e,t,r,n,a){var i=this;void 0===a&&(a=ba(t.sheet,Tw)),this.lastViewport=a,this.scheduler.addTask(Fw.ClientEdit,jD.Back,(function(){if(i.trySetStateId(Fw.ClientEdit,e)){var o="SetFormat"===r.kind?i.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?i.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,ya(t.sheet,n)):"ChangeDecimals"===r.kind?i.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,ya(t.sheet,n)):te("calc.calc.PartialWorkbook: editCellFormats",r);Se(o)||vR(t.set,(function(e){return i.onInferFormatFailure(ba(t.sheet,e),o.reason),!0})),Se(o)&&void 0===o.value||i.handleSetCellContents(!1,t,void 0,void 0,void 0,va(0,0),Se(o)?o.value:yR.Unavailable,void 0,void 0,a)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=on(t.range)),void 0===a&&(a=!1),this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){i.trySetStateId(Fw.ServerUpdate,e)&&i.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=on(t.range)),void 0===a&&(a=ba(t.sheet,Tw)),this.lastViewport=a,this.scheduler.addTask(Fw.ClientEdit,jD.Back,(function(){i.trySetStateId(Fw.ClientEdit,e)&&i.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()},e.prototype.editPaste=function(e,t,r,n,a){var i=this;void 0===a&&(a=ba(r.sheet,Tw)),this.scheduler.addTask(Fw.ClientEdit,jD.Back,(function(){i.trySetStateId(Fw.ClientEdit,e)&&i.handleEditPaste(t,r,n,a)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(Fw.TestAdvanceState,jD.Back,(function(){t.trySetStateId(Fw.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(t,r){var n,a,i,o,u,s=this;if(r<this.stateId)return!1;if(t===Fw.ClientEdit&&(this.deleteComputeTasks(Iw.EditReceived),this.stateEvalTime=0),r>this.stateId){if(this.stateId!==-1/0){var l=this.config.sampleWorkbookStatisticsRate;void 0!==l&&this.shouldSample(l)&&this.outputMessageLog.push({kind:kR.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:l})}2===this.stateChanges&&this.enqueueRunExperiments(kw.OneShot),this.stateChanges>=2&&0===this.scheduler.getCount(Fw.RunExperiment)&&this.enqueueRunExperiments(kw.Recurring);var c=null!==(n=this.config.samplePrecisionEvalRate)&&void 0!==n?n:0,d=null!==(a=this.config.samplePrecisionPrintFormulaRate)&&void 0!==a?a:0,f=null!==(i=this.config.samplePrecisionPrintValueRate)&&void 0!==i?i:0;if(this.stateChanges>=2&&(c>0||d>0||f>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&0===this.scheduler.getCount(Fw.RunExperiment)){var h=this.config.experimentFactories,v=null!==(o=null==h?void 0:h.stepBudget)&&void 0!==o?o:10,p=null!==(u=null==h?void 0:h.totalBudget)&&void 0!==u?u:1e4,m=new eM({samplePrecisionEvalRate:c,samplePrecisionPrintFormulaRate:d,samplePrecisionPrintValueRate:f}),g={stateId:this.stateId,documents:this.docs.clone(m),stepBudget:v,totalBudget:p,viewport:this.lastViewport};m.setContext(g),this.enqueueRunExperiment(v,p,kw.Precision,m,(function(){return s.numPrecisionFailures=0}),(function(){return s.numPrecisionFailures+=1}))}this.deleteComputeTasks(Iw.StateIdAdvanced),this.lastViewport=void 0;var S=this.stateId;this.stateId=r,this.docs.advanceState(S),this.outputMessageLog.push({kind:kR.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(Fw.BeforeCompute,void 0),this.scheduler.deleteTasks(Fw.ComputeCellValue,void 0),this.scheduler.deleteTasks(Fw.AfterCompute,e),e!==Iw.EvalTimedOut&&this.scheduler.deleteTasks(Fw.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r,n,a,i){var o=this,u=0,s=function(){var e=n.failedLogMessage;void 0!==e&&o.outputMessageLog.push({kind:kR.ExperimentRunResult,experimentKind:r,logMessage:e})},l=function(){if(n.done){var c=n.resultLogMessage;return void 0!==c&&o.outputMessageLog.push({kind:kR.ExperimentRunResult,experimentKind:r,logMessage:c}),void a()}for(var d=N(),f=d,h=0;h<1e3&&f===d;h+=1){n.step();var v=N();if(v-f>=e&&!n.done)return s(),void i();f=v}if((u+=f>d?f-d:1)>=t&&!n.done)return s(),void i();o.scheduler.addTask(Fw.RunExperiment,jD.Front,l)};this.scheduler.addTask(Fw.RunExperiment,jD.Back,l)},e.prototype.enqueueRunExperiments=function(e){if(this.config.experimentFactories){var t=this.config.experimentFactories,r=t.stepBudget,n=t.totalBudget,a=t.factories.filter((function(t){var r,n;return t.kind===e&&(null!==(r=t.numFailures)&&void 0!==r?r:0)<(null!==(n=t.maxFailures)&&void 0!==n?n:3)}));if(0!==a.length)for(var i={stateId:this.stateId,documents:this.docs.clone(xD,e===kw.OneShot?Ow.Server:Ow.Client),stepBudget:r,totalBudget:n,viewport:this.lastViewport},o=function(t){var a=t.create();if(!a)return"continue";a.setContext(i),u.enqueueRunExperiment(r,n,e,a,(function(){return t.numFailures=0}),(function(){var e;return t.numFailures=(null!==(e=t.numFailures)&&void 0!==e?e:0)+1}))},u=this,s=0,l=a;s<l.length;s++){o(l[s])}}},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(n.trySetStateId(Fw.ServerUpdate,r)){var a=n.docs.setSheetNames(e,t);a.kind===le.Failure&&n.onUnavailableObject(a.reason),n.deleteComputeTasks(Iw.SetSheetNames)}}))},e.prototype.setRefStyle=function(e,t,r){var n=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(n.trySetStateId(Fw.ServerUpdate,r)){var a=n.docs.config,i=a.localeInfo,o=a.mathpack,u=a.date1904,s=a.dateCompatibility,l=a.timezone,c=a.datepack;n.docs.setConfig(e,gu(i,t,o,u,s,l,c)),n.docs.clearCompiledFormulas(),n.deleteComputeTasks(Iw.SetRefStyle)}}))},e.prototype.setLocaleInfo=function(e,t,r){var n=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(n.trySetStateId(Fw.ServerUpdate,r)){var a=n.docs.config,i=a.refStyle,o=a.mathpack,u=a.date1904,s=a.dateCompatibility,l=a.timezone,c=a.datepack;n.docs.setConfig(e,gu(t,i,o,u,s,l,c)),n.docs.clearCompiledFormulas(),n.docs.clearCompiledNumberFormats(),n.deleteComputeTasks(Iw.SetLocaleInfo)}}))},e.prototype.setWorkbookProps=function(e,t,r){var n=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(n.trySetStateId(Fw.ServerUpdate,r)){var a=n.docs.config,i=a.localeInfo,o=a.refStyle,u=a.mathpack,s=a.datepack,l=t.date1904,c=t.dateCompatibility,d=t.timezone;n.docs.setConfig(e,gu(i,o,u,l,c,d,s))}}))},e.prototype.setNumberFormats=function(e,t,r,n){var a=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(a.trySetStateId(Fw.ServerUpdate,n)){var i=a.docs.setNumberFormats(e,t,r);return i.kind===le.Failure?a.onUnavailableObject(i.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,n){var a=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(a.trySetStateId(Fw.ServerUpdate,e)){var i=a.docs.setNamedObject(!0,Aa(t,r),n);return i.kind===le.Failure?a.onUnavailableObject(i.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(r.trySetStateId(Fw.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===le.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(n.trySetStateId(Fw.ServerUpdate,e)){var a=n.docs.promoteNamedObjects(t,r);if(a.kind===le.Failure)return n.onUnavailableObject(a.reason);a.value||n.outputMessageLog.push({kind:kR.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(r.trySetStateId(Fw.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===le.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(r.trySetStateId(Fw.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===le.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeHiddenCols=function(e,t){var r=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(r.trySetStateId(Fw.ServerUpdate,e)){var n=r.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return n.kind===le.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(Fw.ServerUpdate,jD.Back,(function(){if(r.trySetStateId(Fw.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===le.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(Fw.MaybeCollectGarbage,void 0),this.scheduler.addTask(Fw.MaybeCollectGarbage,jD.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:kR.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var a=t.sheet,i=iR(t.range),o=0,u=e;o<u.length;o++){$r(a,(c=u[o]).sheet)&&n(mR(a,jA(c.set,i)),r)}else for(var s=0,l=e;s<l.length;s++){var c;n(c=l[s],r)}},e.prototype.getVolatileMode=function(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:LD.Estimation},e.maxPrecisionFailures=3,e}();function Gw(e){return b(e)&&"function"==typeof e.then}function jw(e,t){return Gw(e)?e.then(t):t(e)}function Vw(e){return new Promise((function(t){return setTimeout(t,e)}))}function Hw(e,t){var r,n=t&&t.timeThreshold||10,a=t&&t.costThreshold||1,i=t&&t.macrotaskDelay||0,o={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},u=[new Promise((function(e,t){return r=[e,t]})),r],s=u[0],l=u[1],c=l[0],d=l[1];var f=!0;var h=Vw(i),v=N();return function t(){if(!f||!function(){try{for(var t=0;t<a;){o.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return d(e),!1}}())return c();var r=N();r-v<n?(Promise.resolve().then(t),o.microtaskContinues+=1):(h.then((function(){h=Vw(i),v=N(),o.macrotaskTotalDelay+=v-r,t()})),o.macrotaskContinues+=1)}(),{promise:s,stop:function(){f=!1},stats:o}}!function(e){e[e.FunctionMessage=0]="FunctionMessage"}(ww||(ww={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(_w||(_w={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.HighlightPlugin=2]="HighlightPlugin",e[e.DragPlugin=3]="DragPlugin",e[e.ConfigTestPlugin=4]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=5]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=6]="FeatureGateTestPlugin"}(Lw||(Lw={})),function(e){e[e.Done=0]="Done",e[e.Superseded=1]="Superseded"}(Pw||(Pw={})),function(e){e.GetSheetNames="GetSheetNames",e.GetRange="GetRange",e.Delay="Delay",e.GetCell="GetCell",e.GetContainingTable="GetContainingTable",e.GetIformat="GetIformat",e.ParseCellFormula="ParseCellFormula",e.ParseEdit="ParseEdit",e.ParseNumberFormat="ParseNumberFormat",e.PrintFormula="PrintFormula",e.GetActiveCell="GetActiveCell",e.GetConfig="GetConfig",e.AwaitPromise="AwaitPromise",e.GetFunctionsInfo="GetFunctionsInfo",e.GetFunctionInfo="GetFunctionInfo",e.GetCorrelationId="GetCorrelationId"}(xw||(xw={})),function(e){e.setActiveCell="setActiveCell",e.doNothing="doNothing",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.setFunctionsInfo="setFunctionsInfo",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.recalcServiceAttached="recalcServiceAttached"}(Bw||(Bw={}));var Ww;Bw.setActiveCell,Bw.doNothing,Bw.setFunctionsInfo;function Kw(e,t){var r;return Object(fe.d)(this,(function(n){switch(n.label){case 0:return[4,Object(fe.a)({kind:e},t)];case 1:return ne("Response kind coincides with request kind",(r=n.sent()).kind===e),[2,r]}}))}function zw(e){var t;return Object(fe.d)(this,(function(r){switch(r.label){case 0:return[4,{kind:xw.AwaitPromise,promise:e}];case 1:return ne("Response kind coincides with request kind",(t=r.sent()).kind===xw.AwaitPromise),[2,t.result]}}))}function Yw(e){var t,r,n,a;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return r=void 0!==t?e.next(t):e.next(),[4,{kind:xw.AwaitPromise,promise:r}];case 1:return ne("Response kind coincides with request kind",(n=i.sent()).kind===xw.AwaitPromise),!0===(a=n.result).done?[2,a.value]:[4,a.value];case 2:return t=i.sent(),[3,0];case 3:return[2]}}))}function qw(e){return Kw(xw.GetRange,{range:e})}function Jw(){return Kw(xw.GetSheetNames,{})}function Qw(e){return Kw(xw.GetCell,{cell:e})}function Xw(){return Kw(xw.Delay,{})}!function(e){e.functionSuggestion="functionSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance"}(Ww||(Ww={}));var Zw,$w={kind:xw.Delay};function e_(e,t,r){return void 0===r&&(r=!1),Kw(xw.ParseCellFormula,{cell:e,formula:t,useEnglishLocaleInfo:r})}var t_=((Zw={})[Lw.TestPlugin]=Ww.functionSuggestion,Zw[Lw.AutocompletePlugin]=Ww.functionSuggestion,Zw[Lw.HighlightPlugin]=Ww.formulaHighlighting,Zw[Lw.DragPlugin]=Ww.functionSuggestion,Zw[Lw.ConfigTestPlugin]=Ww.functionSuggestion,Zw[Lw.FeatureGateTestPlugin]=Ww.functionSuggestion,Zw[Lw.ArgumentAssistancePlugin]=Ww.argumentAssistance,Zw),r_="Main";var n_=h();function a_(e){var t=e.factoryName,r=n_[t];if(void 0!==r&&r!==e){var n="x10arch.registerPluginFactory: "+Lw[t]+" is already registered on "+r_;throw ee.ULS.traceTag(557056859,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Error,n),new Error(n)}n_[t]=e;var a="x10arch.registerPluginFactory: registered "+Lw[t]+" on "+r_;ee.ULS.traceTag(571246212,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,a)}var i_,o_,u_=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var a=n,i=1+(n<<1),o=2+(n<<1);if(i<=r&&this.cmp(this.items[i],t)<0&&(a=i),o<=r&&this.cmp(this.items[o],a===i?this.items[a]:t)<0&&(a=o),n===a)break;this.items[n]=this.items[a],n=a}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}(),s_=function(){function e(e){this.min=0,this.max=0,this.heap=new u_((function(t,r){var n=t[0],a=t[1],i=r[0],o=r[1],u=e(n,i);return 0!==u?u:a-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e}(),l_={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setImmediate.apply(void 0,e)},setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setTimeout.apply(void 0,e)},clearImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return clearImmediate.apply(void 0,e)},clearTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return clearTimeout.apply(void 0,e)}};function c_(e,t){return{kind:e,handle:t}}function d_(e){return void 0!==e?(e.kind=i_.NoWorkScheduled,e.handle=void 0,e):c_(i_.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(i_||(i_={})),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(o_||(o_={}));var f_,h_,v_,p_=Promise.resolve(),m_=function(){function e(e,t){var r=this;void 0===t&&(t=l_),this.timer=t,this.handleState=d_(),this.clearHandleClosureAndRunBody=function(){var t;switch(r.handleState.kind){case i_.NoWorkScheduled:t=o_.Sync;break;case i_.PromiseScheduled:t=o_.MicroTask;break;case i_.ImmediateScheduled:case i_.FutureScheduled:t=o_.MacroTask;break;default:te("Unknown handle state",r.handleState)}r.handleState=d_(r.handleState),e(t)},this.promiseClosure=function(){r.handleState.kind===i_.PromiseScheduled&&r.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case i_.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case i_.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case i_.PromiseScheduled:return;case i_.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case i_.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=i_.PromiseScheduled,e.handle=void 0,e):c_(i_.PromiseScheduled,void 0),p_.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case i_.ImmediateScheduled:return;case i_.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=i_.ImmediateScheduled,t.handle=e,t):c_(i_.ImmediateScheduled,e))},e.prototype.runNextInFuture=function(e){switch(this.handleState.kind){case i_.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case i_.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=i_.FutureScheduled,r.handle=t,r):c_(i_.FutureScheduled,t))},e.prototype.clear=function(){switch(this.handleState.kind){case i_.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case i_.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=d_(this.handleState)},e}(),g_=Object(fe.a)(Object(fe.a)({},l_),{now:N}),S_=function(){function e(e,t,r,n){var a,i,o=this;void 0===n&&(n=g_),this.cmp=e,this.consumeMessage=t,this.timer=n,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new s_((function(t,r){var n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=null!==(a=null==r?void 0:r.costThreshold)&&void 0!==a?a:1,this.timeThreshold=null!==(i=null==r?void 0:r.timeThreshold)&&void 0!==i?i:10,this.scheduler=new m_((function(e){o.totalSyncCost=0,o.lastFutureAbsoluteTime=void 0,e===o_.MacroTask&&(o.startTime=void 0),o.continue()}),n)}return e.prototype.enqueue=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.push=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.pop=function(){var e;return 1===this.queue.getCount()&&this.scheduler.clear(),null===(e=this.queue.pop())||void 0===e?void 0:e.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var e;for(this.startTime=null!==(e=this.startTime)&&void 0!==e?e:this.now();this.totalSyncCost<this.costThreshold;){var t=this.queue.peek();if(void 0===t)return;if(t.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(t.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=t.abstractCost,this.consumeMessage(t.payload)}var r=this.queue.peek();if(void 0!==r){var n=this.now();n-this.startTime<this.timeThreshold&&r.delayUntil<=n?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(r.delayUntil,n)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}();!function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.RecalcServiceRequest=1]="RecalcServiceRequest",e[e.LocalServiceRequest=2]="LocalServiceRequest",e[e.StepPlugin=3]="StepPlugin",e[e.StopPlugins=4]="StopPlugins"}(f_||(f_={})),function(e){e[e.Function=3]="Function",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table"}(h_||(h_={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(v_||(v_={}));var b_,y_,C_={formulaHighlighting:function(e){if(1===e.length){var t=e[0][1];return{tokens:t.tokens,colors:t.colors,styles:t.styles}}if(0===e.length)return null;throw new Error("Conflict resolver: formula highlighting: "+e.length+" results received, while only one active plugin is currently supported")},functionSuggestion:function(e){for(var t=[],r=[],n=0,a=e;n<a.length;n++){var i=a[n],o=i[0],u=i[1];s(o)===v_.Smart?b(u.items)&&u.items.filter(b).forEach((function(e){return t.push(Object(fe.a)(Object(fe.a)({},e),{type:v_.Smart}))})):b(u.items)&&u.items.filter(b).forEach((function(e){return r.push(Object(fe.a)(Object(fe.a)({},e),{type:v_.Simple}))}))}return{items:Object(fe.f)(t,r)};function s(e){switch(e){case Lw.AutocompletePlugin:return v_.Smart;case Lw.TestPlugin:case Lw.DragPlugin:case Lw.ConfigTestPlugin:case Lw.FeatureGateTestPlugin:return v_.Simple;default:te("unknown plugin factory name: "+e,e)}}},argumentAssistance:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: argumentAssistance: "+e.length+" results received, while only one active plugin is currently supported")}},k_=function(){function e(){var e=this;this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),Gw(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),Gw(e)?this.promise.then():void 0},e}();!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(y_||(y_={}));var E_,A_,R_,N_,T_,I_=((b_={})[y_.FunctionSuggestionAndArgumentAssistance]=[Ww.functionSuggestion,Ww.argumentAssistance],b_),F_=function(){function e(){this.argumentAssistanceResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionKnownNull=!1,this.promise=new k_}return e.prototype.consumeResult=function(e){switch(e.kind){case Ww.functionSuggestion:if(null!==e.result)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null});if(this.argumentAssistanceSet)return this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult});this.functionSuggestionKnownNull=!0;break;case Ww.argumentAssistance:if(this.functionSuggestionKnownNull)return this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;default:te("unknown result: "+e,e)}},e.create=function(){return new e},e}(),O_=((E_={})[y_.FunctionSuggestionAndArgumentAssistance]=F_,E_),D_=((A_={})[Ww.functionSuggestion]={startDelta:5,stopDelta:2e3},A_[Ww.formulaHighlighting]={startDelta:5,stopDelta:2e3},A_[Ww.argumentAssistance]={startDelta:5,stopDelta:2e3},A_),M_=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),w_=function(){function e(){this.subscribers=[]}return e.prototype.next=function(e){for(var t=0,r=this.subscribers;t<r.length;t++){(0,r[t])(e)}},e.prototype.subscribe=function(e){this.subscribers.push(e)},e}(),__=((R_={})[Ww.formulaHighlighting]=null,R_[Ww.functionSuggestion]={items:[]},R_[Ww.argumentAssistance]=null,R_),L_=function(){function e(e){this.pluginKind=e,this.numPlugins=0}return Object.defineProperty(e.prototype,"uiMessageFrame",{get:function(){return this._uiMessageFrame},enumerable:!0,configurable:!0}),e.prototype.createUIMessageFrame=function(e,t,r,n){var a=new k_,i=this.pluginKind;return this._uiMessageFrame={correlationId:e,cache:t,config:r,startTime:n,successfulResults:{kind:i,results:[]},resolvable:a,numFailures:0},a},e.prototype.closeUIMessageFrame=function(e,t){var r,n=this.uiMessageFrame;if(n&&(this._uiMessageFrame=void 0,n.resolvable.resolve("UIMessage"===e?{kind:Pw.Superseded}:{kind:Pw.Done,payload:n.successfulResults}),null===(r=n.cache)||void 0===r||r.then((function(e){return e.close()}),(function(){})),this.numPlugins>0)){var a=this.pluginKind,i=this.numPlugins,o=n.correlationId,u=n.startTime,s=n.successfulResults.results.length,l={correlationId:o,pluginKind:a,numPlugins:i,numSent:s,stopReason:e,startTime:u,stopTime:t};ee.ULS.traceTag(553734789,I.LogCategory.msoulscat_ES_EWAJS,s===i?I.TraceLevel.Verbose:I.TraceLevel.Info,"x10arch.ResponseState.closeUIMessageFrame: "+JSON.stringify(l))}},e.prototype.stop=function(e,t){void 0!==this.uiMessageFrame&&this.closeUIMessageFrame(e,t)},e}(),P_=function(){function e(e,t,r,n,a,i){var o,u,s,l,c=this;void 0===r&&(r=Object(fe.a)({},D_)),void 0===n&&(n=g_),void 0===i&&(i=[]),this.createPrefetchingCache=t,this.pluginResultWindows=r,this.timer=n,this.parent=a,this.responseStates=T(m(Ww).map((function(e){return[e,new L_(e)]}))),this.uiMessages=T(m(Ww).map((function(e){return[e,new w_]}))),this.doNotifySubject=new w_,this.requestWithCorrelationIdSubject=new w_,this.config=WL,this.configChangingMethodsLog=[],this.idFactory=new M_,this.state={},this.notificationProcessorMap=((o={})[Bw.setActiveCell]=this.setActiveCellImpl.bind(this),o[Bw.setA1ReferenceStyle]=this.setA1ReferenceStyle.bind(this),o[Bw.setLocale]=this.setLocale.bind(this),o[Bw.setWorkbookProps]=this.setWorkbookProps.bind(this),o[Bw.doNothing]=function(){},o[Bw.setFunctionsInfo]=this.setFunctionInfo.bind(this),o[Bw.conflictResolverEarlyTermination]=function(e,t){return c.stopPlugins(e,t,"ConflictResolverEarlyTermination")},o[Bw.recalcServiceAttached]=function(){return c.recalcServiceAttachedPromise.resolve()},o),this.requestProcessorMap=((u={})[xw.Delay]=function(){return he({})},u[xw.AwaitPromise]=function(e){var t=e.request.promise;return Object(fe.b)(c,void 0,void 0,(function(){return Object(fe.d)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t];case 1:return[2,he({result:e.sent()})];case 2:return[2,ge(e.sent())];case 3:return[2]}}))}))},u[xw.GetCell]=function(e){var t=e.request.cell,r=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,null===(n=this.responseStates[r].uiMessageFrame)||void 0===n?void 0:n.cache];case 1:return void 0===(e=a.sent())?[2,ge(void 0)]:[4,e.getCell(t)];case 2:return[2,he({result:a.sent()})]}}))}))},u[xw.GetContainingTable]=function(e){var t=e.request.cell,r=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,null===(n=this.responseStates[r].uiMessageFrame)||void 0===n?void 0:n.cache];case 1:return void 0===(e=a.sent())?[2,ge(void 0)]:[4,e.getContainingTable(t)];case 2:return[2,he({result:a.sent()})]}}))}))},u[xw.GetRange]=function(e){var t=e.request.range,r=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,null===(n=this.responseStates[r].uiMessageFrame)||void 0===n?void 0:n.cache];case 1:return void 0===(e=a.sent())?[2,ge(void 0)]:[4,e.getRange(t)];case 2:return[2,he({localSheetGrid:a.sent()})]}}))}))},u[xw.GetSheetNames]=function(e){var t=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,r;return Object(fe.d)(this,(function(n){switch(n.label){case 0:return[4,null===(r=this.responseStates[t].uiMessageFrame)||void 0===r?void 0:r.cache];case 1:return void 0===(e=n.sent())?[2,ge(void 0)]:[2,e.getSheetNames()]}}))}))},u[xw.GetIformat]=function(e){var t=e.request,r=t.document,n=t.iformat,a=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,t;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return[4,null===(t=this.responseStates[a].uiMessageFrame)||void 0===t?void 0:t.cache];case 1:return void 0===(e=i.sent())?[2,ge(void 0)]:[4,e.getIformat(r,n)];case 2:return[2,he({result:i.sent()})]}}))}))},u[xw.ParseCellFormula]=function(e){var t=e.request,r=t.cell,n=t.formula,a=t.useEnglishLocaleInfo,i=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,t;return Object(fe.d)(this,(function(o){switch(o.label){case 0:return[4,null===(t=this.responseStates[i].uiMessageFrame)||void 0===t?void 0:t.cache];case 1:return void 0===(e=o.sent())?[2,ge(void 0)]:[2,he(e.parseCellFormula(r,n,a))]}}))}))},u[xw.ParseEdit]=function(e){var t=e.request,r=t.cell,n=t.formulaBarText,a=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,t,i;return Object(fe.d)(this,(function(o){switch(o.label){case 0:return[4,null===(i=this.responseStates[a].uiMessageFrame)||void 0===i?void 0:i.cache];case 1:return void 0===(e=o.sent())?[2,ge(void 0)]:(t=he,[4,e.parseEdit(r,n)]);case 2:return[2,t.apply(void 0,[o.sent()])]}}))}))},u[xw.ParseNumberFormat]=function(e){var t=e.request,r=t.formatString,n=t.builtIn,a=e.pluginKind;return Object(fe.b)(c,void 0,void 0,(function(){var e,t;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return[4,null===(t=this.responseStates[a].uiMessageFrame)||void 0===t?void 0:t.cache];case 1:return void 0===(e=i.sent())?[2,ge(void 0)]:[2,he(e.parseNumberFormat(r,n))]}}))}))},u[xw.PrintFormula]=function(e){var t=e.request,r=t.formula,n=t.origin;return he({result:zs(Rs(c.config)).printFormula(Ns(aa(Xn.Cell,n),n),r)})},u[xw.GetActiveCell]=function(e){var t=e.schedulerState.activeCell;return void 0===t?ge(void 0):he({activeCell:t})},u[xw.GetConfig]=function(e){var t,r=e.pluginKind,n=null===(t=c.responseStates[r].uiMessageFrame)||void 0===t?void 0:t.config;return void 0===n?ge(void 0):he({config:n})},u[xw.GetFunctionsInfo]=function(e){var t=e.schedulerState.functionsInfoMap;return void 0===t?ge(void 0):he({functionsInfo:Object.keys(t).map((function(e){return t[e]}))})},u[xw.GetFunctionInfo]=function(e){var t=e.request.functionName,r=e.schedulerState;if(void 0===r.functionsInfoMap)return ge(void 0);var n=r.functionsInfoMap[t.toUpperCase()];return void 0===n?ge(void 0):he({functionInfo:n})},u[xw.GetCorrelationId]=function(e){return he({correlationId:e.correlationId})},u),this.notifierObject=function(e){function t(e){return function(t){y(t)||e(t)}}return{doNothing:t((function(t){return e.doNotify(Bw.doNothing,[t])})),setActiveCell:t((function(t){return e.doNotify(Bw.setActiveCell,[t])})),setFunctionsInfo:t((function(t){return e.doNotify(Bw.setFunctionsInfo,[t])}))}}(this),this.requesterObject=(s=this,{argumentAssistance:(l=function(e){return function(t){return y(t)?Promise.resolve(null):Promise.resolve(s.doRequest(e,t))}})(Ww.argumentAssistance),formulaHighlighting:l(Ww.formulaHighlighting),functionSuggestion:l(Ww.functionSuggestion)}),this.recalcServiceAttachedPromise=new k_,this.processor=e(this.consumeMessage.bind(this));for(var d=0,f=i;d<f.length;d++){var h=f[d];switch(h.method){case"setA1ReferenceStyle":this.setA1ReferenceStyle.apply(this,h.args);break;case"setLocale":this.setLocale.apply(this,h.args);break;case"setWorkbookProps":this.setWorkbookProps.apply(this,h.args);break;default:te("FormulaBarScheduler.constructor",h)}}}return e.prototype.setFunctionInfo=function(e){if(!y(e)){for(var t={},r=0,n=e;r<n.length;r++){var a=n[r];b(a)&&(t[a.NameDataStrings]=a)}this.state=Object(fe.a)(Object(fe.a)({},this.state),{functionsInfoMap:t})}},e.prototype.setA1ReferenceStyle=function(e,t){this.configChangingMethodsLog.push({method:"setA1ReferenceStyle",args:[e,t]});var r=t?ft.A1:ft.R1C1,n=this.config,a=n.localeInfo,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,s=n.timezone,l=n.datepack;this.setConfig(e,gu(a,r,i,o,u,s,l))},e.prototype.setLocale=function(e,t){this.configChangingMethodsLog.push({method:"setLocale",args:[e,t]});if(OR(t,tT,{},"localeData")){var r=bL(t),n=this.config,a=n.refStyle,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,s=n.timezone,l=n.datepack;this.setConfig(e,gu(r,a,i,o,u,s,l))}},e.prototype.setWorkbookProps=function(e,t){this.configChangingMethodsLog.push({method:"setWorkbookProps",args:[e,t]});if(OR(t,aT,{},"workbookProps")){var r=this.config,n=r.localeInfo,a=r.refStyle,i=r.mathpack,o=r.datepack,u=t.date1904,s=t.dateCompatibility,l=t.timezone;this.setConfig(e,gu(n,a,i,null!=u?u:WL.date1904,null!=s?s:WL.dateCompatibility,null!=l?l:WL.timezone,o))}},e.prototype.setConfig=function(e,t){this.config=t},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}},e.prototype.consumeMessage=function(e){switch(e.kind){case f_.StepPlugin:this.stepPlugin(e.computation,e.response);break;case f_.NoOpRequest:case f_.LocalServiceRequest:case f_.RecalcServiceRequest:var t=this.timer.now();this.processRequest(e.computation,e.request),e.computation.info.schedulerTime+=this.timer.now()-t;break;case f_.StopPlugins:this.stopPlugins(e.correlationId,e.pluginKind,"Timeout");break;default:te("unknown message: "+e,e)}},e.prototype.enqueueMessage=function(t,r){var n=e.abstractStepCosts[t.kind];this.processor.enqueue(t,n,r)},e.prototype.stepPlugin=function(e,t){var r=this.responseStates[e.info.pluginKind].uiMessageFrame;if(e.info.correlationId===(null==r?void 0:r.correlationId))try{var n=this.timer.now(),a=void 0===t?e.generator.next():e.generator.next(t);if(e.info.pluginTime+=this.timer.now()-n,!0!==a.done){var i=a.value;switch(i.kind){case xw.GetRange:case xw.GetSheetNames:case xw.GetCell:case xw.GetContainingTable:case xw.GetIformat:case xw.AwaitPromise:this.enqueueMessage({kind:f_.RecalcServiceRequest,request:i,computation:e});break;case xw.Delay:case xw.GetActiveCell:case xw.GetConfig:case xw.GetCorrelationId:case xw.GetFunctionInfo:case xw.GetFunctionsInfo:this.enqueueMessage({kind:f_.NoOpRequest,request:i,computation:e});break;case xw.ParseCellFormula:case xw.ParseEdit:case xw.ParseNumberFormat:case xw.PrintFormula:this.enqueueMessage({kind:f_.LocalServiceRequest,request:i,computation:e});break;default:te("unknown request: "+i,i)}}else ee.ULS.traceTag(553734790,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"x10arch.stepPlugin: plugin completed in time. "+JSON.stringify(e.info)),this.addResult(e.info.pluginFactoryName,he(a.value))}catch(t){this.addResult(e.info.pluginFactoryName,ge(void 0)),ee.ULS.traceTag(553734791,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,"x10arch.stepPlugin: plugin threw exception during computation. "+JSON.stringify(e.info))}},e.prototype.addResult=function(e,t){var r,n,a=t_[e],i=this.responseStates[a].uiMessageFrame;void 0!==i&&(this.parent&&this.parent.addResult(e,t),t.kind===le.Success?(r=i.successfulResults.results.push([e,t.value]),n=i.numFailures):(r=i.successfulResults.results.length,n=i.numFailures+=1),r+n===this.responseStates[a].numPlugins&&this.stopPlugins(i.correlationId,a,"Done"))},e.prototype.processRequest=function(e,t){var r=this,n=this.responseStates[e.info.pluginKind].uiMessageFrame;if(e.info.correlationId===(null==n?void 0:n.correlationId)){var a=function(e,t,r,n,a){return jw((0,e[t.kind])({request:t,correlationId:r,pluginKind:n,schedulerState:a}),(function(e){return e.kind!==le.Success?ge(void 0):he(Object(fe.a)({kind:t.kind},e.value))}))}(this.requestProcessorMap,t,e.info.correlationId,e.info.pluginKind,e.schedulerState);jw(a,(function(t){t.kind===le.Success?r.enqueueMessage({kind:f_.StepPlugin,computation:e,response:t.value}):r.addResult(e.info.pluginFactoryName,ge(void 0))}))}},e.prototype.stopPlugins=function(e,t,r){var n,a=this.responseStates[t];e===(null===(n=a.uiMessageFrame)||void 0===n?void 0:n.correlationId)&&a.stop(r,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.doNotify=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=t[1];(e=this.notificationProcessorMap)[n].apply(e,a),this.doNotifySubject.next(t)},e.prototype.requestWithCorrelationId=function(e,t,r){var n=this.timer.now(),a=this.responseStates[e];a.closeUIMessageFrame("UIMessage",n);var i=this.state.asyncGrid?this.createPrefetchingCache(this.state.asyncGrid,this.config,r):void 0,o=a.createUIMessageFrame(r,i,this.config,n);return ee.ULS.traceTag(553734792,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"x10arch.FormulaBarScheduler.request: "+JSON.stringify({correlationId:r,requestKind:e})),this.uiMessages[e].next(t),this.enqueueMessage({kind:f_.StopPlugins,correlationId:r,pluginKind:e},n+this.pluginResultWindows[e].stopDelta),this.requestWithCorrelationIdSubject.next([e,t,r]),o},e.prototype.doRequest=function(e,t){return this.doRequestUntyped(e,t)},e.prototype.doRequestUntyped=function(e,t){return Object(fe.b)(this,void 0,void 0,(function(){var r,n,a;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return 0===this.responseStates[e].numPlugins?(ee.ULS.traceTag(553734793,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"x10arch.FormulaBarScheduler.doRequest: no plugins attached"),[2,{kind:Pw.Done,payload:__[e]}]):(r=this.idFactory.create(),n=this.requestWithCorrelationId(e,t,r),[4,this.resolveConflicts(n)]);case 1:return(a=i.sent()).kind===Pw.Superseded?[2,a]:[2,Object(fe.a)(Object(fe.a)({},a),{payload:a.payload.result})]}}))}))},e.prototype.resolveConflicts=function(e){return Object(fe.b)(this,void 0,void 0,(function(){function t(e,t,r){for(var n=[],a=0,i=r;a<i.length;a++){var o=i[a],u=o[0],s=o[1];b(s)&&n.push([u,s])}return{kind:Pw.Done,payload:{kind:e,result:t(n)}}}var r,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,e];case 1:if((r=a.sent()).kind===Pw.Superseded)return[2,r];switch((n=r.payload).kind){case Ww.argumentAssistance:case Ww.formulaHighlighting:case Ww.functionSuggestion:return[2,t(n.kind,C_[n.kind],n.results)];default:te("unknown request: "+n,n)}return[2]}}))}))},e.prototype.doBatchRequest=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var t,r,n,a,i,o,u,s,l,c,d;return Object(fe.d)(this,(function(f){switch(f.label){case 0:for(t=this.idFactory.create(),r=I_[e.strategy],n=O_[e.strategy].create(),a=r.map((function(){return!0})),i=new k_,o=function(o){var s=r[o],l=e[s],c=u.requestWithCorrelationId(s,l,t);u.resolveConflicts(c).then((function(e){if(a[o]=!1,e.kind===Pw.Superseded)i.resolve({kind:Pw.Superseded});else{var t=e.payload;n.consumeResult(t)}}),(function(){ee.ULS.traceTag(553734794,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Error,'x10arch.doBatchRequest: Custom conflict resolver "'+e.strategy+'" got an exception for plugin kind "'+s+'". Skipping kind.'),a[o]=!1,n.consumeResult({kind:s,result:null})}))},u=this,c=0;c<r.length;c+=1)o(c);return s=jw(n.promise,(function(e){return{kind:Pw.Done,payload:e}})),[4,Promise.race([i,s])];case 1:for(l=f.sent(),c=0;c<r.length;c+=1)d=r[c],a[c]&&this.doNotify(Bw.conflictResolverEarlyTermination,[t,d]);return[2,l]}}))}))},e.prototype.notifier=function(){return this.notifierObject},e.prototype.requester=function(){return this.requesterObject},e.prototype.setActiveCellImpl=function(e){if(y(e.docName)||y(e.sheetIndex))ee.ULS.traceTag(553734796,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,"x10arch.setSelectedCell early exit, some of the arguments is None");else{var t=oa(void 0,""),r=ya(la(t,e.sheetIndex),va(e.rowIndex,e.colIndex));this.state=Object(fe.a)(Object(fe.a)({},this.state),{activeCell:r})}},e.prototype.getConfig=function(){return this.config},e.prototype.getAsyncGrid=function(){return this.state.asyncGrid},e.prototype.createAndAttachPlugin=function(e,t){var r=this,n=e.create(t),a=t_[e.factoryName];this.uiMessages[a].subscribe((function(t){var i=r.responseStates[a].uiMessageFrame;ne("`frame` should be always defined at this point",void 0!==i);var o=n.run(t);r.enqueueMessage({kind:f_.StepPlugin,computation:{info:{correlationId:i.correlationId,pluginKind:a,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0},generator:o,schedulerState:r.state}},i.startTime+r.pluginResultWindows[a].startDelta)})),this.addToPluginCount(a,1)},e.prototype.addToPluginCount=function(e,t){this.parent&&this.parent.addToPluginCount(e,t),this.responseStates[e].numPlugins+=t},e.prototype.registerAsyncGrid=function(e){this.state=Object(fe.a)(Object(fe.a)({},this.state),{asyncGrid:e}),this.doNotify(Bw.recalcServiceAttached,[])},e.abstractStepCosts=((N_={})[f_.NoOpRequest]=.01,N_[f_.RecalcServiceRequest]=.1,N_[f_.LocalServiceRequest]=.5,N_[f_.StepPlugin]=1,N_[f_.StopPlugins]=.01,N_),e}(),x_=function(){function e(e,t){if(this.threadId=e,!(t instanceof P_))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class");this.scheduler=t}return e.prototype.loadPluginScriptTrace=function(e){var t="x10arch.loadPluginScript: "+e+" loaded on "+this.threadId;ee.ULS.traceTag(553734797,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,t)},e.prototype.createAndAttachPlugin=function(e,t){return Object(fe.b)(this,void 0,void 0,(function(){var r;return Object(fe.d)(this,(function(n){return r=function(e){var t=n_[e];if(!t){var r="x10arch.getPluginFactory: "+Lw[e]+" has not been registered on "+r_;throw ee.ULS.traceTag(557056858,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Error,r),new Error(r)}return t}(e),this.scheduler.createAndAttachPlugin(r,t),[2]}))}))},e}(),B_=function(e){function t(t,r,n){var a=e.call(this,"Main",r)||this;a.threadEntryPoint=t,a.loader=n;var i=n.getConfig();return a.resolveScript=i.resolveScript,a}return Object(fe.c)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(fe.b)(this,void 0,void 0,(function(){return Object(fe.d)(this,(function(r){switch(r.label){case 0:return y(e)||y(t)?[2]:[4,this.loader.loadScript(e)];case 1:return r.sent(),this.loadPluginScriptTrace(e),[2]}}))}))},t.prototype.isThreadingSupported=function(){return Fo.isThreadingSupported()&&void 0!==Ou()},t.prototype.createPluginThread=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var r,n,a,i,o,u,s=this;return Object(fe.d)(this,(function(l){switch(l.label){case 0:if(!(r=this.scheduler.getAsyncGrid()))throw new Error("DynamicPluginLoader: scheduler has no async grid");return n="DynamicPluginLoaderThread-"+(t.lastThreadNum+=1)+"-"+e,[4,Fo.createWorker({createMode:"Thread",id:n},Fo.paramInsideDef({scriptUrl:Du(),insideInitName:this.threadEntryPoint},this.scheduler.getPluginResponseWindows(),this.scheduler.configChangingMethodsLog),(function(){return{getRangeValues:r.getRangeValues.bind(r),getRangeFormulae:r.getRangeFormulae.bind(r),getRangeFormats:r.getRangeFormats.bind(r),getSheetNames:r.getSheetNames.bind(r),getIntersectingTables:r.getIntersectingTables.bind(r),getIformats:r.getIformats.bind(r),discardSnapshot:r.discardSnapshot.bind(r),addResult:s.scheduler.addResult.bind(s.scheduler),addToPluginCount:s.scheduler.addToPluginCount.bind(s.scheduler),resolveScript:s.resolveScript}}))];case 1:a=l.sent(),l.label=2;case 2:return l.trys.push([2,4,,5]),i=function(){},a.onClose=function(){i();var e="x10arch.DynamicPluginLoader: "+n+" closed";ee.ULS.traceTag(553734798,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,e)},[4,wu(a)];case 3:return o=l.sent(),i=function(){return o.close()},this.scheduler.doNotifySubject.subscribe((function(e){var t;return(t=a.post).doNotify.apply(t,e)})),this.scheduler.requestWithCorrelationIdSubject.subscribe((function(e){var t;return(t=a.post).requestWithCorrelationId.apply(t,e)})),[2,new U_(a)];case 4:throw u=l.sent(),a.close(),u;case 5:return[2]}}))}))},t.lastThreadNum=0,t}(x_),U_=function(){function e(e){this.outside=e}return e.prototype.loadPluginScript=function(e,t){return this.outside.call.loadPluginScript(e,t)},e.prototype.createAndAttachPlugin=function(e,t){return this.outside.call.createAndAttachPlugin(e,t)},e.prototype.close=function(){this.outside.close()},e}(),G_=function(e,t,r){var n=e.config,a=e.connection;return Object(fe.b)(void 0,void 0,void 0,(function(){return Object(fe.d)(this,(function(e){return[2,Fo.Endpoint.createInside(a,(function(e){var i={addResult:function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).addResult.apply(t,r)},addToPluginCount:function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).addToPluginCount.apply(t,r)}};return new j_(String(a.options.id),new P_(rL(void 0),tL,t,void 0,i,r),n,e)}))]}))}))},j_=function(e){function t(t,r,n,a){var i=e.call(this,t,r)||this;return i.twConfig=n,i.inside=a,i.loadedScripts=h(),i.initCalcThreadInside=function(e,t,r){return Object(fe.b)(i,void 0,void 0,(function(){return Object(fe.d)(this,(function(n){switch(n.label){case 0:return[4,Mu(e,t,r,this.twConfig)];case 1:return n.sent(),this.scheduler.registerAsyncGrid(this.inside.call),[2]}}))}))},i.doNotify=i.scheduler.doNotify.bind(i.scheduler),i.requestWithCorrelationId=i.scheduler.requestWithCorrelationId.bind(i.scheduler),r_=t,i}return Object(fe.c)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(fe.b)(this,void 0,void 0,(function(){var r;return Object(fe.d)(this,(function(n){switch(n.label){case 0:return y(e)||y(t)||this.loadedScripts[e]?[2]:(r=importScripts,[4,this.inside.call.resolveScript({identifier:e,isLocalized:t})]);case 1:return r.apply(void 0,[n.sent()]),this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e),[2]}}))}))},t}(x_);!function(e){e.Value="Value",e.CellFormula="CellFormula"}(T_||(T_={}));var V_=Ya,H_={kind:T_.Value,formulaBarText:"",origin:va(0,0)};function W_(e,t){return{discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=e.getRangeFormats.apply(e,Object(fe.f)([r],n));return t(r),i},getRangeValues:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=e.getRangeValues.apply(e,Object(fe.f)([r],n));return t(r),i},getRangeFormulae:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=e.getRangeFormulae.apply(e,Object(fe.f)([r],n));return t(r),i},getSheetNames:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=e.getSheetNames.apply(e,Object(fe.f)([r],n));return t(r),i},getIntersectingTables:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=e.getIntersectingTables.apply(e,Object(fe.f)([r],n));return t(r),i},getIformats:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var i=e.getIformats.apply(e,Object(fe.f)([r],n));return t(r),i}}}var K_=function(){function e(e){this.calcGrid=e,this.snapshotPromises=[]}return e.prototype.discardSnapshot=function(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)},e.prototype.getSheetNames=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var t,r,n,a,i,o,u;return Object(fe.d)(this,(function(s){switch(s.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(t=s.sent()))return[2,ge(xn(["getSheetNames"]))];if(r={document:this.calcGrid.document,sheets:new Array},!Se(n=t.getSheetRangeIndexes(ca(this.calcGrid.document))))return[2,n];for(a=0,i=n.value.sheets;a<i.length;a++){if(o=i[a],!Se(u=t.getSheetName(this.calcGrid.document,o)))return[2,u];r.sheets.push({sheetIndex:la(this.calcGrid.document,o),sheetName:u.value})}return[2,he(r)]}}))}))},e.prototype.getOrCreateSnapshot=function(e){return Object(fe.b)(this,void 0,void 0,(function(){return Object(fe.d)(this,(function(t){return void 0===this.snapshotPromises[e]?[2,this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot()]:[2,this.snapshotPromises[e]]}))}))},e.prototype.getRangeFormats=function(e,t){return this.getRangeData(e,t,"formats")},e.prototype.getRangeValues=function(e,t){return this.getRangeData(e,t,"values")},e.prototype.getRangeFormulae=function(e,t){return this.getRangeData(e,t,"formulae")},e.prototype.getRangeData=function(e,t,r){return Object(fe.b)(this,void 0,void 0,(function(){var n,a,i,o,u,s,l;return Object(fe.d)(this,(function(c){switch(c.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(n=c.sent())?[2,ge(xn(["getRangeData/getOrCreateSnapshot"]))]:(a=n.allEditedAvailable(t)).kind!==le.Success?[2,ge(xn(["getRangeData/allEditedAvailable"]))]:(i=iR(t.range),!0!==a.value&&(i=HA(i,a.value)),o=function(e){var r=[];return vR(i,(function(n){var a=e(ba(t.sheet,n),(function(e){i=HA(i,iR(e))}),(function(e,t){r.push([[e.row,e.col],t])}));return a.kind===le.Success&&a.value}))?he(r):ge(xn(["getRangeData/extractData"]))},u=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return t[e].apply(t,r)}(r,{formulae:function(){return o((function(e,t,r){return n.forEachEditedFormula(e,(function(e,n){var a=n.lexicalKind,i=n.compiledFmla,o=n.fmla,u=n.origin;return a!==Xn.Range&&Ur(e)?FT(o,void 0!==i)||r(e,{kind:void 0!==i?T_.CellFormula:T_.Value,formulaBarText:o,origin:tn(u,e)?void 0:u}):t(e),!0}))}))},formats:function(){return o((function(e,t,r){return n.forEachEditedFormat(e,(function(e,n){return n===yR.Unavailable?t(e):RT(n)||r(e,"number"==typeof n?n:n.formatString),!0}))}))},values:function(){return o((function(e,t,r){return n.forEachEditedValue(e,(function(e,n){return void 0!==n.failure?t(e):_T(n.oper,n.failure)||r(e,n.oper),!0}))}))}}),(s=u).kind!==le.Success?[2,s]:(l=[],vR(i,(function(e){return l.push(e),!0})),[2,he({nonEmptyCells:s.value,availableRanges:l})]))}}))}))},e.prototype.getIntersectingTables=function(e,t){var r;return Object(fe.b)(this,void 0,void 0,(function(){var n,a,i,o,u,s,l,c,d,f,h,v;return Object(fe.d)(this,(function(p){switch(p.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(n=p.sent()))return[2,ge(xn(["getIntersectingTables/getOrCreateSnapshot"]))];if((a=n.allServerAvailable(t)).kind!==le.Success)return[2,ge(xn(["getIntersectingTables/allServerAvailable"]))];if(!Se(i=n.getIntersectingTables(t)))return[2,ge(xn(["getIntersectingTables/getIntersectingTables"]))];for(o=[],u=function(e){var t=n.getNamedObject(e,Zn.Plain);if(t.kind!==le.Success)return{value:t};if("NamedTable"!==(null===(r=t.value)||void 0===r?void 0:r.kind))return"continue";var a=[];t.value.columnIndexes.forEach((function(e,t){return a.push({column:e,name:t}),!0})),o.push({name:e.name,dataRange:t.value.specialRefRanges[At.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:a})},s=0,l=i.value;s<l.length;s++)if(c=l[s],"object"==typeof(d=u(c)))return[2,d.value];return f=iR(t.range),h=!0===a.value?f:HA(f,a.value),v=[],vR(h,(function(e){return v.push(e),!0})),[2,he({tables:o,availableRanges:v})]}}))}))},e.prototype.getIformats=function(e,t,r,n){return Object(fe.b)(this,void 0,void 0,(function(){var a,i;return Object(fe.d)(this,(function(o){switch(o.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(a=o.sent())?[2,ge(xn(["getIformats/getOrCreateSnapshot"]))]:Se(i=a.getIformats(t,r,n))?[2,he({availableFormats:i.value})]:[2,ge(xn(["getIformats/getIntersectingTables"]))]}}))}))},e}(),z_=function(){function e(t,r,n,a){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,Se(r)&&(this.values=e.buildSparseMatrix(r.value.nonEmptyCells,(function(e){return e})),this.valueAvailabilitySet=e.unionRanges(r.value.availableRanges)),Se(a)&&(this.formats=e.buildSparseMatrix(a.value.nonEmptyCells,(function(e){return e})),this.formatAvailabilitySet=e.unionRanges(a.value.availableRanges)),Se(n)&&(this.formulae=e.buildSparseMatrix(n.value.nonEmptyCells,(function(e){return e})),this.formulaAvailabilitySet=e.unionRanges(n.value.availableRanges))}return e.buildSparseMatrix=function(e,t){for(var r=[],n=0,a=e;n<a.length;n++)for(var i=a[n],o=i[0],u=o[0],s=o[1],l=o[2],c=void 0===l?1:l,d=o[3],f=void 0===d?1:d,h=i.slice(1),v=h.length,p=s,m=0;p<s+f;p+=1)for(var g=u;g<u+c;g+=1,m=(m+1)%v)void 0===r[g]&&(r[g]=[]),r[g][p]=t(h[m],g,p);return r},e.forEachInSparseMatrix=function(e,t,r){void 0===r&&(r=function(){return!1});var n=!0;return e.forEach((function(e,a){n&&e.forEach((function(e,i){n&&(r(e)||t(va(a,i),e)||(n=!1))}))})),n},e.unionRanges=function(e){return e.map(iR).reduce(UA,lA)},e.prototype.getCellValue=function(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?he(this.values[e][t]):he(V_):ge(xn(["getCellValue"]))},e.prototype.getCellFormat=function(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?he(this.formats[e][t]):he(0):ge(xn(["getCellFormat"]))},e.prototype.getCellFormula=function(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?he(this.formulae[e][t]):he(H_):ge(xn(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(t){return void 0===this.values||e.forEachInSparseMatrix(this.values,t,(function(e){return e.kind===Tt.Blank}))},e.prototype.foreachNonBlankCellFormula=function(t){return void 0===this.formulae||e.forEachInSparseMatrix(this.formulae,t,(function(e){return e.kind===H_.kind&&e.formulaBarText===H_.formulaBarText}))},e.prototype.isAvailable=function(e,t,r){var n,a;switch(r){case"value":a=this.valueAvailabilitySet;break;case"formula":a=this.formulaAvailabilitySet;break;case"format":a=this.formatAvailabilitySet;break;default:te("isAvailable",r)}return void 0!==a&&(null!==(n=WA(iR(va(e,t)),a))&&void 0!==n?n:1)<=0},e}();function Y_(e){var t=e.hasHeadersRow,r=e.hasTotalsRow,n=e.dataRange;return ha(n.row-Number(t),n.col,n.rows+Number(t)+Number(r),n.cols)}function q_(e,t,r,n){for(var a=t.name,i=t.hasHeadersRow,o=t.hasTotalsRow,u=t.dataRange,s=t.columns,l=i?ha(u.row-1,u.col,1,u.cols):void 0,c=o?ha(u.row+u.rows,u.col,1,u.cols):void 0,d={},f=zl.create(e.stringCompareCI),h=0,v=s;h<v.length;h++){var p=v[h];d[p.column]=p,f=f.setValue(p.name,p)}return{name:a,sheet:r,dataRange:u,headersRange:l,totalsRange:c,allRange:n,indexToColumn:d,nameToColumn:f,allColumnNamesAvailable:s.length===u.cols}}var J_,Q_=ge(xn(["getCell"])),X_=ge(xn(["getContainingTable"])),Z_=ge(xn(["getIformats"])),$_=function(){function e(e,t,r){this.grid=e,this.config=t,this.correlationId=r,this.sheet2contents=h(),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map;var n={config:t,getTime:function(){return ge(xn(["getTime"]))}};this.parser=ap(n),this.analyzer=Yp(n),this.formatter=gy(n);var a=Object(fe.a)(Object(fe.a)({},n),{config:Object(fe.a)(Object(fe.a)({},t),{localeInfo:os()})});this.englishParser=ap(a),this.englishAnalyzer=Yp(a)}return e.getOrFetchTile=function(t,r,n){var a=r.range.row>>>e.tileHeightPow,i=r.range.col>>>e.tileWidthPow;void 0===t[a]&&(t[a]=[]);var o=t[a][i];return void 0===o?n(ba(r.sheet,ha(a<<e.tileHeightPow,i<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow))).then((function(e){return t[a][i]=e})):o},e.create=function(t,r,n){return Promise.resolve(new e(t,r,n))},e.prototype.getSheetContents=function(e){var t;return null!==(t=this.sheet2contents[e])&&void 0!==t?t:this.sheet2contents[e]={cellTiles:[],tables:CT(),tableTiles:[]}},e.prototype.getSheetNames=function(){return Object(fe.b)(this,void 0,void 0,(function(){var e,t,r,n,a,i,o,u,s,l;return Object(fe.d)(this,(function(c){switch(c.label){case 0:return void 0!==this.sheetNames?[3,2]:[4,this.grid.getSheetNames(this.correlationId)];case 1:if(!Se(e=c.sent()))return[2,ge(void 0)];for(t={},r=zl.create(this.config.localeInfo.stringCompareCI),n=e.value,a=n.document,i=n.sheets,o=0;o<i.length;o+=1)u=i[o],s=u.sheetIndex,l=u.sheetName,t[s.index]=o,r=r.setValue(l,o);this.sheetNames={document:a,sheets:i,idToIndex:t,nameToIndex:r},c.label=2;case 2:return[2,he(this.sheetNames)]}}))}))},e.prototype.getRangeValues=function(e){return this.grid.getRangeValues(this.correlationId,e)},e.prototype.getRangeFormulae=function(e){return this.grid.getRangeFormulae(this.correlationId,e)},e.prototype.getRangeFormats=function(e){return this.grid.getRangeFormats(this.correlationId,e)},e.prototype.getRange=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var t,r,n,a;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.getRangeValues(e),this.getRangeFormulae(e),this.getRangeFormats(e)])];case 1:return t=i.sent(),r=t[0],n=t[1],a=t[2],[2,new z_(e.sheet,r,n,a)]}}))}))},e.prototype.getCell=function(t){var r=this,n=this.getSheetContents(t.sheet.index);return jw(e.getOrFetchTile(n.cellTiles,t,(function(e){return Object(fe.b)(r,void 0,void 0,(function(){var r,n,a,i,o;return Object(fe.d)(this,(function(u){switch(u.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,e)];case 1:return o=[u.sent()],[4,this.grid.getRangeFormulae(this.correlationId,e)];case 2:return o=o.concat([u.sent()]),[4,this.grid.getRangeFormats(this.correlationId,e)];case 3:return r=o.concat([u.sent()]),n=r[0],a=r[1],i=r[2],Se(n)&&Se(a)&&Se(i)?[2,new z_(t.sheet,n,a,i)]:[2,"unavailable"]}}))}))})),(function(e){if("unavailable"===e)return Q_;var r=e.getCellValue(t.range.row,t.range.col),n=e.getCellFormula(t.range.row,t.range.col),a=e.getCellFormat(t.range.row,t.range.col);return Se(r)&&Se(n)&&Se(a)?he({value:r.value,formula:n.value,format:a.value}):Q_}))},e.prototype.getContainingTable=function(t){return Object(fe.b)(this,void 0,void 0,(function(){var r,n=this;return Object(fe.d)(this,(function(a){return r=this.getSheetContents(t.sheet.index),[2,jw(e.getOrFetchTile(r.tableTiles,t,(function(e){return Object(fe.b)(n,void 0,void 0,(function(){var n,a,i,o,u,s;return Object(fe.d)(this,(function(l){switch(l.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,e)];case 1:if(!Se(n=l.sent()))return[2,"unavailable"];for(a=n.value.availableRanges.map(iR).reduce(UA,lA),i=0,o=n.value.tables;i<o.length;i++)u=o[i],s=Y_(u),r.tables.getValue(s)||(r.tables=r.tables.setValue(s,q_(this.config.localeInfo,u,t.sheet,s)));return[2,a]}}))}))})),(function(e){return"unavailable"===e?X_:(r.tables.forEachGe(t.range,(function(e,t){return n=t,!1})),void 0!==n||function(e,t){var r;return(null!==(r=WA(iR(t),e))&&void 0!==r?r:1)<=0}(e,t.range)?he(n):X_);var n}))]}))}))},e.prototype.getIformat=function(t,r){return Object(fe.b)(this,void 0,void 0,(function(){var n,a,i,o,u,s,l,c,d,f;return Object(fe.d)(this,(function(h){switch(h.label){case 0:return n=r>>>e.formatPagePow,a=n<<e.formatPagePow,i=a+(1<<e.formatPagePow),void 0!==(o=this.formatPages[n])?[3,2]:[4,this.grid.getIformats(this.correlationId,t,a,i)];case 1:if(Se(u=h.sent())){for(s=[],l=0,c=u.value.availableFormats;l<c.length;l++)(d=c[l]).iformat<a||d.iformat>=i||(s[d.iformat-a]=d);o=this.formatPages[n]=s}else o=this.formatPages[n]="unavailable";h.label=2;case 2:return"unavailable"===o||void 0===(f=o[r-a])?[2,Z_]:[2,he(f)]}}))}))},e.prototype.parseCellFormula=function(t,r,n){return{result:e.cachedParseFormula(n?this.englishFormulaCache:this.formulaCache,n?this.englishParser:this.parser,n?this.englishAnalyzer:this.analyzer,t,r)}},e.prototype.parseEdit=function(t,r){var n;return Object(fe.b)(this,void 0,void 0,(function(){var a,i,o;return Object(fe.d)(this,(function(u){switch(u.label){case 0:return[4,this.getEditFormat(t)];case 1:return a=null!==(n=u.sent())&&void 0!==n?n:{valueType:$p.General,bidiDate:void 0,culture:void 0},Se(i=this.formatter.parseEdit(r,a))?i.value.kind!==km.Formula?[2,{result:he(i.value)}]:Se(o=e.parseCheckedFormula(this.parser,this.analyzer,t,i.value.fmla,t.range))?[2,{result:he({kind:km.Formula,fmla:i.value.fmla,formula:o.value})}]:[2,{result:o}]:[2,{result:i}]}}))}))},e.prototype.getEditFormat=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var t,r,n,a,i,o;return Object(fe.d)(this,(function(u){switch(u.label){case 0:return[4,this.getCell(e)];case 1:return Se(t=u.sent())?"string"!=typeof t.value.format?[3,2]:(r=this.parseNumberFormat(t.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(e.sheet.document,t.value.format)];case 3:if(!Se(n=u.sent()))return[2,void 0];a=n.value,i=a.formatString,o=a.builtIn,r=this.parseNumberFormat(i,o).result,u.label=4;case 4:return[2,Se(r)?r.value:void 0]}}))}))},e.cachedParseFormula=function(t,r,n,a,i){var o,u=t.get(i);if(void 0!==u)return u;var s=e.parseWellFormedFormula(r,n,a,i.formulaBarText,null!==(o=i.origin)&&void 0!==o?o:a.range);return t.set(i,s),s},e.parseWellFormedFormula=function(t,r,n,a,i){var o=e.parseCheckedFormula(t,r,n,a,i);return Se(o)?Br(o.value)?he(o.value):ge(Ny("ill-formed formula")):o},e.parseCheckedFormula=function(e,t,r,n,a){var i=e.parseFormula(Ql(Xn.Cell,a),n);if(!Se(i))return i;var o=t.checkFormula(gp(Xn.Cell,ya(r.sheet,a)),i.value);return Se(o)?he(o.value):o},e.prototype.parseNumberFormat=function(e,t){return{result:this.cachedParseNumberFormat(e,t)}},e.prototype.cachedParseNumberFormat=function(e,t){var r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;var n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch((function(e){var t="x10arch.PrefetchingCache.close: "+q(e);ee.ULS.traceTag(553734788,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,t)}))},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}(),eL=function(){function e(e){this.consumeMessage=e,this.queue=new s_((function(){return 0}))}return e.prototype.enqueue=function(e,t,r){b(r)&&e.kind===f_.StopPlugins||this.queue.enqueue(e)},e.prototype.step=function(){var e=this.queue.pop();b(e)&&this.consumeMessage(e)},Object.defineProperty(e.prototype,"done",{get:function(){return 0===this.queue.getCount()},enumerable:!0,configurable:!0}),e}(),tL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return $_.create.apply($_,e)},rL=function(e){return function(t){return new S_((function(e,t){return e.kind-t.kind}),t,void 0,e)}},nL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(P_.bind.apply(P_,Object(fe.f)([void 0,rL(e[1]),tL],e)))},aL=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=function(t){return e=new eL(t)},a=new(P_.bind.apply(P_,Object(fe.f)([void 0,n,tL],t)));if(void 0===e)throw"not initialized";return[a,e]},iL=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(B_.bind.apply(B_,Object(fe.f)([void 0,e],t)))},oL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(K_.bind.apply(K_,Object(fe.f)([void 0],e)))},uL=function(e){var t=void 0;return W_(e.call,(function(r){t!==r&&(t=r,e.post.resumeRecalc())}))},sL=(J_=function(){return vL().createFormulaBarScheduler()},function(){function e(){}return e.instance=function(){return void 0===e.value&&(e.value=J_()),e.value},e.prototype.instance=function(){return e.instance()},e.value=void 0,e}());function lL(e){return vL().createDynamicPluginLoader(sL.instance(),e)}var cL,dL=function(){function e(){}return e.create=function(e){return lL(e)},e}();!function(e){e.Dev="Dev",e.Stable="Stable"}(cL||(cL={}));var fL={createFormulaBarScheduler:nL,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return iL.apply(o,Object(fe.f)(["excelOnlineCalc.x10.devDynamicPluginLoaderInsideInit"],e))},createRecalcSideGrid:oL,createPrefetchingCache:tL,createIGridFromRecalcService:uL,createExperimentFormulaBarScheduler:aL},hL={createFormulaBarScheduler:nL,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return iL.apply(i,Object(fe.f)(["excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit"],e))},createRecalcSideGrid:oL,createPrefetchingCache:tL,createIGridFromRecalcService:uL,createExperimentFormulaBarScheduler:aL};function vL(e){return void 0===e&&(e=Be("Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler")?cL.Dev:cL.Stable),e===cL.Dev?fL:hL}var pL=0;var mL=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i")&&!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function gL(){return mL.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function SL(e,t){var r,n,a,i,o,u,s,l,c,d,f,h,v,p,m,g,S,b,C,k,E,A,N,T,I,F,O,D,M,w,_,L,P,x,B,U,G=R("en-US"),j=function(e,t,r){var n=ts().slice();return DR(t,tN,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),rs(e,n)}(G,e.worksheetFunctionNames,t),V=j.getWorksheetFuncId,H=j.getWorksheetFuncName,W=function(e){if(y(e))return function(e){return e>0&&e%3==0};if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,a=0;a<e.length&&!((n-=e[a])<=0);a+=1);return n>0&&r?n%e[e.length-2]==0:0===n}}(e.thousandsData),K=function(e,t){var r=ju.slice();return DR(e,rN,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),z=null!==(r=e.lcid)&&void 0!==r?r:bu.USA,Y=null!==(n=e.country)&&void 0!==n?n:Su.USA,q=z===bu.Thailand,J=z===bu.Korea,Q=z===bu.Japan,X=z===bu.ChinaT||z===bu.HongKong,Z=z===bu.China,$=J||Q||Z||X,ee=z===bu.Hindi||z===bu.Tamil,te=z===bu.Thailand||z===bu.Vietnam||ee,re=(z&bu.LANG)==(bu.Hebrew&bu.LANG)||(z&bu.LANG)==(bu.Arabic&bu.LANG)||z===bu.Syriac||te;return Object(fe.a)(Object(fe.a)({},e),{getWorksheetFuncId:V,getWorksheetFuncName:H,isNumeral:Pu,getOrdinal:xu,getNumberShape:Bu,isThousandsPosition:W,isIdentStart:Uu,isIdentContinue:Gu,stringCompareCI:G,errorNames:K,specialRefNames:null!==(a=e.specialRefNames)&&void 0!==a?a:Vu,thousandsSeparator:null!==(i=e.thousandsSeparator)&&void 0!==i?i:",",lcid:z,country:Y,isThai:q,isEastAsia:$,isKorea:J,isJapan:Q,isChinaT:X,isChinaS:Z,isComplexScript:re,numberDecimals:null!==(o=e.numberDecimals)&&void 0!==o?o:2,isExpSepBySpace:null!==(u=e.isExpSepBySpace)&&void 0!==u&&u,fractionSeparator:null!==(s=e.fractionSeparator)&&void 0!==s?s:" ",isPercentSepBySpace:null!==(l=e.isPercentSepBySpace)&&void 0!==l&&l,currencyFormat:null!==(c=e.currencyFormat)&&void 0!==c?c:mi.Paren,isCurrencySymbolLead:null===(d=e.isCurrencySymbolLead)||void 0===d||d,isCurrencySepBySpace:null!==(f=e.isCurrencySepBySpace)&&void 0!==f&&f,currencySymbol:null!==(h=e.currencySymbol)&&void 0!==h?h:"$",currencyDecimals:null!==(v=e.currencyDecimals)&&void 0!==v?v:2,dateOrder:null!==(p=e.dateOrder)&&void 0!==p?p:gi.MDY,dateSeparator:null!==(m=e.dateSeparator)&&void 0!==m?m:"/",dateAltSeparator:null!==(g=e.dateAltSeparator)&&void 0!==g?g:"-",year4Digits:null===(S=e.year4Digits)||void 0===S||S,month2Digits:null!==(b=e.month2Digits)&&void 0!==b&&b,day2Digits:null!==(C=e.day2Digits)&&void 0!==C&&C,longDateFormat:null===(k=e.longDateFormat)||void 0===k||k,timeSeparator:null!==(E=e.timeSeparator)&&void 0!==E?E:":",timeAltSeparator:null!==(A=e.timeAltSeparator)&&void 0!==A?A:void 0,hour2Digits:null!==(N=e.hour2Digits)&&void 0!==N&&N,clock24Hour:null!==(T=e.clock24Hour)&&void 0!==T&&T,isAMPMSepBySpace:null===(I=e.isAMPMSepBySpace)||void 0===I||I,ampmSymbols:null!==(F=e.ampmSymbols)&&void 0!==F?F:["AM","PM"],dayNameShort:null!==(O=e.dayNameShort)&&void 0!==O?O:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNameLong:null!==(D=e.dayNameLong)&&void 0!==D?D:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthNameShort:null!==(M=e.monthNameShort)&&void 0!==M?M:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthNameLong:null!==(w=e.monthNameLong)&&void 0!==w?w:["January","February","March","April","May","June","July","August","September","October","November","December"],pictureSpecial:null!==(_=e.pictureSpecial)&&void 0!==_?_:Hu,pictureSingle:null!==(L=e.pictureSingle)&&void 0!==L?L:Wu,pictureColor:null!==(P=e.pictureColor)&&void 0!==P?P:Ku,pictureDbnum:null!==(x=e.pictureDbnum)&&void 0!==x?x:zu,sysDateFormat:null!==(B=e.sysDateFormat)&&void 0!==B?B:Yu,sysTimeFormat:null!==(U=e.sysTimeFormat)&&void 0!==U?U:qu})}function bL(e){return SL(e,{})}function yL(e,t){return y(t)?{index:e,length:1}:{index:e,length:A(t-e)+1}}function CL(e,t){var r=yL(t.row,t.lastRow),n=r.index,a=r.length,i=yL(t.column,t.lastColumn),o=i.index,u=i.length;return ba(la(e,t.sheetId),ha(n,o,a,u))}function kL(e,t){var r=t.row,n=t.column;return ya(la(e,t.sheetId),va(r,n))}function EL(e,t){var r=t.sheetId,n=t.usedRange;return b(n)?CL(e,Object(fe.a)({sheetId:r},n)):{sheet:la(e,r),range:void 0}}function AL(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=TA({row:t}),a=TA({col:r}),i=UA(n,a);return HA(iR(e),i)}(e.range,t,r)}}function RL(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function NL(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function TL(e){return jr(e)?Qk(e.sheet.index,e.range.row,e.range.col):Qk(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function IL(e,t,r,n){var a=lA;if(y(n))return a;for(var i=0;i<n.length;i+=1){var o=n[i];if(e<=o&&o<e+t){for(var u=1;i+u<n.length&&n[i+u]===o+u;)u+=1;i+=u-1,a=XE(a,r(C(o,o+u)))}}return a}function FL(e,t){switch(typeof t){case"string":return Fa(t);case"boolean":return Ia(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return Ya;case"Error":return Oa(t.type);default:return}}function OL(e,t){switch(t.kind){case Tt.String:case Tt.Boolean:return t.value;case Tt.Number:return e.toNumber(t);case Tt.Error:return Wk(t.type);case Tt.Blank:return Hk;default:return}}function DL(e,t,r,n){if(!y(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return KT(Fa(n.value));case"boolean":return KT(Ia(n.value));case"number":return KT(e.fromNumber(n.value))}return"Error"===n.value.kind?KT(Oa(n.value.type)):te("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return JT(n.formulaBarText);case"NamedRange":var a=CL(r,n.range);return zT(Wa(a.sheet,a.range));case"NamedTable":return qT(CL(r,n.range),n.hasHeadersRow,n.hasTotalsRow,n.columns,t);case"NamedFailure":return QT(n.failureReason,y(n.objectKind)?void 0:n.objectKind);default:return te("calc.calc.namedObjectDataToNamedObject: kind",n)}}function ML(e,t){var r,n;switch(t.kind){case Sy.NotImplemented:for(var a=0,i=t.features;a<i.length;a++){var o=i[a];TR(e,Sy.NotImplemented+" "+o)}break;case Sy.IllFormedFormula:TR(e,Sy.IllFormedFormula+" "+(null!==(r=t.mode)&&void 0!==r?r:"")+" "+JSON.stringify(null!==(n=t.diagnostics)&&void 0!==n?n:{}));break;case Sy.Unavailable:for(var u=0,s=t.objects;u<s.length;u++){var l=s[u],c=[Sy.Unavailable];if("string"==typeof l.kind&&l.kind in Nw){var d=l;switch(c.push(d.kind),d.kind){case Nw.SheetId:c.push(d.sheetId);break;case Nw.NameLoc:c.push(d.source),c.push(void 0===d.name.scope.index?"global":"sheet");break;case Nw.ClientFailure:c.push(d.reason);break;case Nw.VolatileFunction:c.push(d.name);break;case Nw.TimeGranularity:c.push(Go[d.granularity]);break;case Nw.GetTimeKind:c.push(d.getTimeKind)}}else c.push(JSON.stringify(l));TR(e,c.join(" "))}break;case Sy.LimitExceeded:TR(e,t.kind+" "+Ay[t.limit]);break;case Hp.NotFormatString:case Hp.NotValueString:TR(e,t.kind+" "+t.message);break;case Sy.InvalidStructRef:TR(e,t.kind+" "+t.reason);break;case Sy.Internal:TR(e,t.kind+" "+t.message);break;case Sy.JavaScriptError:case Xl.NotFormulaString:case Sy.CellCycle:case Sy.NameCycle:case Sy.Stopped:case Sy.PreviousFailure:case Sy.PreviousNameFailure:case Hp.PreviousFormatFailure:TR(e,t.kind);break;default:te("calc.calc.incrementFailure",t)}}var wL=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==sR.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){g(e!==sR.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==sR.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(WE(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults(xE(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var a=0;a<E(E(t.length,r.length),n.length);a+=10)this.onRecalcResults(xE(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))},e}();function _L(e){return{kind:e.kind}}var LL,PL,xL,BL,UL,GL,jL,VL,HL,WL={localeInfo:os(),mathpack:mu,refStyle:ft.A1,timezone:Ho,date1904:!1,dateCompatibility:!0,datepack:Yo},KL=function(){function e(e,t,r,n,a){var i=this;void 0===n&&(n={}),void 0===a&&(a="Local"),this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.twConfig=n,this.createMode=a,this.document=oa(void 0,""),this.localeInfo=WL.localeInfo,this.mathpack=WL.mathpack,this.refStyle=WL.refStyle,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=AR,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(e,t,r){return Object(fe.b)(i,void 0,void 0,(function(){var n,a,i;return Object(fe.d)(this,(function(o){if("Thread"===this.createMode&&null!==(i=t[De.CalcAutocompleteExperiment])&&void 0!==i&&i){if(n=!1,a=r.replace(/\/[^/]*?((\.min)?\.js)$/,(function(e,t){return n=!0,"/excelOnlineAutocompleteExperiment"+t})),!n)throw new Error("calcAbsUrl not in expected form");importScripts(a)}return[2,Mu(e,t,r,this.twConfig)]}))}))},this.setConfig({}),this.setProps({}),this.dataModel=new Uw(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config)}return e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e,t,r=this;return this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=Hw((function(){var e=r.dataModel.step(),t=e.messages,n=e.queueEmpty;return t.length>0&&r.processRecalcResults(t),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),e=this.recalcLoop.promise,t=function(){r.recalcLoop=void 0},e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))},e.prototype.testResumeRecalc=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var t;return Object(fe.d)(this,(function(r){switch(r.label){case 0:return[4,this.resumeRecalc()];case 1:return r.sent(),void 0!==e&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = "+e,ee.ULS.traceTag(574128980,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,t)),[2]}}))}))},e.prototype.processRecalcResults=function(e){for(var t=new wL(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var a=n[r];if(a.kind!==kR.GarbageCollected)if(a.kind!==kR.ExperimentRunResult){if(this.setOutputStateId(a.stateId))switch(t.setOutputStateId(a.stateId),a.kind){case kR.CellWrite:var i=a.cell,o=a.value,u=a.format,s=a.cellKind,l=a.formulaBarText,c=a.formatted,d=a.hasHyperlink,f=i.sheet,h=i.range,v=this.cellWriteToRangeDelta(f.index,h.row,h.col,o,u,l,c,d,"messages.<index>.value");b(v)&&t.pushCellWrite(s,v);break;case kR.RangeWrite:var p=a.range,m=a.values,g=(s=a.cellKind,l=a.formulaBarText,c=a.formatted,a.formats);f=p.sheet,h=p.range;t.pushRangeWrite(s,this.rangeWriteToRangeDeltas(f.index,h,m,g,l,c,"messages.<index>.values"));break;case kR.NameFailure:this.nameFailures.push(a);break;case kR.RangeFailure:p=a.range,s=a.cellKind;var S=a.reason;t.pushRangeFailure(s,this.rangeFailure(p,S)),this.rangeFailures.push(a);break;case kR.NumberFormatFailure:this.numberFormatFailures.push(a);break;case kR.PrintFormulaFailure:this.printFormulaFailures.push(a);break;case kR.InferFormatFailure:this.inferFormatFailures.push(a);break;case kR.FormatValueFailure:p=a.range,s=a.cellKind,S=a.reason;t.pushRangeFailure(s,this.rangeFailure(p,S)),this.formatValueFailures.push(a);break;case kR.UnhandledFailure:this.unhandledFailures.push(a);break;case kR.UpdateRequest:t.pushUpdateRequest(TL(a.range));break;case kR.UpdateNamesRequest:t.pushUpdateNameRequest(a.scope);break;case kR.RecalcStatistics:t.pushRecalcFinished(a.message===SR.RecalcFinished),this.recalcStatistics=NR(this.recalcStatistics,a);break;case kR.WorkbookStatistics:this.logWorkbookStats(a.stateId,a.stats,a.p);break;case kR.StateAdvanced:break;default:return te("calc.calc.RecalcServiceImpl.processRecalcResults",a)}}else this.logExperimentRunResult(a.logMessage);else this.onGC(a.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e){ee.ULS.traceTag(594409422,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,"calc.calc.RecalcService: experiment done; "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var a=this.inferFormatFailures;this.inferFormatFailures=[];var i=this.formatValueFailures;this.formatValueFailures=[];var o=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",I.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",I.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",I.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",I.TraceLevel.Info),this.logGenFailureStats(a,590484947,"infer-format",I.TraceLevel.Info),this.logCellFailureStats(i,590484948,"format-value",I.TraceLevel.Info),this.logGenFailureStats(o,595194338,"unhandled",I.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},i=0,o=e;i<o.length;i++){ML(a,o[i].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(a);ee.ULS.traceTag(t,I.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a=this;if(0!==e.length){for(var i={},o=0,u=e;o<u.length;o++){var s=u[o],l=s.reason,c=s.cellKind;ML(i[c]||(i[c]={}),l)}Object.getOwnPropertyNames(i).sort().forEach((function(e){var o=i[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+a.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);ee.ULS.traceTag(t,I.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===Sy.JavaScriptError){var i="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+q(a.error);ee.ULS.traceTag(595658721,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,i)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));ee.ULS.traceTag(e,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==AR)){var e=this.recalcStatistics;this.recalcStatistics=AR,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var r="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e)+", p = "+JSON.stringify(t));ee.ULS.traceTag(595654593,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,r)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=function(e){for(var t,r,n,a,i,o,u,s=h(),l=h(),c=0,d=e;c<d.length;c++){var f=d[c],v=f.range;if(f.reason.kind===Dn.Unavailable)for(var p=0,m=f.reason.objects;p<m.length;p++){var g=m[p];g.kind===Nw.GridRange&&($r(g.range.sheet,v.sheet)?s[g.range.sheet.index]=UA(null!==(t=s[g.range.sheet.index])&&void 0!==t?t:lA,!0!==g.unavailableCells?g.unavailableCells:lA):l[g.range.sheet.index]=UA(null!==(r=l[g.range.sheet.index])&&void 0!==r?r:lA,!0!==g.unavailableCells?g.unavailableCells:lA))}}var S=0,b=0,y=0,C=h();for(var k in s){var E=null!==(n=s[k])&&void 0!==n?n:lA;C[k]=UA(null!==(a=C[k])&&void 0!==a?a:lA,E),vR(E,(function(e){return S+=e.rows*e.cols,!0}))}for(var k in l){E=null!==(i=l[k])&&void 0!==i?i:lA;C[k]=UA(null!==(o=C[k])&&void 0!==o?o:lA,E),vR(E,(function(e){return b+=e.rows*e.cols,!0}))}for(var k in C){vR(E=null!==(u=C[k])&&void 0!==u?u:lA,(function(e){return y+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:S,numOfUnavailableCellsInDifferentSheet:b,totalNumOfUnavailableCells:y}}(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="calc.calc.RecalcService: unavailable cells statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));ee.ULS.traceTag(589632004,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,t)}}},e.prototype.logWorkbookStats=function(e,t,r){var n="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t)+", p = "+JSON.stringify(r));ee.ULS.traceTag(595359882,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,n)},e.prototype.logInputStateIdDecrease=function(e){TR(this.ignoredInputStats,e+": input stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){TR(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i,o,u,s){if(OR(n,uT,this.ignoredOutputStats,s)){var l=OL(this.mathpack,n),c=function(e){var t;if(void 0!==e)return t=e.format,ME("object"==typeof t?_L(e.format):e.format,e.valueType,e.decimals)}(a);return b(i)||b(l)||b(c)||b(o)||b(u)?_E(Qk(e,t,r),wE(i,l,c,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,a,i,o){for(var u=o+".<index>.<index>",s=t.row,l=t.col,c=t.rows,d=t.cols,f=[],h=0;h<c;h+=1)for(var v=0;v<d;v+=1){var p=this.cellWriteToRangeDelta(e,s+h,l+v,r[h][v],n[h][v],0===h&&0===v?a:void 0,i[h][v],void 0,u);b(p)&&f.push(p)}return f},e.prototype.rangeFailure=function(e,t){return PE(TL(e),_L(t))},e.prototype.setA1ReferenceStyle=function(e,t){this.clearAsyncResumeRecalc(),this.refStyle=t?ft.A1:ft.R1C1,this.dataModel.setRefStyle(e,this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e,t){this.clearAsyncResumeRecalc(),OR(t,tT,this.ignoredInputStats,"localeData")&&(this.localeInfo=SL(t,this.ignoredInputStats),this.dataModel.setLocaleInfo(e,this.localeInfo,this.currentInputStateId))},e.prototype.setWorkbookProps=function(e,t){this.clearAsyncResumeRecalc(),OR(t,aT,this.ignoredInputStats,"workbookProps")&&(this.setProps(t),this.dataModel.setWorkbookProps(e,this.props,this.currentInputStateId))},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,DR(e,nN,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,DR(t,iN,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e,"namedObjectsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=DR(t,PN,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var a=n[r],i=a.scope,o=a.objects,u=a.fromStateId,s=Ea(this.document,b(i)?i:void 0);if(b(o))for(var l=0,c=DR(o,LN(i),this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");l<c.length;l++){var d=c[l],f=d.name,h=d.data;this.dataModel.writeNamedObject(e,s,f,DL(this.mathpack,this.localeInfo.stringCompareCI,this.document,h))}else b(u)?this.dataModel.promoteNamedObjects(e,s,u):this.dataModel.writeUndefinedNames(e,s)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=DR(t,kN,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(EL(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e,"rangeUpdates")){this.clearAsyncResumeRecalc();for(var a=0,i=DR(t,bN,this.ignoredInputStats,"rangeUpdates");a<i.length;a++){var o=i[a],u=o.range,s=o.excludeRows,l=o.excludeColumns,c=o.data,d=o.fromStateId,f=CL(this.document,u),h=f.range,v=IL(h.row,h.rows,aR.row,s),p=IL(h.col,h.cols,aR.col,l),m=AL(f,v,p),g=b(c)?FL(this.mathpack,c.value):Ya;ne("calc.calc.RecalcService: updateRanges oper",null!=g);var S=on(h);if(b(c)){var C=c.iformat,k="ArrayFormula"===c.kind?void 0:null!==(r=c.formulaBarText)&&void 0!==r?r:void 0,E=null!==(n=c.failureReason)&&void 0!==n?n:void 0,A="CellFormula"===c.kind;this.dataModel.writeCellContents(e,m,k,A,S,g,C,CR.Blank,E)}else y(d)?this.dataModel.writeCellContents(e,m,"",!1,S,Ya,0,void 0):this.dataModel.promoteCellContents(e,f,m,d);this.dataModel.writeHiddenRows(e,RL(f,v)),this.dataModel.writeHiddenCols(e,NL(f,p))}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=DR(t,CN,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,o=a.data,u=a.fromStateId,s=CL(this.document,i);if(b(o)){var l=o.formulaBarText,c=o.isSpilled,d=on(s.range);this.dataModel.writeArrayFormula(e,s,l,d,c)}else b(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormulaEdits")){this.clearAsyncResumeRecalc();for(var n=DR(t,GN,this.ignoredInputStats,"rangeFormulaEdits"),a=function(t){var n=t.kind,a=t.range,o=t.formulaBarText,u=t.value,s=t.origin,l=t.viewport,c=lA;a.forEach((function(e){c=UA(c,iR(CL(r.document,e).range))}));var d=CL(i.document,a[0]),f=b(s)?va(s.row,s.column):on(d.range),h=b(l)?CL(i.document,l):void 0,v=void 0;b(u)?ne("calc.calc.RecalcService: editRangeFormulas oper",null!=(v=FL(i.mathpack,u))):v=void 0;var p="CellFormula"===n||"Value"!==n&&void 0;i.dataModel.editCellContents(e,mR(d.sheet,c),o,p,f,v,h)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=DR(t,VN,this.ignoredInputStats,"rangeFormatEdits"),a=function(t){var n=t.range,a=t.operation,o=t.origin,u=t.viewport,s="SetFormat"!==a.kind||y(a.format)?"RibbonFormat"!==a.kind||y(a.ribbon)?"ChangeDecimals"!==a.kind||y(a.changeDecimals)?void 0:{kind:a.kind,changeDecimals:a.changeDecimals}:{kind:a.kind,ribbon:a.ribbon}:{kind:a.kind,format:a.format};ne("calc.calc.RecalcService: editRangeFormats operation",null!=s);var l=lA;n.forEach((function(e){l=UA(l,iR(CL(r.document,e).range))}));var c=CL(i.document,n[0]),d=null!=o?va(o.row,o.column):on(c.range),f=b(u)?CL(i.document,u):void 0;i.dataModel.editCellFormats(e,mR(c.sheet,l),s,d,f)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=DR(t,HN,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,o=a.formulaBarText,u=a.origin,s=a.viewport,l=CL(this.document,i),c=b(u)?va(u.row,u.column):va(i.row,i.column),d=b(s)?CL(this.document,s):void 0;this.dataModel.editArrayFormula(e,l,o,c,d)}}},e.prototype.editRangePaste=function(e,t){if(this.setInputStateId(e,"editRangePaste")){this.clearAsyncResumeRecalc();for(var r=0,n=DR(t,KN,this.ignoredInputStats,"pasteEdits");r<n.length;r++){var a=n[r],i=a.kind,o=a.source,u=a.target,s=a.viewport,l=CL(this.document,o),c=kL(this.document,u),d=b(s)?CL(this.document,s):void 0;this.dataModel.editPaste(e,i,c,l,d)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,u,s,l,c,d,f,h,v=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,factories:(h=e.runExperiments,h.map((function(e){var t,r=e.name,n=e.param;return null===(t=Aw[r])||void 0===t?void 0:t.call(Aw,n)})).filter((function(e){return void 0!==e})))}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(a=e.samplePrecisionEvalRate)&&void 0!==a?a:.02,samplePrecisionPrintFormulaRate:null!==(i=e.samplePrecisionPrintFormulaRate)&&void 0!==i?i:.001,samplePrecisionPrintValueRate:null!==(o=e.samplePrecisionPrintValueRate)&&void 0!==o?o:1e-4,sampleRecalcStatisticsRate:null!==(u=e.sampleRecalcStatisticsRate)&&void 0!==u?u:.2,sampleWorkbookStatisticsRate:null!==(s=e.sampleWorkbookStatisticsRate)&&void 0!==s?s:.1,sampleCellEvalStopwatchRate:null!==(l=e.sampleCellEvalStopwatchRate)&&void 0!==l?l:.003,sampleRecalcEditedStopwatchRate:null!==(c=e.sampleRecalcEditedStopwatchRate)&&void 0!==c?c:1,sampleRecalcViewportStopwatchRate:null!==(d=e.sampleRecalcViewportStopwatchRate)&&void 0!==d?d:1,rngSeed:null!==(f=e.rngSeed)&&void 0!==f?f:1e3*Date.now(),volatileMode:null!=e.volatileMode?LD[e.volatileMode]:LD.Estimation,experimentFactories:v}},e.prototype.setProps=function(e){var t,r,n;this.props={date1904:null!==(t=e.date1904)&&void 0!==t?t:WL.date1904,dateCompatibility:null!==(r=e.dateCompatibility)&&void 0!==r?r:WL.dateCompatibility,timezone:null!==(n=e.timezone)&&void 0!==n?n:WL.timezone,datepack:WL.datepack}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new Uw(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config),this.recalcStatistics=AR,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormula=function(e,t,r,n){var a=this;return OR(r,hN,this.ignoredInputStats,"origin")?OR(n,iT,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,kL(this.document,r),function(e){if(null!=e)switch(e.kind){case"Origin":return yR.Origin;case"Iformat":return ne("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Inferred":return yR.Inferred;default:return te("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}(n)).then((function(e){var t,r=e.value,n=e.formatted;if(Se(r)){if(!OR(r.value,uT,a.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var i=OL(a.mathpack,r.value);ne("calc.calc.RecalcService.evalFormula",void 0!==i),t=he(i)}else t=ge(_L(r.reason));return VE(t,void 0===n?void 0:Se(n)?n:ge(_L(n.reason)))})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return Object(fe.b)(this,void 0,void 0,(function(){return Object(fe.d)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e.prototype.getMissingJSFeatures=function(){return gL()},e}(),zL=function(e,t,r){for(var n,a=(void 0===(n="___mixinField")&&(n=""),n+(pL+=1).toString()),i={},o=function(e){i[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=this[a];return(t=i[e]).call.apply(t,Object(fe.f)([i],r))}},u=0,s=r;u<s.length;u++){o(s[u])}return function(e){function n(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];for(var u=e.apply(this,n)||this,s=t(u),l=0,c=r;l<c.length;l++){var d=c[l];Object.defineProperty(u,d,{value:i[d],enumerable:!1,configurable:!1})}return u[a]=s,u}return Object(fe.c)(n,e),n}(e)}(KL,(function(e){return vL().createRecalcSideGrid(e)}),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot"]),YL=function(e){var t=e.config,r=e.connection;return Fo.Endpoint.createInside(r,(function(e){return new zL((function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onRecalcResults.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onUpdateRequest.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onGC.apply(t,r)}),t,r.createMode)}))};function qL(e,t){return Object(fe.b)(this,void 0,void 0,(function(){function r(e){void 0===e&&(e="Requested"),l=e,u.close()}var n,a,i,o,u,s,l,c,d,f,h,v,p=this;return Object(fe.d)(this,(function(m){switch(m.label){case 0:return n=!0===t?(new sL).instance():void 0,a=vL(),i=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){i=e}},[4,Fo.createWorker({id:"RecalcService",createMode:e},{local:YL,thread:{scriptUrl:Du(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(function(){return o}))];case 1:u=m.sent(),void 0!==n&&n.registerAsyncGrid(a.createIGridFromRecalcService(u)),s=function(){},l="Requested",u.onClose=function(){s();var e="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = "+l;ee.ULS.traceTag(561534148,I.LogCategory.msoulscat_ES_EWAJS,"Requested"===l?I.TraceLevel.Info:I.TraceLevel.Warning,e)},m.label=2;case 2:return m.trys.push([2,5,,6]),"Thread"!==u.createMode?[3,4]:[4,wu(u)];case 3:c=m.sent(),s=function(){return c.close()},Le(De.CalcWebWorkerTest)&&(0,u.call.getMissingJSFeatures)().then((function(e){var t={main:gL(),worker:e},r="calc.calc.logMissingJSFeatures: missing = "+JSON.stringify(t);ee.ULS.traceTag(561534152,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,r)})).catch((function(e){var t="calc.calc.logMissingJSFeatures: threw "+q(e);ee.ULS.traceTag(561534153,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Info,t)})),m.label=4;case 4:return u.call.ping.callTimeout=3e4,d=3,f=0,h=function(){},(g=function(){return Object(fe.b)(p,void 0,void 0,(function(){var e,t,n,a,i,o,s;return Object(fe.d)(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(l.sent(),u.hasBeenClosed())return[2,void 0];e=u.call.ping.callTimeout,t=N(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,u.call.ping()];case 3:return l.sent(),[3,5];case 4:if(n=l.sent(),!Fo.WorkerError.isWorkerError(n)||"Timeout"!==n.info.cause)throw n;return a=N()-t,(f+=1)>=d&&r("Unresponsive"),i=u.hasBeenClosed(),o={timeout:e,waitTime:a,timeoutCount:f,hasBeenClosed:i},s="calc.calc.RecalcService: unresponsive; "+JSON.stringify(o),ee.ULS.traceTag(561534149,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,s),h(e,a,f,i),[2,!0];case 5:return f=0,[2,!0]}}))}))},S=!0,new Promise((function(e,t){Promise.resolve(S).then((function r(n){if(void 0!==n){b=n;try{Promise.resolve(g(b)).then(r,t)}catch(e){t(e)}}else e(b)}),t)}))).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: "+q(e);ee.ULS.traceTag(561534150,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,t)})),u.post.updateRanges.onPostMessageError=Fo.dispatchWorkerError,[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setOnUnresponsive:function(e){h=e},setA1ReferenceStyle:function(e){u.post.setA1ReferenceStyle(BD,e),void 0!==n&&n.doNotify(Bw.setA1ReferenceStyle,[BD,e])},setLocale:function(e){u.post.setLocale(BD,e),void 0!==n&&n.doNotify(Bw.setLocale,[BD,e])},setWorkbookProps:function(e){u.post.setWorkbookProps(BD,e),void 0!==n&&n.doNotify(Bw.setWorkbookProps,[BD,e])},setNumberFormats:u.post.setNumberFormats,updateSheetNames:u.post.updateSheetNames,updateNamedObjects:u.post.updateNamedObjects,updateUnusedCells:u.post.updateUnusedCells,updateRanges:u.post.updateRanges,updateArrays:u.post.updateArrays,editRangeFormulas:u.post.editRangeFormulas,editRangeFormats:u.post.editRangeFormats,editArrayFormulas:u.post.editArrayFormulas,editRangePaste:u.post.editRangePaste,resumeRecalc:u.post.resumeRecalc,reconfigure:function(e){var t,r;u.call.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,d=null!==(r=e.responsivenessPingAttempts)&&void 0!==r?r:3,u.post.reconfigure(e)},clearCache:function(){u.post.clearCache(),i=-1/0},testAdvanceState:u.post.testAdvanceState,testResumeRecalc:u.call.testResumeRecalc,close:r,stateIdAvailable:function(e){return e>=i},evalFormula:u.call.evalFormula}];case 5:throw v=m.sent(),r("Error"),v;case 6:return[2]}var g,S,b}))}))}function JL(){}function QL(){return Promise.resolve()}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(LL||(LL={})),(BL=PL||(PL={})).worksheetFunctionName=Bk,BL.errorTypeName=Uk,BL.localeData=Gk,BL.numberFormat=jk,BL.sheetName=Vk,BL.blankValue=Hk,BL.errorValue=Wk,BL.richValue=Kk,BL.getCellValueKind=zk,BL.getCellFormatKind=Yk,BL.cellLocation=qk,BL.rangeLocation=Jk,BL.sheetRangeLocation=Qk,BL.sheetCellLocation=Xk,BL.cellData=Zk,BL.cellFormulaCellData=$k,BL.arrayFormulaCellData=eE,BL.valueCellData=tE,BL.rangeUpdate=rE,BL.rangeWrite=nE,BL.rangePromote=aE,BL.arrayData=iE,BL.arrayUpdate=oE,BL.arrayWrite=uE,BL.arrayPromote=sE,BL.unusedCellsUpdate=lE,BL.namedValueData=cE,BL.namedFormulaData=dE,BL.namedRangeData=fE,BL.namedFailureData=pE,BL.namedObject=mE,BL.namedObjectsUpdate=gE,BL.namedObjectsWrite=SE,BL.undefinedNamesWrite=bE,BL.namedObjectsPromote=yE,BL.namedTableData=vE,BL.columnData=hE,BL.rangeFormulaEdit=CE,BL.cellFormulaRangeFormulaEdit=kE,BL.valueRangeFormulaEdit=EE,BL.inferredRangeFormulaEdit=AE,BL.RibbonFormat=ng,BL.formatEditOperation=RE,BL.formatEditSetFormat=NE,BL.formatEditRibbonFormat=TE,BL.formatEditChangeDecimals=IE,BL.rangeFormatEdit=FE,BL.arrayFormulaEdit=OE,BL.rangePasteEdit=DE,BL.inferredFormat=ME,BL.cellDataDelta=wE,BL.rangeDelta=_E,BL.arrayDelta=LE,BL.rangeFailure=PE,BL.recalcResults=xE,BL.evalFormulaData=VE,BL.evalFormulaFormat=BE,BL.evalFormulaFormatOrigin=UE,BL.evalFormulaFormatIformat=GE,BL.evalFormulaFormatInferred=jE,BL.updateRequest=WE,BL.runExperiment=KE,BL.recalcServiceConfig=zE,BL.workbookProps=YE,BL.createRecalcService=qL,BL.RecalcServiceCreateMode=LL,BL.localeInfoFromData=bL,BL.cellValueToReadOper=FL,BL.readOperToCellValue=OL,BL.recalcServiceInsideInit=YL,BL.getEvalResultKind=iI,BL.getEvalFailureReason=oI,(xL=BL.internal||(BL.internal={})).PartialWorkbookDocumentCollection=UD,xL.VolatileMode=LD,xL.voidCallback=xD,xL.sheetCellSet=mR,xL.createSheetCellSetFromRange=gR,xL.ComputedCellKind=sR,xL.ComputeKind=uR,xL.SpecialStyle=CR,xL.SpecialFormat=yR,xL.UnavailableKind=Nw,xL.CloningTarget=Ow,xL.unavailable=Dw,xL.createCellSetFromRange=iR,xL.bspFactory=aR,xL.makeGridRangeTable=CT,xL.namedFormula=JT,xL.namedTable=qT,xL.empty=lA,xL.dense=sA,xL.union=XE,xL.unionProduct=UA,xL.meetsProduct=zA,xL.exceptProduct=HA,xL.blankStyleValue=DD,xL.UnitExperiment=fw,xL.ExperimentKind=kw,xL.registerExperimentFactory=Rw,xL.incrementFailure=ML,xL.arrayChecker=PR,xL.chBoolean=JR,xL.check=OR,xL.chFiniteNumber=WR,xL.chPossiblyInfiniteNumber=HR,xL.objectChecker=wR,xL.oneOfChecker=ZR,xL.optChecker=MR,(UL||(UL={})).getWorksheetFunc=CD,(jL=GL||(GL={})).FontUnderline=kD,jL.FontVerticalAlignment=ED,jL.FillKind=AD,jL.PatternType=RD,jL.BorderLineType=ND,jL.HorizontalAlignment=TD,jL.VerticalAlignment=ID,(HL=VL||(VL={})).runSmokeTest=QL,HL.cancelSmokeTest=JL;var XL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};function ZL(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=(t=this.obj)[e].apply(t,r);return Promise.resolve(a)}},n=0,a=e;n<a.length;n++){r(a[n])}return t}(e)}}function $L(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return os().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var eP=function(e){function t(t){var r=this,n=(new(function(e){function t(){var t=e.call(this,XL,XL,XL)||this;return t.interval=void 0,t.calcGrid=t,t}return Object(fe.c)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!0,configurable:!0}),t.prototype.runTasks=function(){for(;!this.calcGrid.dataModel.step().queueEmpty;);},t.prototype.startRecalc=function(e){void 0===e&&(e=5),this.stopRecalc(),this.interval=setInterval(this.runTasks.bind(this),e)},t.prototype.stopRecalc=function(){void 0!==this.interval&&clearInterval(this.interval),this.interval=void 0},t}(KL))).calcGrid,a=vL(t).createRecalcSideGrid(n);return(r=e.call(this,a)||this).calcGrid=n,r.document=n.document,r}return Object(fe.c)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!0,configurable:!0}),t.prototype.setSheet=function(e,t,r){var n=la(oa(void 0,""),e);this.calcGrid.updateSheetNames(0,[Vk(n.index,t)]);for(var a=[],i=0;i<r.length;i+=1){var o=r[i];if(void 0!==o)for(var u=0;u<o.length;u+=1){var s=o[u];if(void 0!==s){var l=Qk(n.index,i,u);a.push(nE(l,tE($L(s),s,0)))}}}this.calcGrid.updateRanges(0,Object(fe.f)([nE(Qk(n.index,0,0))],a)),this.runTasks()},t.prototype.setNamedObjects=function(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()},t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t}(ZL()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIntersectingTables","getIformats","discardSnapshot"]));function tP(e){var t=new eP(e),r=W_(t,(function(){return t.calcGrid.resumeRecalc()}));return r.setSheet=t.setSheet.bind(t),r.setNamedObjects=t.setNamedObjects.bind(t),r.document=t.document,Object.defineProperty(r,"calcConfig",{get:function(){return t.calcConfig}}),r}!function(){function e(e){var t=this;this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(void 0!==t.handle)throw"setImmediate called, even though we already have a callback";return t.setImmediateCalls.push(e),t.handle=setImmediate((function(){var r;return t.handle=void 0,e[0].apply(e,null!==(r=e[1])&&void 0!==r?r:[])}))},this.clearImmediate=function(e){if(t.handle!==e)throw"clearImmediate called with a different handle than the one supplied";clearImmediate(t.handle),t.clearImmediateCalls.push([e]),t.handle=void 0},this.setTimeout=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(void 0!==t.handle)throw"setTimeout called, even though we already have a callback";return t.setTimeoutCalls.push(e),t.handle=setImmediate((function(){var r;return t.handle=void 0,e[0].apply(e,null!==(r=e[2])&&void 0!==r?r:[])}))},this.clearTimeout=function(e){if(t.handle!==e)throw"clearTimeout called with a different handle than the one supplied";clearImmediate(t.handle),t.clearTimeoutCalls.push([e]),t.handle=void 0}}e.prototype.now=function(){var e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e}}();var rP=function(){function e(t,r){var n=this;void 0===t&&(t=1),void 0===r&&(r=0),this.precisionMs=t,this.startTime=r,this.setImmediate=function(t){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var i={delayUntil:-1,callback:t,args:r,isValid:!0};return n.queue.enqueue(i),new e.Immediate(i)},this.clearImmediate=function(t){if(!(t instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immedate");t.delayedCallback.isValid=!1},this.setTimeout=function(t,r){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];var o=n.time+(r>4?r:4),u={delayUntil:o,callback:t,args:a,isValid:!0};return n.queue.enqueue(u),new e.Timeout(u)},this.clearTimeout=function(t){if(!(t instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");t.delayedCallback.isValid=!1},this.time=r>0?r:0,this.queue=new s_((function(e,t){return e.delayUntil-t.delayUntil}))}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(e){this.time+=e>0?e:0},e.prototype.busyWaitUntil=function(e){this.time=this.time<e?e:this.time},e.prototype.runMacrotasksWhile=function(e){return Object(fe.b)(this,void 0,void 0,(function(){var t;return Object(fe.d)(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setImmediate((function(){return e()}))}))];case 1:if(r.sent(),!e())return[2];if(!(t=this.queue.pop()))return[2];if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback.apply(t,t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:e.message,filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}}))}))},e.Immediate=function(e){this.delayedCallback=e},e.Timeout=function(e){this.delayedCallback=e},e}(),nP=function(){function e(e){this.config=e,this.tableNameCache={}}return e.prototype.getDocumentLoc=function(e,t){var r,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,{kind:xw.GetSheetNames}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getDocumentLoc",(r=a.sent()).kind===xw.GetSheetNames),void 0===(n=r.document)||void 0!==e&&e!==n.path||0!==this.config.localeInfo.stringCompareCI(t,n.name)?[2,ge(xn(["getDocumentLoc: document"]))]:[2,he(n)]}}))},e.prototype.getSheetIndex=function(e,t){var r,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,{kind:xw.GetSheetNames}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getSheetIndex",(r=a.sent()).kind===xw.GetSheetNames),Zr(e,r.document)?[2,he(void 0===(n=r.nameToIndex.getValue(t))?void 0:r.sheets[n].sheetIndex.index)]:[2,ge(xn(["getSheetIndex: document"]))]}}))},e.prototype.getSheetName=function(e,t){var r;return Object(fe.d)(this,(function(n){switch(n.label){case 0:return[4,{kind:xw.GetSheetNames}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getSheetName",(r=n.sent()).kind===xw.GetSheetNames),Zr(e,r.document)?[2,he(r.sheets[r.idToIndex[t]].sheetName)]:[2,ge(xn(["getSheetName: document"]))]}}))},e.prototype.getSheetRangeIndexes=function(e){var t,r,n,a,i;return Object(fe.d)(this,(function(o){switch(o.label){case 0:return[4,{kind:xw.GetSheetNames}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getSheetRangeIndexes",(t=o.sent()).kind===xw.GetSheetNames),Zr(e.document,t.document)?(r=0,n=t.sheets.length,void 0!==e.index&&(a=t.idToIndex[e.index],i=t.idToIndex[e.index2],r=k(a,i),n=E(a,i)+1),[2,he(da(t.sheets.slice(r,n).map((function(e){return e.sheetIndex.index})),r))]):[2,ge(xn(["getSheetRangeIndexes: document"]))]}}))},e.prototype.getContainingTable=function(e){var t,r;return Object(fe.d)(this,(function(n){switch(n.label){case 0:return[4,{kind:xw.GetContainingTable,cell:e}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getContainingTable",(t=n.sent()).kind===xw.GetContainingTable),Se(t.result)?void 0===(r=t.result.value)?[2,he(void 0)]:(this.tableNameCache[r.name]=r,[2,he(Aa(ka(e.sheet.document),r.name))]):[2,t.result]}}))},e.prototype.getStructRefColumn=function(e,t){var r,n;return Object(fe.d)(this,(function(a){return void 0===(r=this.tableNameCache[e.name])?[2,ge(ls(as.UndefinedTableName))]:void 0===(n="string"==typeof t?r.nameToColumn.getValue(t):r.indexToColumn[t])?[2,ge(ls(as.UndefinedColumnName))]:[2,he(ua(n.name,ba(r.sheet,ha(r.dataRange.row,n.column,r.dataRange.rows,1)),void 0!==r.headersRange,void 0!==r.totalsRange))]}))},e.prototype.getStructRefSpecialRef=function(e,t){var r;return Object(fe.d)(this,(function(n){if(void 0===(r=this.tableNameCache[e.name]))return[2,ge(ls(as.UndefinedTableName))];switch(t){case At.All:return[2,he(ba(r.sheet,r.allRange))];case At.Data:return[2,he(ba(r.sheet,r.dataRange))];case At.Headers:return[2,he(void 0!==r.headersRange?ba(r.sheet,r.headersRange):void 0)];case At.Totals:return[2,he(void 0!==r.totalsRange?ba(r.sheet,r.totalsRange):void 0)];default:return[2,te("calc.x10.GlobalsGeneratorImpl.getStructRefSpecialRef",t)]}return[2]}))},e.prototype.getCellValue=function(e){var t;return Object(fe.d)(this,(function(r){switch(r.label){case 0:return[4,{kind:xw.GetCell,cell:e}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getCellValue",(t=r.sent()).kind===xw.GetCell),Se(t.result)?[2,he(Ty(t.result.value.value))]:[2,t.result]}}))},e.prototype.getCellFormula=function(e){var t,r,n,a;return Object(fe.d)(this,(function(i){switch(i.label){case 0:return[4,{kind:xw.GetCell,cell:e}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getCellFormula",(t=i.sent()).kind===xw.GetCell),Se(t.result)?(r=t.result.value.formula).kind!==T_.CellFormula?[2,me]:(n=r,[4,{kind:xw.ParseCellFormula,cell:e,formula:n,useEnglishLocaleInfo:!1}]):[2,t.result];case 2:return ne("calc.x10.GlobalsGeneratorImpl.getCellFormula",(a=i.sent()).kind===xw.ParseCellFormula),Se(a.result)?[2,he(Fy(ra(e),a.result.value))]:[2,ge(xn(["getCellFormula: parse/analyze failure"]))]}}))},e.prototype.getHiddenRows=function(){return Object(fe.d)(this,(function(e){return[2,he([])]}))},e.prototype.getHiddenCols=function(){return Object(fe.d)(this,(function(e){return[2,he([])]}))},e.prototype.getCellFormat=function(e){var t,r,n;return Object(fe.d)(this,(function(a){switch(a.label){case 0:return[4,{kind:xw.GetCell,cell:e}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getCellFormat",(t=a.sent()).kind===xw.GetCell),Se(t.result)?"number"==typeof(r=t.result.value.format)?[2,he(r)]:[4,{kind:xw.ParseNumberFormat,formatString:r,builtIn:!1}]:[2,t.result];case 2:return ne("calc.x10.GlobalsGeneratorImpl.getCellFormat",(n=a.sent()).kind===xw.ParseNumberFormat),Se(n.result)?[2,he(n.result.value)]:[2,ge(xn(["getCellFormat: parse format failure"]))]}}))},e.prototype.getIformat=function(e,t){var r,n,a,i,o;return Object(fe.d)(this,(function(u){switch(u.label){case 0:return[4,{kind:xw.GetIformat,document:e,iformat:t}];case 1:return ne("calc.x10.GlobalsGeneratorImpl.getIformat",(r=u.sent()).kind===xw.GetIformat),Se(r.result)?(n=r.result.value,a=n.formatString,i=n.builtIn,[4,{kind:xw.ParseNumberFormat,formatString:a,builtIn:i}]):[2,r.result];case 2:return ne("calc.x10.GlobalsGeneratorImpl.getIformat",(o=u.sent()).kind===xw.ParseNumberFormat),Se(o.result)?[2,he(o.result.value)]:[2,ge(xn(["getIformat: parse format failure"]))]}}))},e.prototype.getMergeCell=function(e){return Object(fe.d)(this,(function(e){return[2,me]}))},e.prototype.getCellStyle=function(e){return Object(fe.d)(this,(function(e){return[2,he(DD)]}))},e}();function aP(){var e;return Object(fe.d)(this,(function(t){switch(t.label){case 0:return[4,{kind:xw.GetConfig}];case 1:return ne("calc.x10.GetConfig",(e=t.sent()).kind===xw.GetConfig),[2,new nP(e.config)]}}))}var iP,oP,uP=new aI((function(){var e;return(e={})[Ka.ABS]="=ABS(2)",e[Ka.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'+FormulaAuthoringStrings.Sales+'","['+FormulaAuthoringStrings.Time+"].["+FormulaAuthoringStrings.Fiscal+'].[2014]",$A$3)',e[Ka.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'+FormulaAuthoringStrings.Sales+'",$D$4,1,"'+FormulaAuthoringStrings.TopMonth+'")',e[Ka.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[Ka.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[Ka.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[Ka.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[Ka.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[Ka.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[Ka.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[Ka.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[Ka.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[Ka.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[Ka.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[Ka.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'+FormulaAuthoringStrings.Sales+'","'+FormulaAuthoringStrings.MySalesKPI+'",1)',e[Ka.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[Ka.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[Ka.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[Ka.GETPIVOTDATA]='=GETPIVOTDATA("'+FormulaAuthoringStrings.Sales+'", $A$3, "'+FormulaAuthoringStrings.Region+'", "'+FormulaAuthoringStrings.South+'")',e[Ka.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[Ka.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[Ka.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[Ka.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[Ka.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[Ka.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[Ka.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[Ka.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[Ka.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[Ka.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[Ka.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[Ka.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[Ka.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[Ka.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[Ka.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[Ka.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[Ka.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[Ka.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[Ka.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[Ka.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[Ka.REGISTER_ID]='=REGISTER.ID(Kernel32, "GetTickCount", "J!")',e[Ka.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[Ka.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[Ka.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[Ka.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[Ka.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[Ka.FORMULATEXT]="=FORMULATEXT(A2)",e[Ka.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[Ka.CONCATENATE]='=CONCATENATE("'+FormulaAuthoringStrings.Andreas+'", " ", "'+FormulaAuthoringStrings.Hauser+'")',e[Ka.ISO_CEILING]="=ISO.CEILING(4.3)",e[Ka.VALUETOTEXT]='=VALUETOTEXT("'+FormulaAuthoringStrings.SomeText+'")',e[Ka.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[Ka.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[Ka.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[Ka.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[Ka.CUBEMEMBER]='=CUBEMEMBER("'+FormulaAuthoringStrings.Sales+'",(B4, C6, D5),"'+FormulaAuthoringStrings.SalesFor2004+'")',e[Ka.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[Ka.SUBSTITUTE]='=SUBSTITUTE("'+FormulaAuthoringStrings.SalesData+'", "'+FormulaAuthoringStrings.Sales+'", "'+FormulaAuthoringStrings.Cost+'")',e[Ka.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[Ka.WEBSERVICE]="=WEBSERVICE("+FormulaAuthoringStrings.WebServiceLink+")",e[Ka.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[Ka.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[Ka.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[Ka.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[Ka.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[Ka.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[Ka.NORM_S_INV]="=NORM.S.INV(0.908789)",e[Ka.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[Ka.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[Ka.FIELDVALUE]='=FIELDVALUE(A2, "'+FormulaAuthoringStrings.Price+'")',e[Ka.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[Ka.BITLSHIFT]="=BITLSHIFT(4,2)",e[Ka.BITRSHIFT]="=BITRSHIFT(13,2)",e[Ka.DATEVALUE]="=DATEVALUE(40685)",e[Ka.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[Ka.CUBEVALUE]='=CUBEVALUE(Sales,"['+FormulaAuthoringStrings.Measures+"].["+FormulaAuthoringStrings.Profit+']","['+FormulaAuthoringStrings.Time+'].[2004]","['+FormulaAuthoringStrings.AllProduct+"].["+FormulaAuthoringStrings.Beverages+']")',e[Ka.ENCODEURL]='=ENCODEURL("'+FormulaAuthoringStrings.EncodeURLExmapleLink+'")',e[Ka.HYPERLINK]='=HYPERLINK("'+FormulaAuthoringStrings.HyperlinkExampleLink+'", "'+FormulaAuthoringStrings.ClickForReport+'")',e[Ka.ISLOGICAL]="=ISLOGICAL(TRUE)",e[Ka.ISNONTEXT]="=ISNONTEXT(A2)",e[Ka.ISFORMULA]="=ISFORMULA(A2)",e[Ka.PDURATION]="=PDURATION(2.5%,2000,2200)",e[Ka.TIMEVALUE]="=TIMEVALUE(0.1)",e[Ka.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[Ka.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[Ka.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[Ka.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[Ka.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[Ka.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[Ka.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[Ka.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[Ka.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[Ka.FISHERINV]="=FISHERINV(0.972955)",e[Ka.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[Ka.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[Ka.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[Ka.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[Ka.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[Ka.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[Ka.MODE_MULT]="=MODE.MULT(A2:A13)",e[Ka.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[Ka.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[Ka.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[Ka.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[Ka.DAVERAGE]='=DAVERAGE(A4:E10, "'+FormulaAuthoringStrings.Yield+'", A1:B2)',e[Ka.BAHTTEXT]="=BAHTTEXT(1234)",e[Ka.DPRODUCT]='=DPRODUCT(A5:E11, "'+FormulaAuthoringStrings.Yield+'", A1:F3)',e[Ka.INDIRECT]="=INDIRECT(B&A)",e[Ka.ISNUMBER]="=ISNUMBER(A2)",e[Ka.MINVERSE]="=MINVERSE(A1:D4)",e[Ka.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[Ka.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[Ka.BETADIST]="=BETADIST(2,8,10,1,3)",e[Ka.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[Ka.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[Ka.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[Ka.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[Ka.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[Ka.NORMSINV]="=NORMSINV(0.9088)",e[Ka.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[Ka.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[Ka.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[Ka.QUARTILE]="=QUARTILE(A2:A9,1)",e[Ka.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[Ka.T_INV_2T]="=T.INV.2T(0.546449,60)",e[Ka.AVERAGEA]="=AVERAGEA(A2:A6)",e[Ka.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[Ka.SEQUENCE]="=SEQUENCE(4,5)",e[Ka.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['+FormulaAuthoringStrings.Book1+"]"+FormulaAuthoringStrings.Sheet1+'")',e[Ka.AVERAGE]="=AVERAGE(A2:A6)",e[Ka.COLUMNS]="=COLUMNS(C1:E4)",e[Ka.COUNTIF]='=COUNTIF(B2:B5,">55")',e[Ka.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[Ka.DCOUNTA]='=DCOUNTA(A4:E10, "'+FormulaAuthoringStrings.Profit+'", A1:F2)',e[Ka.DECIMAL]="=DECIMAL(FF,16)",e[Ka.DEGREES]="=DEGREES(PI())",e[Ka.DSTDEVP]='=DSTDEVP(A5:E11, "'+FormulaAuthoringStrings.Yield+'", A1:A3)',e[Ka.CUBESET]='=CUBESET("'+FormulaAuthoringStrings.Sales+'","['+FormulaAuthoringStrings.Product+"].["+FormulaAuthoringStrings.AllProducts+"]."+FormulaAuthoringStrings.Children+'","'+FormulaAuthoringStrings.Products+'",1,"['+FormulaAuthoringStrings.Measures+"].["+FormulaAuthoringStrings.SalesAmount+']")',e[Ka.HLOOKUP]='=HLOOKUP("'+FormulaAuthoringStrings.Axles+'", A1:C4, 2, TRUE)',e[Ka.IFERROR]='=IFERROR(55/0, "'+FormulaAuthoringStrings.ErrorInCalculation+'")',e[Ka.ISBLANK]="=ISBLANK(A2)",e[Ka.ISERROR]="=ISERROR(#REF!)",e[Ka.XLOOKUP]="=XLOOKUP(3405, A2:B26, 2, FALSE)",e[Ka.MDETERM]="=MDETERM(A2:D5)",e[Ka.PRODUCT]="=PRODUCT(A2:A4)",e[Ka.RADIANS]="=RADIANS(270)",e[Ka.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[Ka.REPLACE]='=REPLACE(2009,3,2,"10")',e[Ka.STDEV_S]="=STDEV.S(A2:A11)",e[Ka.STDEV_P]="=STDEV.P(A3:A12)",e[Ka.UNICODE]="=UNICODE(B)",e[Ka.UNICHAR]="=UNICHAR(66)",e[Ka.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[Ka.WEEKDAY]="=WEEKDAY(39492)",e[Ka.GAMMALN]="=GAMMALN(4)",e[Ka.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[Ka.CHIDIST]="=CHIDIST(18.307,10)",e[Ka.COMBINA]="=COMBINA(4,3)",e[Ka.CEILING]="=CEILING(2.5, 1)",e[Ka.NORMINV]="=NORMINV(0.908789,40,1.5)",e[Ka.POISSON]="=POISSON(1, 2, TRUE)",e[Ka.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[Ka.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[Ka.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[Ka.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[Ka.GEOMEAN]="=GEOMEAN(A2:A8)",e[Ka.HARMEAN]="=HARMEAN(A2:A8)",e[Ka.STDEVPA]="=STDEVPA(A3:A12)",e[Ka.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[Ka.ARABIC]="=ARABIC(LVII)",e[Ka.CHOOSE]='=CHOOSE(3,"'+FormulaAuthoringStrings.Wide+'",115,"'+FormulaAuthoringStrings.World+'",8)',e[Ka.COLUMN]="=COLUMN(C9)",e[Ka.COUNTA]="=COUNTA(B2:B6)",e[Ka.DCOUNT]='=DCOUNT(A5:E11, "'+FormulaAuthoringStrings.Age+'", A1:F2)',e[Ka.DOLLAR]="=DOLLAR(1.2351, 4)",e[Ka.DSTDEV]='=DSTDEV(A5:E11, "'+FormulaAuthoringStrings.Yield+'", A1:A3)',e[Ka.GROWTH]="=GROWTH(#VALUE!)",e[Ka.IMCOSH]='=IMCOSH("4+3i")',e[Ka.IMCSCH]='=IMCSCH("4+3i")',e[Ka.IMSECH]='=IMSECH("4+3i")',e[Ka.IMSINH]='=IMSINH("4+3i")',e[Ka.ISTEXT]='=ISTEXT("'+FormulaAuthoringStrings.Region1+'")',e[Ka.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[Ka.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[Ka.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[Ka.XMATCH]="=XMATCH(F2,C3:C9,1)",e[Ka.MEDIAN]="=MEDIAN(A2:A6)",e[Ka.MINUTE]="=MINUTE(0.53125)",e[Ka.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[Ka.PROPER]='=PROPER("'+FormulaAuthoringStrings.ThisIsATITLE+'")',e[Ka.SEARCH]='=SEARCH("'+FormulaAuthoringStrings.E+'","'+FormulaAuthoringStrings.Statements+'",6)',e[Ka.SECOND]="=SECOND(0.700208333333333)",e[Ka.SHEETS]="=SHEETS("+FormulaAuthoringStrings.My3DRef+")",e[Ka.STDEVP]="=STDEVP(A3:A12)",e[Ka.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'+FormulaAuthoringStrings.Bananas+'", C2:C9, "'+FormulaAuthoringStrings.Tom+'")',e[Ka.AVEDEV]="=AVEDEV(A2:A8)",e[Ka.CHIINV]="=CHIINV(0.3, 2)",e[Ka.COMBIN]="=COMBIN(8,2)",e[Ka.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[Ka.FISHER]="=FISHER(0.75)",e[Ka.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[Ka.PERMUT]="=PERMUT(100,3)",e[Ka.T_DIST]="=T.DIST(60,1,TRUE)",e[Ka.CORREL]="=CORREL(A2:A6, B2:B6)",e[Ka.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[Ka.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[Ka.SKEW_P]="=SKEW.P(A2:A11)",e[Ka.Z_TEST]="=Z.TEST(A2:A11,4)",e[Ka.STDEVA]="=STDEVA(A3:A12)",e[Ka.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'+FormulaAuthoringStrings.IfsB+'",D2:D7,">100")',e[Ka.MINIFS]='=MINIFS(A2:A7,B2:B7,"'+FormulaAuthoringStrings.IfsB+'",D2:D7,">100")',e[Ka.CONCAT]='=CONCAT("'+FormulaAuthoringStrings.Andreas+'"," ", "'+FormulaAuthoringStrings.Hauser+'")',e[Ka.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'+FormulaAuthoringStrings.Sunday+'",2,"'+FormulaAuthoringStrings.Monday+'",3,"'+FormulaAuthoringStrings.Tuesday+'","'+FormulaAuthoringStrings.NoMatch+'")',e[Ka.FILTER]='=FILTER(A5:D20,(C5:C20="'+FormulaAuthoringStrings.Apple+'")*(A5:A20="'+FormulaAuthoringStrings.East+'"),"")',e[Ka.UNIQUE]="=UNIQUE(A2:A12)",e[Ka.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[Ka.BITAND]="=BITAND(1,5)",e[Ka.BITXOR]="=BITXOR(5,3)",e[Ka.ACOSH]="=ACOSH(10)",e[Ka.ACOTH]="=ACOTH(6)",e[Ka.ATANH]="=ATANH(-0.1)",e[Ka.ATAN2]="=ATAN2(4,0)",e[Ka.CLEAN]="=CLEAN(A2)",e[Ka.COUNT]="=COUNT(A2:A7)",e[Ka.DVARP]='=DVARP(A4:E10, "'+FormulaAuthoringStrings.Yield+'", A1:A3)',e[Ka.EXACT]='=EXACT("'+FormulaAuthoringStrings.Hello+'", "'+FormulaAuthoringStrings.Goodbye+'")',e[Ka.FALSE]="=FALSE()",e[Ka.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[Ka.IMCOT]='=IMCOT("4+3i")',e[Ka.IMCSC]='=IMCSC("4+3i")',e[Ka.IMSEC]='=IMSEC("4+3i")',e[Ka.IMTAN]='=IMTAN("4+3i")',e[Ka.INDEX]="=INDEX(A2:B3,2,1)",e[Ka.ISERR]="=ISERR(#N/A)",e[Ka.ISREF]="=ISREF(A2)",e[Ka.LOWER]='=LOWER("'+FormulaAuthoringStrings.EECummings+'")',e[Ka.MATCH]="=MATCH(39,B2:B5,1)",e[Ka.MMULT]="=MMULT(A1:B3, C1:F2)",e[Ka.MONTH]="=MONTH(40648)",e[Ka.RIGHT]='=RIGHT("'+FormulaAuthoringStrings.SalePrice+'",5)',e[Ka.ROUND]="=ROUND(2.149, 1)",e[Ka.SHEET]="=SHEET("+FormulaAuthoringStrings.Table1+")",e[Ka.STDEV]="=STDEV(A3:A12)",e[Ka.SUMIF]='=SUMIF(A2:A5,">160000")',e[Ka.TODAY]="=TODAY()",e[Ka.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[Ka.TRUNC]="=TRUNC(8.9)",e[Ka.UPPER]='=UPPER("'+FormulaAuthoringStrings.KelliXu+'")',e[Ka.VALUE]="=VALUE(1000)",e[Ka.VAR_S]="=VAR.S(A2:A11)",e[Ka.VAR_P]="=VAR.P(A2:A11)",e[Ka.GAMMA]="=GAMMA(-3.75)",e[Ka.GAUSS]="=GAUSS(2)",e[Ka.FDIST]="=FDIST(15.20686486,6,4)",e[Ka.F_INV]="=F.INV(0.01,6,4)",e[Ka.FLOOR]="=FLOOR(23.25, 0.1)",e[Ka.TDIST]="=TDIST(60, 1, 1)",e[Ka.COVAR]="=COVAR(A2:A6, B2:B6)",e[Ka.FTEST]="=FTEST(A2:A6,B2:B6)",e[Ka.STEYX]="=STEYX(A3:A9,B3:B9)",e[Ka.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[Ka.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[Ka.DEVSQ]="=DEVSQ(A2:A8)",e[Ka.SUMSQ]="=SUMSQ(3, 4)",e[Ka.ZTEST]="=ZTEST(A2:A11,6)",e[Ka.LARGE]="=LARGE(A2:B6,7)",e[Ka.SMALL]="=SMALL(A2:A10,4)",e[Ka.MUNIT]="=MUNIT(2)",e[Ka.T_INV]="=T.INV(0.75,2)",e[Ka.ROMAN]="=ROMAN(499,0)",e[Ka.POWER]="=POWER(5,2)",e[Ka.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[Ka.VARPA]="=VARPA(1, 2)",e[Ka.AREAS]="=AREAS(B2:D4)",e[Ka.ASINH]="=ASINH(10)",e[Ka.BITOR]="=BITOR(23,10)",e[Ka.ACOS]="=ACOS(-0.5)",e[Ka.ACOT]="=ACOT(2)",e[Ka.ATAN]="=ATAN(1)",e[Ka.CALL]="=CALL(A5)",e[Ka.CELL]='=CELL("'+FormulaAuthoringStrings.Address+'", C2)',e[Ka.CHAR]="=CHAR(65)",e[Ka.COSH]="=COSH(EXP(1))",e[Ka.COTH]="=COTH(2)",e[Ka.CSCH]="=CSCH(2)",e[Ka.DATE]="=DATE(2008,1,2)",e[Ka.DAYS]="=DAYS(3/15/11,2/1/11)",e[Ka.DGET]='=DGET(A5:E11, "'+FormulaAuthoringStrings.Yield+'", A1:A3)',e[Ka.DMAX]='=DMAX(A5:E11, "'+FormulaAuthoringStrings.Profit+'", A1:F3)',e[Ka.DMIN]='=DMIN(A5:E11, "'+FormulaAuthoringStrings.Profit+'", A1:F3)',e[Ka.DSUM]='=DSUM(A4:E10,"'+FormulaAuthoringStrings.Profit+'", A1:F3)',e[Ka.DVAR]='=DVAR(A4:E10, "'+FormulaAuthoringStrings.Yield+'", A1:A3)',e[Ka.FACT]="=FACT(5)",e[Ka.FIND]='=FIND("'+FormulaAuthoringStrings.M+'",A2)',e[Ka.HOUR]="=HOUR(0.75)",e[Ka.IFNA]='=IFNA("'+FormulaAuthoringStrings.NoNAError+'", "'+FormulaAuthoringStrings.Error+'")',e[Ka.IPMT]="=IPMT(10%, 3, 3, 8000)",e[Ka.ISNA]="=ISNA(#REF!)",e[Ka.LEFT]='=LEFT("'+FormulaAuthoringStrings.SalePrice+'",4)',e[Ka.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[Ka.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[Ka.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[Ka.RAND]="=RAND()",e[Ka.RANK]="=RANK(3.5,A2:A6,1)",e[Ka.RATE]="=RATE(4*12, -200, 8000)",e[Ka.REPT]='=REPT("*-", 3)',e[Ka.ROWS]="=ROWS(C1:E4)",e[Ka.SECH]="=SECH(0)",e[Ka.SIGN]="=SIGN(10)",e[Ka.SINH]="=SINH(2)",e[Ka.SQRT]="=SQRT(16)",e[Ka.TANH]="=TANH(0.5)",e[Ka.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[Ka.TIME]="=TIME(16,48,10)",e[Ka.TRIM]='=TRIM("'+FormulaAuthoringStrings.FirstQuarterEarnings+'")',e[Ka.TRUE]="=TRUE()",e[Ka.TYPE]='=TYPE("'+FormulaAuthoringStrings.Smith+'")',e[Ka.VARP]="=VARP(A2:A11)",e[Ka.YEAR]="=YEAR(39634)",e[Ka.INFO]='=INFO("'+FormulaAuthoringStrings.Numfile+'")',e[Ka.EVEN]="=EVEN(1.5)",e[Ka.FINV]="=FINV(0.42, 2, 3)",e[Ka.PROB]="=PROB(A3:A6,B3:B6,2)",e[Ka.KURT]="=KURT(A2:A11)",e[Ka.SKEW]="=SKEW(A2:A11)",e[Ka.MODE]="=MODE(A2:A7)",e[Ka.MINA]="=MINA(A2:A6)",e[Ka.MAXA]="=MAXA(A2:A6)",e[Ka.VARA]="=VARA(1, 2)",e[Ka.SORT]="=SORT(A2:A17)",e[Ka.ASIN]="=ASIN(-0.5)",e[Ka.BASE]="=BASE(7,2)",e[Ka.CODE]='=CODE("'+FormulaAuthoringStrings.CodeA+'")',e[Ka.AND]="=AND(A2>1,A2<100)",e[Ka.COS]="=COS(1.047)",e[Ka.COT]="=COT(30)",e[Ka.CSC]="=CSC(15)",e[Ka.DAY]="=DAY(40648)",e[Ka.DDB]="=DDB(2400,300,10*365,1)",e[Ka.RTD]='=RTD(mycomaddin.progid,,"'+FormulaAuthoringStrings.ServerName+'","'+FormulaAuthoringStrings.Price+'")',e[Ka.EXP]="=EXP(1)",e[Ka.INT]="=INT(8.9)",e[Ka.IRR]="=IRR(A2:A4,-10%)",e[Ka.LEN]='=LEN("'+FormulaAuthoringStrings.Excel+'")',e[Ka.LOG]="=LOG(10)",e[Ka.MAX]="=MAX(A2:A6)",e[Ka.MID]='=MID("'+FormulaAuthoringStrings.FluidFlow+'",1,5)',e[Ka.MIN]="=MIN(A2:A6)",e[Ka.MOD]="=MOD(3, 2)",e[Ka.NOT]="=NOT(A2>100)",e[Ka.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[Ka.PMT]="=PMT(0.08/12,10,10000)",e[Ka.ROW]="=ROW(C10)",e[Ka.RRI]="=RRI(96,10000,11000)",e[Ka.SEC]="=SEC(30)",e[Ka.SIN]="=SIN(PI())",e[Ka.SLN]="=SLN(30000, 7500, 10)",e[Ka.SUM]="=SUM(A1:A3)",e[Ka.SYD]="=SYD(30000,7500,10,1)",e[Ka.TAN]="=TAN(0.785)",e[Ka.VAR]="=VAR(A2:A11)",e[Ka.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[Ka.XOR]="=XOR(3>0,2<9)",e[Ka.ODD]="=ODD(1.5)",e[Ka.PHI]="=PHI(0.75)",e[Ka.RSQ]="=RSQ(A3:A9, B3:B9)",e[Ka.IFS]='=IFS(A2>89,"'+FormulaAuthoringStrings.IfsA+'",A2>79,"'+FormulaAuthoringStrings.IfsB+'",A2>69,"'+FormulaAuthoringStrings.IfsC+'",A2>59,"'+FormulaAuthoringStrings.IfsD+'",TRUE,"'+FormulaAuthoringStrings.IfsF+'")',e[Ka.DB]="=DB(1000000,100000,6,1,7)",e[Ka.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[Ka.IF]='=IF(C2>B2,"'+FormulaAuthoringStrings.OverBudget+'","'+FormulaAuthoringStrings.WithinBudget+'")',e[Ka.LN]="=LN(86)",e[Ka.NA]="=NA()",e[Ka.OR]="=OR(A2>1,A2<100)",e[Ka.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[Ka.N]="=N("+FormulaAuthoringStrings.Even+")",e[Ka.T]='=T("'+FormulaAuthoringStrings.Hello+'")',e[Ka.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[Ka.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[Ka.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[Ka.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[Ka.BESSELI]="=BESSELI(1.5,1)",e[Ka.BESSELJ]="=BESSELJ(1.9,2)",e[Ka.BESSELK]="=BESSELK(1.5,1)",e[Ka.BESSELY]="=BESSELY(2.5,1)",e[Ka.BIN2DEC]="=BIN2DEC(1100100)",e[Ka.BIN2HEX]="=BIN2HEX(11111011, 4)",e[Ka.BIN2OCT]="=BIN2OCT(1001, 3)",e[Ka.COMPLEX]='=COMPLEX(3,4,"j")',e[Ka.CONVERT]='=CONVERT(1,"lbm","kg")',e[Ka.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[Ka.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[Ka.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[Ka.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[Ka.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[Ka.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[Ka.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[Ka.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[Ka.DEC2BIN]="=DEC2BIN(9, 4)",e[Ka.DEC2HEX]="=DEC2HEX(100,4)",e[Ka.DEC2OCT]="=DEC2OCT(58,3)",e[Ka.DELTA]="=DELTA(5,4)",e[Ka.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[Ka.DOLLARDE]="=DOLLARDE(1.02,16)",e[Ka.DOLLARFR]="=DOLLARFR(1.125,16)",e[Ka.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[Ka.EDATE]="=EDATE(15-Jan-11,1)",e[Ka.EFFECT]="=EFFECT(0.0525,4)",e[Ka.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[Ka.ERF]="=ERF(0.745)",e[Ka.ERFC]="=ERFC(1)",e[Ka.FACTDOUBLE]="=FACTDOUBLE(6)",e[Ka.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[Ka.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[Ka.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[Ka.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[Ka.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[Ka.GCD]="=GCD(24,36)",e[Ka.GESTEP]="=GESTEP(5,4)",e[Ka.HEX2BIN]="=HEX2BIN(F,8)",e[Ka.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[Ka.HEX2OCT]="=HEX2OCT(F, 3)",e[Ka.IMABS]='=IMABS("5+12i")',e[Ka.IMAGINARY]='=IMAGINARY("3+4i")',e[Ka.IMARGUMENT]='=IMARGUMENT("3+4i")',e[Ka.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[Ka.IMCOS]='=IMCOS("1+i")',e[Ka.IMDIV]='=IMDIV("-238+240i","10+24i")',e[Ka.IMEXP]='=IMEXP("1+i")',e[Ka.IMLN]='=IMLN("3+4i")',e[Ka.IMLOG10]='=IMLOG10("3+4i")',e[Ka.IMLOG2]='=IMLOG2("3+4i")',e[Ka.IMPOWER]='=IMPOWER("2+3i", 3)',e[Ka.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[Ka.IMREAL]='=IMREAL("6-9i")',e[Ka.IMSIN]='=IMSIN("4+3i")',e[Ka.IMSQRT]='=IMSQRT("1+i")',e[Ka.IMSUB]='=IMSUB("13+4i","5+3i")',e[Ka.IMSUM]='=IMSUM("3+4i","5-3i")',e[Ka.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[Ka.ISEVEN]="=ISEVEN(2.5)",e[Ka.ISODD]="=ISODD(2.5)",e[Ka.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[Ka.LET]='=LET(value1, "Hello World ", value2, SUM(1,122), value1 & value2)',e[Ka.LCM]="=LCM(5,2)",e[Ka.LOG10]="=LOG10(86)",e[Ka.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[Ka.MROUND]="=MROUND(10,3)",e[Ka.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[Ka.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[Ka.NOMINAL]="=NOMINAL(0.053543, 4)",e[Ka.NOW]="=NOW()",e[Ka.OCT2BIN]="=OCT2BIN(3,3)",e[Ka.OCT2DEC]="=OCT2DEC(54)",e[Ka.OCT2HEX]="=OCT2HEX(100,4)",e[Ka.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[Ka.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[Ka.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[Ka.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[Ka.PI]="=PI()",e[Ka.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[Ka.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[Ka.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[Ka.QUOTIENT]="=QUOTIENT(5,2)",e[Ka.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[Ka.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[Ka.RECURSE]="=RECURSE()",e[Ka.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[Ka.ROUNDUP]="=ROUNDUP(3.14159,3)",e[Ka.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[Ka.SQRTPI]="=SQRTPI(1)",e[Ka.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[Ka.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[Ka.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[Ka.TINV]="=TINV(0.05464,60)",e[Ka.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[Ka.WORKDAY]="=WORKDAY(10/1/2008,151)",e[Ka.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[Ka.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[Ka.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[Ka.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[Ka.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[Ka.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e})),sP=function(){function e(){}return e.create=function(){return new e},e.prototype.run=function(e){var t,r,n,a,i,o,u,s,l,c,d,f;return Object(fe.d)(this,(function(h){switch(h.label){case 0:return[4,{kind:xw.GetActiveCell}];case 1:return(t=h.sent()).kind!==xw.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):[4,{kind:xw.ParseEdit,cell:t.activeCell,formulaBarText:e.content}];case 2:return(r=h.sent()).kind===xw.ParseEdit&&Se(r.result)&&r.result.value.kind===km.Formula?(n=r.result.value.formula,St(a=new lP(n,e.caretPosition),n),void 0===a.assistedFunctionHead?[2,null]:[4,{kind:xw.GetFunctionInfo,functionName:a.assistedFunctionHead.whole}]):(this.logFailure("failed to parse cell content"),[2,null]);case 3:return(i=h.sent()).kind!==xw.GetFunctionInfo?(this.logFailure("failed to get function info for "+a.assistedFunctionHead.whole),[2,null]):[4,{kind:xw.GetConfig}];case 4:return o=h.sent(),u=o.kind===xw.GetConfig?o.config.localeInfo.listSeparator:",",s=this.createFunctionRenderingInfo(i.functionInfo,n,a.assistedFunctionArgs,e.caretPosition,a.assistedFunctionHead.id,u),void 0===(l=uP.getValue()[a.assistedFunctionHead.id])?(this.logFailure("no example found for WSFId: "+a.assistedFunctionHead.id),[2,s]):[4,{kind:xw.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:l,kind:T_.CellFormula},useEnglishLocaleInfo:!0}];case 5:return(c=h.sent()).kind===xw.ParseCellFormula&&Se(c.result)?o.kind===xw.GetConfig&&o.config.localeInfo.lcid===bu.USA?[2,this.createFunctionRenderingInfo(i.functionInfo,n,a.assistedFunctionArgs,e.caretPosition,a.assistedFunctionHead.id,u,l,c.result.value)]:[4,{kind:xw.PrintFormula,formula:c.result.value,origin:t.activeCell}]:(this.logFailure("failed to parse example for WSFId: "+a.assistedFunctionHead.id),[2,s]);case 6:return(d=h.sent()).kind===xw.PrintFormula&&Se(d.result)?[4,{kind:xw.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:d.result.value,kind:T_.CellFormula},useEnglishLocaleInfo:!1}]:(this.logFailure("failed to pretty print localized example for WSFId: "+a.assistedFunctionHead.id),[2,s]);case 7:return(f=h.sent()).kind===xw.ParseCellFormula&&Se(f.result)?[2,this.createFunctionRenderingInfo(i.functionInfo,n,a.assistedFunctionArgs,e.caretPosition,a.assistedFunctionHead.id,u,d.result.value,f.result.value)]:(this.logFailure("failed to parse localized example for WSFId: "+a.assistedFunctionHead.id),[2,s])}}))},e.prototype.createFunctionRenderingInfo=function(e,t,r,n,a,i,o,u){var s=this,l=this.getActiveParamIndex(t,r,n),c=e.Params.split("!");return{functionName:e.NameDataStrings,functionDescription:e.Help,signatures:c.map((function(t,r){return s.createFunctionSignature(e,t,r,l,a,i,o,u)})),activeSignature:0,listSeparator:i,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},e.prototype.createFunctionSignature=function(e,t,r,n,a,i,o,u){var s=vi(a),l=""!==t?t.split(i+" "):[],c=this.getLocalizedExampleParamsArray(o,u),d=e.ParamsHelp.split("!"),f=l.slice(0,d.length),h={signatureParams:this.createParameters(l,this.getParamIndexToHighlight(n,l.filter((function(e){return"..."!==e})).length,s)),descriptions:d,descriptionParams:this.createParameters(f,this.getParamIndexToHighlight(n,f.length,s)),exampleParams:null!==c?this.createParameters(c,this.getParamIndexToHighlight(n,c.length,s,!0)):null,exampleDescription:""};return 1===r&&(h.descriptions=h.descriptions.slice(-1*l.length)),h},e.prototype.getActiveParamIndex=function(e,t,r){for(var n,a=0,i=t.length-1;i>=0;i-=1){var o=null===(n=e.spans[t[i].label])||void 0===n?void 0:n.end;void 0!==o&&r<=o&&(a=i)}return a},e.prototype.getParamIndexToHighlight=function(e,t,r,n){void 0===n&&(n=!1);var a=n?r.tailTypes.length:0;if(e<t-a)return e;var i=t-1;if(2===r.restTypes.length){var o=e+1;return i-a-Math.max(0,o-r.headTypes.length)%2}return i},e.prototype.getLocalizedExampleParamsArray=function(e,t){return void 0===e||void 0===t?null:t.node.args.map((function(r){var n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))},e.prototype.createParameters=function(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}},e.prototype.logFailure=function(e){ee.ULS.traceTag(556344668,I.LogCategory.msoulscat_ES_EWAJS,I.TraceLevel.Warning,"ArgumentAssistancePlugin encountered a failure with msg "+e)},e.factoryName=Lw.ArgumentAssistancePlugin,e}(),lP=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n.assistedFunctionScopeStart=0,n}return Object(fe.c)(t,e),t.prototype.appNode=function(t,r,n,a){return t.kind===kt.WSF&&this.updateAssistedFunction(t,r),e.prototype.appNode.call(this,t,r,n,a)},t.prototype.letNode=function(t,r,n,a,i,o){var u=e.prototype.letNode.call(this,t,r,n,a,i,o);return this.updateAssistedFunction(t,u.args),u},t.prototype.lambdaNode=function(t,r,n,a,i,o){var u=e.prototype.lambdaNode.call(this,t,r,n,a,i,o);return this.updateAssistedFunction(t,u.args),u},t.prototype.updateAssistedFunction=function(e,t){var r,n,a,i=null===(r=this.parsedFormulaTree.spans[t[0].label])||void 0===r?void 0:r.start,o=null===(n=this.parsedFormulaTree.spans[t[t.length-1].label])||void 0===n?void 0:n.end;void 0!==o&&void 0!==i&&this.caretPosition<=o&&(this.caretPosition>=i||1===(null===(a=this.parsedFormulaTree.spans[e.label])||void 0===a?void 0:a.start))&&(void 0===this.assistedFunctionHead||i>this.assistedFunctionScopeStart)&&void 0!==this.parsedFormulaTree.spans[e.label]&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=i)},t}(ze);a_(sP),(oP=iP||(iP={})).defaultPluginResponseWindows=D_,oP.SchedulerVersion=cL,oP.getSchedulerFactories=vL,oP.PluginSchedulerSingleton=sL,oP.FormulaKind=T_,oP.createMockAsyncGrid=tP,oP.MockTimerImmediate=rP,oP.PluginFactoryName=Lw,oP.registerPluginFactory=a_,oP.createDynamicPluginLoader=lL,oP.DynamicPluginLoader=dL,oP.devDynamicPluginLoaderInsideInit=G_,oP.stableDynamicPluginLoaderInsideInit=G_,oP.PluginRequestKind=xw,oP.typedRequest=Kw,oP.awaitPromise=zw,oP.yieldStarAsyncGenerator=Yw,oP.delay=$w,oP.delayRequest=Xw,oP.getSheetNamesRequest=Jw,oP.getRangeRequest=qw,oP.getCellRequest=Qw,oP.parseCellFormulaRequest=e_,oP.RequestKind=Ww,oP.NotificationKind=Bw,oP.PluginSchedulerResultKind=Pw,oP.createGlobalsGenerator=aP,oP.ArgumentAssistancePlugin=sP;var cP=new sL;r.d(t,"featureGates",(function(){return dP})),r.d(t,"packageVersion",(function(){return"28.11.0"})),r.d(t,"PluginSchedulerSingletonGlobal",(function(){return cP})),r.d(t,"common",(function(){return Re})),r.d(t,"location",(function(){return Fl})),r.d(t,"formula",(function(){return wl})),r.d(t,"value",(function(){return Dl})),r.d(t,"signature",(function(){return Ll})),r.d(t,"util",(function(){return xl})),r.d(t,"config",(function(){return Ul})),r.d(t,"math",(function(){return jl})),r.d(t,"date",(function(){return Hl})),r.d(t,"parse",(function(){return up})),r.d(t,"analyze",(function(){return jp})),r.d(t,"numfmt",(function(){return sy})),r.d(t,"runtime",(function(){return Ek})),r.d(t,"calc",(function(){return PL})),r.d(t,"funcs",(function(){return UL})),r.d(t,"style",(function(){return GL})),r.d(t,"worker",(function(){return VL})),r.d(t,"x10",(function(){return iP}));var dP={getTypedFeatureGate:Be,overrideFeatureGatesForTest:function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t[a]=e[a].toString()}var i=Object(Me.e)((function(){return{}}));if(void 0===i)throw new Error("Attempt to override FeatureGates while getFeatureGateDictionary callback is not set");return Object(Me.e)((function(){return Object(fe.a)(Object(fe.a)({},i()),t)})),i},setFeatureGateDictionaryGetter:Me.e}}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map